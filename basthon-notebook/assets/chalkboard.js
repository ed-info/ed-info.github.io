function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var RevealChalkboard=window.RevealChalkboard||function(){var e,t,n=function(){var e;if(document.currentScript)e=document.currentScript.src;else{var t=document.querySelector('script[src$="/chalkboard.js"]');t&&(e=t.src)}return void 0===_typeof(e)?e:e.slice(0,e.lastIndexOf("/")+1)}(),a=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){a=!0}}))}catch(e){}var o,r=!1,i=3,s=7,l=1,c=[!0,!1],d={src:n+"img/sponge.png",radius:20},u=[{color:"rgba(100,100,100,1)",cursor:"url("+n+"img/boardmarker-black.png), auto"},{color:"rgba(30,144,255, 1)",cursor:"url("+n+"img/boardmarker-blue.png), auto"},{color:"rgba(220,20,60,1)",cursor:"url("+n+"img/boardmarker-red.png), auto"},{color:"rgba(50,205,50,1)",cursor:"url("+n+"img/boardmarker-green.png), auto"},{color:"rgba(255,140,0,1)",cursor:"url("+n+"img/boardmarker-orange.png), auto"},{color:"rgba(150,0,20150,1)",cursor:"url("+n+"img/boardmarker-purple.png), auto"},{color:"rgba(255,220,0,1)",cursor:"url("+n+"img/boardmarker-yellow.png), auto"}],h=[{color:"rgba(255,255,255,0.5)",cursor:"url("+n+"img/chalk-white.png), auto"},{color:"rgba(96, 154, 244, 0.5)",cursor:"url("+n+"img/chalk-blue.png), auto"},{color:"rgba(237, 20, 28, 0.5)",cursor:"url("+n+"img/chalk-red.png), auto"},{color:"rgba(20, 237, 28, 0.5)",cursor:"url("+n+"img/chalk-green.png), auto"},{color:"rgba(220, 133, 41, 0.5)",cursor:"url("+n+"img/chalk-orange.png), auto"},{color:"rgba(220,0,220,0.5)",cursor:"url("+n+"img/chalk-purple.png), auto"},{color:"rgba(255,220,0,0.5)",cursor:"url("+n+"img/chalk-yellow.png), auto"}],g="chalkboard",v=[0,0],f=!0,p=!0,y=800,m=void 0,b=w(Reveal.getConfig().chalkboard||{});function w(a){return(a.boardmarkerWidth||a.penWidth)&&(i=a.boardmarkerWidth||a.penWidth),a.chalkWidth&&(s=a.chalkWidth),"chalkEffect"in a&&(l="chalkEffect"in a),a.rememberColor&&(c=a.rememberColor),a.eraser&&(d=a.eraser),"boardmarkers"in a&&(u=a.boardmarkers),"chalks"in a&&(h=a.chalks),a.theme&&(g=a.theme),"whiteboard"===g?(e=["rgba(127,127,127,.1)",n+"img/whiteboard.png"],t=[Y,Y],pens=[u,u],r={color:"rgb(127,127,255,0.1)",distance:40,width:2}):(e=["rgba(127,127,127,.1)",n+"img/blackboard.png"],t=[Y,_],pens=[u,h],r={color:"rgb(50,50,10,0.5)",distance:80,width:2}),a.background&&(e=a.background),null!=a.grid&&(r=a.grid),null!=a.toggleChalkboardButton&&(f=a.toggleChalkboardButton),null!=a.toggleNotesButton&&(p=a.toggleNotesButton),a.transition&&(y=a.transition),a.readOnly&&(m=a.readOnly),x&&(a.theme||a.background||a.grid)&&(document.getElementById(x[1].id).style.background='url("'+e[1]+'") repeat',$(1),G()),a}function k(e){null==N||document.querySelector("section[data-markdown]:not([data-markdown-parsed])")?setTimeout(k,500,e):e()}f&&((o=document.createElement("div")).className="chalkboard-button",o.id="toggle-chalkboard",o.style.visibility="visible",o.style.position="absolute",o.style.zIndex=30,o.style.fontSize="24px",o.style.left=f.left||"30px",o.style.bottom=f.bottom||"30px",o.style.top=f.top||"auto",o.style.right=f.right||"auto",o.innerHTML='<a href="#" onclick="RevealChalkboard.toggleChalkboard(); return false;"><i class="fa fa-pencil-square"></i></a>',document.querySelector(".reveal").appendChild(o)),p&&((o=document.createElement("div")).className="chalkboard-button",o.id="toggle-notes",o.style.position="absolute",o.style.zIndex=30,o.style.fontSize="24px",o.style.left=p.left||"70px",o.style.bottom=p.bottom||"30px",o.style.top=p.top||"auto",o.style.right=p.right||"auto",o.innerHTML='<a href="#" onclick="RevealChalkboard.toggleNotesCanvas(); return false;"><i class="fa fa-pencil"></i></a>',document.querySelector(".reveal").appendChild(o));var x=[{id:"notescanvas"},{id:"chalkboard"}];I(0),I(1);var E=0,C=0,O=0,S=null,D=null,M=Date.now(),R={h:0,v:0},T=null,L=[[],[]],W=null,P=null,q=!1;function I(t){var n=document.createElement("div");if(n.id=x[t].id,n.classList.add("overlay"),n.setAttribute("data-prevent-swipe",""),n.oncontextmenu=function(){return!1},n.style.cursor=pens[t][v[t]].cursor,x[t].width=window.innerWidth,x[t].height=window.innerHeight,x[t].scale=1,x[t].xOffset=0,x[t].yOffset=0,"0"==t){n.style.background="rgba(0,0,0,0)",n.style.zIndex="24",n.style.opacity=1,n.style.visibility="visible",n.style.pointerEvents="none",document.querySelector(".slides");var a=Reveal.getConfig().width/Reveal.getConfig().height;x[t].width>x[t].height*a?x[t].xOffset=(x[t].width-x[t].height*a)/2:x[t].height>x[t].width/a&&(x[t].yOffset=(x[t].height-x[t].width/a)/2)}else n.style.background='url("'+e[t]+'") repeat',n.style.zIndex="26",n.style.opacity=0,n.style.visibility="hidden";var o=document.createElement("img");o.src=d.src,o.id="sponge",o.style.visibility="hidden",o.style.position="absolute",n.appendChild(o),x[t].sponge=o;var r=document.createElement("canvas");r.width=x[t].width,r.height=x[t].height,r.setAttribute("data-chalkboard",t),r.style.cursor=pens[t][v[t]].cursor,n.appendChild(r),x[t].canvas=r,x[t].context=r.getContext("2d"),document.querySelector(".reveal").appendChild(n),x[t].container=n}var A=[{width:x[0].width-2*x[0].xOffset,height:x[0].height-2*x[0].yOffset,data:[]},{width:x[1].width,height:x[1].height,data:[]}],N=null;function z(e,t){null==t&&(t=E),e||(e=R);for(var n=0;n<A[t].data.length;n++)if(A[t].data[n].slide.h===e.h&&A[t].data[n].slide.v===e.v&&A[t].data[n].slide.f===e.f)return A[t].data[n];return A[t].data.push({slide:e,events:[],duration:0}),A[t].data[A[t].data.length-1]}function B(e){e||(e=R);for(var t=0,n=0;n<2;n++)for(var a=0;a<A[n].data.length;a++)if(A[n].data[a].slide.h===e.h&&A[n].data[a].slide.v===e.v&&A[n].data[a].slide.f===e.f){t=Math.max(t,A[n].data[a].duration);break}return t}null!=b.src&&function(e){var t=new XMLHttpRequest;t.onload=function(){if(4===t.readyState&&404!=t.status){A=JSON.parse(t.responseText);for(var n=0;n<A.length;n++)x[n].width==A[n].width&&x[n].height==A[n].height||(x[n].scale=Math.min(x[n].width/A[n].width,x[n].height/A[n].height),x[n].xOffset=(x[n].width-A[n].width*x[n].scale)/2,x[n].yOffset=(x[n].height-A[n].height*x[n].scale)/2),b.readOnly&&(x[n].container.style.cursor="default",x[n].canvas.style.cursor="default");N=!0}else b.readOnly=void 0,m=void 0,console.warn("Failed to get file "+e+". ReadyState: "+t.readyState+", Status: "+t.status),N=!1},t.open("GET",e,!0);try{t.send()}catch(t){b.readOnly=void 0,m=void 0,console.warn("Failed to get file "+e+". Make sure that the presentation and the file are served by a HTTP server and the file can be found there. "+t),N=!1}}(b.src);var H=/print-pdf/gi.test(window.location.search);function j(){x[0].container.style.opacity=0,x[0].container.style.visibility="hidden";for(var n=[],a=0;a<A[1].data.length;a++){var o=Reveal.getSlide(A[1].data[a].slide.h,A[1].data[a].slide.v);n.push(o.nextSibling)}var r=new Image;r.onload=function(){var e=Reveal.getConfig().width,a=Reveal.getConfig().height,o=1,i=0,s=0;e==A[1].width&&a==A[1].height||(o=Math.min(e/A[1].width,a/A[1].height),i=(e-A[1].width*o)/2,s=(a-A[1].height*o)/2),E=1;for(var l=0;l<A[1].data.length;l++){console.log("Create printout for slide "+A[1].data[l].slide.h+"."+A[1].data[l].slide.v);var c=Reveal.getSlide(A[1].data[l].slide.h,A[1].data[l].slide.v).parentElement,d=z(A[1].data[l].slide,1),u=document.createElement("canvas");u.width=e,u.height=a;var h=u.getContext("2d");h.fillStyle=h.createPattern(r,"repeat"),h.rect(0,0,u.width,u.height),h.fill();for(var g=0;g<d.events.length;g++)switch(d.events[g].type){case"draw":for(var v=1;v<d.events[g].curve.length;v++)t[1](h,i+d.events[g].curve[v-1].x*o,s+d.events[g].curve[v-1].y*o,i+d.events[g].curve[v].x*o,s+d.events[g].curve[v].y*o);break;case"erase":for(v=0;v<d.events[g].curve.length;v++)U(h,i+d.events[g].curve[v].x*o,s+d.events[g].curve[v].y*o);break;case"setcolor":K(d.events[g].index);break;case"clear":X(c,n[l],u,r),h.clearRect(0,0,u.width,u.height),h.fill()}E=0,d.events.length&&X(c,n[l],u,r)}Reveal.sync()},r.src=e[1]}function X(e,t,n,a){var o=document.createElement("canvas");o.width=Reveal.getConfig().width,o.height=Reveal.getConfig().height;var r=o.getContext("2d");r.fillStyle=r.createPattern(a,"repeat"),r.rect(0,0,o.width,o.height),r.fill(),r.drawImage(n,0,0);var i=document.createElement("section");i.classList.add("present"),i.innerHTML='<h1 style="visibility:hidden">Drawing</h1>',i.setAttribute("data-background-size","100% 100%"),i.setAttribute("data-background-repeat","norepeat"),i.setAttribute("data-background",'url("'+o.toDataURL("image/png")+'")'),null!=t?e.insertBefore(i,t):e.append(i)}function Y(e,t,n,a,o){e.lineWidth=i,e.lineCap="round",e.strokeStyle=u[v[E]].color,e.beginPath(),e.moveTo(t,n),e.lineTo(a,o),e.stroke()}function _(e,t,n,a,o){var r=s;e.lineWidth=r,e.lineCap="round",e.fillStyle=h[v[E]].color,e.strokeStyle=h[v[E]].color,e.strokeStyle=e.strokeStyle.replace(/[\d\.]+\)$/g,"1)"),e.beginPath(),e.moveTo(t,n),e.lineTo(a,o),e.stroke();for(var i=Math.round(Math.sqrt(Math.pow(a-t,2)+Math.pow(o-n,2))/(5/r)),c=(a-t)/i,d=(o-n)/i,u=0;u<i;u++)if(l>.9*Math.random()){var g=n+u*d,f=t+u*c+(Math.random()-.5)*r*1.2,p=g+(Math.random()-.5)*r*1.2;e.clearRect(f,p,2*Math.random()+2,Math.random()+1)}}function U(e,t,n){e.save(),e.beginPath(),e.arc(t,n,d.radius,0,2*Math.PI,!1),e.clip(),e.clearRect(t-d.radius-1,n-d.radius-1,2*d.radius+2,2*d.radius+2),e.restore(),1==E&&r&&function(e,t,n){var a=x[1].context;x[1].scale=Math.min(x[1].width/A[1].width,x[1].height/A[1].height),x[1].xOffset=(x[1].width-A[1].width*x[1].scale)/2,x[1].yOffset=(x[1].height-A[1].height*x[1].scale)/2;for(var o=x[1].scale,i=(x[1].xOffset,x[1].yOffset,r.distance*o),s=x[1].width/2-i/2-Math.floor((x[1].width-i)/2/i)*i,l=s+i*Math.ceil((e-n-s)/i);l<=s+i*Math.floor((e+n-s)/i);l+=i)a.beginPath(),a.lineWidth=r.width*o,a.lineCap="round",a.fillStyle=r.color,a.strokeStyle=r.color,a.moveTo(l,t-Math.sqrt(n*n-(e-l)*(e-l))),a.lineTo(l,t+Math.sqrt(n*n-(e-l)*(e-l))),a.stroke();for(var c=x[1].height/2-i/2-Math.floor((x[1].height-i)/2/i)*i,d=c+i*Math.ceil((t-n-c)/i);d<=c+i*Math.floor((t+n-c)/i);d+=i)a.beginPath(),a.lineWidth=r.width*o,a.lineCap="round",a.fillStyle=r.color,a.strokeStyle=r.color,a.moveTo(e-Math.sqrt(n*n-(t-d)*(t-d)),d),a.lineTo(e+Math.sqrt(n*n-(t-d)*(t-d)),d),a.stroke()}(t,n,d.radius)}function F(){clearTimeout(W),W=null,x[0].sponge.style.visibility="hidden",x[1].sponge.style.visibility="hidden",x[1].container.style.opacity=1,x[1].container.style.visibility="visible",E=1;var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"showChalkboard"},document.dispatchEvent(e)}function J(){clearTimeout(W),W=null,x[0].sponge.style.visibility="hidden",x[1].sponge.style.visibility="hidden",x[1].container.style.opacity=0,x[1].container.style.visibility="hidden",S=null,D=null,T=null,E=0;var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"closeChalkboard"},document.dispatchEvent(e)}function $(e){0==e&&clearTimeout(P),x[e].context.clearRect(0,0,x[e].width,x[e].height),1==e&&r&&G()}function G(){var e=x[1].context;x[1].scale=Math.min(x[1].width/A[1].width,x[1].height/A[1].height),x[1].xOffset=(x[1].width-A[1].width*x[1].scale)/2,x[1].yOffset=(x[1].height-A[1].height*x[1].scale)/2;for(var t=x[1].scale,n=(x[1].xOffset,x[1].yOffset,r.distance*t),a=x[1].width/2-n/2-Math.floor((x[1].width-n)/2/n)*n;a<x[1].width;a+=n)e.beginPath(),e.lineWidth=r.width*t,e.lineCap="round",e.fillStyle=r.color,e.strokeStyle=r.color,e.moveTo(a,0),e.lineTo(a,x[1].height),e.stroke();for(var o=x[1].height/2-n/2-Math.floor((x[1].height-n)/2/n)*n;o<x[1].height;o+=n)e.beginPath(),e.lineWidth=r.width*t,e.lineCap="round",e.fillStyle=r.color,e.strokeStyle=r.color,e.moveTo(0,o),e.lineTo(x[1].width,o),e.stroke()}function K(e){e>=u[E].length&&(e=0),v[E]=e,x[E].canvas.style.cursor=pens[E][v[E]].cursor}function Q(e){for(var t=z(),n=t.events.length;n>0&&e.begin<t.events[n-1].begin;)n--;t.events.splice(n,0,e),t.duration=Math.max(t.duration,Date.now()-M)+1}function V(){ce(!0),ie(),M=Date.now()}function Z(e,t,n){null==n&&ie(),M=Date.now()-e,J(),E=0;for(var a=0;a<2;a++){$(a);for(var o=z(R,a),r=0;r<o.events.length&&o.events[r].begin<Date.now()-M;)te(a,o.events[r],e),r++;for(;q&&r<o.events.length;)L[a].push(setTimeout(te,o.events[r].begin-(Date.now()-M),a,o.events[r],e)),r++}null!=t&&(E=t),1==E&&F()}function ee(){for(var e=0;e<2;e++){for(var t=0;t<L[e].length;t++)clearTimeout(L[e][t]);L[e]=[]}}function te(e,n,a){switch(n.type){case"open":a<=n.begin?F():E=1;break;case"close":a<n.begin?J():E=0;break;case"clear":$(e);break;case"setcolor":K(n.index);break;case"draw":!function(e,n,a){if(n.curve.length>1)for(var o=x[e].context,r=x[e].scale,i=x[e].xOffset,s=x[e].yOffset,l=(n.end-n.begin)/(n.curve.length-1),c=1;c<n.curve.length;c++)n.begin+c*l<=Date.now()-M?t[e](o,i+n.curve[c-1].x*r,s+n.curve[c-1].y*r,i+n.curve[c].x*r,s+n.curve[c].y*r):q&&L.push(setTimeout(t[e],Math.max(0,n.begin+c*l-(Date.now()-M)),o,i+n.curve[c-1].x*r,s+n.curve[c-1].y*r,i+n.curve[c].x*r,s+n.curve[c].y*r))}(e,n);break;case"erase":!function(e,t,n){if(t.curve.length>1)for(var a=x[e].context,o=x[e].scale,r=x[e].xOffset,i=x[e].yOffset,s=(t.end-t.begin)/t.curve.length,l=0;l<t.curve.length;l++)t.begin+l*s<=Date.now()-M?U(a,r+t.curve[l].x*o,i+t.curve[l].y*o):q&&L.push(setTimeout(U,Math.max(0,t.begin+l*s-(Date.now()-M)),a,r+t.curve[l].x*o,i+t.curve[l].y*o))}(e,n)}}function ne(e,t,n){var a=x[E].context,o=x[E].scale,r=x[E].xOffset,i=x[E].yOffset;S=e*o+r,D=t*o+i,1==n?(T={type:"erase",begin:Date.now()-M,end:null,curve:[{x:e,y:t}]},x[E].canvas.style.cursor='url("'+d.src+'") '+d.radius+" "+d.radius+", auto",U(a,e*o+r,t*o+i)):T={type:"draw",begin:Date.now()-M,end:null,curve:[{x:e,y:t}]}}function ae(e,t){if(T){T.type="erase",T.begin=Date.now()-M,x[E].sponge.style.left=e-d.radius+"px",x[E].sponge.style.top=t-d.radius+"px",x[E].sponge.style.visibility="visible",U(x[E].context,e,t);var n=new CustomEvent("send");n.content={sender:"chalkboard-plugin",type:"startErasing",x:(C-xOffset)/scale,y:(O-yOffset)/scale},document.dispatchEvent(n)}}function oe(e,n,a){var o=x[E].context,r=x[E].scale,i=x[E].xOffset,s=x[E].yOffset;T||ne(e,n,a),T.curve.push({x:e,y:n}),n*r+s<x[E].height&&e*r+i<x[E].width&&(a?U(o,e*r+i,n*r+s):t[E](o,S,D,e*r+i,n*r+s),S=e*r+i,D=n*r+s)}function re(){T&&(T.end=Date.now()-M,("erase"==T.type||T.curve.length>1)&&Q(T),T=null)}function ie(){null==b.readOnly&&((m=B()>0)?(x[0].container.style.cursor="default",x[1].container.style.cursor="default",x[0].canvas.style.cursor="default",x[1].canvas.style.cursor="default","none"!=notescanvas.style.pointerEvents&&(T=null,notescanvas.style.background="rgba(0,0,0,0)",notescanvas.style.pointerEvents="none")):(x[0].container.style.cursor=pens[0][v[0]].cursor,x[1].container.style.cursor=pens[1][v[1]].cursor,x[0].canvas.style.cursor=pens[0][v[0]].cursor,x[1].canvas.style.cursor=pens[1][v[1]].cursor))}function se(){if(1==E)T=null,m||Q({type:"close",begin:Date.now()-M}),J();else if(F(),!m)if(Q({type:"open",begin:Date.now()-M}),K(0),Q({type:"setcolor",index:0,begin:Date.now()-M}),c[E]){var e=v[E];K(e),Q({type:"setcolor",index:e,begin:Date.now()-M})}else v[E]=0}function le(){if(!m){Q({type:"clear",begin:Date.now()-M}),$(E);var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"clear"},document.dispatchEvent(e)}}function ce(e){if(e||confirm("Please confirm to delete chalkboard drawings on this slide!")){var t;ee(),M=Date.now(),T=null,J(),$(0),$(1),E=1,(t=z()).duration=0,t.events=[],E=0,(t=z()).duration=0,t.events=[],ie();var n=new CustomEvent("send");n.content={sender:"chalkboard-plugin",type:"resetSlide"},document.dispatchEvent(n)}}return document.addEventListener("received",(function(e){if(e.content&&"chalkboard-plugin"==e.content.sender)switch(e.content.type){case"showChalkboard":F();break;case"closeChalkboard":J();break;case"startDrawing":ne(e.content.x,e.content.y,e.content.erase);break;case"startErasing":e.content&&(e.content.type="erase",e.content.begin=Date.now()-M,U(x[E].context,e.content.x,e.content.y));break;case"drawSegment":oe(e.content.x,e.content.y,e.content.erase);break;case"stopDrawing":re();break;case"clear":le();break;case"setcolor":K(e.content.index);break;case"resetSlide":ce(!0);break;case"init":A=e.content.storage;for(var t=0;t<2;t++)x[t].scale=Math.min(x[t].width/A[t].width,x[t].height/A[t].height),x[t].xOffset=(x[t].width-A[t].width*x[t].scale)/2,x[t].yOffset=(x[t].height-A[t].height*x[t].scale)/2;$(0),$(1),q||(P=setTimeout(Z,y,B(),0)),1==E&&0==e.content.mode&&setTimeout(J,y+50),0==E&&1==e.content.mode&&setTimeout(F,y+50),E=e.content.mode}})),document.addEventListener("newclient",(function(){var e=new CustomEvent("send");e.content={sender:"chalkboard-plugin",type:"init",storage:A,mode:E},document.dispatchEvent(e)})),document.addEventListener("seekplayback",(function(e){ee(),q&&0!=e.timestamp||Z(e.timestamp)})),document.addEventListener("startplayback",(function(e){ee(),q=!0,Z(e.timestamp)})),document.addEventListener("stopplayback",(function(e){q=!1,ee()})),document.addEventListener("startrecording",(function(e){V()})),document.addEventListener("touchstart",(function(e){if(!m&&e.target.getAttribute("data-chalkboard")==E){var t=x[E].scale,n=x[E].xOffset,a=x[E].yOffset;e.preventDefault();var o=e.touches[0];C=o.pageX,O=o.pageY,ne((C-n)/t,(O-a)/t,!1);var r=new CustomEvent("send");r.content={sender:"chalkboard-plugin",type:"startDrawing",x:(C-n)/t,y:(O-a)/t,erase:!1},document.dispatchEvent(r),W=setTimeout(ae,500,C,O)}}),!!a&&{passive:!1}),document.addEventListener("touchmove",(function(e){if(clearTimeout(W),W=null,T){var t=x[E].scale,n=x[E].xOffset,a=x[E].yOffset,o=e.touches[0];C=o.pageX,(O=o.pageY)<x[E].height&&C<x[E].width&&(e.preventDefault(),"erase"==T.type&&(x[E].sponge.style.left=C-d.radius+"px",x[E].sponge.style.top=O-d.radius+"px")),oe((C-n)/t,(O-a)/t,"erase"==T.type);var r=new CustomEvent("send");r.content={sender:"chalkboard-plugin",type:"drawSegment",x:(C-n)/t,y:(O-a)/t,erase:"erase"==T.type},document.dispatchEvent(r)}}),!1),document.addEventListener("touchend",(function(e){clearTimeout(W),W=null,x[E].sponge.style.visibility="hidden",re();var t=new CustomEvent("send");t.content={sender:"chalkboard-plugin",type:"stopDrawing"},document.dispatchEvent(t)}),!1),document.addEventListener("mousedown",(function(e){if(!m&&e.target.getAttribute("data-chalkboard")==E){var t=x[E].scale,n=x[E].xOffset,a=x[E].yOffset;C=e.pageX,O=e.pageY,ne((C-n)/t,(O-a)/t,2==e.button||1==e.button);var o=new CustomEvent("send");o.content={sender:"chalkboard-plugin",type:"startDrawing",x:(C-n)/t,y:(O-a)/t,erase:2==e.button||1==e.button},document.dispatchEvent(o)}})),document.addEventListener("mousemove",(function(e){if(T){var t=x[E].scale,n=x[E].xOffset,a=x[E].yOffset;C=e.pageX,O=e.pageY,oe((C-n)/t,(O-a)/t,"erase"==T.type);var o=new CustomEvent("send");o.content={sender:"chalkboard-plugin",type:"drawSegment",x:(C-n)/t,y:(O-a)/t,erase:"erase"==T.type},document.dispatchEvent(o)}})),document.addEventListener("mouseup",(function(e){if(x[E].canvas.style.cursor=pens[E][v[E]].cursor,T){re();var t=new CustomEvent("send");t.content={sender:"chalkboard-plugin",type:"stopDrawing"},document.dispatchEvent(t)}})),window.addEventListener("resize",(function(){var e=Date.now()-M;q||(e=B());for(var t=0;t<2;t++)x[t].width=window.innerWidth,x[t].height=window.innerHeight,x[t].canvas.width=x[t].width,x[t].canvas.height=x[t].height,x[t].context.canvas.width=x[t].width,x[t].context.canvas.height=x[t].height,x[t].scale=Math.min(x[t].width/A[t].width,x[t].height/A[t].height),x[t].xOffset=(x[t].width-A[t].width*x[t].scale)/2,x[t].yOffset=(x[t].height-A[t].height*x[t].scale)/2;Z(e,E,!0)})),Reveal.addEventListener("ready",(function(e){if(H)k(j);else{if(M=Date.now(),R=Reveal.getIndices(),q||Z(B(),0),Reveal.isAutoSliding()){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}ie()}})),Reveal.addEventListener("slidechanged",(function(e){if(!H){if(M=Date.now(),R=Reveal.getIndices(),J(),$(0),$(1),q||(P=setTimeout(Z,y,B(),0)),Reveal.isAutoSliding()){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}ie()}})),Reveal.addEventListener("fragmentshown",(function(e){if(!H){if(M=Date.now(),R=Reveal.getIndices(),J(),$(0),$(1),Reveal.isAutoSliding()){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}else q||Z(B(),0);ie()}})),Reveal.addEventListener("fragmenthidden",(function(e){H||(M=Date.now(),R=Reveal.getIndices(),J(),$(0),$(1),Reveal.isAutoSliding()?document.dispatchEvent(new CustomEvent("stopplayback")):q||(Z(B()),J()),ie())})),Reveal.addEventListener("autoslideresumed",(function(e){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)})),Reveal.addEventListener("autoslidepaused",(function(e){document.dispatchEvent(new CustomEvent("stopplayback")),Z(B(),0)})),this.drawWithBoardmarker=Y,this.drawWithChalk=_,this.toggleNotesCanvas=function(){if(!m)if(1==E)se(),notescanvas.style.background=e[0],notescanvas.style.pointerEvents="auto";else if("none"!=notescanvas.style.pointerEvents)T=null,notescanvas.style.background="rgba(0,0,0,0)",notescanvas.style.pointerEvents="none";else{if(K(0),Q({type:"setcolor",index:0,begin:Date.now()-M}),v[E]){var t=v[E];K(t),Q({type:"setcolor",index:t,begin:Date.now()-M})}else v[E]=0;notescanvas.style.background=e[0],notescanvas.style.pointerEvents="auto"}},this.toggleChalkboard=se,this.startRecording=V,this.clear=le,this.colorNext=function(){if(!m){var e=(v[E]=(v[E]+1)%pens[E].length,v[E]);K(e),Q({type:"setcolor",index:e,begin:Date.now()-M});var t=new CustomEvent("send");t.content={sender:"chalkboard-plugin",type:"setcolor",index:e},document.dispatchEvent(t)}},this.colorPrev=function(){if(!m){var e=(v[E]=(v[E]+(pens[E].length-1))%pens[E].length,v[E]);K(e),Q({type:"setcolor",index:e,begin:Date.now()-M});var t=new CustomEvent("send");t.content={sender:"chalkboard-plugin",type:"setcolor",index:e},document.dispatchEvent(t)}},this.reset=ce,this.resetAll=function(e){if(e||confirm("Please confirm to delete all chalkboard drawings!")){ee(),M=Date.now(),$(0),$(1),1==E&&(T=null,J()),A=[{width:x[0].width-2*x[0].xOffset,height:x[0].height-2*x[0].yOffset,data:[]},{width:x[1].width,height:x[1].height,data:[]}],ie();var t=new CustomEvent("send");t.content={sender:"chalkboard-plugin",type:"init",storage:A,mode:E},document.dispatchEvent(t)}},this.download=function(){var e=document.createElement("a");document.body.appendChild(e);try{for(var t=0;t<2;t++)for(var n=A[t].data.length-1;n>=0;n--)0==A[t].data[n].events.length&&A[t].data.splice(n,1);e.download="chalkboard.json";var a=new Blob([JSON.stringify(A)],{type:"application/json"});e.href=window.URL.createObjectURL(a)}catch(t){e.innerHTML+=" ("+t+")"}e.click(),document.body.removeChild(e)},this.configure=w,this}();