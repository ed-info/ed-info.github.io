MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready",(function(){var e=MathJax.ElementJax.mml,t=MathJax.Hub.config,i=MathJax.OutputJax.CommonHTML,a=e.mo().With({CHTML:i.BBOX.empty()}),n={newline:0,nobreak:1e6,goodbreak:[-200],badbreak:[200],auto:[0],maxwidth:1.33,toobig:800,nestfactor:400,spacefactor:-100,spaceoffset:2,spacelimit:1,fence:500,close:500},s={linebreakstyle:"after"};e.mbase.Augment({CHTMLlinebreakPenalty:n,CHTMLmultiline:function(t){for(var a=this;a.inferred||a.parent&&"mrow"===a.parent.type&&a.parent.isEmbellished();)a=a.parent;var l="math"===a.type&&"block"===a.Get("display")||"mtd"===a.type;a.isMultiline=!0;var h=this.getValues("linebreak","linebreakstyle","lineleading","linebreakmultchar","indentalign","indentshift","indentalignfirst","indentshiftfirst","indentalignlast","indentshiftlast");h.linebreakstyle===e.LINEBREAKSTYLE.INFIXLINEBREAKSTYLE&&(h.linebreakstyle=this.Get("infixlinebreakstyle")),h.lineleading=this.CHTMLlength2em(h.lineleading,.5),i.BBOX.empty(this.CHTML);for(var r=i.addElement(t,"mjx-stack"),d={BBOX:this.CHTML,n:0,Y:0,scale:this.CHTML.scale||1,isTop:l,values:{},VALUES:h},o=this.CHTMLgetAlign(d,{}),L=this.CHTMLgetShift(d,{},o),T=[],c={index:[],penalty:n.nobreak,w:0,W:L,shift:L,scanW:L,nest:0},C=!1;this.CHTMLbetterBreak(c,d,!0)&&(c.scanW>=i.linebreakWidth||c.penalty===n.newline);)this.CHTMLaddLine(r,T,c.index,d,c.values,C),T=c.index.slice(0),C=!0,o=this.CHTMLgetAlign(d,c.values),L=this.CHTMLgetShift(d,c.values,o),c.W=c.shift=c.scanW=L,c.penalty=n.nobreak;return d.isLast=!0,this.CHTMLaddLine(r,T,[],d,s,C),"math"===a.type&&(t.style.width=r.style.width=this.CHTML.pwidth="100%"),this.CHTML.mwidth=i.Em(this.CHTML.w),this.CHTML.isMultiline=a.CHTML.isMultiline=!0,r.style.verticalAlign=i.Em(d.d-this.CHTML.d),t},CHTMLbetterBreak:function(e,t,s){if(this.isToken)return!1;if(this.isEmbellished())return e.embellished=this,this.CoreMO().CHTMLbetterBreak(e,t);if(this.linebreakContainer)return!1;var l,h,r,d=e.index.slice(0),o=e.index.shift(),L=this.data.length,T=e.index.length>0,c=!1;for(null==o&&(o=-1),T||(o++,e.W+=e.w,e.w=0),r=e.scanW=e.W,e.nest++;o<L&&(e.scanW<n.maxwidth*i.linebreakWidth||0===e.w);){if(this.data[o]){if(this.data[o].CHTMLbetterBreak(e,t)&&(c=!0,d=[o].concat(e.index),l=e.W,h=e.w,e.penalty===n.newline))return e.index=d,e.nest&&e.nest--,!0;r=T?e.scanW:this.CHTMLaddWidth(o,e,r)}e.index=[],o++,T=!1}return s&&c&&(a.parent=this.parent,a.inherit=this.inherit,a.CHTMLbetterBreak(e,t)&&(c=!1,d=e.index)),e.nest&&e.nest--,e.index=d,c&&(e.W=l,e.w=h),c},CHTMLaddWidth:function(e,t,i){if(this.data[e]){var a=this.data[e].CHTML;i+=(a.w+(a.L||0)+(a.R||0))*(a.scale||1),t.W=t.scanW=i,t.w=0}return i},CHTMLaddLine:function(t,a,n,s,l,h){var r=i.addElement(t,"mjx-block",{},[["mjx-box"]]),d=r.firstChild,o=s.bbox=i.BBOX.empty();s.first=h,s.last=!0,this.CHTMLmoveLine(a,n,d,s,l),o.clean();var L=this.CHTMLgetAlign(s,l),T=this.CHTMLgetShift(s,l,L,!0),c=0;if(s.n>0){var C=i.FONTDATA.baselineskip,M=(null==s.values.lineleading?s.VALUES:s.values).lineleading*s.scale,m=s.Y;s.Y-=Math.max(C,s.d+o.h+M),c=m-s.Y-s.d-o.h}T&&(d.style.margin="0 "+i.Em(-T)+" 0 "+i.Em(T)),L!==e.INDENTALIGN.LEFT&&(r.style.textAlign=L),c&&(r.style.paddingTop=i.Em(c)),s.BBOX.combine(o,T,s.Y),s.d=s.bbox.d,s.values=l,s.n++},CHTMLgetAlign:function(i,a){var n,s=a,l=i.values,h=i.VALUES;return(n=0===i.n?s.indentalignfirst||l.indentalignfirst||h.indentalignfirst:i.isLast?l.indentalignlast||h.indentalignlast:l.indentalign||h.indentalign)===e.INDENTALIGN.INDENTALIGN&&(n=l.indentalign||h.indentalign),n===e.INDENTALIGN.AUTO&&(n=i.isTop?t.displayAlign:e.INDENTALIGN.LEFT),n},CHTMLgetShift:function(a,n,s,l){var h,r=n,d=a.values,o=a.VALUES;if((h=0===a.n?r.indentshiftfirst||d.indentshiftfirst||o.indentshiftfirst:a.isLast?d.indentshiftlast||o.indentshiftlast:d.indentshift||o.indentshift)===e.INDENTSHIFT.INDENTSHIFT&&(h=d.indentshift||o.indentshift),"auto"!==h&&""!==h||(h="0"),h=this.CHTMLlength2em(h,i.cwidth),a.isTop&&"0"!==t.displayIndent){var L=this.CHTMLlength2em(t.displayIndent,i.cwidth);h+=s===e.INDENTALIGN.RIGHT?-L:L}return s!==e.INDENTALIGN.RIGHT||l?h:-h},CHTMLmoveLine:function(e,t,i,a,n){var s=e[0],l=t[0];if(null==s&&(s=-1),null==l&&(l=this.data.length-1),s===l&&e.length>1)this.data[s].CHTMLmoveSlice(e.slice(1),t.slice(1),i,a,n,"marginLeft");else{var h=a.last;for(a.last=!1;s<l;)this.data[s]&&(e.length<=1?this.data[s].CHTMLmoveNode(i,a,n):this.data[s].CHTMLmoveSlice(e.slice(1),[],i,a,n,"marginLeft")),s++,a.first=!1,e=[];a.last=h,this.data[s]&&(t.length<=1?this.data[s].CHTMLmoveNode(i,a,n):this.data[s].CHTMLmoveSlice([],t.slice(1),i,a,n,"marginRight"))}},CHTMLmoveSlice:function(e,t,i,a,n,s){var l=this.CHTMLcreateSliceNode(i);return this.CHTMLmoveLine(e,t,l,a,n),l.style[s]&&(l.style[s]=""),this.CHTML.L&&("marginLeft"!==s?a.bbox.w+=this.CHTML.L:l.className=l.className.replace(/ MJXc-space\d/,"")),this.CHTML.R&&"marginRight"!==s&&(a.bbox.w+=this.CHTML.R),0===t.length&&(i=this.CHTMLnodeElement(),this.href&&(i=i.parentNode),i.parentNode.removeChild(i),i.nextMathJaxNode.id=i.id),l},CHTMLcreateSliceNode:function(e){var t=this.CHTMLnodeElement(),i=0;this.href&&(t=t.parentNode);for(var a=t;a.nextMathJaxNode;)a=a.nextMathJaxNode,i++;var n=t.cloneNode(!1);return a.nextMathJaxNode=n,n.nextMathJaxNode=null,n.id+="-MJX-Continue-"+i,e.appendChild(n)},CHTMLmoveNode:function(t,i,a){if(!i.first&&!i.last||i.first&&i.values.linebreakstyle===e.LINEBREAKSTYLE.BEFORE||i.last&&a.linebreakstyle===e.LINEBREAKSTYLE.AFTER){var n=this.CHTMLnodeElement();this.href&&(n=n.parentNode),t.appendChild(n),this.CHTML.pwidth&&!t.style.width&&(t.style.width=this.CHTML.pwidth),i.last&&(n.style.marginRight=""),(i.first||i.nextIsFirst)&&(n.style.marginLeft="",this.CHTML.L=0,n.className=n.className.replace(/ MJXc-space\d/,"")),i.first&&0===this.CHTML.w?i.nextIsFirst=!0:delete i.nextIsFirst,i.bbox.combine(this.CHTML,i.bbox.w,0)}}}),e.mfenced.Augment({CHTMLbetterBreak:function(e,t){var a,s,l,h=e.index.slice(0),r=e.index.shift(),d=this.data.length,o=e.index.length>0,L=!1;if(null==r&&(r=-1),o||(r++,e.W+=e.w,e.w=0),l=e.scanW=e.W,e.nest++,!this.dataI){this.dataI=[],this.data.open&&this.dataI.push("open"),d&&this.dataI.push(0);for(var T=1;T<d;T++)this.data["sep"+T]&&this.dataI.push("sep"+T),this.dataI.push(T);this.data.close&&this.dataI.push("close")}for(d=this.dataI.length;r<d&&(e.scanW<n.maxwidth*i.linebreakWidth||0===e.w);){var c=this.dataI[r];if(this.data[c]){if(this.data[c].CHTMLbetterBreak(e,t)&&(L=!0,h=[r].concat(e.index),a=e.W,s=e.w,e.penalty===n.newline))return e.index=h,e.nest&&e.nest--,!0;l=o?e.scanW:this.CHTMLaddWidth(r,e,l)}e.index=[],r++,o=!1}return e.nest&&e.nest--,e.index=h,L&&(e.W=a,e.w=s),L},CHTMLmoveLine:function(e,t,i,a,n){var s=e[0],l=t[0];if(null==s&&(s=-1),null==l&&(l=this.dataI.length-1),s===l&&e.length>1)this.data[this.dataI[s]].CHTMLmoveSlice(e.slice(1),t.slice(1),i,a,n,"marginLeft");else{var h=a.last;a.last=!1;for(var r=this.dataI[s];s<l;)this.data[r]&&(e.length<=1?this.data[r].CHTMLmoveNode(i,a,n):this.data[r].CHTMLmoveSlice(e.slice(1),[],i,a,n,"marginLeft")),s++,r=this.dataI[s],a.first=!1,e=[];a.last=h,this.data[r]&&(t.length<=1?this.data[r].CHTMLmoveNode(i,a,n):this.data[r].CHTMLmoveSlice([],t.slice(1),i,a,n,"marginRight"))}}}),e.msubsup.Augment({CHTMLbetterBreak:function(e,t){if(!this.data[this.base])return!1;var i,a,s,l=e.index.slice(0),h=e.index.shift(),r=e.index.length>0,d=!1;return r||(e.W+=e.w,e.w=0),s=e.scanW=e.W,null==h&&(this.CHTML.baseW=this.data[this.base].CHTML.w,this.CHTML.dw=this.CHTML.w-this.CHTML.baseW),this.data[this.base].CHTMLbetterBreak(e,t)&&(d=!0,l=[this.base].concat(e.index),i=e.W,a=e.w,e.penalty===n.newline&&(d=r=!0)),r||this.CHTMLaddWidth(this.base,e,s),e.scanW+=this.CHTML.dw,e.W=e.scanW,e.index=[],d&&(e.W=i,e.w=a,e.index=l),d},CHTMLmoveLine:function(e,t,a,n,s){if(this.data[this.base]){var l=i.addElement(a,"mjx-base"),h=this.data[this.base].CHTML.ic;h&&(l.style.marginRight=i.Em(-h)),e.length>1?this.data[this.base].CHTMLmoveSlice(e.slice(1),t.slice(1),l,n,s,"marginLeft"):t.length<=1?this.data[this.base].CHTMLmoveNode(l,n,s):this.data[this.base].CHTMLmoveSlice([],t.slice(1),l,n,s,"marginRight")}if(0===t.length){var r=this.CHTMLnodeElement(),d=i.getNode(r,"mjx-stack"),o=i.getNode(r,"mjx-sup"),L=i.getNode(r,"mjx-sub");d?a.appendChild(d):o?a.appendChild(o):L&&a.appendChild(L);var T,c=n.bbox.w;o&&(T=this.data[this.sup].CHTML,n.bbox.combine(T,c,T.Y)),L&&(T=this.data[this.sub].CHTML,n.bbox.combine(T,c,T.Y))}}}),e.mmultiscripts.Augment({CHTMLbetterBreak:function(e,t){if(!this.data[this.base])return!1;var i=e.index.slice(0);e.index.shift();var a,s,l,h=e.index.length>0,r=!1;h||(e.W+=e.w,e.w=0),e.scanW=e.W;var d=this.CHTML,o=this.data[this.base].CHTML,L=d.w-o.w-(d.X||0);return e.scanW+=d.X||0,l=e.scanW,this.data[this.base].CHTMLbetterBreak(e,t)&&(r=!0,i=[this.base].concat(e.index),a=e.W,s=e.w,e.penalty===n.newline&&(r=h=!0)),h||this.CHTMLaddWidth(this.base,e,l),e.scanW+=L,e.W=e.scanW,e.index=[],r&&(e.W=a,e.w=s,e.index=i),r},CHTMLmoveLine:function(e,t,a,n,s){var l,h,r=this.CHTMLbbox;if(e.length<1){l=this.CHTMLnodeElement();var d=i.getNode(l,"mjx-prestack"),o=i.getNode(l,"mjx-presup"),L=i.getNode(l,"mjx-presub");d?a.appendChild(d):o?a.appendChild(o):L&&a.appendChild(L),h=n.bbox.w,o&&n.bbox.combine(r.presup,h+r.presup.X,r.presup.Y),L&&n.bbox.combine(r.presub,h+r.presub.X,r.presub.Y)}if(this.data[this.base]){var T=i.addElement(a,"mjx-base");e.length>1?this.data[this.base].CHTMLmoveSlice(e.slice(1),t.slice(1),T,n,s,"marginLeft"):t.length<=1?this.data[this.base].CHTMLmoveNode(T,n,s):this.data[this.base].CHTMLmoveSlice([],t.slice(1),T,n,s,"marginRight")}if(0===t.length){l=this.CHTMLnodeElement();var c=i.getNode(l,"mjx-stack"),C=i.getNode(l,"mjx-sup"),M=i.getNode(l,"mjx-sub");c?a.appendChild(c):C?a.appendChild(C):M&&a.appendChild(M),h=n.bbox.w,C&&n.bbox.combine(r.sup,h,r.sup.Y),M&&n.bbox.combine(r.sub,h,r.sub.Y)}}}),e.mo.Augment({CHTMLbetterBreak:function(t,a){if(t.values&&t.values.id===this.CHTMLnodeID)return!1;var s=this.getValues("linebreak","linebreakstyle","lineleading","linebreakmultchar","indentalign","indentshift","indentalignfirst","indentshiftfirst","indentalignlast","indentshiftlast","texClass","fence");s.linebreakstyle===e.LINEBREAKSTYLE.INFIXLINEBREAKSTYLE&&(s.linebreakstyle=this.Get("infixlinebreakstyle")),s.texClass===e.TEXCLASS.OPEN&&t.nest++,s.texClass===e.TEXCLASS.CLOSE&&t.nest&&t.nest--;var l=t.scanW;delete t.embellished;var h=this.CHTML.w+(this.CHTML.L||0)+(this.CHTML.R||0);if(s.linebreakstyle===e.LINEBREAKSTYLE.AFTER&&(l+=h,h=0),l-t.shift==0&&s.linebreak!==e.LINEBREAK.NEWLINE)return!1;var r=i.linebreakWidth-l;if(0===a.n&&(s.indentshiftfirst!==a.VALUES.indentshiftfirst||s.indentalignfirst!==a.VALUES.indentalignfirst)){var d=this.CHTMLgetAlign(a,s),o=this.CHTMLgetShift(a,s,d);r+=t.shift-o}var L=Math.floor(r/i.linebreakWidth*1e3);L<0&&(L=n.toobig-3*L),s.fence&&(L+=n.fence),(s.linebreakstyle===e.LINEBREAKSTYLE.AFTER&&s.texClass===e.TEXCLASS.OPEN||s.texClass===e.TEXCLASS.CLOSE)&&(L+=n.close),L+=t.nest*n.nestfactor;var T=n[s.linebreak||e.LINEBREAK.AUTO]||0;return MathJax.Object.isArray(T)?L=Math.max(1,L+T[0]*t.nest):(T||r>=0)&&(L=T*t.nest),!(L>=t.penalty||(t.penalty=L,t.values=s,t.W=l,t.w=h,s.lineleading=this.CHTMLlength2em(s.lineleading,a.VALUES.lineleading),s.id=this.CHTMLnodeID,0))}}),e.mspace.Augment({CHTMLbetterBreak:function(t,a){if(t.values&&t.values.id===this.CHTMLnodeID)return!1;var s=this.getValues("linebreak"),l=s.linebreak;l&&!this.hasDimAttr()||(l=e.LINEBREAK.AUTO);var h=t.scanW,r=this.CHTML.w+(this.CHTML.L||0)+(this.CHTML.R||0);if(h-t.shift==0)return!1;var d=i.linebreakWidth-h,o=Math.floor(d/i.linebreakWidth*1e3);o<0&&(o=n.toobig-3*o),o+=t.nest*n.nestfactor;var L=n[l]||0;return l===e.LINEBREAK.AUTO&&r>=n.spacelimit&&!this.mathbackground&&!this.background&&(L=[(r+n.spaceoffset)*n.spacefactor]),MathJax.Object.isArray(L)?o=Math.max(1,o+L[0]*t.nest):(L||d>=0)&&(o=L*t.nest),!(o>=t.penalty||(t.penalty=o,t.values=s,t.W=h,t.w=r,s.lineleading=a.VALUES.lineleading,s.linebreakstyle="before",s.id=this.CHTMLnodeID,0))}}),MathJax.Hub.Register.StartupHook("TeX mathchoice Ready",(function(){e.TeXmathchoice.Augment({CHTMLbetterBreak:function(e,t){return this.Core().CHTMLbetterBreak(e,t)},CHTMLmoveLine:function(e,t,i,a,n){return this.Core().CHTMLmoveSlice(e,t,i,a,n)}})})),e.maction.Augment({CHTMLbetterBreak:function(e,t){return this.Core().CHTMLbetterBreak(e,t)},CHTMLmoveLine:function(e,t,i,a,n){return this.Core().CHTMLmoveSlice(e,t,i,a,n)}}),e.semantics.Augment({CHTMLbetterBreak:function(e,t){return!!this.data[0]&&this.data[0].CHTMLbetterBreak(e,t)},CHTMLmoveLine:function(e,t,i,a,n){return this.data[0]?this.data[0].CHTMLmoveSlice(e,t,i,a,n):null}}),MathJax.Hub.Startup.signal.Post("CommonHTML multiline Ready"),MathJax.Ajax.loadComplete(i.autoloadDir+"/multiline.js")}));