MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready",(function(){var t=MathJax.ElementJax.mml,e=MathJax.OutputJax.CommonHTML;t.mmultiscripts.Augment({toCommonHTML:function(t,s){var i,a,p=(s||{}).stretch;p||(t=this.CHTMLcreateNode(t),this.CHTMLhandleStyle(t),this.CHTMLgetVariant(),this.CHTMLhandleScale(t)),e.BBOX.empty(this.CHTML),p?i=e.getNode(t,"mjx-base"):(this.CHTMLaddChild(t,0,{type:"mjx-base",noBBox:!0,forceChild:!0}),i=t.firstChild),(a=this.CHTMLbboxFor(0)).ic&&(a.R-=a.ic,p||(i.style.marginRight=e.Em(-a.ic)),E=1.3*a.ic+.05);var r={},l={};this.CHTMLgetScripts(r,l,p,t);var h=r.sub,n=r.sup,u=r.presub,c=r.presup,m=l.sub,d=l.sup,M=l.presub,o=l.presup;p||this.CHTMLaddBoxes(t,i,r);var C,T=this.getValues("scriptlevel","scriptsizemultiplier"),L=this.Get("scriptlevel")<3?T.scriptsizemultiplier:1,H=e.TEX.x_height,b=e.TEX.scriptspace,y=e.TEX.sup_drop*L,f=e.TEX.sub_drop*L,g=a.h-y,x=a.d+f,E=0,v=this.data[this.base];!v||"mi"!==v.type&&"mo"!==v.type||!e.isChar(v.data.join(""))||1!==a.rscale||a.sH||v.Get("largeop")||(g=x=0),(T=this.getValues("displaystyle","subscriptshift","superscriptshift","texprimestyle")).subscriptshift=""===T.subscriptshift?0:this.CHTMLlength2em(T.subscriptshift),T.superscriptshift=""===T.superscriptshift?0:this.CHTMLlength2em(T.superscriptshift);var B=u?b+M.w:c?b+o.w-E:0;this.CHTML.combine(a,B,0);var w=this.CHTML.w;if(n||c)if(h||u){x=Math.max(x,e.TEX.sub2);var S=e.TEX.rule_thickness,O=(m||M).h,X=(d||o).d;u&&(O=Math.max(O,M.h)),c&&(X=Math.max(X,o.d)),g-X-(O-x)<3*S&&(x=3*S-g+X+O,(y=.8*H-(g-X))>0&&(g+=y,x-=y)),g=Math.max(g,T.superscriptshift),x=Math.max(x,T.subscriptshift),n?h?this.CHTMLplaceSubSup(h,m,n,d,w,E,g,x,b):this.CHTMLplaceSupOnly(n,d,w,E,g,b):h&&this.CHTMLplaceSubOnly(h,m,w,x,b),c?u?this.CHTMLplacePresubPresup(u,M,c,o,E,g,x,b):this.CHTMLplacePresupOnly(c,o,E,g,b):u&&this.CHTMLplacePresubOnly(u,M,x,b)}else C=e.TEX[T.displaystyle?"sup1":T.texprimestyle?"sup3":"sup2"],g=Math.max(g,C,T.superscriptshift),n&&(g=Math.max(g,d.d+1/4*H)),c&&(g=Math.max(g,o.d+1/4*H)),n&&this.CHTMLplaceSupOnly(n,d,w,E,g,b),c&&this.CHTMLplacePresupOnly(c,o,E,g,b);else x=Math.max(x,e.TEX.sub1,T.subscriptshift),h&&(x=Math.max(x,m.h-.8*H)),u&&(x=Math.max(x,M.h-.8*H)),h&&this.CHTMLplaceSubOnly(h,m,w,x,b),u&&this.CHTMLplacePresubOnly(u,M,x,b);return this.CHTML.clean(),this.CHTMLhandleSpace(t),this.CHTMLhandleBBox(t),this.CHTMLhandleColor(t),t},CHTMLgetScripts:function(t,s,i,a){if(i)return t.sub=e.getNode(a,"mjx-sub"),t.sup=e.getNode(a,"mjx-sup"),t.presub=e.getNode(a,"mjx-presub"),t.presup=e.getNode(a,"mjx-presup"),s.sub=this.CHTMLbbox.sub,s.sup=this.CHTMLbbox.sup,s.presub=this.CHTMLbbox.presub,void(s.presup=this.CHTMLbbox.presup);this.CHTMLbbox=s;for(var p={i:1,w:0,BOX:t,BBOX:s},r=this.data.length,l="sub",h="sup";p.i<r;)if("mprescripts"===(this.data[p.i]||{}).type)p.i++,p.w=0,l="presub",h="presup";else{var n=this.CHTMLaddScript(l,p,a),u=this.CHTMLaddScript(h,p,a),c=Math.max(n?n.rscale*n.w:0,u?u.rscale*u.w:0);this.CHTMLpadScript(l,c,n,p),this.CHTMLpadScript(h,c,u,p),p.w+=c}s.sub&&s.sub.clean(),s.sup&&s.sup.clean(),s.presub&&s.presub.clean(),s.presup&&s.presup.clean()},CHTMLaddScript:function(t,s,i){var a,p,r=this.data[s.i];return r&&"none"!==r.type&&"mprescripts"!==r.type&&((a=s.BOX[t])||(a=s.BOX[t]=e.addElement(i,"mjx-"+t),p=s.BBOX[t]=e.BBOX.empty(),s.w&&(a.style.paddingLeft=e.Em(s.w),p.w=p.r=s.w,p.x=s.w)),r.toCommonHTML(a),p=r.CHTML),r&&"mprescripts"!==r.type&&s.i++,p},CHTMLpadScript:function(t,s,i,a){i||(i={w:0,fake:1,rscale:1});var p=a.BBOX[t],r=0,l=0;if(p){if(i.rscale*i.w<s){var h=a.BOX[t];l=s-i.rscale*i.w;var n=e.Element("mjx-spacer",{style:{width:e.Em(l)}});"pre"!==t.substr(0,3)||i.fake?h.appendChild(n):(h.insertBefore(n,h.lastChild),r=l,l=0)}i.fake?p.w+=r:p.combine(i,p.w+r,0),p.w+=l}},CHTMLaddBoxes:function(t,s,i){var a=i.sub,p=i.sup,r=i.presub,l=i.presup;if(r&&l){var h=e.Element("mjx-prestack");t.insertBefore(h,s),h.appendChild(l),h.appendChild(r)}else r&&t.insertBefore(r,s),l&&t.insertBefore(l,s);if(a&&p){var n=e.addElement(t,"mjx-stack");n.appendChild(p),n.appendChild(a)}else a&&t.appendChild(a),p&&t.appendChild(p)},CHTMLplaceSubOnly:function(t,s,i,a,p){t.style.verticalAlign=e.Em(-a),t.style.marginRight=e.Em(p),s.w+=p,this.CHTML.combine(s,i,-a)},CHTMLplaceSupOnly:function(t,s,i,a,p,r){t.style.verticalAlign=e.Em(p),t.style.paddingLeft=e.Em(a),t.style.paddingRight=e.Em(r),s.w+=r,this.CHTML.combine(s,i+a,p)},CHTMLplaceSubSup:function(t,s,i,a,p,r,l,h,n){t.style.paddingRight=e.Em(n),s.w+=n,i.style.paddingBottom=e.Em(l+h-a.d-s.h),i.style.paddingLeft=e.Em(r+(a.x||0)),i.style.paddingRight=e.Em(n),a.w+=n,i.parentNode.style.verticalAlign=e.Em(-h),this.CHTML.combine(s,p,-h),this.CHTML.combine(a,p+r,l)},CHTMLplacePresubOnly:function(t,s,i,a){t.style.verticalAlign=e.Em(-i),t.style.marginLeft=e.Em(a),this.CHTML.combine(s,a,-i)},CHTMLplacePresupOnly:function(t,s,i,a,p){t.style.verticalAlign=e.Em(a),t.style.paddingLeft=e.Em(p),t.style.paddingRight=e.Em(-i),this.CHTML.combine(s,p,a)},CHTMLplacePresubPresup:function(t,s,i,a,p,r,l,h){t.style.paddingLeft=e.Em(h),i.style.paddingBottom=e.Em(r+l-a.d-s.h),i.style.paddingLeft=e.Em(p+h+(a.x||0)),i.style.paddingRight=e.Em(-p),i.parentNode.style.verticalAlign=e.Em(-l),this.CHTML.combine(s,h,-l),this.CHTML.combine(a,h+p,r)},CHTMLstretchH:t.mbase.CHTMLstretchH,CHTMLstretchV:t.mbase.CHTMLstretchV}),MathJax.Hub.Startup.signal.Post("CommonHTML mmultiscripts Ready"),MathJax.Ajax.loadComplete(e.autoloadDir+"/mmultiscripts.js")}));