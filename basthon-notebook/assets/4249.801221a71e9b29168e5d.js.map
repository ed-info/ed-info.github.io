{"version":3,"file":"assets/4249.801221a71e9b29168e5d.js","mappings":"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,MAED,qBAAsB,CACrB,MACA,MAED,iBAAkB,CACjB,MACA,KACA,KACA,KAED,6BAA8B,CAC7B,MACA,MAED,yCAA0C,CACzC,MACA,MAED,uBAAwB,CACvB,MACA,MAED,iBAAkB,CACjB,MACA,MAED,iCAAkC,CACjC,MACA,KACA,KACA,MAED,2BAA4B,CAC3B,MACA,KACA,KACA,MAED,iBAAkB,CACjB,MACA,MAED,eAAgB,CACf,MACA,MAED,6BAA8B,CAC7B,MACA,MAED,qBAAsB,CACrB,MACA,MAED,eAAgB,CACf,MACA,KACA,MAED,mBAAoB,CACnB,MACA,MAED,6BAA8B,CAC7B,MACA,MAED,eAAgB,CACf,MACA,MAED,yBAA0B,CACzB,OAED,+BAAgC,CAC/B,MACA,MAED,iBAAkB,CACjB,MACA,MAED,YAAa,CACZ,OAED,iBAAkB,CACjB,MACA,MAED,qBAAsB,CACrB,MACA,MAED,yBAA0B,CACzB,MACA,MAED,qBAAsB,CACrB,MACA,MAED,mBAAoB,CACnB,MACA,MAED,mBAAoB,CACnB,MACA,KAED,iBAAkB,CACjB,MACA,MAED,yBAA0B,CACzB,MACA,MAED,qBAAsB,CACrB,MACA,MAED,aAAc,CACb,MACA,MAED,qBAAsB,CACrB,MACA,MAED,mBAAoB,CACnB,MACA,KACA,MAED,iBAAkB,CACjB,MACA,IAED,eAAgB,CACf,MACA,KACA,KACA,KACA,MAED,eAAgB,CACf,MACA,MAED,6BAA8B,CAC7B,MACA,MAED,6BAA8B,CAC7B,KACA,MAED,yBAA0B,CACzB,MACA,MAED,eAAgB,CACf,MACA,KACA,KACA,MAED,qBAAsB,CACrB,MACA,KAED,qBAAsB,CACrB,MAED,WAAY,CACX,MACA,MAED,WAAY,CACX,MACA,MAED,eAAgB,CACf,KACA,MAED,eAAgB,CACf,MACA,MAED,iBAAkB,CACjB,MACA,KAED,iBAAkB,CACjB,MACA,KAED,eAAgB,CACf,MACA,MAED,iBAAkB,CACjB,MACA,KACA,MAED,qBAAsB,CACrB,MACA,MAED,mBAAoB,CACnB,MACA,MAED,mBAAoB,CACnB,MACA,MAED,iBAAkB,CACjB,MACA,KACA,KACA,MAED,2BAA4B,CAC3B,MACA,MAED,qBAAsB,CACrB,MACA,MAED,iBAAkB,CACjB,MACA,MAED,eAAgB,CACf,MACA,KACA,KACA,MAED,qBAAsB,CACrB,MACA,MAED,+BAAgC,CAC/B,MACA,MAED,eAAgB,CACf,MACA,MAED,iBAAkB,CACjB,OAED,qBAAsB,CACrB,MACA,KAED,mBAAoB,CACnB,MACA,MAED,eAAgB,CACf,MACA,MAED,uBAAwB,CACvB,MACA,MAED,6BAA8B,CAC7B,MACA,MAED,iBAAkB,CACjB,MACA,MAED,iBAAkB,CACjB,MACA,MAED,uBAAwB,CACvB,MACA,KACA,KACA,MAED,mBAAoB,CACnB,MACA,KAED,yBAA0B,CACzB,MACA,MAED,iBAAkB,CACjB,MACA,MAED,qBAAsB,CACrB,MACA,MAED,iBAAkB,CACjB,MACA,MAED,aAAc,CACb,MACA,MAED,yBAA0B,CACzB,MACA,MAED,yBAA0B,CACzB,MACA,MAED,uBAAwB,CACvB,MACA,MAED,iBAAkB,CACjB,MACA,MAED,eAAgB,CACf,KACA,KACA,KACA,IACA,KACA,MAED,iBAAkB,CACjB,KACA,MAED,qBAAsB,CACrB,MACA,MAED,eAAgB,CACf,OAED,qBAAsB,CACrB,MACA,MAED,mBAAoB,CACnB,MACA,MAED,yCAA0C,CACzC,MACA,MAED,iBAAkB,CACjB,MACA,MAED,eAAgB,CACf,MACA,OAGF,SAASohE,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAEvhE,EAAKqhE,GAC9B,OAAOrvE,QAAQC,UAAUsE,MAAK,KAC7B,IAAIpH,EAAI,IAAIC,MAAM,uBAAyBiyE,EAAM,KAEjD,MADAlyE,EAAEoG,KAAO,mBACHpG,CAAC,IAIT,IAAIqyE,EAAMxhE,EAAIqhE,GAAMjtE,EAAKotE,EAAI,GAC7B,OAAOxvE,QAAQ6Z,IAAI21D,EAAI1oE,MAAM,GAAGkH,IAAIshE,EAAoBnyE,IAAIoH,MAAK,IACzD+qE,EAAoB/pC,EAAEnjC,E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","sources":["webpack://@basthon/basthon-notebook/./src/ts/basthon_gui.ts","webpack://@basthon/basthon-notebook/./src/ts/basthonwebsocket.ts","webpack://@basthon/basthon-notebook/./src/js/base/js/dialog.js","webpack://@basthon/basthon-notebook/./src/js/base/js/events.js","webpack://@basthon/basthon-notebook/./src/js/base/js/i18n.js","webpack://@basthon/basthon-notebook/./src/js/base/js/keyboard.js","webpack://@basthon/basthon-notebook/./src/js/base/js/namespace.js","webpack://@basthon/basthon-notebook/./src/js/base/js/notificationarea.js","webpack://@basthon/basthon-notebook/./src/js/base/js/notificationwidget.js","webpack://@basthon/basthon-notebook/./src/js/base/js/page.js","webpack://@basthon/basthon-notebook/./src/js/base/js/promises.js","webpack://@basthon/basthon-notebook/./src/js/base/js/security.js","webpack://@basthon/basthon-notebook/./src/js/base/js/utils.js","webpack://@basthon/basthon-notebook/./src/js/bidi/bidi.js","webpack://@basthon/basthon-notebook/./src/js/bidi/numericshaping.js","webpack://@basthon/basthon-notebook/./src/js/nbextensions/rise/main.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/about.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/actions.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/cell.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/celltoolbar.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/celltoolbarpresets/attachments.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/celltoolbarpresets/default.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/celltoolbarpresets/rawcell.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/celltoolbarpresets/slideshow.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/celltoolbarpresets/tags.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/clipboard.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/codecell.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/codemirror-ipython.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/codemirror-ipythongfm.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/commandpalette.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/completer.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/contexthint.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/kernelselector.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/keyboardmanager.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/maintoolbar.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/mathjaxutils.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/menubar.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/notebook.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/notificationarea.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/outputarea.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/pager.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/promises.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/quickhelp.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/savewidget.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/scrollmanager.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/searchandreplace.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/shortcuteditor.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/textcell.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/toolbar.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/tooltip.js","webpack://@basthon/basthon-notebook/./src/js/notebook/js/tour.js","webpack://@basthon/basthon-notebook/./src/js/services/config.js","webpack://@basthon/basthon-notebook/./src/js/services/contents.js","webpack://@basthon/basthon-notebook/./src/js/services/kernels/comm.js","webpack://@basthon/basthon-notebook/./src/js/services/kernels/kernel.js","webpack://@basthon/basthon-notebook/./src/js/services/kernels/serialize.js","webpack://@basthon/basthon-notebook/./src/js/services/sessions/session.js","webpack://@basthon/basthon-notebook/./node_modules/codemirror/mode/ lazy ^\\.\\/.*\\.js$ namespace object","webpack://@basthon/basthon-notebook/./node_modules/moment/locale/ sync ^\\.\\/.*$","webpack://@basthon/basthon-notebook/./node_modules/reveal.js/dist/theme/ lazy ^\\.\\/.*\\.css$ namespace object"],"sourcesContent":["//jquery\nimport * as $ from \"jquery\";\n// basthon\nimport { GUIBase, GUIOptions } from \"@basthon/gui-base\";\nconst dialog = require('../js/base/js/dialog');\n\n\n/**\n * Basthon part of the notebook GUI.\n */\nexport class GUI extends GUIBase {\n    private _notebook?: any;\n    private _events?: any;\n\n    public constructor(options: GUIOptions) {\n        super((() => { options.uiName = \"notebook\"; return options; })());\n        this._contentFilename = \"Untitled.ipynb\";\n        this._urlKey = \"ipynb\";\n\n        /* register extensions */\n        const admonitionLoader = async () => {\n            const marked = require(\"marked\");\n            const admonition = (await import(\"marked-admonition-extension\")).default;\n            //@ts-ignore\n            import(\"../css/admonition.css\");\n            marked.use(admonition);\n        };\n        this.registerExtension(\"admonition\", admonitionLoader);\n        this.registerExtension(\"admonitions\", admonitionLoader);\n    }\n\n    /**\n     * Get notebook's content.\n     */\n    public content(): string {\n        return JSON.stringify(this._notebook.toJSON());\n    }\n\n    /**\n     * Set notebook's content.\n     */\n    public setContent(content: string): void {\n        if (!content) return;\n        let ipynb: string;\n        try {\n            ipynb = JSON.parse(content);\n        } catch (e: any) {\n            throw new Error(`Impossible d'ouvrir le notebook : l'ipynb est corrompu.\\n${e.toString()}`);\n        }\n        try {\n            this._notebook.fromJSON(ipynb);\n        } catch (e: any) {\n            throw new Error(`Impossible d'ouvrir le notebook : l'ipynb n'est pas conforme.\\n${e.toString()}`);\n        }\n    }\n\n    /**\n     * Notify the user with an error.\n     */\n    public error(title: string, message: string) {\n        dialog.modal({\n            notebook: this._notebook,\n            keyboard_manager: this._notebook?.keyboard_manager,\n            title: title,\n            body: $('<div>').html(message),\n            buttons: {\n                OK: {\n                    \"class\": \"btn-danger\",\n                },\n            },\n        });\n    }\n\n    /**\n     * Notify the user.\n     */\n    public info(title: string, message: string) {\n        dialog.modal({\n            notebook: this._notebook,\n            keyboard_manager: this._notebook?.keyboard_manager,\n            title: title,\n            body: $('<div>').html(message),\n            buttons: {\n                OK: {\n                    \"class\": \"btn-primary\",\n                },\n            },\n        });\n    }\n\n    /**\n     * Ask the user to confirm or cancel.\n     */\n    public confirm(\n        title: string,\n        message: string,\n        text: string,\n        callback: (() => void),\n        textCancel: string,\n        callbackCancel: (() => void)): void {\n        dialog.modal({\n            notebook: this._notebook,\n            keyboard_manager: this._notebook.keyboard_manager,\n            title: title,\n            body: $('<div>').html(message),\n            buttons: {\n                [text]: {\n                    \"class\": \"btn-primary\",\n                    \"click\": callback\n                },\n                [textCancel]: {\n                    \"click\": callbackCancel\n                }\n            }\n        });\n    }\n\n    /**\n     * Ask the user to select a choice.\n     */\n    public select(\n        title: string,\n        message: string,\n        choices: {\n            text: string,\n            handler: () => void\n        }[],\n        textCancel: string,\n        callbackCancel: (() => void)): void {\n        // build select menu\n        let selected = 0;\n        const selectMenu = $('<div class=\"list-group\" style=\"max-width: 200px; margin: auto; margin-top: 10px;\">');\n        choices.forEach((c, i) => {\n            const item = $('<a href=\"#\">').html(c.text);\n            item.addClass(\"list-group-item\");\n            item.addClass(\"list-group-item-action\");\n            if (i == 0) item.addClass(\"active\");\n            item.click(() => {\n                item.parent().find('a').removeClass('active');\n                item.addClass('active');\n                selected = i;\n            });\n            selectMenu.append(item);\n        });\n        const body = $('<div>')\n            .append($('<p>').html(message))\n            .append(selectMenu);\n        dialog.modal({\n            notebook: this._notebook,\n            keyboard_manager: this._notebook.keyboard_manager,\n            title: title,\n            body: body,\n            buttons: {\n                OK: {\n                    \"class\": \"btn-primary\",\n                    \"click\": () => {\n                        const handler = choices[selected].handler;\n                        if (handler != null) handler();\n                    },\n                },\n                [textCancel]: {\n                    \"click\": callbackCancel || (() => { }),\n                }\n            }\n        });\n    }\n\n    /**\n     * Get current darkmode.\n     */\n    private async _getDarkmode(): Promise<boolean> {\n        return await this.getState(\"darkmode\", false);\n    }\n\n    /**\n     * Get mode as a string (dark/light).\n     */\n    public async theme() {\n        const darkmode = await this._getDarkmode();\n        return darkmode ? \"dark\" : \"light\";\n    }\n\n    /**\n     * Switch dark/light mode.\n     */\n    public async switchDarkLight() {\n        const darkmode = await this._getDarkmode();\n        await this.setState(\"darkmode\", !darkmode);\n        await this.updateDarkLight();\n    }\n\n    /**\n     * Update dark/light appearence.\n     */\n    public async updateDarkLight() {\n        const darkmode = await this._getDarkmode();\n        const mode = darkmode ? 'dark' : 'light';\n        this._notebook?.set_theme(mode);\n    }\n\n    protected async setupUI(options: any) {\n        this._notebook = options?.notebook;\n        this._contentFilename = this._notebook.notebook_name ?? this._contentFilename;\n        await super.setupUI(options);\n\n        await this.updateDarkLight();\n\n        // avoiding notebook loading failure.\n        if (!this._notebook) location.reload();\n\n        // keeping back events from notebook.\n        this._events = this._notebook.events;\n\n        if (!this._notebook._fully_loaded) {\n            await new Promise((resolve, reject) =>\n                this._events.on('notebook_loaded.Notebook', resolve)\n            );\n        }\n\n        // alert when opening old Python 3.8 notebook\n        if (this.language === \"python3-old\") {\n            const callback = () => {\n                const url = new URL(window.location.href);\n                url.searchParams.set(\"kernel\", \"python3\");\n                window.location.href = url.toString();\n            };\n            this.confirm(\n                \"Ouvrir avec la dernière version de Basthon ?\",\n                \"Ce notebook utilise une version ancienne du\" +\n                \" noyau de Basthon (Python 3.8) qui ne sera \" +\n                \"bientôt plus maintenue. Voulez-vous utiliser \" +\n                \"la dernière version du noyau (Python 3.10) ?\",\n                \"Utiliser Python 3.10\", callback,\n                \"Rester avec Python 3.8\", () => {});\n        }\n    }\n\n    /**\n     * Sharing notebook via URL.\n     */\n    public async share() {\n        this._events.trigger('before_share.Notebook');\n        super.share();\n        this._events.trigger('notebook_shared.Notebook');\n    };\n\n    /**\n     * Load the content of a Python script in first cell.\n     */\n    public async loadPythonInCell(file: File): Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            const reader = new FileReader();\n            reader.readAsText(file);\n            reader.onload = async (event) => {\n                const new_cell = this._notebook.insert_cell_above('code', 0);\n                new_cell.set_text(event?.target?.result);\n                // notification seems useless here.\n                resolve();\n            };\n            reader.onerror = reject;\n        });\n    }\n\n    /**\n     * Open *.py file by asking user what to do:\n     * load in notebook cell or put on (emulated) local filesystem.\n     */\n    public async openPythonFile(file: File) {\n        const msg = $(\"<div>\").html(\n            \"Que faire de \" + file.name + \" ?\");\n        this.confirm(\n            \"Que faire du fichier ?\",\n            msg,\n            \"Charger dans le notebook\",\n            () => { this.loadPythonInCell(file); },\n            \"Installer le module\",\n            () => { this.putFSRessource(file); },\n        );\n    }\n\n    /**\n     * Opening file: If it has .ipynb extension, load the notebook,\n     * if it has .py extension, loading it in the first cell\n     * or put on (emulated) local filesystem (user is asked to),\n     * otherwise, loading it in the local filesystem.\n     */\n    public async openFile() {\n        return await this._openFile({\n            'py': this.openPythonFile.bind(this),\n            'ipynb': this.open.bind(this)\n        });\n    }\n}\n","import { KernelBase } from \"@basthon/kernel-base\";\n\ndeclare global {\n  interface Window {\n    _basthonDomNodeBus?: DomNodeBus;\n  }\n}\n\n/**\n * DOM node exchanger (Bus) to bypass stringifying\n * messages between frontend and kernel that prevents DOMNode sharing.\n */\nclass DomNodeBus {\n  // The actual bus is a Map.\n  private _bus = new Map<number, any>();\n\n  public constructor() {}\n\n  /**\n   * Push an object to the bus and get back an id to later pop it.\n   */\n  public push(obj: any): number {\n    let id = 0;\n    for (; id < this._bus.size; id++) if (!this._bus.has(id)) break;\n    this._bus.set(id, obj);\n    return id;\n  }\n\n  /**\n   * Remove an object from the bus from its id.\n   */\n  public pop(id: number): any {\n    const res = this._bus.get(id);\n    this._bus.delete(id);\n    return res;\n  }\n}\n\n/**\n * Evaluation queue (FIFO).\n */\nclass EvalQueue {\n  private ws: BasthonWebSocket;\n  private _queue: any[] = [];\n  public ready: boolean = false;\n\n  public constructor(ws: BasthonWebSocket) {\n    this.ws = ws;\n  }\n\n  /**\n   * Pushing an eval to the queue.\n   */\n  public push(data: any): any {\n    this._queue.push(data);\n    if (this.ready) this.popAndRun();\n    return data;\n  }\n\n  /**\n   * Poping an eval from the queue.\n   */\n  public pop(): any {\n    return this._queue.shift();\n  }\n\n  /**\n   * Pop data and run it.\n   */\n  public popAndRun(): any {\n    const data = this.pop();\n    if (data) {\n      this.ready = false;\n      this.ws._send_busy(data.parent_msg);\n      this.ws._send(\n        this.ws._format_msg(\n          data.parent_msg,\n          \"execute_input\",\n          {\n            code: data.code,\n            execution_count: data.execution_cout,\n          },\n          \"iopub\"\n        )\n      );\n      // this should fix the output mess when running all cells\n      // at a time\n      window.setTimeout(() => {\n        this.ws.kernelSafe?.dispatchEvent(\"eval.request\", data);\n      }, 1);\n    } else {\n      this.ready = true;\n    }\n    return data;\n  }\n}\n\nexport const CLOSED = 0;\nexport const OPEN = 1;\n\n/**\n * A fake interface to WebSocket to simulate communication with\n * Python kernel.\n */\nexport class BasthonWebSocket {\n  public url: string;\n  public onopen?: () => void;\n  public onclose?: () => void;\n  public onerror = null;\n  public onmessage?: (_: any) => void;\n  public readyState = OPEN;\n  public message_count = 0;\n  public kernel?: KernelBase;\n  public eval_queue: EvalQueue;\n  public domNodeBus = new DomNodeBus();\n  private _input_resolver: Function | undefined = undefined;\n\n  public constructor(url: string, basthonKernelAvailable: Promise<KernelBase>) {\n    this.url = url;\n    this.eval_queue = new EvalQueue(this);\n    window._basthonDomNodeBus = this.domNodeBus;\n    setTimeout(() => {\n      this.onopen?.call(this);\n    }, 500);\n    basthonKernelAvailable.then(this._connectEvents.bind(this));\n  }\n\n  // Safe kernel getter\n  public get kernelSafe() {\n    return this.kernel?.ready ? this.kernel : null;\n  }\n\n  private _connectEvents(kernel: KernelBase) {\n    this.kernel = kernel;\n\n    /* send finished signal to kernel and run next eval */\n    const send_finished_and_continue = (data: any) => {\n      const parent = data.parent_msg;\n      this._send_idle(parent);\n      this._send(\n        this._format_msg(\n          parent,\n          \"execute_reply\",\n          {\n            execution_count: data.execution_count,\n            metadata: {},\n          },\n          \"shell\"\n        )\n      );\n\n      this.eval_queue.popAndRun();\n    };\n\n    this.kernel.addEventListener(\"eval.finished\", (data: any) => {\n      // updating output\n      if (\"result\" in data) {\n        this._send(\n          this._format_msg(\n            data.parent_msg,\n            \"execute_result\",\n            {\n              execution_count: data.execution_count,\n              data: data.result,\n              metadata: {},\n            },\n            \"iopub\"\n          )\n        );\n      }\n      send_finished_and_continue(data);\n    });\n\n    this.kernel.addEventListener(\"eval.error\", (data: any) => {\n      this._send(\n        this._format_msg(\n          data.parent_msg,\n          \"error\",\n          {\n            execution_count: data.execution_count,\n            metadata: {},\n          },\n          \"iopub\"\n        )\n      );\n      send_finished_and_continue(data);\n    });\n\n    this.kernel.addEventListener(\"eval.output\", (data: any) => {\n      this._send(\n        this._format_msg(\n          data.parent_msg,\n          \"stream\",\n          {\n            name: data.stream,\n            text: data.content,\n          },\n          \"iopub\"\n        )\n      );\n    });\n\n    this.kernel.addEventListener(\"eval.input\", (data: any) => {\n      this._input_resolver = data.resolve;\n      this._send(\n        this._format_msg(\n          data.parent_msg,\n          \"input_request\",\n          data.content,\n          \"stdin\"\n        )\n      );\n    });\n\n    this.kernel.addEventListener(\"eval.display\", (data: any) => {\n      /* see outputarea.js to understand interaction */\n      let send_data: any;\n      switch (data.display_type) {\n        case \"sympy\":\n          send_data = { \"text/latex\": data.content };\n          break;\n        case \"turtle\":\n          const root = data.content;\n          root.setAttribute(\"width\", \"50%\");\n          root.setAttribute(\"height\", \"auto\");\n          send_data = { \"image/svg+xml\": root.outerHTML };\n          break;\n        case \"ocaml-canvas\":\n        case \"matplotlib\":\n        case \"p5\":\n          /* /!\\ big hack /!\\\n                       To allow javascript loading of DOM node,\n                       we get an id identifying the object. We can then\n                       pickup the object from its id.\n                    */\n          const id = this.domNodeBus.push(data.content);\n          send_data = {\n            \"application/javascript\": `element.append(window._basthonDomNodeBus.pop(${id}));`,\n          };\n          break;\n        case \"multiple\":\n          /* typically dispached by display() */\n          send_data = data.content;\n          break;\n        case \"tutor\":\n          send_data = { \"text/html\": data.content };\n          break;\n        default:\n          console.error(\"Not recognized display_type: \" + data.display_type);\n      }\n\n      this._send(\n        this._format_msg(\n          data.parent_msg,\n          \"display_data\",\n          {\n            data: send_data,\n            metadata: {},\n            transcient: {},\n          },\n          \"iopub\"\n        )\n      );\n    });\n\n    // start eval queue when kernel is ready\n    (async () => {\n      await this.kernel?.loaded();\n      /* FIXME: we should wait for aux/modules to be loaded before\n       * executing first cell but how to wait for this without using a\n       * global variable? */\n      // @ts-ignore\n      await Jupyter?.notebook?.basthonGUI?.loaded();\n      this.eval_queue.ready = true;\n      this.eval_queue.popAndRun();\n    })();\n  }\n\n  public _send(data: any) {\n    this.onmessage?.call(this, { data: JSON.stringify(data) });\n  }\n\n  public _format_msg(\n    parent: any,\n    msg_type: any,\n    content: any,\n    channel: string\n  ) {\n    const parent_header = parent?.header ?? {};\n    const session_id = parent_header.session ?? \"\";\n    const msg_id = session_id + \"_\" + String(this.message_count);\n    this.message_count++;\n    const username = parent_header.username ?? \"username\";\n    const date = new Date().toISOString();\n    const version = parent_header.version ?? \"5.2\";\n    channel = channel ?? parent?.channel;\n\n    return {\n      header: {\n        msg_id: msg_id,\n        msg_type: msg_type,\n        username: username,\n        session: session_id,\n        date: date,\n        version: version,\n      },\n      msg_id: msg_id,\n      msg_type: msg_type,\n      parent_header: parent_header,\n      metadata: {},\n      content: content,\n      buffers: [],\n      channel: channel,\n    };\n  }\n\n  public _send_busy(parent: any) {\n    const msg = this._format_msg(\n      parent,\n      \"status\",\n      { execution_state: \"busy\" },\n      \"iopub\"\n    );\n    this._send(msg);\n  }\n\n  public _send_idle(parent: any) {\n    const msg = this._format_msg(\n      parent,\n      \"status\",\n      { execution_state: \"idle\" },\n      \"iopub\"\n    );\n    this._send(msg);\n  }\n\n  public send(msg: any) {\n    msg = JSON.parse(msg);\n\n    let header = msg.header;\n    let channel = msg.channel;\n    let msg_type = header.msg_type;\n\n    switch (channel) {\n      case \"shell\":\n        switch (msg_type) {\n          case \"kernel_info_request\":\n            this._send_busy(msg);\n            this._send_idle(msg);\n            this._send(\n              this._format_msg(\n                msg,\n                \"kernel_info_reply\",\n                { status: \"ok\" },\n                \"shell\"\n              )\n            );\n            break;\n          case \"execute_request\":\n            let code = msg.content.code;\n            this.eval_queue.push({ code: code, parent_msg: msg });\n            break;\n          case \"complete_request\":\n            this._send_busy(msg);\n            const src = msg.content.code.slice(0, msg.content.cursor_pos);\n            const kernelCompletions = this.kernelSafe?.complete(src);\n            if (!kernelCompletions?.length) return;\n            const cursor_start = kernelCompletions[1];\n            let completions = kernelCompletions[0];\n            this._send_busy(msg);\n            this._send(\n              this._format_msg(\n                msg,\n                \"complete_reply\",\n                {\n                  status: \"ok\",\n                  matches: completions,\n                  cursor_start: cursor_start,\n                  // explicitly set to null as it will be\n                  // dynamically computed from completer.js\n                  // (this fix: math.s<tab>q<tab> badly completed)\n                  cursor_end: null,\n                },\n                \"shell\"\n              )\n            );\n            this._send_idle(msg);\n            break;\n        }\n        break;\n      case \"iopub\":\n        break;\n      case \"stdin\":\n        switch (msg_type) {\n          case \"input_reply\":\n            if (this._input_resolver != null)\n              this._input_resolver(msg?.content?.value);\n            break;\n        }\n        break;\n    }\n  }\n\n  public close() {\n    this.onclose?.call(this);\n  }\n}\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine(['jquery',\n        'codemirror/lib/codemirror',\n        'bootstrap',\n\t'base/js/i18n'],\n       function($, CodeMirror, bs, i18n) {\n    \"use strict\";\n\n    /**\n     * A wrapper around bootstrap modal for easier use\n     * Pass it an option dictionary with the following properties:\n     *\n     *    - body : <string> or <DOM node>, main content of the dialog\n     *            if pass a <string> it will be wrapped in a p tag and\n     *            html element escaped, unless you specify sanitize=false\n     *            option.\n     *    - title : Dialog title, default to empty string.\n     *    - buttons : dict of btn_options who keys are button label.\n     *            see btn_options below for description\n     *    - open : callback to trigger on dialog open.\n     *    - destroy:\n     *    - notebook : notebook instance\n     *    - keyboard_manager: keyboard manager instance.\n     *\n     *  Unlike bootstrap modals, the backdrop options is set by default \n     *  to 'static'.\n     *\n     *  The rest of the options are passed as is to bootstrap modals. \n     *\n     *  btn_options: dict with the following property:\n     *  \n     *    - click : callback to trigger on click\n     *    - class : css classes to add to button.\n     *\n     *\n     *\n     **/\n    var modal = function (options) {\n\n        var modal = $(\"<div/>\")\n            .addClass(\"modal\")\n            .addClass(\"fade\")\n            .attr(\"role\", \"dialog\");\n        var dialog = $(\"<div/>\")\n            .addClass(\"modal-dialog\")\n            .appendTo(modal);\n        var dialog_content = $(\"<div/>\")\n            .addClass(\"modal-content\")\n            .appendTo(dialog);\n        if(typeof(options.body) === 'string' && options.sanitize !== false){\n            options.body = $(\"<p/>\").text(options.body);\n        }\n        dialog_content.append(\n            $(\"<div/>\")\n                .addClass(\"modal-header\")\n                .mousedown(function() {\n                  $(\".modal\").draggable({handle: '.modal-header'});\n                })\n                .append($(\"<button>\")\n                    .attr(\"type\", \"button\")\n                    .attr(\"aria-label\", i18n.msg._(\"close\"))\n                    .addClass(\"close\")\n                    .attr(\"data-dismiss\", \"modal\")\n                    .attr(\"aria-hidden\", \"true\")\n                    .html(\"&times;\")\n                ).append(\n                    $(\"<h4/>\")\n                        .addClass('modal-title')\n                        .text(options.title || \"\")\n                )\n        ).append(\n            $(\"<div/>\")\n                .addClass(\"modal-body\")\n                .append(\n                    options.body || $(\"<p/>\")\n                )\n        );\n        \n        var footer = $(\"<div/>\").addClass(\"modal-footer\");\n        \n        var default_button;\n        \n        for (var label in options.buttons) {\n            var btn_opts = options.buttons[label];\n            var button = $(\"<button/>\")\n                .addClass(\"btn btn-default btn-sm\")\n                .attr(\"data-dismiss\", \"modal\")\n                .text(i18n.msg.translate(label).fetch());\n            if (btn_opts.id) {\n                button.attr('id', btn_opts.id);\n            }\n            if (btn_opts.click) {\n                button.click($.proxy(btn_opts.click, dialog_content));\n            }\n            if (btn_opts.class) {\n                button.addClass(btn_opts.class);\n            }\n            footer.append(button);\n            if (options.default_button && label === options.default_button) {\n                default_button = button;\n            }\n        }\n        if (!options.default_button) {\n            default_button = footer.find(\"button\").last();\n        }\n        dialog_content.append(footer);\n        // hook up on-open event\n        modal.on(\"shown.bs.modal\", function () {\n            setTimeout(function () {\n                default_button.focus();\n                if (options.open) {\n                    $.proxy(options.open, modal)();\n                }\n            }, 0);\n        });\n        \n        // destroy modal on hide, unless explicitly asked not to\n        if (options.destroy === undefined || options.destroy) {\n            modal.on(\"hidden.bs.modal\", function () {\n                modal.remove();\n            });\n        }\n        modal.on(\"hidden.bs.modal\", function () {\n            if (options.notebook) {\n                var cell = options.notebook.get_selected_cell();\n                if (cell) cell.select();\n            }\n            if (options.keyboard_manager) {\n                options.keyboard_manager.enable();\n                options.keyboard_manager.command_mode();\n            }\n\t    if (options.focus_button) {\n            \t$(options.focus_button).focus();\n\t    }\n        });\n        \n        if (options.keyboard_manager) {\n            options.keyboard_manager.disable();\n        }\n        \n        if(options.backdrop === undefined){\n          options.backdrop = 'static';\n        }\n        \n        return modal.modal(options);\n    };\n\n    var kernel_modal = function (options) {\n        /**\n         * only one kernel dialog should be open at a time -- but\n         * other modal dialogs can still be open\n         */\n        $('.kernel-modal').modal('hide');\n        var dialog = modal(options);\n        dialog.addClass('kernel-modal');\n        return dialog;\n    };\n\n    var edit_metadata = function (options) {\n        options.name = options.name || \"Cell\";\n        var error_div = $('<div/>').css('color', 'red');\n        var message_cell = \n            i18n.msg._(\"Manually edit the JSON below to manipulate the metadata for this cell.\");\n        var message_notebook = \n            i18n.msg._(\"Manually edit the JSON below to manipulate the metadata for this notebook.\");\n        var message_end = \n            i18n.msg._(\" We recommend putting custom metadata attributes in an appropriately named substructure,\" +\n            \" so they don't conflict with those of others.\");\n\n        var message;\n        if (options.name === 'Notebook') {\n        \tmessage = message_notebook + message_end;\n        } else {\n        \tmessage = message_cell + message_end;\n        }\n        var textarea = $('<textarea/>')\n            .attr('rows', '13')\n            .attr('cols', '80')\n            .attr('name', 'metadata')\n            .text(JSON.stringify(options.md || {}, null, 2));\n        \n        var dialogform = $('<div/>').attr('title', i18n.msg._('Edit the metadata'))\n            .append(\n                $('<form/>').append(\n                    $('<fieldset/>').append(\n                        $('<label/>')\n                        .attr('for','metadata')\n                        .text(message)\n                        )\n                        .append(error_div)\n                        .append($('<br/>'))\n                        .append(textarea)\n                    )\n            );\n        var editor = CodeMirror.fromTextArea(textarea[0], {\n            theme: options.notebook.theme() === \"dark\" ? \"darcula\" : \"ipython\",\n            lineNumbers: true,\n            matchBrackets: true,\n            indentUnit: 2,\n            autoIndent: true,\n            mode: 'application/json',\n        });\n        var title_msg;\n        if (options.name === \"Notebook\") {\n        \ttitle_msg = i18n.msg._(\"Edit Notebook Metadata\");\n        } else {\n        \ttitle_msg = i18n.msg._(\"Edit Cell Metadata\");\n        }\n        // This statement is used simply so that message extraction\n        // will pick up the strings.\n        var button_labels = [ i18n.msg._(\"Cancel\"), i18n.msg._(\"Edit\"), i18n.msg._(\"OK\"), i18n.msg._(\"Apply\")];\n        var modal_obj = modal({\n            title: title_msg,\n            body: dialogform,\n            default_button: \"Cancel\",\n            buttons: {\n                Cancel: {},\n                Edit: { class : \"btn-primary\",\n                    click: function() {\n                        /**\n                         * validate json and set it\n                         */\n                        var new_md;\n                        try {\n                            new_md = JSON.parse(editor.getValue());\n                        } catch(e) {\n                            console.log(e);\n                            error_div.text(i18n.msg._('WARNING: Could not save invalid JSON.'));\n                            return false;\n                        }\n                        options.callback(new_md);\n                    }\n                }\n            },\n            notebook: options.notebook,\n            keyboard_manager: options.keyboard_manager,\n        });\n\n        modal_obj.on('shown.bs.modal', function(){ editor.refresh(); });\n        modal_obj.on('hide.bs.modal', function(){\n            options.edit_metadata_button ? options.edit_metadata_button.focus() : \"\";});\n    };\n\n    var edit_attachments = function (options) {\n        // This shows the Edit Attachments dialog. This dialog allows the\n        // user to delete attachments. We show a list of attachments to\n        // the user and he can mark some of them for deletion. The deletion\n        // is applied when the 'Apply' button of this dialog is pressed.\n        var message;\n        var attachments_list;\n        if (Object.keys(options.attachments).length == 0) {\n            message = i18n.msg._(\"There are no attachments for this cell.\");\n            attachments_list = $('<div>');\n        } else {\n            message = i18n.msg._(\"Current cell attachments\");\n\n            attachments_list = $('<div>')\n                .addClass('list_container')\n                .append(\n                    $('<div>')\n                    .addClass('row list_header')\n                    .append(\n                        $('<div>')\n                        .text(i18n.msg._('Attachments'))\n                    )\n                );\n\n            // This is a set containing keys of attachments to be deleted when\n            // the Apply button is clicked\n            var to_delete = {};\n\n            var refresh_attachments_list = function() {\n                $(attachments_list).find('.row').remove();\n                for (var key in options.attachments) {\n                    var mime = Object.keys(options.attachments[key])[0];\n                    var deleted = key in to_delete;\n\n                    // This ensures the current value of key is captured since\n                    // javascript only has function scope\n                    var btn;\n                    // Trash/restore button\n                    (function(){\n                        var _key = key;\n                        btn = $('<button>')\n                            .addClass('btn btn-default btn-xs')\n                            .css('display', 'inline-block');\n                        if (deleted) {\n                            btn.attr('title', i18n.msg._('Restore'))\n                               .append(\n                                   $('<i>')\n                                   .addClass('fa fa-plus')\n                               );\n                            btn.click(function() {\n                                delete to_delete[_key];\n                                refresh_attachments_list();\n                            });\n                        } else {\n                            btn.attr('title', i18n.msg._('Delete'))\n                               .addClass('btn-danger')\n                               .append(\n                                   $('<i>')\n                                   .addClass('fa fa-trash')\n                               );\n                            btn.click(function() {\n                                to_delete[_key] = true;\n                                refresh_attachments_list();\n                            });\n                        }\n                        return btn;\n                    })();\n                    var row = $('<div>')\n                        .addClass('col-md-12 att_row')\n                        .append(\n                            $('<div>')\n                            .addClass('row')\n                            .append(\n                                $('<div>')\n                                .addClass('att-name col-xs-4')\n                                .text(key)\n                            )\n                            .append(\n                                $('<div>')\n                                .addClass('col-xs-4 text-muted')\n                                .text(mime)\n                            )\n                            .append(\n                                $('<div>')\n                                .addClass('item-buttons pull-right')\n                                .append(btn)\n                            )\n                        );\n                    if (deleted) {\n                        row.find('.att-name')\n                           .css('text-decoration', 'line-through');\n                    }\n\n                    attachments_list.append($('<div>')\n                        .addClass('list_item row')\n                        .append(row)\n                    );\n                }\n            };\n            refresh_attachments_list();\n        }\n\n        var dialogform = $('<div/>')\n            .attr('title', i18n.msg._('Edit attachments'))\n            .append(message)\n            .append('<br />')\n            .append(attachments_list);\n        var title_msg;\n        if ( options.name === \"Notebook\" ) {\n        \ttitle_msg = i18n.msg._(\"Edit Notebook Attachments\");\n        } else {\n        \ttitle_msg = i18n.msg._(\"Edit Cell Attachments\");\n        }\n        var modal_obj = modal({\n            title: title_msg,\n            body: dialogform,\n            buttons: {\n                Apply: { class : \"btn-primary\",\n                    click: function() {\n                        for (var key in to_delete) {\n                            delete options.attachments[key];\n                        }\n                        options.callback(options.attachments);\n                    }\n                },\n                Cancel: {}\n            },\n            notebook: options.notebook,\n            keyboard_manager: options.keyboard_manager,\n        });\n    };\n\n    var insert_image = function (options) {\n        var message =\n            i18n.msg._(\"Select a file to insert.\");\n        var file_input = $('<input/>')\n            .attr('type', 'file')\n            .attr('accept', 'image/*')\n            .attr('name', 'file')\n            .on('change', function(file) {\n                var $btn = $(modal_obj).find('#btn_ok');\n                if (this.files.length > 0) {\n                    $btn.removeClass('disabled');\n                } else {\n                    $btn.addClass('disabled');\n                }\n            });\n        var dialogform = $('<div/>').attr('title', i18n.msg._('Edit attachments'))\n            .append(\n                $('<form id=\"insert-image-form\" />').append(\n                    $('<fieldset/>').append(\n                        $('<label/>')\n                        .attr('for','file')\n                        .text(message)\n                        )\n                        .append($('<br/>'))\n                        .append(file_input)\n                    )\n            );\n        var modal_obj = modal({\n            title: i18n.msg._(\"Select a file\"),\n            body: dialogform,\n            buttons: {\n                OK: {\n                    id : 'btn_ok',\n                    class : \"btn-primary disabled\",\n                    click: function() {\n                        options.callback(file_input[0].files[0]);\n                    }\n                },\n                Cancel: {}\n            },\n            notebook: options.notebook,\n            keyboard_manager: options.keyboard_manager,\n        });\n    };\n\n    \n    var dialog = {\n        modal : modal,\n        kernel_modal : kernel_modal,\n        edit_metadata : edit_metadata,\n        edit_attachments : edit_attachments,\n        insert_image : insert_image\n    };\n\n    return dialog;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// Give us an object to bind all events to. This object should be created\n// before all other objects so it exists when others register event handlers.\n// To register an event handler:\n//\n// requirejs(['base/js/events'], function (events) {\n//     events.on(\"event.Namespace\", function () { do_stuff(); });\n// });\n\ndefine(['jquery', 'base/js/namespace'], function($, Jupyter) {\n    \"use strict\";\n    \n    // Events singleton\n    if (!window._Events) {\n        window._Events = function () {};\n        window._events = new window._Events();\n    }\n    \n    // Backwards compatibility.\n    Jupyter.Events = window._Events;\n    Jupyter.events = window._events;\n    \n    var events = $([window._events]);\n\n    // catch and log errors in triggered events\n    events._original_trigger = events.trigger;\n    events.trigger = function (name, data) {\n        try {\n            this._original_trigger.apply(this, arguments);\n        } catch (e) {\n            console.error(\"Exception in event handler for \" + name, e, arguments);\n        }\n    }\n    return events;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// Module to handle i18n ( Internationalization ) and translated UI\n\ndefine([\n    'jed'\n], function(Jed) {\n    \"use strict\";\n    \n    const translations = require(\"i18n/fr_FR/LC_MESSAGES/nbjs.po\");\n    var i18n = new Jed(translations);\n    i18n._ = i18n.gettext;\n    i18n.msg = i18n; // Just a place holder until the init promise resolves.\n\n    return i18n;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n/**\n *\n *\n * @module keyboard\n * @namespace keyboard\n * @class ShortcutManager\n */\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'underscore',\n], function($, utils, _) {\n    \"use strict\";\n\n\n    /**\n     * Setup global keycodes and inverse keycodes.\n     *\n     * See http://unixpapa.com/js/key.html for a complete description. The short of\n     * it is that there are different keycode sets. Firefox uses the \"Mozilla keycodes\"\n     * and Webkit/IE use the \"IE keycodes\". These keycode sets are mostly the same\n     * but have minor differences.\n     **/\n\n     // These apply to Firefox, (Webkit and IE)\n     // This does work **only** on US keyboard.\n    var _keycodes = {\n        'a': 65, 'b': 66, 'c': 67, 'd': 68, 'e': 69, 'f': 70, 'g': 71, 'h': 72, 'i': 73,\n        'j': 74, 'k': 75, 'l': 76, 'm': 77, 'n': 78, 'o': 79, 'p': 80, 'q': 81, 'r': 82,\n        's': 83, 't': 84, 'u': 85, 'v': 86, 'w': 87, 'x': 88, 'y': 89, 'z': 90,\n        '1 !': 49, '2 @': 50, '3 #': 51, '4 $': 52, '5 %': 53, '6 ^': 54,\n        '7 &': 55, '8 *': 56, '9 (': 57, '0 )': 48, \n        '[ {': 219, '] }': 221, '` ~': 192,  ', <': 188, '. >': 190, '/ ?': 191,\n        '\\\\ |': 220, '\\' \"': 222,\n        'numpad0': 96, 'numpad1': 97, 'numpad2': 98, 'numpad3': 99, 'numpad4': 100,\n        'numpad5': 101, 'numpad6': 102, 'numpad7': 103, 'numpad8': 104, 'numpad9': 105,\n        'multiply': 106, 'add': 107, 'subtract': 109, 'decimal': 110, 'divide': 111,\n        'f1': 112, 'f2': 113, 'f3': 114, 'f4': 115, 'f5': 116, 'f6': 117, 'f7': 118,\n        'f8': 119, 'f9': 120, 'f10': 121, 'f11': 122, 'f12': 123, 'f13': 124, 'f14': 125, 'f15': 126,\n        'backspace': 8, 'tab': 9, 'enter': 13, 'shift': 16, 'ctrl': 17, 'alt': 18,\n        'meta': 91, 'capslock': 20, 'esc': 27, 'space': 32, 'pageup': 33, 'pagedown': 34,\n        'end': 35, 'home': 36, 'left': 37, 'up': 38, 'right': 39, 'down': 40,\n        'insert': 45, 'delete': 46, 'numlock': 144,\n    };\n    \n    // These apply to Firefox and Opera\n    var _mozilla_keycodes = {\n        '; :': 59, '= +': 61, '- _': 173, 'meta': 224, 'minus':173\n    };\n    \n    // This apply to Webkit and IE\n    var _ie_keycodes = {\n        '; :': 186, '= +': 187, '- _': 189, 'minus':189\n    };\n    \n    var browser = utils.browser[0];\n    var platform = utils.platform;\n    \n    if (browser === 'Firefox' || browser === 'Opera' || browser === 'Netscape') {\n        $.extend(_keycodes, _mozilla_keycodes);\n    } else if (browser === 'Safari' || browser === 'Chrome' || browser === 'MSIE') {\n        $.extend(_keycodes, _ie_keycodes);\n    }\n\n    var keycodes = {};\n    var inv_keycodes = {};\n    for (var name in _keycodes) {\n        var names = name.split(' ');\n        if (names.length === 1) {\n            var n = names[0];\n            keycodes[n] = _keycodes[n];\n            inv_keycodes[_keycodes[n]] = n;\n        } else {\n            var primary = names[0];\n            var secondary = names[1];\n            keycodes[primary] = _keycodes[name];\n            keycodes[secondary] = _keycodes[name];\n            inv_keycodes[_keycodes[name]] = primary;\n        }\n    }\n\n    var normalize_key = function (key) {\n        return inv_keycodes[keycodes[key]];\n    };\n\n    var normalize_shortcut = function (shortcut) {\n        /**\n         * @function _normalize_shortcut\n         * @private\n         * return a dict containing the normalized shortcut and the number of time it should be pressed:\n         *\n         * Put a shortcut into normalized form:\n         * 1. Make lowercase\n         * 2. Replace cmd by meta\n         * 3. Sort '-' separated modifiers into the order alt-ctrl-meta-shift\n         * 4. Normalize keys\n         **/\n        if (platform === 'MacOS') {\n            shortcut = shortcut.toLowerCase().replace('cmdtrl-', 'cmd-');\n        } else {\n            shortcut = shortcut.toLowerCase().replace('cmdtrl-', 'ctrl-');\n        }\n\n        shortcut = shortcut.toLowerCase().replace('cmd', 'meta');\n        shortcut = shortcut.replace(/-$/, 'minus');  // catch shortcuts using '-' key\n        shortcut = shortcut.replace(/,$/, 'comma');  // catch shortcuts using '-' key\n        if(shortcut.indexOf(',') !== -1){\n            var sht = shortcut.split(',');\n            sht = _.map(sht, normalize_shortcut);\n            return shortcut;\n        }\n        shortcut = shortcut.replace(/comma/g, ',');  // catch shortcuts using '-' key\n        var values = shortcut.split(\"-\");\n        if (values.length === 1) {\n            return normalize_key(values[0]);\n        } else {\n            var modifiers = values.slice(0,-1);\n            var key = normalize_key(values[values.length-1]);\n            modifiers.sort();\n            return modifiers.join('-') + '-' + key;\n        }\n    };\n\n    var shortcut_to_event = function (shortcut, type) {\n        /**\n         * Convert a shortcut (shift-r) to a jQuery Event object\n         **/\n        type = type || 'keydown';\n        shortcut = normalize_shortcut(shortcut);\n        shortcut = shortcut.replace(/-$/, 'minus');  // catch shortcuts using '-' key\n        var values = shortcut.split(\"-\");\n        var modifiers = values.slice(0,-1);\n        var key = values[values.length-1];\n        var opts = {which: keycodes[key]};\n        if (modifiers.indexOf('alt') !== -1) {opts.altKey = true;}\n        if (modifiers.indexOf('ctrl') !== -1) {opts.ctrlKey = true;}\n        if (modifiers.indexOf('meta') !== -1) {opts.metaKey = true;}\n        if (modifiers.indexOf('shift') !== -1) {opts.shiftKey = true;}\n        return $.Event(type, opts);\n    };\n\n    var only_modifier_event = function(event){\n        /**\n         * Return `true` if the event only contains modifiers keys.\n         * false otherwise\n         **/\n        var key = inv_keycodes[event.which];\n        return ((event.altKey || event.ctrlKey || event.metaKey || event.shiftKey) &&\n         (key === 'alt'|| key === 'ctrl'|| key === 'meta'|| key === 'shift'));\n\n    };\n\n    var event_to_shortcut = function (event) {\n        /**\n         * Convert a jQuery Event object to a normalized shortcut string (shift-r)\n         **/\n        var shortcut = '';\n        var key = inv_keycodes[event.which];\n        if (event.altKey && key !== 'alt') {shortcut += 'alt-';}\n        if (event.ctrlKey && key !== 'ctrl') {shortcut += 'ctrl-';}\n        if (event.metaKey && key !== 'meta') {shortcut += 'meta-';}\n        if (event.shiftKey && key !== 'shift') {shortcut += 'shift-';}\n        shortcut += key;\n        return shortcut;\n    };\n\n    // Shortcut manager class\n\n    var ShortcutManager = function (delay, events, actions, env, config, mode) {\n        /**\n         * A class to deal with keyboard event and shortcut\n         *\n         * @class ShortcutManager\n         * @constructor\n         *\n         * :config: configobjet on which to call `update(....)` to persist the config.\n         * :mode: mode of this shortcut manager where to persist config.\n         */\n        mode = mode || 'command';\n        this._shortcuts = {};\n        this._defaults_bindings = [];\n        this.delay = delay || 800; // delay in milliseconds\n        this.events = events;\n        this.actions = actions;\n        this.actions.extend_env(env);\n        this._queue = [];\n        this._cleartimeout = null;\n        this._config = config;\n        this._mode = mode;\n        Object.seal(this);\n    };\n\n    ShortcutManager.prototype.clearsoon = function(){\n        /**\n         * Clear the pending shortcut soon, and cancel previous clearing\n         * that might be registered.\n         **/\n         var that = this;\n         clearTimeout(this._cleartimeout);\n         this._cleartimeout = setTimeout(function(){that.clearqueue();}, this.delay);\n    };\n\n\n    ShortcutManager.prototype.clearqueue = function(){\n        /**\n         * clear the pending shortcut sequence now. \n         **/\n        this._queue = [];\n        clearTimeout(this._cleartimeout);\n    };\n\n\n    var flatten_shorttree = function(tree){\n        /**\n         * Flatten a tree of shortcut sequences. \n         * use full to iterate over all the key/values of available shortcuts.\n         **/\n        var dct = {};\n        _.forEach(tree, function(value, key) {\n            if(typeof(value) === 'string'){\n                dct[key] = value;\n            } else {\n                var ftree=flatten_shorttree(value);\n                _.forEach(ftree, function(v2, subkey) {\n                    dct[key+','+subkey] = ftree[subkey];\n                });\n            } \n        });\n        return dct;\n    };\n\n\n    ShortcutManager.prototype.get_action_shortcuts = function(name){\n      var ftree = flatten_shorttree(this._shortcuts);\n      var res = [];\n      _.forEach(ftree, function(value, key) {\n        if(value === name){\n          res.push(key);\n        }\n      });\n      return res;\n    };\n    \n    ShortcutManager.prototype.get_action_shortcut = function(name){\n      var matches = this.get_action_shortcuts(name);\n      if (matches.length > 0) {\n          return matches[0];\n      }\n      return undefined;\n    };\n\n    ShortcutManager.prototype.help = function () {\n        var that = this;\n        var help = [];\n        var ftree = flatten_shorttree(this._shortcuts);\n        _.forEach(ftree, function(value, key) {\n            var action = that.actions.get(value);\n            var help_string = action.help||'== no help ==';\n            var help_index = action.help_index;\n            if (help_string) {\n                var shortstring = (action.shortstring||key);\n                help.push({\n                    shortcut: shortstring,\n                    help: help_string,\n                    help_index: help_index}\n                );\n            }\n        });\n        help.sort(function (a, b) {\n            if (a.help_index === b.help_index) {\n                if (a.shortcut === b.shortcut) {\n                    return 0;\n                }\n                if (a.shortcut > b.shortcut) {\n                    return 1;\n                }\n                return -1;\n            }\n            if (a.help_index === undefined || a.help_index > b.help_index){\n                return 1;\n            }\n            return -1;\n        });\n        return help;\n    };\n\n    ShortcutManager.prototype.clear_shortcuts = function () {\n        this._shortcuts = {};\n    };\n\n    ShortcutManager.prototype.get_shortcut = function (shortcut){\n        /**\n         * return a node of the shortcut tree which an action name (string) if leaf,\n         * and an object with `object.subtree===true`\n         **/\n        if(typeof(shortcut) === 'string'){\n            shortcut = shortcut.split(',');\n        }\n        \n        return this._get_leaf(shortcut, this._shortcuts);\n    };\n\n\n    ShortcutManager.prototype._get_leaf = function(shortcut_array, tree){\n        /**\n         * @private\n         * find a leaf/node in a subtree of the keyboard shortcut\n         *\n         **/\n        if(shortcut_array.length === 1){\n            return tree[shortcut_array[0]];\n        } else if(  typeof(tree[shortcut_array[0]]) !== 'string'){\n            return this._get_leaf(shortcut_array.slice(1), tree[shortcut_array[0]]);\n        }\n        return null;\n    };\n\n    ShortcutManager.prototype.set_shortcut = function( shortcut, action_name){\n        if( typeof(action_name) !== 'string'){throw new Error('action is not a string', action_name);}\n        if( typeof(shortcut) === 'string'){\n            shortcut = shortcut.split(',');\n        }\n        return this._set_leaf(shortcut, action_name, this._shortcuts);\n    };\n\n    ShortcutManager.prototype._is_leaf = function(shortcut_array, tree){\n        if(shortcut_array.length === 1){\n           return(typeof(tree[shortcut_array[0]]) === 'string');\n        } else {\n            var subtree = tree[shortcut_array[0]];\n            return this._is_leaf(shortcut_array.slice(1), subtree );\n        }\n    };\n\n    ShortcutManager.prototype._remove_leaf = function(shortcut_array, tree, allow_node){\n        if(shortcut_array.length === 1){\n            var current_node = tree[shortcut_array[0]];\n            if(typeof(current_node) === 'string'){\n                delete tree[shortcut_array[0]];\n            } else {\n                throw new Error('try to delete non-leaf');\n            }\n        } else {\n            this._remove_leaf(shortcut_array.slice(1),  tree[shortcut_array[0]], allow_node);\n            if(_.keys(tree[shortcut_array[0]]).length === 0){\n                delete tree[shortcut_array[0]];\n            }\n        }\n    };\n\n    ShortcutManager.prototype.is_available_shortcut = function(shortcut){\n        var shortcut_array = shortcut.split(',');\n        return this._is_available_shortcut(shortcut_array, this._shortcuts);\n    };\n\n    ShortcutManager.prototype._is_available_shortcut = function(shortcut_array, tree){\n        var current_node = tree[shortcut_array[0]];\n        if(!shortcut_array[0]){\n            return false;\n        }\n        if(current_node === undefined){\n            return true;\n        } else {\n            if (typeof(current_node) === 'string'){\n                return false;\n            } else { // assume is a sub-shortcut tree\n                return this._is_available_shortcut(shortcut_array.slice(1), current_node);\n            }\n        }\n    };\n\n    ShortcutManager.prototype._set_leaf = function(shortcut_array, action_name, tree){\n        var current_node = tree[shortcut_array[0]];\n\n        if(shortcut_array.length === 1){\n            if(current_node !== undefined && typeof(current_node) !== 'string'){\n                console.warn('[warning], you are overriting a long shortcut with a shorter one');\n            }\n            tree[shortcut_array[0]] = action_name;\n            return true;\n        } else {\n            if(typeof(current_node) === 'string'){\n                console.warn('you are trying to set a shortcut that will be shadowed'+\n                             'by a more specific one. Aborting for :', action_name, 'the following '+\n                             'will take precedence', current_node);\n                return false;\n            } else {\n                tree[shortcut_array[0]] = tree[shortcut_array[0]]||{};\n            }\n            this._set_leaf(shortcut_array.slice(1), action_name, tree[shortcut_array[0]]);\n            return true;\n        }\n    };\n\n    ShortcutManager.prototype._persist_shortcut = function(shortcut, data) {\n        /**\n         * add a shortcut to this manager and persist it to the config file. \n         **/ \n        shortcut = shortcut.toLowerCase();\n        this.add_shortcut(shortcut, data);\n        var patch = {keys:{}};\n        patch.keys[this._mode] = {bind:{}};\n        patch.keys[this._mode].bind[shortcut] = data;\n        this._config.update(patch);\n    };\n\n    ShortcutManager.prototype._persist_remove_shortcut = function(shortcut){\n        /**\n         * Remove a shortcut from this manager and persist its removal.\n         */\n\n        shortcut = shortcut.toLowerCase();\n        this.remove_shortcut(shortcut);\n        var patch = {keys: {}};\n        patch.keys[this._mode] = {bind:{}};\n        patch.keys[this._mode].bind[shortcut] = null;\n        this._config.update(patch);\n\n        // if the shortcut we unbind is a default one, we add it to the list of\n        // things to unbind at startup\n        if( this._defaults_bindings.indexOf(shortcut) !== -1 ){\n            var cnf = (this._config.data.keys || {})[this._mode];\n            var unbind_array = cnf.unbind || [];\n\n\n            // unless it's already there (like if we have remapped a default\n            // shortcut to another command): unbind it)\n            if(unbind_array.indexOf(shortcut) === -1){\n                var _parray = unbind_array.concat(shortcut);\n                var unbind_patch = {keys:{}};\n                unbind_patch.keys[this._mode] = {unbind:_parray};\n                console.warn('up:', unbind_patch);\n                this._config.update(unbind_patch);\n            }\n        }\n    };\n\n\n    ShortcutManager.prototype.add_shortcut = function (shortcut, data, suppress_help_update) {\n        /**\n         * Add an action to be handled by shortcut manager. \n         * \n         * - `shortcut` should be a `Shortcut Sequence` of the for `Ctrl-Alt-C,Meta-X`...\n         * - `data` could be an `action name`, an `action` or a `function`.\n         *   if a `function` is passed it will be converted to an anonymous `action`. \n         *\n         **/\n        var action_name = this.actions.get_name(data);\n        if (! action_name){\n          if (typeof data === 'string') {\n            // If we have an action name, allow it to be bound anyway.\n            console.log(\"Unknown action '\" + data + \"' for shortcut \" + shortcut\n                + \"; it may be defined by an extension which is not yet loaded.\");\n            action_name = data;\n          } else {\n            throw new Error('does not know how to deal with : ' + data);\n          }\n        }\n        var _shortcut = normalize_shortcut(shortcut);\n        this.set_shortcut(_shortcut, action_name);\n\n        if (!suppress_help_update) {\n            // update the keyboard shortcuts notebook help\n            this.events.trigger('rebuild.QuickHelp');\n        }\n    };\n\n    ShortcutManager.prototype.add_shortcuts = function (data) {\n        /**\n         * Convenient methods to call `add_shortcut(key, value)` on several items\n         * \n         *  data : Dict of the form {key:value, ...}\n         **/\n        var that = this;\n        _.forEach(data, function(value, key) {\n            that.add_shortcut(key, value, true);\n        });\n        // update the keyboard shortcuts notebook help\n        this.events.trigger('rebuild.QuickHelp');\n    };\n\n    ShortcutManager.prototype._add_default_shortcuts = function (data) {\n        /**\n         * same as add_shortcuts, but register them as \"default\" that if persistently unbound, with\n         * persist_remove_shortcut, need to be on the \"unbind\" list. \n         **/\n        this._defaults_bindings = this._defaults_bindings.concat(Object.keys(data));\n        this.add_shortcuts(data);\n\n    };\n\n    ShortcutManager.prototype.remove_shortcut = function (shortcut, suppress_help_update) {\n        /**\n         * Remove the binding of shortcut `shortcut` with its action.\n         * throw an error if trying to remove a non-exiting shortcut\n         **/\n        if(!shortcut){\n            console.warn('trying to remove empty shortcut');\n            return;\n        }\n        shortcut = normalize_shortcut(shortcut);\n        if( typeof(shortcut) === 'string'){\n            shortcut = shortcut.split(',');\n        }\n        /*\n         *  The shortcut error should be explicit here, because it will be\n         *  seen by users.\n         */\n        try {\n          this._remove_leaf(shortcut, this._shortcuts);\n          if (!suppress_help_update) {\n            // update the keyboard shortcuts notebook help\n            this.events.trigger('rebuild.QuickHelp');\n          }\n        } catch (ex) {\n          throw new Error('trying to remove a non-existent shortcut', shortcut, typeof shortcut);\n        }\n    };\n\n\n\n    ShortcutManager.prototype.call_handler = function (event) {\n        /**\n         * Call the corresponding shortcut handler for a keyboard event\n         * @method call_handler\n         * @return {Boolean} `true|false`, `false` if no handler was found, otherwise the  value return by the handler. \n         * @param event {event}\n         *\n         * given an event, call the corresponding shortcut. \n         * return false is event wan handled, true otherwise \n         * in any case returning false stop event propagation\n         **/\n\n\n        this.clearsoon();\n        if(only_modifier_event(event)){\n            return true;\n        }\n        var shortcut = event_to_shortcut(event);\n        this._queue.push(shortcut);\n        var action_name = this.get_shortcut(this._queue);\n\n        if (typeof(action_name) === 'undefined'|| action_name === null){\n            this.clearqueue();\n            return true;\n        }\n        \n        if (this.actions.exists(action_name)) {\n            event.preventDefault();\n            this.clearqueue();\n            return this.actions.call(action_name, event);\n        }\n\n        return false;\n    };\n\n\n    ShortcutManager.prototype.handles = function (event) {\n        var shortcut = event_to_shortcut(event);\n        var action_name = this.get_shortcut(this._queue.concat(shortcut));\n        return (typeof(action_name) !== 'undefined');\n    };\n\n    return {\n        keycodes : keycodes,\n        inv_keycodes : inv_keycodes,\n        ShortcutManager : ShortcutManager,\n        normalize_key : normalize_key,\n        normalize_shortcut : normalize_shortcut,\n        shortcut_to_event : shortcut_to_event,\n        event_to_shortcut : event_to_shortcut,\n    };\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n\nvar Jupyter = Jupyter || {};\n// [Basthon]\nwindow.Jupyter = Jupyter;\n\nvar jprop = function(name, module_path){\n    Object.defineProperty(Jupyter, name, {\n      get: function() { \n          console.warn('accessing `'+name+'` is deprecated. Use `requirejs(\"'+module_path+'\")`');\n          return requirejs(module_path); \n      },\n      enumerable: true,\n      configurable: false\n    });\n}\n\nvar jglobal = function(name, module_path){\n    Object.defineProperty(Jupyter, name, {\n      get: function() { \n          console.warn('accessing `'+name+'` is deprecated. Use `requirejs(\"'+module_path+'\").'+name+'`');\n          return requirejs(module_path)[name]; \n      },\n      enumerable: true,\n      configurable: false\n    });\n}\n\ndefine(function(){\n    \"use strict\";\n\n    // expose modules\n    \n    jprop('utils','base/js/utils')\n    \n    //Jupyter.load_extensions = Jupyter.utils.load_extensions;\n    // \n    jprop('security','base/js/security');\n    jprop('keyboard','base/js/keyboard');\n    jprop('dialog','base/js/dialog');\n    jprop('mathjaxutils','notebook/js/mathjaxutils');\n\n\n    //// exposed constructors\n    jglobal('CommManager','services/kernels/comm')\n    jglobal('Comm','services/kernels/comm')\n\n    jglobal('NotificationWidget','base/js/notificationwidget');\n    jglobal('Kernel','services/kernels/kernel');\n    jglobal('Session','services/sessions/session');\n    jglobal('LoginWidget','auth/js/loginwidget');\n    jglobal('Page','base/js/page');\n\n    // notebook\n    jglobal('TextCell','notebook/js/textcell');\n    jglobal('OutputArea','notebook/js/outputarea');\n    jglobal('KeyboardManager','notebook/js/keyboardmanager');\n    jglobal('Completer','notebook/js/completer');\n    jglobal('Notebook','notebook/js/notebook');\n    jglobal('Tooltip','notebook/js/tooltip');\n    jglobal('Toolbar','notebook/js/toolbar');\n    jglobal('SaveWidget','notebook/js/savewidget');\n    jglobal('Pager','notebook/js/pager');\n    jglobal('QuickHelp','notebook/js/quickhelp');\n    jglobal('MarkdownCell','notebook/js/textcell');\n    jglobal('RawCell','notebook/js/textcell');\n    jglobal('Cell','notebook/js/cell');\n    jglobal('MainToolBar','notebook/js/maintoolbar');\n    jglobal('NotebookNotificationArea','notebook/js/notificationarea');\n    jglobal('NotebookTour', 'notebook/js/tour');\n    jglobal('MenuBar', 'notebook/js/menubar');\n\n    // tree\n    jglobal('SessionList','tree/js/sessionlist');\n\n    Jupyter.version = \"7.0.0.dev0\";\n    Jupyter._target = '_blank';\n\n    return Jupyter;\n});\n\n// deprecated since 4.0, remove in 5+\nvar IPython = Jupyter;\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/notificationwidget',\n], function($, notificationwidget) {\n    \"use strict\";\n\n    // store reference to the NotificationWidget class\n    var NotificationWidget = notificationwidget.NotificationWidget;\n\n    /**\n     * Construct the NotificationArea object. Options are:\n     *     events: $(Events) instance\n     *     save_widget: SaveWidget instance\n     *     notebook: Notebook instance\n     *     keyboard_manager: KeyboardManager instance\n     *\n     * @constructor\n     * @param {string} selector - a jQuery selector string for the\n     * notification area element\n     * @param {Object} [options] - a dictionary of keyword arguments.\n     */\n    var NotificationArea = function (selector, options) {\n        this.selector = selector;\n        this.events = options.events;\n        if (this.selector !== undefined) {\n            this.element = $(selector);\n        }\n        this.widget_dict = {};\n    };\n\n    /**\n     * Get a widget by name, creating it if it doesn't exist.\n     *\n     * @method widget\n     * @param {string} name - the widget name\n     */\n    NotificationArea.prototype.widget = function (name) {\n        if (this.widget_dict[name] === undefined) {\n            return this.new_notification_widget(name);\n        }\n        return this.get_widget(name);\n    };\n\n    /**\n     * Get a widget by name, throwing an error if it doesn't exist.\n     *\n     * @method get_widget\n     * @param {string} name - the widget name\n     */\n    NotificationArea.prototype.get_widget = function (name) {\n        if(this.widget_dict[name] === undefined) {\n            throw new Error('no widgets with this name');\n        }\n        return this.widget_dict[name];\n    };\n\n    /**\n     * Create a new notification widget with the given name. The\n     * widget must not already exist.\n     *\n     * @method new_notification_widget\n     * @param {string} name - the widget name\n     */\n    NotificationArea.prototype.new_notification_widget = function (name) {\n        if (this.widget_dict[name] !== undefined) {\n            throw new Error('widget with that name already exists!');\n        }\n\n        // create the element for the notification widget and add it\n        // to the notification aread element\n        var div = $('<div/>').attr('id', 'notification_' + name);\n        $(this.selector).append(div);\n\n        // create the widget object and return it\n        this.widget_dict[name] = new NotificationWidget('#notification_' + name);\n        return this.widget_dict[name];\n    };\n\n    return {'NotificationArea': NotificationArea};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine(['jquery'], function($) {\n    \"use strict\";\n\n    /**\n     * Construct a NotificationWidget object.\n     *\n     * @constructor\n     * @param {string} selector - a jQuery selector string for the\n     * notification widget element\n     */\n    var NotificationWidget = function (selector) {\n        this.selector = selector;\n        this.timeout = null;\n        this.busy = false;\n        if (this.selector !== undefined) {\n            this.element = $(selector);\n            this.style();\n        }\n        this.element.hide();\n        this.inner = $('<span/>');\n        this.element.append(this.inner);\n    };\n\n    /**\n     * Add the 'notification_widget' CSS class to the widget element.\n     *\n     * @method style\n     */\n    NotificationWidget.prototype.style = function () {\n        // use explicit bootstrap classes here,\n        // because multiple inheritance in LESS doesn't work\n        // for this particular combination\n        this.element.addClass('notification_widget btn btn-xs navbar-btn');\n    };\n   \n    /**\n     * hide the widget and empty the text\n     **/\n    NotificationWidget.prototype.hide = function () {\n        var that = this;\n        this.element.fadeOut(100, function(){that.inner.text('');});\n    };\n\n    /**\n     * Set the notification widget message to display for a certain\n     * amount of time (timeout).  The widget will be shown forever if\n     * timeout is <= 0 or undefined. If the widget is clicked while it\n     * is still displayed, execute an optional callback\n     * (click_callback). If the callback returns false, it will\n     * prevent the notification from being dismissed.\n     *\n     * Options:\n     *    class - CSS class name for styling\n     *    icon - CSS class name for the widget icon\n     *    title - HTML title attribute for the widget\n     *\n     * @method set_message\n     * @param {string} msg - The notification to display\n     * @param {integer} [timeout] - The amount of time in milliseconds to display the widget\n     * @param {function} [click_callback] - The function to run when the widget is clicked\n     * @param {Object} [options] - Additional options\n     */\n    NotificationWidget.prototype.set_message = function (msg, timeout, click_callback, options) {\n        options = options || {};\n\n        // unbind potential previous callback\n        this.element.unbind('click');\n        this.inner.attr('class', options.icon);\n        this.inner.attr('title', options.title);\n        this.inner.text(msg);\n        this.element.fadeIn(100);\n\n        // reset previous set style\n        this.element.removeClass();\n        this.style();\n        if (options.class) {\n            this.element.addClass(options.class);\n        }\n\n        // clear previous timer\n        if (this.timeout !== null) {\n            clearTimeout(this.timeout);\n            this.timeout = null;\n        }\n\n        // set the timer if a timeout is given\n        var that = this;\n        if (timeout !== undefined && timeout >= 0) {\n            this.timeout = setTimeout(function () {\n                that.element.fadeOut(100, function () {that.inner.text('');});\n                that.element.unbind('click');\n                that.timeout = null;\n            }, timeout);\n        }\n\n        // if no click callback assume we will just dismiss the notification\n        if (click_callback === undefined) {\n            click_callback = function(){return true};\n        }\n        // on click, remove widget if click callback say so\n        // and unbind click event.\n        this.element.click(function () {\n            if (click_callback() !== false) {\n                that.element.fadeOut(100, function () {that.inner.text('');});\n                that.element.unbind('click');\n            }\n            if (that.timeout !== null) {\n                clearTimeout(that.timeout);\n                that.timeout = null;\n            }\n        });\n    };\n\n    /**\n     * Display an information message (styled with the 'info'\n     * class). Arguments are the same as in set_message. Default\n     * timeout is 3500 milliseconds.\n     *\n     * @method info\n     */\n    NotificationWidget.prototype.info = function (msg, timeout, click_callback, options) {\n        options = options || {};\n        options.class = options.class + ' info';\n        timeout = timeout || 3500;\n        this.set_message(msg, timeout, click_callback, options);\n    };\n\n    /**\n     * Display a warning message (styled with the 'warning'\n     * class). Arguments are the same as in set_message. Messages are\n     * sticky by default.\n     *\n     * @method warning\n     */\n    NotificationWidget.prototype.warning = function (msg, timeout, click_callback, options) {\n        options = options || {};\n        options.class = options.class + ' warning';\n        this.set_message(msg, timeout, click_callback, options);\n    };\n\n    /**\n     * Display a danger message (styled with the 'danger'\n     * class). Arguments are the same as in set_message. Messages are\n     * sticky by default.\n     *\n     * @method danger\n     */\n    NotificationWidget.prototype.danger = function (msg, timeout, click_callback, options) {\n        options = options || {};\n        options.class = options.class + ' danger';\n        this.set_message(msg, timeout, click_callback, options);\n    };\n\n    /**\n     * Get the text of the widget message.\n     *\n     * @method get_message\n     * @return {string} - the message text\n     */\n    NotificationWidget.prototype.get_message = function () {\n        return this.inner.html();\n    };\n\n    return {'NotificationWidget': NotificationWidget};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/events',\n], function($, events){\n    \"use strict\";\n\n    var Page = function (header_div_selector, site_div_selector) {\n        /**\n        * Constructor\n        *\n        * Parameters\n        * header_div_selector: string\n        * site_div_selector: string\n        */\n        this.header_div_element = $(header_div_selector || 'div#header');\n        this.site_div_element = $(site_div_selector || 'div#site');\n\n        this.bind_events();\n    };\n\n    Page.prototype.bind_events = function () {\n        // resize site on:\n        // - window resize\n        // - header change\n        // - page load\n        var _handle_resize = $.proxy(this._resize_site, this);\n        \n        $(window).resize(_handle_resize);\n\n        // On document ready, resize codemirror.\n        $(document).ready(_handle_resize);\n        events.on('resize-header.Page', _handle_resize);\n    };\n\n    Page.prototype.show = function () {\n        /**\n         * The header and site divs start out hidden to prevent FLOUC.\n         * Main scripts should call this method after styling everything.\n         */\n        this.show_header();\n        this.show_site();\n    };\n\n    Page.prototype.show_header = function () {\n        /**\n         * The header and site divs start out hidden to prevent FLOUC.\n         * Main scripts should call this method after styling everything.\n         */\n        this.header_div_element.css('display','block');\n    };\n\n    Page.prototype.show_site = function () {\n        /**\n         * The header and site divs start out hidden to prevent FLOUC.\n         * Main scripts should call this method after styling everything.\n         */\n        this.site_div_element.css('display', 'block');\n        this._resize_site();\n    };\n\n\n\n    Page.prototype._resize_site = function(e) {\n        /**\n         * Update the site's size.\n         */\n\n        // In the case an event is passed in, only trigger if the event does\n        // *not* have a target DOM node (i.e., it is not bubbling up). See\n        // https://bugs.jquery.com/ticket/9841#comment:8\n        if (!(e && e.target && e.target.tagName)) {\n            $('div#site').height($(window).height() - $('#header').height());\n        }\n    };\n\n    return {'Page': Page};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// Define an object to attach promises to for one-time events.\n\ndefine(['base/js/events', 'base/js/namespace'], function(events, Jupyter) {\n    \"use strict\";\n\n    // Promise to be resolved when the application is initialized.\n    // The value is the name of the app on the current page.\n    var app_initialized = new Promise(function(resolve, reject) {\n        events.on('app_initialized.NotebookApp', function() {\n            resolve('NotebookApp');\n        });\n        events.on('app_initialized.DashboardApp', function() {\n            resolve('DashboardApp');\n        });\n    });\n\n    var promises = {\n        app_initialized: app_initialized\n    };\n    Jupyter.promises = promises;\n\n    return promises;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'google-caja-sanitizer'\n], function($, google_caja) {\n    \"use strict\";\n    \n    var noop = function (x) { return x; };\n    \n    var caja;\n    if (google_caja) {\n        caja = google_caja.html;\n        caja.html4 = google_caja.html4;\n        caja.sanitizeStylesheet = google_caja.sanitizeStylesheet;\n    }\n    \n    var sanitizeAttribs = function (tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n        /**\n         * add trusting data-attributes to the default sanitizeAttribs from caja\n         * this function is mostly copied from the caja source\n         */\n        var ATTRIBS = caja.html4.ATTRIBS;\n        for (var i = 0; i < attribs.length; i += 2) {\n            var attribName = attribs[i];\n            if (attribName.substr(0,5) == 'data-') {\n                var attribKey = '*::' + attribName;\n                if (!ATTRIBS.hasOwnProperty(attribKey)) {\n                    ATTRIBS[attribKey] = 0;\n                }\n            }\n        }\n        // Caja doesn't allow data uri for img::src, see\n        // https://github.com/google/caja/issues/1558\n        // This is not a security issue for browser post ie6 though, so we\n        // disable the check\n        // https://www.owasp.org/index.php/Script_in_IMG_tags\n        ATTRIBS['img::src'] = 0;\n        return caja.sanitizeAttribs(tagName, attribs, opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger);\n    };\n    \n    var sanitize_css = function (css, tagPolicy) {\n        /**\n         * sanitize CSS\n         * like sanitize_html, but for CSS\n         * called by sanitize_stylesheets\n         */\n        return caja.sanitizeStylesheet(\n            window.location.pathname,\n            css,\n            {\n                containerClass: null,\n                idSuffix: '',\n                tagPolicy: tagPolicy,\n                virtualizeAttrName: noop\n            },\n            noop\n        );\n    };\n    \n    var sanitize_stylesheets = function (html, tagPolicy) {\n        /**\n         * sanitize just the css in style tags in a block of html\n         * called by sanitize_html, if allow_css is true\n         */\n        var h = $(\"<div/>\").append(html);\n        var style_tags = h.find(\"style\");\n        if (!style_tags.length) {\n            // no style tags to sanitize\n            return html;\n        }\n        style_tags.each(function(i, style) {\n            style.innerHTML = sanitize_css(style.innerHTML, tagPolicy);\n        });\n        return h.html();\n    };\n    \n    var sanitize_html = function (html, allow_css) {\n        /**\n         * sanitize HTML\n         * if allow_css is true (default: false), CSS is sanitized as well.\n         * otherwise, CSS elements and attributes are simply removed.\n         */\n        var html4 = caja.html4;\n\n        if (allow_css) {\n            // allow sanitization of style tags,\n            // not just scrubbing\n            html4.ELEMENTS.style &= ~html4.eflags.UNSAFE;\n            html4.ATTRIBS.style = html4.atype.STYLE;\n        } else {\n            // scrub all CSS\n            html4.ELEMENTS.style |= html4.eflags.UNSAFE;\n            html4.ATTRIBS.style = html4.atype.SCRIPT;\n        }\n        \n        var record_messages = function (msg, opts) {\n            console.log(\"HTML Sanitizer\", msg, opts);\n        };\n        \n        var policy = function (tagName, attribs) {\n            if (!(html4.ELEMENTS[tagName] & html4.eflags.UNSAFE)) {\n                return {\n                    'attribs': sanitizeAttribs(tagName, attribs,\n                        noop, noop, record_messages)\n                    };\n            } else {\n                record_messages(tagName + \" removed\", {\n                  change: \"removed\",\n                  tagName: tagName\n                });\n            }\n        };\n        \n        var sanitized = caja.sanitizeWithPolicy(html, policy);\n        \n        if (allow_css) {\n            // sanitize style tags as stylesheets\n            sanitized = sanitize_stylesheets(sanitized, policy);\n        }\n        \n        return sanitized;\n    };\n\n    var sanitize_html_and_parse = function (html, allow_css) {\n        /**\n         * Sanitize HTML and parse it safely using jQuery.\n         *\n         * This disable's jQuery's html 'prefilter', which can make invalid\n         * HTML valid after the sanitizer has checked it.\n         *\n         * Returns an array of DOM nodes.\n         */\n        var sanitized_html = sanitize_html(html, allow_css);\n        var prev_htmlPrefilter = $.htmlPrefilter;\n        $.htmlPrefilter = function(html) {return html;};  // Don't modify HTML\n        try {\n            return $.parseHTML(sanitized_html);\n        } finally {\n            $.htmlPrefilter = prev_htmlPrefilter;  // Set it back again\n        }\n    };\n    \n    var security = {\n        caja: caja,\n        sanitize_html_and_parse: sanitize_html_and_parse,\n        sanitize_html: sanitize_html\n    };\n\n    return security;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'requirejs/require',\n    'codemirror/lib/codemirror',\n    'moment',\n    'underscore',\n    // silently upgrades CodeMirror\n    'codemirror/mode/meta',\n], function($, requirejs, CodeMirror, moment, _){\n    \"use strict\";\n\n    requirejs.requirejs.config({ baseUrl: \"static/\" });\n    \n    // keep track of which extensions have been loaded already\n    var extensions_loaded = [];\n\n    /**\n     * Whether or not an extension has been loaded\n     * @param  {string} extension - name of the extension\n     * @return {boolean}            true if loaded already\n     */\n    var is_loaded = function(extension) {\n        var ext_path = \"nbextensions/\" + extension;\n        return extensions_loaded.indexOf(ext_path) >= 0;\n    };\n\n    /**\n     * Load a single extension.\n     * @param  {string} extension - extension path.\n     * @return {Promise} that resolves to an extension module handle\n     */\n    var load_extension = function (extension) {\n        return new Promise(function(resolve, reject) {\n            var ext_path = \"nbextensions/\" + extension;\n            requirejs.requirejs([ext_path], function(module) {\n                if (!is_loaded(extension)) {\n                    console.log(\"Loading extension: \" + extension);\n                    if (module && module.load_ipython_extension) {\n                        Promise.resolve(module.load_ipython_extension()).then(function() {\n                            resolve(module);\n                        }).catch(reject);\n                    }\n                    extensions_loaded.push(ext_path);\n                } else {\n                    console.log(\"Loaded extension already: \" + extension);\n                    resolve(module);\n                }\n            }, function(err) {\n                reject(err);\n            });\n        });\n    };\n\n    /**\n     * Load multiple extensions.\n     * Takes n-args, where each arg is a string path to the extension.\n     * @return {Promise} that resolves to a list of loaded module handles.\n     */\n    var load_extensions = function () {\n        console.log('load_extensions', arguments);\n        return Promise.all(Array.prototype.map.call(arguments, load_extension)).catch(function(err) {\n            console.error(\"Failed to load extension\" + (err.requireModules.length>1?'s':'') + \":\", err.requireModules, err);\n        });\n    };\n\n    /**\n     * Return a list of extensions that should be active\n     * The config for nbextensions comes in as a dict where keys are\n     * nbextensions paths and the values are a bool indicating if it\n     * should be active. This returns a list of nbextension paths\n     * where the value is true\n     */\n    function filter_extensions(nbext_config) {\n        var active = [];\n        Object.keys(nbext_config).forEach(function (nbext) {\n            if (nbext_config[nbext]) {active.push(nbext);}\n        });\n        return active;\n    }\n\n    /**\n     * Wait for a config section to load, and then load the extensions specified\n     * in a 'load_extensions' key inside it.\n     */\n    function load_extensions_from_config(section) {\n        return section.loaded.then(function() {\n            if (section.data.load_extensions) {\n                var active = filter_extensions(section.data.load_extensions);\n                return load_extensions.apply(this, active);\n            }\n        }).catch(utils.reject('Could not load nbextensions from ' + section.section_name + ' config file'));\n    }\n\n    //============================================================================\n    // Cross-browser RegEx Split\n    //============================================================================\n\n    // This code has been MODIFIED from the code licensed below to not replace the\n    // default browser split.  The license is reproduced here.\n\n    // see http://blog.stevenlevithan.com/archives/cross-browser-split for more info:\n    /*!\n     * Cross-Browser Split 1.1.1\n     * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>\n     * Available under the MIT License\n     * ECMAScript compliant, uniform cross-browser split method\n     */\n\n    /**\n     * Splits a string into an array of strings using a regex or string\n     * separator. Matches of the separator are not included in the result array.\n     * However, if `separator` is a regex that contains capturing groups,\n     * backreferences are spliced into the result each time `separator` is\n     * matched. Fixes browser bugs compared to the native\n     * `String.prototype.split` and can be used reliably cross-browser.\n     * @param {String} str String to split.\n     * @param {RegExp} separator Regex to use for separating\n     *     the string.\n     * @param {Number} [limit] Maximum number of items to include in the result\n     *     array.\n     * @returns {Array} Array of substrings.\n     * @example\n     *\n     * // Basic use\n     * regex_split('a b c d', ' ');\n     * // -> ['a', 'b', 'c', 'd']\n     *\n     * // With limit\n     * regex_split('a b c d', ' ', 2);\n     * // -> ['a', 'b']\n     *\n     * // Backreferences in result array\n     * regex_split('..word1 word2..', /([a-z]+)(\\d+)/i);\n     * // -> ['..', 'word', '1', ' ', 'word', '2', '..']\n     */\n    var regex_split = function (str, separator, limit) {\n        var output = [],\n            flags = (separator.ignoreCase ? \"i\" : \"\") +\n                    (separator.multiline  ? \"m\" : \"\") +\n                    (separator.extended   ? \"x\" : \"\") + // Proposed for ES6\n                    (separator.sticky     ? \"y\" : \"\"), // Firefox 3+\n            lastLastIndex = 0,\n            separator2, match, lastIndex, lastLength;\n        // Make `global` and avoid `lastIndex` issues by working with a copy\n        separator = new RegExp(separator.source, flags + \"g\");\n\n        var compliantExecNpcg = typeof(/()??/.exec(\"\")[1]) === \"undefined\";\n        if (!compliantExecNpcg) {\n            // Doesn't need flags gy, but they don't hurt\n            separator2 = new RegExp(\"^\" + separator.source + \"$(?!\\\\s)\", flags);\n        }\n        /* Values for `limit`, per the spec:\n         * If undefined: 4294967295 // Math.pow(2, 32) - 1\n         * If 0, Infinity, or NaN: 0\n         * If positive number: limit = Math.floor(limit); if (limit > 4294967295) limit -= 4294967296;\n         * If negative number: 4294967296 - Math.floor(Math.abs(limit))\n         * If other: Type-convert, then use the above rules\n         */\n        limit = typeof(limit) === \"undefined\" ?\n            -1 >>> 0 : // Math.pow(2, 32) - 1\n            limit >>> 0; // ToUint32(limit)\n        for (match = separator.exec(str); match; match = separator.exec(str)) {\n            // `separator.lastIndex` is not reliable cross-browser\n            lastIndex = match.index + match[0].length;\n            if (lastIndex > lastLastIndex) {\n                output.push(str.slice(lastLastIndex, match.index));\n                // Fix browsers whose `exec` methods don't consistently return `undefined` for\n                // nonparticipating capturing groups\n                if (!compliantExecNpcg && match.length > 1) {\n                    match[0].replace(separator2, function () {\n                        for (var i = 1; i < arguments.length - 2; i++) {\n                            if (typeof(arguments[i]) === \"undefined\") {\n                                match[i] = undefined;\n                            }\n                        }\n                    });\n                }\n                if (match.length > 1 && match.index < str.length) {\n                    Array.prototype.push.apply(output, match.slice(1));\n                }\n                lastLength = match[0].length;\n                lastLastIndex = lastIndex;\n                if (output.length >= limit) {\n                    break;\n                }\n            }\n            if (separator.lastIndex === match.index) {\n                separator.lastIndex++; // Avoid an infinite loop\n            }\n        }\n        if (lastLastIndex === str.length) {\n            if (lastLength || !separator.test(\"\")) {\n                output.push(\"\");\n            }\n        } else {\n            output.push(str.slice(lastLastIndex));\n        }\n        return output.length > limit ? output.slice(0, limit) : output;\n    };\n\n    //============================================================================\n    // End contributed Cross-browser RegEx Split\n    //============================================================================\n\n\n    var uuid = function () {\n        /**\n         * http://www.ietf.org/rfc/rfc4122.txt\n         */\n        var s = [];\n        var hexDigits = \"0123456789abcdef\";\n        for (var i = 0; i < 32; i++) {\n            s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n        }\n        s[12] = \"4\";  // bits 12-15 of the time_hi_and_version field to 0010\n        s[16] = hexDigits.substr((s[16] & 0x3) | 0x8, 1);  // bits 6-7 of the clock_seq_hi_and_reserved to 01\n\n        var uuid = s.join(\"\");\n        return uuid;\n    };\n\n    var _ANSI_COLORS = [\n        \"ansi-black\",\n        \"ansi-red\",\n        \"ansi-green\",\n        \"ansi-yellow\",\n        \"ansi-blue\",\n        \"ansi-magenta\",\n        \"ansi-cyan\",\n        \"ansi-white\",\n        \"ansi-black-intense\",\n        \"ansi-red-intense\",\n        \"ansi-green-intense\",\n        \"ansi-yellow-intense\",\n        \"ansi-blue-intense\",\n        \"ansi-magenta-intense\",\n        \"ansi-cyan-intense\",\n        \"ansi-white-intense\",\n    ];\n    \n    function _pushColoredChunk(chunk, fg, bg, bold, underline, inverse, out) {\n        if (chunk) {\n            var classes = [];\n            var styles = [];\n\n            if (bold && typeof fg === \"number\" && 0 <= fg && fg < 8) {\n                fg += 8;  // Bold text uses \"intense\" colors\n            }\n            if (inverse) {\n                [fg, bg] = [bg, fg];\n            }\n\n            if (typeof fg === \"number\") {\n                classes.push(_ANSI_COLORS[fg] + \"-fg\");\n            } else if (fg.length) {\n                styles.push(\"color: rgb(\" + fg + \")\");\n            } else if (inverse) {\n                classes.push(\"ansi-default-inverse-fg\");\n            }\n\n            if (typeof bg === \"number\") {\n                classes.push(_ANSI_COLORS[bg] + \"-bg\");\n            } else if (bg.length) {\n                styles.push(\"background-color: rgb(\" + bg + \")\");\n            } else if (inverse) {\n                classes.push(\"ansi-default-inverse-bg\");\n            }\n\n            if (bold) {\n                classes.push(\"ansi-bold\");\n            }\n\n            if (underline) {\n                classes.push(\"ansi-underline\");\n            }\n\n            if (classes.length || styles.length) {\n                out.push(\"<span\");\n                if (classes.length) {\n                    out.push(' class=\"' + classes.join(\" \") + '\"');\n                }\n                if (styles.length) {\n                    out.push(' style=\"' + styles.join(\"; \") + '\"');\n                }\n                out.push(\">\");\n                out.push(chunk);\n                out.push(\"</span>\");\n            } else {\n                out.push(chunk);\n            }\n        }\n    }\n\n    function _getExtendedColors(numbers) {\n        var r, g, b;\n        var n = numbers.shift();\n        if (n === 2 && numbers.length >= 3) {\n            // 24-bit RGB\n            r = numbers.shift();\n            g = numbers.shift();\n            b = numbers.shift();\n            if ([r, g, b].some(function (c) { return c < 0 || 255 < c; })) {\n                throw new RangeError(\"Invalid range for RGB colors\");\n            }\n        } else if (n === 5 && numbers.length >= 1) {\n            // 256 colors\n            var idx = numbers.shift();\n            if (idx < 0) {\n                throw new RangeError(\"Color index must be >= 0\");\n            } else if (idx < 16) {\n                // 16 default terminal colors\n                return idx;\n            } else if (idx < 232) {\n                // 6x6x6 color cube, see https://stackoverflow.com/a/27165165/500098\n                r = Math.floor((idx - 16) / 36);\n                r = r > 0 ? 55 + r * 40 : 0;\n                g = Math.floor(((idx - 16) % 36) / 6);\n                g = g > 0 ? 55 + g * 40 : 0;\n                b = (idx - 16) % 6;\n                b = b > 0 ? 55 + b * 40 : 0;\n            } else if (idx < 256) {\n                // grayscale, see https://stackoverflow.com/a/27165165/500098\n                r = g = b = (idx - 232) * 10 + 8;\n            } else {\n                throw new RangeError(\"Color index must be < 256\");\n            }\n        } else {\n            throw new RangeError(\"Invalid extended color specification\");\n        }\n        return [r, g, b];\n    }\n\n    function _ansispan(str) {\n        var ansi_re = /\\x1b\\[(.*?)([@-~])/g;\n        var fg = [];\n        var bg = [];\n        var bold = false;\n        var underline = false;\n        var inverse = false;\n        var match;\n        var out = [];\n        var numbers = [];\n        var start = 0;\n\n        str += \"\\x1b[m\";  // Ensure markup for trailing text\n        while ((match = ansi_re.exec(str))) {\n            if (match[2] === \"m\") {\n                var items = match[1].split(\";\");\n                for (var i = 0; i < items.length; i++) {\n                    var item = items[i];\n                    if (item === \"\") {\n                        numbers.push(0);\n                    } else if (item.search(/^\\d+$/) !== -1) {\n                        numbers.push(parseInt(item));\n                    } else {\n                        // Ignored: Invalid color specification\n                        numbers.length = 0;\n                        break;\n                    }\n                }\n            } else {\n                // Ignored: Not a color code\n            }\n            var chunk = str.substring(start, match.index);\n\t    _pushColoredChunk(chunk, fg, bg, bold, underline, inverse, out);\n            start = ansi_re.lastIndex;\n\n            while (numbers.length) {\n                var n = numbers.shift();\n                switch (n) {\n                    case 0:\n                        fg = bg = [];\n                        bold = false;\n                        underline = false;\n                        inverse = false;\n                        break;\n                    case 1:\n                    case 5:\n                        bold = true;\n                        break;\n                    case 4:\n                        underline = true;\n                        break;\n                    case 7:\n                        inverse = true;\n                        break;\n                    case 21:\n                    case 22:\n                        bold = false;\n                        break;\n                    case 24:\n                        underline = false;\n                        break;\n                    case 27:\n                        inverse = false;\n                        break;\n                    case 30:\n                    case 31:\n                    case 32:\n                    case 33:\n                    case 34:\n                    case 35:\n                    case 36:\n                    case 37:\n                        fg = n - 30;\n                        break;\n                    case 38:\n                        try {\n                            fg = _getExtendedColors(numbers);\n                        } catch(e) {\n                            numbers.length = 0;\n                        }\n                        break;\n                    case 39:\n                        fg = [];\n                        break;\n                    case 40:\n                    case 41:\n                    case 42:\n                    case 43:\n                    case 44:\n                    case 45:\n                    case 46:\n                    case 47:\n                        bg = n - 40;\n                        break;\n                    case 48:\n                        try {\n                            bg = _getExtendedColors(numbers);\n                        } catch(e) {\n                            numbers.length = 0;\n                        }\n                        break;\n                    case 49:\n                        bg = [];\n                        break;\n\t\t    case 90:\n\t\t    case 91:\n\t\t    case 92:\n\t\t    case 93:\n\t\t    case 94:\n\t\t    case 95:\n\t\t    case 96:\n\t\t    case 97:\n\t\t\tfg = n - 90 + 8;\n                        break;\n\t\t    case 100:\n\t\t    case 101:\n\t\t    case 102:\n\t\t    case 103:\n\t\t    case 104:\n\t\t    case 105:\n\t\t    case 106:\n\t\t    case 107:\n\t\t\tbg = n - 100 + 8;\n                        break;\n                    default:\n                        // Unknown codes are ignored\n                }\n            }\n        }\n        return out.join(\"\");\n    }\n\n    // Transform ANSI color escape codes into HTML <span> tags with CSS\n    // classes such as \"ansi-green-intense-fg\".\n    // The actual colors used are set in the CSS file.\n    // This is supposed to have the same behavior as nbconvert.filters.ansi2html()\n    function fixConsole(txt) {\n        txt = _.escape(txt);\n\n        // color ansi codes (and remove non-color escape sequences)\n        txt = _ansispan(txt);\n        return txt;\n    }\n\n    // Remove chunks that should be overridden by the effect of\n    // carriage return characters\n    function fixCarriageReturn(txt) {\n        txt = txt.replace(/\\r+\\n/gm, '\\n'); // \\r followed by \\n --> newline\n        while (txt.search(/\\r[^$]/g) > -1) {\n            var base = txt.match(/^(.*)\\r+/m)[1];\n            var insert = txt.match(/\\r+(.*)$/m)[1];\n            insert = insert + base.slice(insert.length, base.length);\n            txt = txt.replace(/\\r+.*$/m, '\\r').replace(/^.*\\r/m, insert);\n        }\n        return txt;\n    }\n\n    // Remove characters that are overridden by backspace characters\n    function fixBackspace(txt) {\n        var tmp = txt;\n        do {\n            txt = tmp;\n            // Cancel out anything-but-newline followed by backspace\n            tmp = txt.replace(/[^\\n]\\x08/gm, '');\n        } while (tmp.length < txt.length);\n        return txt;\n    }\n\n    // Remove characters overridden by backspace and carriage return\n    function fixOverwrittenChars(txt) {\n        return fixCarriageReturn(fixBackspace(txt));\n    }\n\n    // Locate any URLs and convert them to an anchor tag\n    function autoLinkUrls(txt) {\n        return txt.replace(/(^|\\s)(https?|ftp)(:[^'\"<>\\s]+)/gi,\n            \"$1<a target=\\\"_blank\\\" href=\\\"$2$3\\\">$2$3</a>\");\n    }\n\n    var points_to_pixels = function (points) {\n        /**\n         * A reasonably good way of converting between points and pixels.\n         */\n        var test = $('<div style=\"display: none; width: 10000pt; padding:0; border:0;\"></div>');\n        $('body').append(test);\n        var pixel_per_point = test.width()/10000;\n        test.remove();\n        return Math.floor(points*pixel_per_point);\n    };\n    \n    var always_new = function (constructor) {\n        /**\n         * wrapper around contructor to avoid requiring `var a = new constructor()`\n         * useful for passing constructors as callbacks,\n         * not for programmer laziness.\n         * from https://programmers.stackexchange.com/questions/118798\n         */\n        return function () {\n            var obj = Object.create(constructor.prototype);\n            constructor.apply(obj, arguments);\n            return obj;\n        };\n    };\n\n    var url_path_join = function () {\n        /**\n         * join a sequence of url components with '/'\n         */\n        var url = '';\n        for (var i = 0; i < arguments.length; i++) {\n            if (arguments[i] === '') {\n                continue;\n            }\n            if (url.length > 0 && url[url.length-1] != '/') {\n                url = url + '/' + arguments[i];\n            } else {\n                url = url + arguments[i];\n            }\n        }\n        url = url.replace(/\\/\\/+/, '/');\n        return url;\n    };\n    \n    var url_path_split = function (path) {\n        /**\n         * Like os.path.split for URLs.\n         * Always returns two strings, the directory path and the base filename\n         */\n        \n        var idx = path.lastIndexOf('/');\n        if (idx === -1) {\n            return ['', path];\n        } else {\n            return [ path.slice(0, idx), path.slice(idx + 1) ];\n        }\n    };\n    \n    var parse_url = function (url) {\n        /**\n         * an `a` element with an href allows attr-access to the parsed segments of a URL\n         * a = parse_url(\"http://localhost:8888/path/name#hash\")\n         * a.protocol = \"http:\"\n         * a.host     = \"localhost:8888\"\n         * a.hostname = \"localhost\"\n         * a.port     = 8888\n         * a.pathname = \"/path/name\"\n         * a.hash     = \"#hash\"\n         */\n        var a = document.createElement(\"a\");\n        a.href = url;\n        return a;\n    };\n    \n    var encode_uri_components = function (uri) {\n        /**\n         * encode just the components of a multi-segment uri,\n         * leaving '/' separators\n         */\n        return uri.split('/').map(encodeURIComponent).join('/');\n    };\n    \n    var url_join_encode = function () {\n        /**\n         * join a sequence of url components with '/',\n         * encoding each component with encodeURIComponent\n         */\n        return encode_uri_components(url_path_join.apply(null, arguments));\n    };\n\n\n    var splitext = function (filename) {\n        /**\n         * mimic Python os.path.splitext\n         * Returns ['base', '.ext']\n         */\n        var idx = filename.lastIndexOf('.');\n        if (idx > 0) {\n            return [filename.slice(0, idx), filename.slice(idx)];\n        } else {\n            return [filename, ''];\n        }\n    };\n\n\n    var escape_html = function (text) {\n        /**\n         * escape text to HTML\n         */\n        return $(\"<div/>\").text(text).html();\n    };\n\n\n    var get_body_data = function(key) {\n        /**\n         * get a url-encoded item from body.data and decode it\n         * we should never have any encoded URLs anywhere else in code\n         * until we are building an actual request\n         */\n        var val = $('body').data(key);\n        if (typeof val === 'undefined')\n            switch(key) {\n            case \"wsUrl\":\n            case \"baseUrl\":\n                val = \"\";\n                break;\n            case \"notebookPath\":\n                val = `${window.basthonLanguage}/Untitled.ipynb`;\n                break;\n            case \"notebookName\":\n                val = \"Untitled.ipynb\";\n                break;\n            default:\n                return val;\n            }\n        return decodeURIComponent(val);\n    };\n    \n    var to_absolute_cursor_pos = function (cm, cursor) {\n        console.warn('`utils.to_absolute_cursor_pos(cm, pos)` is deprecated. Use `cm.indexFromPos(cursor)`');\n        return cm.indexFromPos(cursor);\n    };\n    \n    var from_absolute_cursor_pos = function (cm, cursor_pos) {\n        console.warn('`utils.from_absolute_cursor_pos(cm, pos)` is deprecated. Use `cm.posFromIndex(index)`');\n        return cm.posFromIndex(cursor_pos);\n    };\n    \n    // https://stackoverflow.com/questions/2400935/browser-detection-in-javascript\n    var browser = (function() {\n        if (typeof navigator === 'undefined') {\n            // navigator undefined in node\n            return 'None';\n        }\n        var N= navigator.appName, ua= navigator.userAgent, tem;\n        var M= ua.match(/(opera|chrome|safari|firefox|msie)\\/?\\s*(\\.?\\d+(\\.\\d+)*)/i);\n        if (M && (tem= ua.match(/version\\/([\\.\\d]+)/i)) !== null) M[2]= tem[1];\n        M= M? [M[1], M[2]]: [N, navigator.appVersion,'-?'];\n        return M;\n    })();\n\n    // https://stackoverflow.com/questions/11219582/how-to-detect-my-browser-version-and-operating-system-using-javascript\n    var platform = (function () {\n        if (typeof navigator === 'undefined') {\n            // navigator undefined in node\n            return 'None';\n        }\n        var OSName=\"None\";\n        if (navigator.appVersion.indexOf(\"Win\")!=-1) OSName=\"Windows\";\n        if (navigator.appVersion.indexOf(\"Mac\")!=-1) OSName=\"MacOS\";\n        if (navigator.appVersion.indexOf(\"X11\")!=-1) OSName=\"UNIX\";\n        if (navigator.appVersion.indexOf(\"Linux\")!=-1) OSName=\"Linux\";\n        return OSName;\n    })();\n    \n    var get_url_param = function (name) {\n        // get a URL parameter. I cannot believe we actually need this.\n        // Based on https://stackoverflow.com/a/25359264/938949\n        var match = new RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);\n        if (match){\n            return decodeURIComponent(match[1] || '');\n        }\n    };\n    \n    var is_or_has = function (a, b) {\n        /**\n         * Is b a child of a or a itself?\n         */\n        return a.has(b).length !==0 || a.is(b);\n    };\n\n    var is_focused = function (e) {\n        /**\n         * Is element e, or one of its children focused?\n         */\n        e = $(e);\n        var target = $(document.activeElement);\n        if (target.length > 0) {\n            if (is_or_has(e, target)) {\n                return true;\n            } else {\n                return false;\n            }\n        } else {\n            return false;\n        }\n    };\n    \n    var mergeopt = function(_class, options, overwrite){\n        options = options || {};\n        overwrite = overwrite || {};\n        return $.extend(true, {}, _class.options_default, options, overwrite);\n    };\n    \n    var ajax_error_msg = function (jqXHR) {\n        /**\n         * Return a JSON error message if there is one,\n         * otherwise the basic HTTP status text.\n         */\n        if (jqXHR.responseJSON && jqXHR.responseJSON.traceback) {\n            return jqXHR.responseJSON.traceback;\n        } else if (jqXHR.responseJSON && jqXHR.responseJSON.message) {\n            return jqXHR.responseJSON.message;\n        } else {\n            return jqXHR.statusText;\n        }\n    };\n    var log_ajax_error = function (jqXHR, status, error) {\n        /**\n         * log ajax failures with informative messages\n         */\n        var msg = \"API request failed (\" + jqXHR.status + \"): \";\n        console.log(jqXHR);\n        msg += ajax_error_msg(jqXHR);\n        console.log(msg);\n    };\n\n    var requireCodeMirrorMode = function (mode, callback, errback) {\n        /** \n         * find a predefined mode or detect from CM metadata then\n         * require and callback with the resolvable mode string: mime or\n         * custom name\n         */\n\n        var modename = (typeof mode == \"string\") ? mode :\n            mode.mode || mode.name;\n\n        // simplest, cheapest check by mode name: mode may also have config\n        if (CodeMirror.modes.hasOwnProperty(modename)) {\n            // return the full mode object, if it has a name\n            callback(mode.name ? mode : modename);\n            return;\n        }\n\n        // *somehow* get back a CM.modeInfo-like object that has .mode and\n        // .mime\n        var info = (mode && mode.mode && mode.mime && mode) ||\n            CodeMirror.findModeByName(modename) ||\n            CodeMirror.findModeByExtension(modename.split(\".\").pop()) ||\n            CodeMirror.findModeByMIME(modename) ||\n            {mode: modename, mime: modename};\n\n        // might want to use CodeMirror.modeURL here\n        import(`codemirror/mode/${info.mode}/${info.mode}.js`).then(\n            function() {\n                // return the original mode, as from a kernelspec on first load\n                // or the mimetype, as for most highlighting\n                callback(mode.name ? mode : info.mime);\n            }, errback\n        );\n    };\n    \n    /** Error type for wrapped XHR errors. */\n    var XHR_ERROR = 'XhrError';\n    \n    /**\n     * Wraps an AJAX error as an Error object.\n     */\n    var wrap_ajax_error = function (jqXHR, status, error) {\n        var wrapped_error = new Error(ajax_error_msg(jqXHR));\n        wrapped_error.name =  XHR_ERROR;\n        // provide xhr response\n        wrapped_error.xhr = jqXHR;\n        wrapped_error.xhr_status = status;\n        wrapped_error.xhr_error = error;\n        return wrapped_error;\n    };\n    \n    var ajax = function (url, settings) {\n        // like $.ajax, but ensure XSRF or Authorization header is set\n        if (typeof url === \"object\") {\n            // called with single argument: $.ajax({url: '...'})\n            settings = url;\n            url = settings.url;\n            delete settings.url;\n        }\n        // [Basthon]\n        // force caching and use our cache busting strategy\n        settings.cache = true;\n        const data = (settings.data || {});\n        data['v'] = window.BASTHON_CACHE_BUSTING_TIMESTAMP;\n        settings.data = data;\n\n        settings = _add_auth_header(settings);\n        return $.ajax(url, settings);\n    };\n    \n    var _get_cookie = function (name) {\n        // from tornado docs: http://www.tornadoweb.org/en/stable/guide/security.html\n        var r = document.cookie.match(\"\\\\b\" + name + \"=([^;]*)\\\\b\");\n        return r ? r[1] : undefined;\n    }\n\n    var _add_auth_header = function (settings) {\n        /**\n         * Adds auth header to jquery ajax settings\n         */\n        settings = settings || {};\n        if (!settings.headers) {\n            settings.headers = {};\n        }\n        if (!settings.headers.Authorization) {\n            var xsrf_token = _get_cookie('_xsrf');\n            if (xsrf_token) {\n                settings.headers['X-XSRFToken'] = xsrf_token;\n            }\n        }\n        return settings;\n    };\n\n    var promising_ajax = function(url, settings) {\n        /**\n         * Like $.ajax, but returning an ES6 promise. success and error settings\n         * will be ignored.\n         */\n        settings = settings || {};\n        return new Promise(function(resolve, reject) {\n            settings.success = function(data, status, jqXHR) {\n                resolve(data);\n            };\n            settings.error = function(jqXHR, status, error) {\n                log_ajax_error(jqXHR, status, error);\n                reject(wrap_ajax_error(jqXHR, status, error));\n            };\n            ajax(url, settings);\n        });\n    };\n\n    var WrappedError = function(message, error){\n        /**\n         * Wrappable Error class\n         *\n         * The Error class doesn't actually act on `this`.  Instead it always\n         * returns a new instance of Error.  Here we capture that instance so we\n         * can apply it's properties to `this`.\n         */\n        var tmp = Error.apply(this, [message]);\n\n        // Copy the properties of the error over to this.\n        var properties = Object.getOwnPropertyNames(tmp);\n        for (var i = 0; i < properties.length; i++) {\n            this[properties[i]] = tmp[properties[i]];\n        }\n\n        // Keep a stack of the original error messages.\n        if (error instanceof WrappedError) {\n            this.error_stack = error.error_stack;\n        } else {\n            this.error_stack = [error];\n        }\n        this.error_stack.push(tmp);\n\n        return this;\n    };\n\n    WrappedError.prototype = Object.create(Error.prototype, {});\n\n\n    var load_class = function(class_name, module_name, registry) {\n        /**\n         * Tries to load a class\n         *\n         * Tries to load a class from a module using require.js, if a module \n         * is specified, otherwise tries to load a class from the global \n         * registry, if the global registry is provided.\n         */\n        return new Promise(function(resolve, reject) {\n\n            // Try loading the view module using require.js\n            if (module_name) {\n                requirejs.requirejs([module_name], function(module) {\n                    if (module[class_name] === undefined) {\n                        reject(new Error('Class '+class_name+' not found in module '+module_name));\n                    } else {\n                        resolve(module[class_name]);\n                    }\n                }, reject);\n            } else {\n                if (registry && registry[class_name]) {\n                    resolve(registry[class_name]);\n                } else {\n                    reject(new Error('Class '+class_name+' not found in registry '));\n                }\n            }\n        });\n    };\n\n    var resolve_promises_dict = function(d) {\n        /**\n         * Resolve a promiseful dictionary.\n         * Returns a single Promise.\n         */\n        var keys = Object.keys(d);\n        var values = [];\n        keys.forEach(function(key) {\n            values.push(d[key]);\n        });\n        return Promise.all(values).then(function(v) {\n            d = {};\n            for(var i=0; i<keys.length; i++) {\n                d[keys[i]] = v[i];\n            }\n            return d;\n        });\n    };\n\n    var reject = function(message, log) {\n        /**\n         * Creates a wrappable Promise rejection function.\n         * \n         * Creates a function that returns a Promise.reject with a new WrappedError\n         * that has the provided message and wraps the original error that \n         * caused the promise to reject.\n         */\n        return function(error) { \n            var wrapped_error = new WrappedError(message, error);\n            if (log) {\n                console.error(message, \" -- \", error);\n            }\n            return Promise.reject(wrapped_error); \n        };\n    };\n\n    var typeset = function(element, text) {\n        /**\n         * Apply MathJax rendering to an element, and optionally set its text\n         *\n         * If MathJax is not available, make no changes.\n         *\n         * Returns the output any number of typeset elements, or undefined if\n         * MathJax was not available.\n         *\n         * Parameters\n         * ----------\n         * element: Node, NodeList, or jQuery selection\n         * text: option string\n         */\n        var $el = element.jquery ? element : $(element);\n        if(arguments.length > 1){\n            $el.text(text);\n        }\n        if(!window.MathJax){\n            return;\n        }\n        $el.map(function(){\n            // MathJax takes a DOM node: $.map makes `this` the context\n            MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, this]);\n            try {\n                MathJax.Hub.Queue(\n                    [\"Require\", MathJax.Ajax, \"[MathJax]/extensions/TeX/AMSmath.js\"],\n                    function() { MathJax.InputJax.TeX.resetEquationNumbers(); }\n                );\n            } catch (e) {\n                console.error(\"Error queueing resetEquationNumbers:\", e);\n            }\n        });\n    };\n\n    var parse_b64_data_uri = function(uri) {\n        /**\n         * Parses a base64 encoded data-uri to extract mimetype and the\n         * base64 string.\n         *\n         * For example, given 'data:image/png;base64,iVBORw', it will return\n         * [\"image/png\", \"iVBORw\"]\n         *\n         * Parameters\n         */\n        // For performance reasons, the non-greedy ? qualifiers are crucial so\n        // that the matcher stops early on big blobs. Without them, it will try\n        // to match the whole blob which can take ages\n        var regex = /^data:(.+?\\/.+?);base64,/;\n        var matches = uri.match(regex);\n        var mime = matches[1];\n        // matches[0] contains the whole data-uri prefix\n        var b64_data = uri.slice(matches[0].length);\n        return [mime, b64_data];\n    };\n    \n    var time = {};\n    time.milliseconds = {};\n    time.milliseconds.s = 1000;\n    time.milliseconds.m = 60 * time.milliseconds.s;\n    time.milliseconds.h = 60 * time.milliseconds.m;\n    time.milliseconds.d = 24 * time.milliseconds.h;\n    \n    time.thresholds = {\n        // moment.js thresholds in milliseconds\n        s: moment.relativeTimeThreshold('s') * time.milliseconds.s,\n        m: moment.relativeTimeThreshold('m') * time.milliseconds.m,\n        h: moment.relativeTimeThreshold('h') * time.milliseconds.h,\n        d: moment.relativeTimeThreshold('d') * time.milliseconds.d,\n    };\n    \n    time.timeout_from_dt = function (dt) {\n        /** compute a timeout based on dt\n        \n        input and output both in milliseconds\n        \n        use moment's relative time thresholds:\n        \n        - 10 seconds if in 'seconds ago' territory\n        - 1 minute if in 'minutes ago'\n        - 1 hour otherwise\n        */\n        if (dt < time.thresholds.s) {\n            return 10 * time.milliseconds.s;\n        } else if (dt < time.thresholds.m) {\n            return time.milliseconds.m;\n        } else {\n            return time.milliseconds.h;\n        }\n    };\n\n    var format_datetime = function(date) {\n        var text = moment(date).fromNow();\n        return text === 'a few seconds ago' ? 'seconds ago' : text;\n    };\n\n    var datetime_sort_helper = function(a, b, order) {\n        if (moment(a).isBefore(moment(b))) {\n            return (order == 1) ? -1 : 1;\n        } else if (moment(a).isSame(moment(b))) {\n            return 0;\n        } else {\n            return (order == 1) ? 1 : -1;\n        }\n    };\n    \n    /**\n    source: https://github.com/sindresorhus/pretty-bytes\n    The MIT License (MIT)\n\n    Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (sindresorhus.com)\n\n    Permission is hereby granted, free of charge, to any person obtaining a copy\n    of this software and associated documentation files (the \"Software\"), to deal\n    in the Software without restriction, including without limitation the rights\n    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n    copies of the Software, and to permit persons to whom the Software is\n    furnished to do so, subject to the following conditions:\n\n    The above copyright notice and this permission notice shall be included in\n    all copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n    THE SOFTWARE.\n    **/\n    var format_filesize = function(num) {\n      if (num === undefined || num === null)\n        return;\n\n      var UNITS = ['B', 'kB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n\n      if (!Number.isFinite(num)) {\n        console.error(\"Expected finite number, got \", typeof(num) + \": \" + num);\n      }\n\n      var neg = num < 0;\n\n      if (neg) {\n        num = -num;\n      }\n\n      if (num < 1) {\n        return (neg ? '-' : '') + num + ' B';\n      }\n\n      var exponent = Math.min(Math.floor(Math.log10(num) / 3), UNITS.length - 1);\n      var numStr = Number((num / Math.pow(1000, exponent)).toPrecision(3));\n      var unit = UNITS[exponent];\n\n      return (neg ? '-' : '') + numStr + ' ' + unit;\n    }\n\n    // javascript stores text as utf16 and string indices use \"code units\",\n    // which stores high-codepoint characters as \"surrogate pairs\",\n    // which occupy two indices in the javascript string.\n    // We need to translate cursor_pos in the protocol (in characters)\n    // to js offset (with surrogate pairs taking two spots).\n    function js_idx_to_char_idx (js_idx, text) {\n        var char_idx = js_idx;\n        for (var i = 0; i + 1 < text.length && i < js_idx; i++) {\n            var char_code = text.charCodeAt(i);\n            // check for surrogate pair\n            if (char_code >= 0xD800 && char_code <= 0xDBFF) {\n                var next_char_code = text.charCodeAt(i+1);\n                if (next_char_code >= 0xDC00 && next_char_code <= 0xDFFF) {\n                    char_idx--;\n                    i++;\n                }\n            }\n        }\n        return char_idx;\n    }\n\n    function char_idx_to_js_idx (char_idx, text) {\n        var js_idx = char_idx;\n        for (var i = 0; i + 1 < text.length && i < js_idx; i++) {\n            var char_code = text.charCodeAt(i);\n            // check for surrogate pair\n            if (char_code >= 0xD800 && char_code <= 0xDBFF) {\n                var next_char_code = text.charCodeAt(i+1);\n                if (next_char_code >= 0xDC00 && next_char_code <= 0xDFFF) {\n                    js_idx++;\n                    i++;\n                }\n            }\n        }\n        return js_idx;\n    }\n\n    if ('𝐚'.length === 1) {\n        // If javascript fixes string indices of non-BMP characters,\n        // don't keep shifting offsets to compensate for surrogate pairs\n        char_idx_to_js_idx = js_idx_to_char_idx = function (idx, text) { return idx; };\n    }\n\n    // Test if a drag'n'drop event contains a file (as opposed to an HTML\n    // element/text from the document)\n    var dnd_contain_file = function(event) {\n        // As per the HTML5 drag'n'drop spec, the dataTransfer.types should\n        // contain one \"Files\" type if a file is being dragged\n        // https://www.w3.org/TR/2011/WD-html5-20110113/dnd.html#dom-datatransfer-types\n        if (event.dataTransfer.types) {\n            for (var i = 0; i < event.dataTransfer.types.length; i++) {\n                if (event.dataTransfer.types[i] == \"Files\") {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    var throttle = function(fn, time) {\n      var pending = null;\n\n      return function () {\n        if (pending) return;\n        pending = setTimeout(run, time);\n\n        return function () {\n          clearTimeout(pending);\n          pending = null;\n        }\n      }\n\n      function run () {\n        pending = null;\n        fn();\n      }\n    }\n    \n    var change_favicon = function (src) {\n        var link = document.createElement('link'),\n            oldLink = document.getElementById('favicon');\n        link.id = 'favicon';\n        link.type = 'image/x-icon';\n        link.rel = 'shortcut icon';\n        link.href = utils.url_path_join(utils.get_body_data('baseUrl'), src);\n        if (oldLink && (link.href === oldLink.href)) {\n            // This favicon is already set, don't modify the DOM.\n            return;\n        }\n        if (oldLink) document.head.removeChild(oldLink);\n        document.head.appendChild(link);\n    };\n\n    var utils = {\n        throttle: throttle,\n        is_loaded: is_loaded,\n        load_extension: load_extension,\n        load_extensions: load_extensions,\n        filter_extensions: filter_extensions,\n        load_extensions_from_config: load_extensions_from_config,\n        regex_split : regex_split,\n        uuid : uuid,\n        fixConsole : fixConsole,\n        fixCarriageReturn : fixCarriageReturn,\n        fixBackspace : fixBackspace,\n        fixOverwrittenChars: fixOverwrittenChars,\n        autoLinkUrls : autoLinkUrls,\n        points_to_pixels : points_to_pixels,\n        get_body_data : get_body_data,\n        parse_url : parse_url,\n        url_path_split : url_path_split,\n        url_path_join : url_path_join,\n        url_join_encode : url_join_encode,\n        encode_uri_components : encode_uri_components,\n        splitext : splitext,\n        escape_html : escape_html,\n        always_new : always_new,\n        to_absolute_cursor_pos : to_absolute_cursor_pos,\n        from_absolute_cursor_pos : from_absolute_cursor_pos,\n        browser : browser,\n        platform: platform,\n        get_url_param: get_url_param,\n        is_or_has : is_or_has,\n        is_focused : is_focused,\n        mergeopt: mergeopt,\n        requireCodeMirrorMode : requireCodeMirrorMode,\n        XHR_ERROR : XHR_ERROR,\n        ajax : ajax,\n        ajax_error_msg : ajax_error_msg,\n        log_ajax_error : log_ajax_error,\n        wrap_ajax_error : wrap_ajax_error,\n        promising_ajax : promising_ajax,\n        WrappedError: WrappedError,\n        load_class: load_class,\n        resolve_promises_dict: resolve_promises_dict,\n        reject: reject,\n        typeset: typeset,\n        parse_b64_data_uri: parse_b64_data_uri,\n        time: time,\n        format_datetime: format_datetime,\n        format_filesize: format_filesize,\n        datetime_sort_helper: datetime_sort_helper,\n        dnd_contain_file: dnd_contain_file,\n        js_idx_to_char_idx: js_idx_to_char_idx,\n        char_idx_to_js_idx: char_idx_to_js_idx,\n        _ansispan:_ansispan,\n        change_favicon: change_favicon\n    };\n\n    return utils;\n}); \n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine(['bidi/numericshaping', 'moment'], function(numericshaping, moment) {\n  'use strict';\n\n  var shaperType = '';\n\n  var _uiLang = function() {\n    return navigator.language.toLowerCase();\n  };\n\n  var _loadLocale = function() {\n    if (_isMirroringEnabled()) {\n      document.body.dir = 'rtl';\n    }\n\n    console.log('Loaded moment locale', moment.locale(_uiLang()));\n\n    shaperType = _uiLang().split('-')[0] == 'ar' ? 'national' : 'defaultNumeral';\n  };\n\n  var _isMirroringEnabled = function() {\n    return new RegExp('^(ar|he)').test(_uiLang());\n  };\n\n  /**\n     * @param value : the string to apply the bidi-support on it.\n     * @param flag :indicates the type of bidi-support (Numeric-shaping ,Base-text-dir ).\n     */\n  var _applyBidi = function(value /*, flag*/) {\n    value = numericshaping.shapeNumerals(value, shaperType);\n    return value;\n  };\n\n  var bidi = {\n    applyBidi: _applyBidi,\n    isMirroringEnabled: _isMirroringEnabled,\n    loadLocale: _loadLocale,\n  };\n\n  return bidi;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([],\n    function(bidi) {\n    \"use strict\";\n\t\n    var regex = /([0-9])|([\\u0660-\\u0669])|([\\u0608\\u060B\\u060D\\u061B-\\u064A\\u066D-\\u066F\\u0671-\\u06D5\\u06E5-\\u06E6\\u06EE-\\u06EF\\u06FA-\\u06FF\\u0750-\\u077F\\u08A0-\\u08E3\\u200F\\u202B\\u202E\\u2067\\uFB50-\\uFD3D\\uFD40-\\uFDCF\\uFDF0-\\uFDFC\\uFDFE-\\uFDFF\\uFE70-\\uFEFE]+)|([^0-9\\u0660-\\u0669\\u0608\\u060B\\u060D\\u061B-\\u064A\\u066D-\\u066F\\u0671-\\u06D5\\u06E5-\\u06E6\\u06EE-\\u06EF\\u06FA-\\u06FF\\u0750-\\u077F\\u08A0-\\u08E3\\u200F\\u202B\\u202E\\u2067\\uFB50-\\uFD3D\\uFD40-\\uFDCF\\uFDF0-\\uFDFC\\uFDFE-\\uFDFF\\uFE70-\\uFEFE\\u0600-\\u0607\\u0609-\\u060A\\u060C\\u060E-\\u061A\\u064B-\\u066C\\u0670\\u06D6-\\u06E4\\u06E7-\\u06ED\\u06F0-\\u06F9\\u08E4-\\u08FF\\uFD3E-\\uFD3F\\uFDD0-\\uFDEF\\uFDFD\\uFEFF\\u0000-\\u0040\\u005B-\\u0060\\u007B-\\u007F\\u0080-\\u00A9\\u00AB-\\u00B4\\u00B6-\\u00B9\\u00BB-\\u00BF\\u00D7\\u00F7\\u02B9-\\u02BA\\u02C2-\\u02CF\\u02D2-\\u02DF\\u02E5-\\u02ED\\u02EF-\\u02FF\\u2070\\u2074-\\u207E\\u2080-\\u208E\\u2100-\\u2101\\u2103-\\u2106\\u2108-\\u2109\\u2114\\u2116-\\u2118\\u211E-\\u2123\\u2125\\u2127\\u2129\\u212E\\u213A-\\u213B\\u2140-\\u2144\\u214A-\\u214D\\u2150-\\u215F\\u2189\\uA720-\\uA721\\uA788\\uFF01-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF65\\uFFE0-\\uFFE6\\uFFE8-\\uFFEE]+)/g;\n\t\n    var shape = function(text, shaperType) {\n        text = text.toString();\n        if (!text) { \n            return text;\n        }\n        switch (shaperType) {\n            case \"defaultNumeral\":\n                return _shapeEuropean(text);\n            case \"national\":\n                return _shapeArabic(text);\n            default:\n                return text;\n        }\n    };\n    \n    var _shapeEuropean = function(text) {\n        return text.replace(/[\\u0660-\\u0669]/g, function(c) {\n            return c.charCodeAt(0) - 1632;\n        });\n    };\n\n    var _shapeArabic = function(text) {\n        return text.replace(/[0-9]/g, function(c) {\n            return String.fromCharCode(parseInt(c) + 1632);\n        });\n    };\n   \n    var numericshaping = {\n        shapeNumerals : shape\n    };\n           \n    return numericshaping;       \n});\n","/* -*- coding: utf-8; js-indent-level: 2 -*-\n * ----------------------------------------------------------------------------\n * Copyright (c) 2013-2017 Damián Avila and contributors.\n *\n * Distributed under the terms of the Modified BSD License.\n *\n * A Jupyter notebook extension to support *Live* Reveal.js-based slideshows.\n * -----------------------------------------------------------------------------\n */\n\ndefine([\n  'reveal.js',\n  'jquery',\n  'base/js/namespace',\n  'base/js/utils',\n  'services/config',\n  'base/js/dialog',\n], function(Reveal, $, Jupyter, utils, configmod, dialog) {\n\n  \"use strict\";\n\n  window.Reveal = Reveal = Reveal.default;\n\n  /*\n   * load configuration\n   *\n   * 1) start from the hardwired settings (in this file)\n   * 2) add settings configured in python; these typically can be\n   *   2a) either in a legacy file named `livereveal.json`\n   *   2b) or, with the official name, in `rise.json`\n   * 3) add the settings from nbext_configurator (i.e. .jupyter/nbconfig/notebook.json)\n   *    they should all belong in the 'rise' category\n   *    the configurator came after the shift from 'livereveal' to 'rise'\n   *    so no need to consider 'livereveal' here\n   * 4) and finally add the settings from the notebook metadata\n   *   4a) for legacy reasons: use the 'livereveal' key\n   *   4b) for more consistency, then override with the 'rise' key\n   *\n   * configLoaded alters the complete_config object in place.\n   * it will hold a consolidated set of all relevant settings with their priorities resolved\n   *\n   * it returns a promise that can be then'ed once the config is loaded\n   *\n   * setup waits for the config to be loaded before it actually enables keyboard shortcuts\n   * and other menu items; so this means that the bulk of the code can assume that the config\n   * is already loaded and does not need to worry about using promises, or\n   * waiting for any asynchronous code to complete\n   */\n\n  let complete_config = {};\n\n  // returns a promise; you can do 'then()' on this promise\n  // to do stuff *after* the configuration is completely loaded\n  function configLoaded() {\n\n    // see rise.yaml for more details\n    let hardwired_config = {\n\n      // behaviour\n      autolaunch: false,\n      start_slideshow_at: 'selected',\n      auto_select: 'code',\n      auto_select_fragment: true,\n      show_buttons_on_startup: true,\n\n      // aspect\n      header: undefined,\n      footer: undefined,\n      backimage: undefined,\n      overlay: undefined,\n\n      // timeouts\n      // wait for that amont before calling ensure_focused on the\n      // selected cell\n      restore_timeout: 500,\n      // wait for that amount before actually selected auto-selected fragment\n      // when going too short, like 250, size of selected cell get odd\n      auto_select_timeout: 450,\n      // wait for that amount before calling sync() again\n      // this is a workaround that fixes #504\n      sync_timeout: 250,\n\n      // UI\n      toolbar_icon: 'fa-bar-chart',\n      shortcuts: {\n        'slideshow' : 'alt-r',\n        'toggle-slide': 'shift-i',\n        'toggle-subslide': 'shift-b',\n        'toggle-fragment': 'shift-g',\n        // this can be helpful\n        'rise-nbconfigurator': 'shift-c',\n        // unassigned by default\n        'toggle-notes': '',\n        'toggle-skip': '',\n      },\n\n      // reveal native settings passed as-is\n      // see also the 'inherited' variable below in Revealer\n      theme: 'simple',\n      transition: 'linear',\n      // xxx there might be a need to tweak this one when set\n      // by the configurator, as e.g. 'false' or 'true' will result\n      // in a string and not a boolean\n      slideNumber: true,\n      width: \"100%\",\n      height: \"100%\",\n      controls: true,\n      progress: true,\n      history: true,\n      scroll: false,\n      center: true,\n      margin: 0.1,\n      minScale: 1.0, // we need this for codemirror to work right\n      // turn off reveal's help overlay that is by default bound to question mark / ?\n      help: false,\n\n      // plugins\n      enable_chalkboard: false,\n      enable_leap_motion: false,\n    };\n\n    // honour the 2 names: 'livereveal' and 'rise'\n    // use the ones in livereveal/legacy first\n    // so they get overridden if redefined in rise\n    let config_section_legacy = new configmod.ConfigSection(\n      'livereveal',\n      {base_url: utils.get_body_data(\"baseUrl\")});\n    // trigger an asynchronous load\n    config_section_legacy.load();\n    let config_section = new configmod.ConfigSection(\n      'rise',\n      {base_url: utils.get_body_data(\"baseUrl\")});\n    config_section.load();\n\n    // this is also a ConfigSection object as per notebook/static/services/config.js\n    let nbext_configurator = Jupyter.notebook.config;\n    nbext_configurator.load();\n\n    // with Promise.all we can wait for all 3 configs to have loaded\n    return Promise.all([\n      config_section_legacy.loaded,\n      config_section.loaded,\n      nbext_configurator.loaded,\n    ]).then(\n      // and now we can compute the layered config\n      function() {\n        // 1) initialize with hardwired defaults\n        $.extend(true, complete_config, hardwired_config);\n        // 2a) and 2b)\n        $.extend(true, complete_config, config_section_legacy.data);\n        $.extend(true, complete_config, config_section.data);\n        // 3)\n        $.extend(true, complete_config, nbext_configurator.data.rise);\n        // 4a) from the notebook metadata\n        let metadata_legacy = Jupyter.notebook.metadata.livereveal;\n        $.extend(true, complete_config, metadata_legacy);\n        // 4b) ditto\n        let metadata = Jupyter.notebook.metadata.rise;\n        $.extend(true, complete_config, metadata);\n        // console.log(\"complete_config is OK\");\n      });\n  }\n\n  /*\n   * this function is a heuristic that says if this notebook seems to\n   * be meant to be a slideshow.\n   * this primarily is for autolaunch, so that somebody who would\n   * enable autolaunch in her ~/.jupyter/ area would not\n   * see RISE trigger on every single notebook\n   *\n   * xxx note that this might take too long on large notebooks\n   * a possible improvement would be to look for the first, say, 10 cells only\n   * as a matter of fact, in most cases the first cell would be a slide cell really\n   */\n  function is_slideshow(notebook) {\n    for (let cell of notebook.get_cells())\n      if (is_slide(cell) || is_subslide(cell))\n        return true;\n    return false;\n  }\n\n  /*\n   * Version of get_cell_elements that will see cell divs at any depth in the HTML tree,\n   * allowing container divs, etc to be used without breaking notebook machinery.\n   * You'll need to make sure the cells are getting detected in the right order.\n   * NOTE: We use the Object prototype to workaround a firefox issue, check the following\n   * link to know more about the discussion leading to this use:\n   * https://github.com/damianavila/RISE/issues/117#issuecomment-127331816\n   */\n  Object.getPrototypeOf(Jupyter.notebook).get_cell_elements = function () {\n    return this.container.find(\"div.cell\");\n  };\n\n  /* uniform way to access slide type, whether the slideshow metadata is set or not\n   * also sometimes slide_type is set to '-' by the toolbar\n   */\n  function get_slide_type(cell) {\n    let slide_type = (cell.metadata.slideshow || {}).slide_type;\n    return ( (slide_type === undefined) || (slide_type == '-')) ? '' : slide_type;\n  }\n\n  function is_slide(cell)    {return get_slide_type(cell) == 'slide';}\n  function is_subslide(cell) {return get_slide_type(cell) == 'subslide';}\n  function is_fragment(cell) {return get_slide_type(cell) == 'fragment';}\n  function is_skip(cell)     {return get_slide_type(cell) == 'skip';}\n  function is_notes(cell)    {return get_slide_type(cell) == 'notes';}\n  function is_regular(cell)  {return get_slide_type(cell) == '';}\n\n  /* Use the slideshow metadata to rearrange cell DOM elements into the\n   * structure expected by reveal.js\n   *\n   * in the process, each cell receives a 'smart_exec' tag that says\n   * how to behave when the cell gets executed with Shift-Enter\n   * this tag can be either\n   * 'smart_exec_slide' : just do exec, which is what RISE did on all cells at first\n   this is for the last cell on a (sub)slide\n   i.e. if next cell is slide or subslide\n   * 'smart_exec_fragment' : do exec + show next fragment\n   if next cell is a fragment\n   * 'smart_exec_next' : do the usual exec + select next like in classic notebook\n   */\n  function markupSlides(container) {\n    // Machinery to create slide/subslide <section>s and give them IDs\n    let slide_counter = -1, subslide_counter = -1;\n    let slide_section, subslide_section;\n    function new_slide() {\n      slide_counter++;\n      subslide_counter = -1;\n      return $('<section>').appendTo(container);\n    }\n    function new_subslide() {\n      subslide_counter++;\n      return $('<section>').attr('id', 'slide-'+slide_counter+'-'+subslide_counter)\n        .appendTo(slide_section);\n    }\n\n    // Containers for the first slide.\n    slide_section = new_slide();\n    subslide_section = new_subslide();\n    let current_fragment = subslide_section;\n\n    let selected_cell_idx = Jupyter.notebook.get_selected_index();\n    let selected_cell_slide = [0, 0];\n\n    /* Special handling for the first slide: it will work even if the user\n     * doesn't start with a 'Slide' cell. But if the user does explicitly\n     * start with slide/subslide, we don't want a blank first slide. So we\n     * don't create a new slide/subslide until there is visible content on\n     * the first slide.\n     */\n    let content_on_slide1 = false;\n\n    let cells = Jupyter.notebook.get_cells();\n\n    for (let i=0; i < cells.length; i++) {\n      let cell = cells[i];\n      let slide_type = get_slide_type(cell);\n\n      if (content_on_slide1) {\n        if (slide_type === 'slide') {\n          // Start new slide\n          slide_section = new_slide();\n          // In each subslide, we insert cells directly into the\n          // <section> until we reach a fragment, when we create a div.\n          current_fragment = subslide_section = new_subslide();\n        } else if (slide_type === 'subslide') {\n          // Start new subslide\n          current_fragment = subslide_section = new_subslide();\n        } else if (slide_type === 'fragment') {\n          // record the <div class='fragment'> element corresponding\n          // to each fragment cell in the 'fragment_div' attribute\n          cell.fragment_div = current_fragment = $('<div>').addClass('fragment')\n            .appendTo(subslide_section);\n        }\n      } else if (slide_type !== 'notes' && slide_type !== 'skip') {\n        // Subsequent cells should be able to start new slides\n        content_on_slide1 = true;\n      }\n\n      // Record that this slide contains the selected cell\n      // this is where we need i as set in the loop over cells\n      if (i === selected_cell_idx) {\n        selected_cell_slide = [slide_counter, subslide_counter];\n      }\n\n      // Move the cell element into the slide <section>\n      // N.B. jQuery append takes the element out of the DOM where it was\n      if (slide_type === 'notes') {\n        // Notes are wrapped in an <aside> element\n        subslide_section.append(\n          $('<aside>').addClass('notes').append(cell.element)\n        );\n      } else {\n        current_fragment.append(cell.element);\n      }\n\n      // Hide skipped cells\n      if (slide_type === 'skip') {\n        cell.element.addClass('reveal-skip');\n      }\n\n    }\n\n    /* set on all cells a smart_exec tag that says how smart exec\n     * should behave on that cell\n     * the fragment cell also get a smart_exec_next_fragment\n     * attribute that points at the <div class='fragment'>\n     * corresponding to the (usually immediately) next cell\n     * that is a fragment cell\n     */\n    for (let i=0; i < cells.length; i++) {\n      let cell = cells[i];\n      // default is 'pinned' because this applies to the last cell\n      let tag = 'smart_exec_slide';\n      for (let j = i+1; j < cells.length; j++) {\n        let next_cell = cells[j];\n        let next_type = get_slide_type(next_cell);\n        if ((next_type == 'slide') || (next_type) == 'subslide') {\n          tag = 'smart_exec_slide';\n          break;\n        } else if (next_type == 'fragment') {\n          tag = 'smart_exec_fragment';\n          /* these cells are the last before a fragment\n           * and when running smart-exec we'll want to know\n           * if that fragment is visible, so we keep a link to\n           * the <div class='fragment'> element of that (next)\n           * fragment cell\n           */\n          cell.smart_exec_next_fragment = next_cell.fragment_div;\n          break;\n        } else if (next_type == '') {\n          tag = 'smart_exec_next';\n          break;\n        }\n      }\n      cell.smart_exec = tag;\n    }\n\n    return selected_cell_slide;\n  }\n\n  /* Set the #slide-x-y part of the URL to control where the slideshow will start.\n   * N.B. We do this instead of using Reveal.slide() after reveal initialises,\n   * because that leaves one slide clearly visible on screen for a moment before\n   * changing to the one we want. By changing the URL before setting up reveal,\n   * the slideshow really starts on the desired slide.\n   */\n  function setStartingSlide(selected) {\n\n    let start_slideshow = complete_config.start_slideshow_at;\n    if (start_slideshow === 'selected') {\n      // Start from the selected cell\n      Reveal.slide(selected[0], selected[1]);\n    } else {\n      // Start from the beginning\n      Reveal.slide(0, 0);\n    }\n    setScrollingSlide();\n    // warkaround for #504\n    // when editing if you swap out of reveal, and then\n    // come back in, with 5.6 most of the time display \n    // becomes empty or the contents is way too low\n    // this patch makes the situation much better,\n    // although it is clearly suboptimal to have \n    // to resort to that sort of dirty patch\n    setTimeout(()=>Reveal.sync(), complete_config.sync_timeout);\n  }\n\n  /* Setup the scrolling in the current slide if the config option is activated\n   *  and the content is greater than 0.95 * slide height\n   */\n  function setScrollingSlide() {\n\n    let scroll = complete_config.scroll;\n    if (scroll === true) {\n      let h = $('.reveal').height() * 0.95;\n      $('section.present').find('section')\n        .filter(function() {\n          return $(this).height() > h;\n        })\n        .css('height', 'calc(95vh)')\n        .css('overflow-y', 'scroll')\n        .css('margin-top', '20px');\n    }\n  }\n\n  /*\n   * Setup the auto-launch function, which checks metadata to see if\n   * RISE should launch automatically when the notebook is opened.\n   *\n   * this will trigger only on notebooks that have\n   * either a 'livereveal' or a 'rise' section in their metadata\n   * this is because autolaunch can be enabled in nbextensions_configurator\n   * and so can possibly have a too big impact if we are not careful\n   */\n  function autoLaunch() {\n    if (complete_config.autolaunch && is_slideshow(Jupyter.notebook)) {\n      revealMode();\n    }\n\n    // Ref: https://stackoverflow.com/a/7739035\n    let url = (window.location != window.parent.location)\n        ? document.referrer\n        : document.location.href;\n    let lastPart = url.substr(url.lastIndexOf('/') + 1);\n\n    if (lastPart === \"notes.html\") {\n      revealMode();\n    }\n  }\n\n  /* Setup a MutationObserver to call Reveal.sync when an output is generated.\n   * This fixes issue #188: https://github.com/damianavila/RISE/issues/188\n   */\n  let outputObserver = null;\n  function setupOutputObserver() {\n    function mutationHandler(mutationRecords) {\n      mutationRecords.forEach(function(mutation) {\n        if (mutation.addedNodes && mutation.addedNodes.length) {\n          Reveal.sync();\n          setScrollingSlide();\n        }\n      });\n    }\n\n    let $output = $(\".output\");\n    let MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n    outputObserver = new MutationObserver(mutationHandler);\n\n    let observerOptions = { childList: true,\n                            characterData: false,\n                            attributes: false,\n                            subtree: false\n                          };\n    $output.each(function () {\n      outputObserver.observe(this, observerOptions);\n    });\n  }\n\n  function disconnectOutputObserver() {\n    if (outputObserver !== null) {\n      outputObserver.disconnect();\n    }\n  }\n\n  function addHeaderFooterOverlay() {\n    let overlay = complete_config.overlay;\n    let header =  complete_config.header;\n    let footer =  complete_config.footer;\n    let backimage =  complete_config.backimage;\n    // minimum styling to make these 3 things look\n    // like what their name says they should look\n    let header_style = \"position: absolute; top: 0px;\";\n    let footer_style = \"position: absolute; bottom: 0px;\";\n    let backimage_style = \"width: 100%; height: 100%;\";\n\n    let overlay_body = \"\";\n    if (overlay) {\n      overlay_body = overlay;\n    } else {\n      if (header)\n        overlay_body += `<div id='rise-header' style='${header_style}'>${header}</div>`;\n      if (backimage)\n        overlay_body += `<img id='rise-backimage' style='${backimage_style}' src='${backimage}' />`;\n      if (footer)\n        overlay_body += `<div id='rise-footer' style='${footer_style}'>${footer}</div>`;\n    }\n    let overlay_div = `<div id='rise-overlay'>${overlay_body}</div>`;\n    $('div.reveal').append(overlay_div);\n  }\n\n  function removeHeaderFooterOverlay() {\n    // it's easier to remove than to hide, plus this way\n    // changes in the metadata will be reflected each time\n    // we enter reveal again\n    $('div#rise-overlay').remove();\n  }\n   \n  function toggleAllRiseButtons() {\n    $('#help_b,#exit_b,#toggle-chalkboard,#toggle-notes').fadeToggle()\n  }\n  \n  function Revealer(selected_slide) {\n    \n    // console.log(`complete_config: ${JSON.stringify(complete_config)}`);\n    \n    $('body').addClass(\"rise-enabled\");\n    // Prepare the DOM to start the slideshow\n    $('div#header').hide();\n    $('.end_space').hide();\n\n    // Add the main reveal.js classes\n    $('div#notebook').addClass(\"reveal\");\n    $('div#notebook-container').addClass(\"slides\");\n\n    // Header\n    // Available themes are in static/css/theme\n    let theme = complete_config.theme;\n    $('body').addClass(`theme-${theme}`);\n    import(`reveal.js/dist/theme/${theme}.css`);\n\n    // Add reveal css\n    import(\"reveal.js/dist/reveal.css\");\n\n    /* this policy of trying ./rise.css and then <notebook>.css\n     * should be redefinable in the config\n     */\n    // https://github.com/damianavila/RISE/issues/509\n    let name = Jupyter.notebook.notebook_name;\n    // remove extension if any\n    let dot_index = name.lastIndexOf('.');\n    let stem = (dot_index == -1) ? name : name.substr(0, dot_index);\n    // associated css\n    let name_css = `${stem}.css`;\n    // Attempt to load rise.css\n    $('head').append(\n      `<link rel=\"stylesheet\" href=\"rise.css\" id=\"rise-custom-css\" />`);\n    // Attempt to load css with the same path as notebook\n    $('head').append(\n      `<link rel=\"stylesheet\" href=\"${name_css}\" id=\"rise-notebook-css\" />`);\n\n\n    // Full list of configuration options available here:\n    // https://github.com/hakimel/reveal.js#configuration\n    \n\n    // all these settings are passed along to reveal as-is\n    // xxx it might be just better to copy the whole complete_config instead\n    // of selecting some names, which would allow users to transparently use\n    // all reveal's features\n    let inherited = ['controls', 'progress', 'history', 'width', 'height', 'margin',\n                     'minScale', 'transition', 'slideNumber', 'center', 'help'];\n\n    let options = {\n\n      //parallaxBackgroundImage: 'https://raw.github.com/damianavila/par_IPy_slides_example/gh-pages/figs/star_wars_stormtroopers_darth_vader.jpg',\n      //parallaxBackgroundSize: '2560px 1600px',\n      \n      // turn off reveal native help\n      help: false,\n\n      // key bindings configurable are now defined in the reveal_default_bindings dict - \n      // this should only be used to unbind keys\n      // note that toggleAllRiseButtons is bound to comma here as jupyter does not\n      // allow to bind anything to comma!\n      keyboard: {\n        13: null, // Enter disabled\n        27: null, // ESC disabled\n        35: null, // End - last slide disabled (will be set in custom keys)\n        36: null, // Home - first slide disabled (will be set in custom keys)\n        38: null, // up arrow disabled\n        40: null, // down arrow disabled\n        66: null, // b, black pause disabled, use period or forward slash\n        70: null, // disable fullscreen inside the slideshow, makes codemirror unreliable\n        72: null, // h, left disabled\n        74: null, // j, down disabled\n        75: null, // k, up disabled\n        76: null, // l, right disabled\n        78: null, // n, down disabled\n        79: null, // o disabled\n        80: null, // p, up disabled\n        84: null, // t, modified in the custom notes plugin.\n        87: null, // w, toggle overview\n        188: toggleAllRiseButtons, // comma\n      },\n\n      dependencies: [\n        // Optional libraries used to extend on reveal.js\n        /* { src: \"static/custom/livereveal/reveal.js/lib/js/classList.js\",\n         *   condition: function() { return !document.body.classList; } },\n         * { src: \"static/custom/livereveal/reveal.js/plugin/highlight/highlight.js\",\n         *   async: true,\n         *  callback: function() { hljs.initHighlightingOnLoad(); } },\n         */\n        { src: require(\"reveal.js/plugin/notes/notes.js?path-rise\"),\n          async: true,\n        },\n      ],\n      \n    };\n\n    for (let setting of inherited) {\n      options[setting] = complete_config[setting];\n    }\n    \n    ////////// set up the leap motion integration if configured\n    let enable_leap_motion = complete_config.enable_leap_motion;\n    if (enable_leap_motion) {\n      // [Basthon] leap not used so not bundled\n      /*options.dependencies.push({ src: require(\"reveal.js/plugin/leap/leap.js?path-rise\"),\n                                  async: true });*/\n      options.leap = enable_leap_motion;\n    }\n    \n    //$.extend(options.keyboard, reveal_bindings);\n\t      \n    ////////// set up chalkboard if configured\n    let enable_chalkboard = complete_config.enable_chalkboard;\n    if (enable_chalkboard) {\n      if (\"chalkboard\" in complete_config) {\n        options[\"chalkboard\"] = complete_config[\"chalkboard\"];\n      }\n      options.dependencies.push({ src: require(\"./reveal.js-chalkboard/chalkboard.js?path-rise\"),\n                                  async: true });\n      // xxx need to explore the option of registering jupyter actions\n      // and have jupyter handle the keyboard entirely instead of this approach\n      // could hopefully avoid conflicting behaviours in case of overlaps\n      \n      // comment from thecker: \n      // this is not implemented - reveal.js & chalkboard bindings are now defined in\n      // nbconfing and setupKeys + registerJupyterActions is used to set the bindings\n      \n      //$.extend(options.keyboard, cb_bindings);\n    }\n    \n    let promise = Promise.resolve();\n    if (Reveal.initialized) {\n      //delete options[\"dependencies\"];\n      Reveal.configure(options);\n      //console.log(\"Reveal is already initialized and is being configured\");\n    } else {\n      promise = Reveal.initialize(options);\n      //console.log(\"Reveal initialized\");\n      Reveal.initialized = true;\n    }\n\n    Reveal.addEventListener('ready', function(event) {\n      Unselecter();\n      // check and set the scrolling slide when you start the whole thing\n      setScrollingSlide();\n      autoSelectHook();\n    });\n    \n    Reveal.addEventListener('slidechanged', function(event) {\n      Unselecter();\n      // check and set the scrolling slide every time the slide change\n      setScrollingSlide();\n      autoSelectHook();\n    });\n    \n    Reveal.addEventListener('fragmentshown', function(event) {\n      autoSelectHook();\n    });\n    Reveal.addEventListener('fragmenthidden', function(event) {\n      autoSelectHook();\n    });\n\n    promise.then(_ => {\n      // Sync when an output is generated.\n      setupOutputObserver();\n\n      // Setup the starting slide\n      setStartingSlide(selected_slide);\n      addHeaderFooterOverlay();\n    });\n    if (! complete_config.show_buttons_on_startup) {\n      /* safer, and nicer too, to wait for reveal extensions to start */\n      setTimeout(toggleAllRiseButtons, 2000);\n    }\n  }\n\n  function Unselecter(){\n    let cells = Jupyter.notebook.get_cells();\n    for (let cell of cells){\n      cell.unselect();\n    }\n  }\n\n  function fixCellHeight(){\n    // Let's start with all the cell unselected, the unselect the current selected one\n    let scell = Jupyter.notebook.get_selected_cell();\n    scell.unselect();\n    // This select/unselect code cell triggers the \"correct\" heigth in the codemirror instance\n    let cells = Jupyter.notebook.get_cells();\n    for (let cell of cells){\n      if (cell.cell_type === \"code\") {\n        cell.select();\n        cell.unselect();\n      }\n    }\n  }\n\n  /* from notebook/actions.js\n   * jupyter-notebook:run-cell -> notebook.execute_selected_cells()\n   * jupyter-notebook:run-cell-and-select-next -> notebook.execute_cell_and_select_below()\n   */\n  function smartExec() {\n    // is it really the selected cell that matters ?\n    let smart_exec = Jupyter.notebook.get_selected_cell().smart_exec;\n    if (smart_exec == 'smart_exec_slide') {\n      Jupyter.notebook.execute_selected_cells();\n    } else if (smart_exec == \"smart_exec_fragment\") {\n      // let's see if the next fragment is visible or not\n      let cell = Jupyter.notebook.get_selected_cell();\n      let fragment_div = cell.smart_exec_next_fragment;\n      let visible = $(fragment_div).hasClass('visible');\n      if (visible) {\n        Jupyter.notebook.execute_cell_and_select_below();\n      } else {\n        Jupyter.notebook.execute_selected_cells();\n      }\n    } else {\n      Jupyter.notebook.execute_cell_and_select_below();\n    }\n  }\n  \n  // action for reveal.js and reveal.js plug-in bindings\n  // this a the dictionary structure as generated by nbextension_configurator \n  // with the corresponding API calls to RISE/reveal.js and/or its plug-ins \n  let reveal_actions = {\n      'main': {   // RISE/reveal.js API calls\n        'firstSlide': () => Reveal.slide(0), // jump to first slide\n        'lastSlide': () => Reveal.slide( Number.MAX_VALUE ),  // jump to last slide\n        'toggleOverview': () => Reveal.toggleOverview(),  // toggle overview\n        'toggleAllRiseButtons': toggleAllRiseButtons,  // show/hide buttons\n        'fullscreenHelp': fullscreenHelp,  // show fullscreen help\n        'riseHelp': riseHelp,  // '?' show our help\n      },\n      'chalkboard': { // API calls for RevealChalkboard plug-in\n        'clear': () => RevealChalkboard.clear(), // clear full size chalkboard\n        'reset': () => RevealChalkboard.reset(), // reset chalkboard data on current slide\n        'toggleChalkboard': () => RevealChalkboard.toggleChalkboard(),  // toggle full size chalkboard\n        'toggleNotesCanvas': () => RevealChalkboard.toggleNotesCanvas(), // toggle notes (slide-local)\n        'colorNext': () => RevealChalkboard.colorNext(), // next color\n        'colorPrev': () => RevealChalkboard.colorPrev(), // previous color\n        'download': () => RevealChalkboard.download()  //  download recorded chalkboard drawing\n      },\n      'notes': { // API calls for RevealNotes plug-in\n          'openNotes' : () => RevealNotes.open(), // open speaker notes window\n      },\n  }\n  \n  let reveal_helpstr = {\n      'main': {   // RISE/reveal.js API calls\n        'firstSlide': 'jump to first slide',\n        'lastSlide': 'jump to last slide',\n        'toggleOverview': 'toggle overview',\n        'toggleAllRiseButtons': 'show/hide buttons',\n        'fullscreenHelp': 'show fullscreen help',\n        'riseHelp': 'show this help dialog'\n      },\n      'chalkboard': { // API calls for RevealChalkboard plug-in\n        'clear': 'clear full size chalkboard',\n        'reset': 'reset chalkboard data on current slide',\n        'toggleChalkboard': 'toggle full size chalkboard',\n        'toggleNotesCanvas': 'toggle notes (slide-local)',\n        'colorNext': 'cycle to next pen color',\n        'colorPrev': 'cycle to previous pen color',\n        'download': 'download recorded chalkboard drawing'\n      },\n      'notes': { // API calls for RevealNotes plug-in\n          'openNotes' : 'open speaker notes window'\n      },\n  }\n  \n  // need to check, if we can fetch the default bindings from rise.yaml (nbconfig)\n  let reveal_default_bindings = {\n      'main': {\n        'firstSlide': 'home',\n        'lastSlide': 'end',             // keycode 35\n        'toggleOverview': 'w',          // keycode 87\n        //'toggleAllRiseButtons': 'm',  // keycode 188 (\",\") is not allowed in jupyter! using m instead\n        'fullscreenHelp': 'f',          // keycode 70\n        'riseHelp': '?',                // keycode 63\n      },\n      'chalkboard': {\n        'clear': 't,c',\n        'reset': 'd,c',\n        'toggleChalkboard': 't,t',\n        'toggleNotesCanvas': 'd,d',\n        'colorPrev': 'q',               // keycode 81\n        'colorNext': 's',               // kecode 83\n        'download': 'd,g'\n      },\n      'notes': { // API calls for RevealNotes plug-in\n          'openNotes' : 'n,n'\n      },\n  }\n  \n  // update reveal bindings with custom key codes\n  function updateRevealBindings(default_bindings){\n    \n    // console.log(`complete_config in updateRevealBindings`, complete_config);\n    let custom_shortcuts = complete_config.reveal_shortcuts;\n    // console.log(`custom_shortcuts in updateRevealBindings`, custom_shortcuts);\n    \n    if (custom_shortcuts) {\n      for (const module of Object.keys(custom_shortcuts)){\n        for (const action of Object.keys(custom_shortcuts[module])){\n           default_bindings[module][action] = custom_shortcuts[module][action];\n        }\n      }\n    }\n    return default_bindings;\n  }\n  \n\n  function setupKeys(mode){\n    \n    let key_str;\n    let reveal_bindings = updateRevealBindings(reveal_default_bindings);\n    \n    // Lets setup some specific keys for the reveal_mode\n    if (mode === 'reveal_mode') {\n      Jupyter.keyboard_manager.command_shortcuts.set_shortcut(\"shift-enter\", \"RISE:smart-exec\");\n      Jupyter.keyboard_manager.edit_shortcuts.set_shortcut(\"shift-enter\", \"RISE:smart-exec\");\n      // Save the f keyboard event for the Reveal fullscreen action\n      // see also #375\n      // reveal.js and chalkboard key bindings\n      // console.log(`complete_config in setupKeys: ${JSON.stringify(complete_config)}`);\n      \n      // add all reveal.js bindings to jupyter\n      for (const module of Object.keys(reveal_bindings)){\n        for (const action of Object.keys(reveal_bindings[module])){\n          key_str = reveal_bindings[module][action];\n          Jupyter.keyboard_manager.command_shortcuts.set_shortcut(key_str, `RISE:${action}`);\n          // console.log(`Setup jupyter keybinding: ${key_str}, RISE:${action}.`);\n        }\n      }\n      try {\n        Jupyter.keyboard_manager.command_shortcuts.remove_shortcut(\"f\");\n        Jupyter.keyboard_manager.command_shortcuts.set_shortcut(\"shift-f\", \"jupyter-notebook:find-and-replace\");\n      } catch(error) {\n        console.log(`entering RISE : could not remove shortcut 'f' - ignored`);\n      }\n    } else if (mode === 'notebook_mode') {\n      Jupyter.keyboard_manager.command_shortcuts.set_shortcut(\"shift-enter\", \"jupyter-notebook:run-cell-and-select-next\");\n      Jupyter.keyboard_manager.edit_shortcuts.set_shortcut(\"shift-enter\", \"jupyter-notebook:run-cell-and-select-next\");\n      try {      \n        Jupyter.keyboard_manager.command_shortcuts.remove_shortcut(\"shift-f\");\n        Jupyter.keyboard_manager.command_shortcuts.set_shortcut(\"f\", \"jupyter-notebook:find-and-replace\");\n      } catch(error) {\n        console.log(`exiting RISE : could not remove shortcut 'shift-f' - ignored`);\n      }\n    }\n  }\n\n  /*\n   * Creates a string of the valid shortcuts (i.e. the ones for which a key \n   * code could be identified). If no key code could be identified the keys are\n   * still mapped to the default key code values (a string provided by\n   * the default_str argument will be used instead).\n   */\n  function shortcutRepr(shortcuts){\n    \n    let key_str = \"\";\n    let first_entry = true;\n    \n    if (shortcuts.length > 0){\n      for (const key of shortcuts.split(\",\")){\n        if (!first_entry){\n          key_str += \",<kbd>\" + key + \"</kbd>\";\n          \n        } else {\n          key_str += \"<kbd>\" + key + \"</kbd>\";\n          first_entry = false;\n        }\n      }\n    } else {\n      key_str += \"<kbd>\" + default_str + \"</kbd>\";\n    }\n    return key_str;\n  }\n\n  \n  /*\n   * Creates a list item string for help dialog\n   * \n   * Args:\n   * shortcut_str = string representation of keyboard shortcut(s)\n   * default_str = default (fall back) string for key\n   * help_str = help text to be shown for item\n   */\n  function helpListItem(shortcut_str, help_str){\n    return `<li>${shortcutRepr(shortcut_str)} : ${help_str}</li>`;\n  }\n  \n  function riseHelp() {\n    let jupyter_keys;\n    let reveal_keys;\n    let cb_keys;\n    let no_keys;\n    \n    //check if custom bindings for registered jupyter calls are defined\n    if (typeof complete_config.shortcuts !== 'undefined'){\n      jupyter_keys = complete_config.shortcuts;\n    }\n    else{\n      jupyter_keys = {};\n    }\n\n    let updated_keybindings = updateRevealBindings(reveal_default_bindings);\n    \n    //console.log(`updated bindings: ${JSON.stringify(updated_keybindings)}`);\n    \n    reveal_keys = updated_keybindings['main'];\n    cb_keys = updated_keybindings['chalkboard'];\n    no_keys = updated_keybindings['notes'];\n    let reveal_help = reveal_helpstr['main'];\n    let cb_help = reveal_helpstr['chalkboard'];\n    let no_help= reveal_helpstr['notes'];\n    \n    let message = $('<div/>').append(\n      $(\"<p/></p>\").addClass('dialog').html(\n        \"<ul>\" +\n          helpListItem(reveal_keys.riseHelp, reveal_help.riseHelp) +\n          \"<li><kbd>Alt</kbd>+<kbd>r</kbd>: enter/exit RISE</li>\" +\n          \"<li><kbd>Space</kbd>: next</li>\" +\n          \"<li><kbd>Shift</kbd>+<kbd>Space</kbd>: previous</li>\" +\n          \"<li><kbd>Shift</kbd>+<kbd>Enter</kbd>: eval and select next cell if visible</li>\" +\n          helpListItem(reveal_keys.firstSlide, reveal_help.firstSlide) +\n          helpListItem(reveal_keys.lastSlide, reveal_help.lastSlide) +\n          helpListItem(reveal_keys.toggleOverview, reveal_help.toggleOverview) +\n          helpListItem(no_keys.openNotes, no_help.openNotes) +\n          `<li><kbd>,</kbd>: ${reveal_help.toggleAllRiseButtons}</li>` +\n          \"<li><kbd>/</kbd>: black screen</li>\" +\n          \"<li><strong>less useful:</strong>\" +\n          \"<ul>\" +\n          \"<li><kbd>PgUp</kbd>: up</li>\" +\n          \"<li><kbd>PgDn</kbd>: down</li>\" +\n          \"<li><kbd>Left Arrow</kbd>: left <em>(note: Space preferred)</em></li>\" +\n          \"<li><kbd>Right Arrow</kbd>: right <em>(note: Shift Space preferred)</em></li>\" +\n          \"</ul>\" +\n          \"<li><strong>with chalkboard enabled:</strong>\" +\n          \"<ul>\" +\n          helpListItem(cb_keys.toggleChalkboard, cb_help.toggleChalkboard) +\n          helpListItem(cb_keys.toggleNotesCanvas, cb_help.toggleNotesCanvaas) +\n          helpListItem(cb_keys.colorNext, cb_help.colorNext) +\n          helpListItem(cb_keys.colorPrev, cb_help.colorPrev) +\n          helpListItem(cb_keys.download, cb_help.download) +\n          helpListItem(cb_keys.reset, cb_help.reset) +\n          helpListItem(cb_keys.clear, cb_help.clear) +\n          \"</ul>\" +\n          \"</ul>\" +\n          \"<b>NOTE</b>: of course you have to use these shortcuts <b>in command mode.</b>\"\n      )\n    );\n\n    dialog.modal({\n      title : \"Reveal Shortcuts Help\",\n      body : message,\n      buttons : {\n        OK : {class: \"btn-danger\"}\n      }\n    });\n  }\n\n  function buttonHelp() {\n    let help_button = $('<i/>')\n        .attr('id','help_b')\n        .attr('title','Reveal Shortcuts Help')\n        .addClass('fa-question fa-4x fa')\n        .addClass('my-main-tool-bar')\n        .click(riseHelp);\n    $('.reveal').after(help_button);\n  }\n\n  function buttonExit() {\n    let exit_button = $('<i/>')\n        .attr('id','exit_b')\n        .attr('title','Exit RISE')\n        .addClass('fa-times-circle fa-4x fa')\n        .addClass('my-main-tool-bar')\n        .click(revealMode);\n    $('.reveal').after(exit_button);\n  }\n\n  function fullscreenHelp() {\n    let message = $('<div/>').append(\n      $(\"<p/></p>\").addClass('dialog').html(\n        \"<b>Entering Fullscreen mode from inside RISE is disabled.</b>\" +\n          \"<br>\" +\n          \"<b>Exit RISE, make you browser Fullscreen and re-enter RISE</b>\" +\n          \"<br>\" +\n          \"That will help Reveal.js to perform the correct transformations \" +\n          \"at the time to interact with code cells.\"\n      )\n    );\n\n    dialog.modal({\n      title : \"Fullscreen Help\",\n      body : message,\n      buttons : {\n        OK : {class: \"btn-danger\"}\n      }\n    });\n\n  }\n\n  function removeHash() {\n    history.pushState(\"\", document.title, window.location.pathname\n                      + window.location.search);\n  }\n\n  function Remover() {\n    Reveal.configure({minScale: 1.0});\n    Reveal.removeEventListeners();\n    $('body').removeClass(\"rise-enabled\");\n    let theme = complete_config.theme;\n    $('body').removeClass(`theme-${theme}`);\n    $('div#header').show();\n\n    $('div#notebook').removeClass(\"reveal\");\n    // woekaround to fix fade class conflicting between notebook and reveal css...\n    if ($('div#notebook').hasClass('fade')) { $('div#notebook').removeClass(\"fade\"); };\n    $('div#notebook-container').removeClass(\"slides\");\n    $('div#notebook-container').css('width','');\n    $('div#notebook-container').css('height','');\n    $('div#notebook-container').css('zoom','');\n\n    $('#theme').remove();\n    $('#revealcss').remove();\n    $('#rise-custom-css').remove();\n    $('#rise-notebook-css').remove();\n\n    $('.backgrounds').hide();\n    $('.progress').hide();\n    $('.controls').hide();\n    $('.slide-number').hide();\n    $('.speaker-notes').hide();\n    $('.pause-overlay').hide();\n    $('div#aria-status-div').hide();\n\n    let cells = Jupyter.notebook.get_cells();\n    for(let i in cells){\n      $('.cell:nth('+i+')').removeClass('reveal-skip');\n      $('div#notebook-container').append(cells[i].element);\n    }\n\n    $('div#notebook-container').children('section').remove();\n    $('.end_space').show();\n\n    disconnectOutputObserver();\n    removeHash();\n    removeHeaderFooterOverlay();\n  }\n\n  /*\n    using Reveal.getCurrentSlide() it is possible to get a lot of data\n    about where we are in the slideshow\n\n    the following function inspects this and returns a triple\n    [slide, subslide, fragments]\n\n    slide and subslide both start at 0 (1st slide numbered 0)\n\n    fragments is the number of <fragments> tags currently showed\n    that is to say, **in addition** to the slide beginning\n    note that a jupyter cell cannot be a slide *and* a fragment at the same time\n    the first slide however may be different as the first cell may be a fragment\n    which I chose not to support for now\n    bottom line: is fragments also starts at 0\n\n    ---------- historical note\n\n    in a previous implementation - for traditional notebooks -\n    we used to get slide and subslide from window.location.href\n    however this in jupyter lab may be no longer possible\n\n    in addition this is the way to go for getting info on the current fragment\n  */\n  function reveal_current_position() {\n    let current_slide = Reveal.getCurrentSlide();\n    // href of the form slide-2-3\n    let href = current_slide.id;\n    let chunks = href.split('-');\n    let slide = Number(chunks[1]);\n    let subslide = Number(chunks[2]);\n    let fragments = $(current_slide).find('div.fragment.visible').length;\n    return [slide, subslide, fragments];\n  }\n\n\n  /* Just before exiting reveal mode, we run this function\n   * whose job is to find the notebook index\n   * for the first cell in the current (sub)slide\n   * this allows to restore the notebook at the correct location,\n   * i.e. with that cell being selected\n   *\n   * if cell_type is not set, returns the first cell in slide\n   * otherwise, it returns the first cell of that type in slide\n   *\n   * if auto_select_fragment is set to true, search is restricted to the current fragment\n   * otherwise, the whole slide is considered\n   *\n   * returns null if no match is found\n   */\n  function reveal_cell_index(notebook, cell_type=null, auto_select_fragment=false) {\n    /* scan all cells until we find one that matches current reveal location\n     * need to deal carefully with beginning of that process because\n     * (.) we do not impose a starting 'slide', and\n     * (.) the first cell(s) might be of type 'skip'\n     *     which then must not be counted\n     */\n    let [slide, subslide, fragment] = reveal_current_position();\n\n    // start at slide -1 because we don't impose a starting 'slide'\n    let [slide_counter, subslide_counter, fragment_counter] = [-1, 0, 0];\n    let result = null;\n\n    let cells = notebook.get_cells();\n    for (let index in cells) {\n      let cell = cells[index];\n      // ignore skip cells no matter what\n      if (is_skip(cell) || is_notes(cell))\n        continue;\n      // a slide always increments, even at the start, since we begin at -1\n      if (is_slide(cell)) {\n        slide_counter += 1;\n        subslide_counter = 0;\n      }\n      // if we see anything else then we're on a visible slide\n      // that has to be at least 0\n      slide_counter = Math.max(slide_counter, 0);\n      if (is_subslide(cell)) {\n        subslide_counter += 1;\n      }\n\n      if ((slide_counter == slide) && (subslide_counter == subslide)) {\n        // keep count of fragments but only on current slide\n        if (is_fragment(cell)) {\n          fragment_counter += 1;\n        }\n        /* we're on the right slide\n         * now: do we need to also worry about focusing on the right fragment ?\n         * if auto_select_fragment is true, we only consider cells in the fragment\n         * otherwise, the whole (sub)slide is considered valid\n         */\n        let fragment_match = (auto_select_fragment) ? (fragment_counter == fragment) : true;\n        // we still need to match cell types\n        if ( fragment_match &&\n\t     ((cell_type === null) || (cell.cell_type == cell_type))) {\n\t  return index;\n        }\n      }\n    }\n    // for consistency with previous implementations\n    return null;\n  }\n\n  function registerJupyterActions() {\n\n    // accessing Jupyter.actions directly results in a warning message\n    // https://github.com/jupyter/notebook/issues/2401\n    let actions = Jupyter.notebook.keyboard_manager.actions;\n\n    // register main action\n    actions.register(\n      {help:    \"Enter/Exit RISE Slideshow\",\n       handler: revealMode},\n      \"slideshow\", \"RISE\");\n\n    actions.register(\n      {help:    \"execute cell, and move to the next if on the same slide\",\n       handler: smartExec},\n      \"smart-exec\", \"RISE\");\n\n    // helpers for toggling slide_type\n    function init_metadata_slideshow(optional_cell) {\n      // use selected cell if not specified\n      let cell = optional_cell || Jupyter.notebook.get_selected_cell();\n      let metadata = cell.metadata;\n      if (metadata.slideshow === undefined)\n        metadata.slideshow = {};\n      return metadata.slideshow;\n    }\n\n    // new_type can be any of 'slide' 'subslide' 'fragment' 'notes' 'skip'\n    function toggle_slide_type(new_type) {\n      let slideshow = init_metadata_slideshow();\n      slideshow.slide_type = (slideshow.slide_type == new_type) ? '' : new_type;\n      Jupyter.CellToolbar.rebuild_all();\n    }\n\n    actions.register(\n      {help   : '(un)set current cell as a Slide cell',\n       handler: () => toggle_slide_type('slide')},\n      \"toggle-slide\", \"RISE\");\n\n    actions.register(\n      {help   : '(un)set current cell as a Sub-slide cell',\n       handler: () => toggle_slide_type('subslide')},\n      \"toggle-subslide\", \"RISE\");\n\n    actions.register(\n      {help   : '(un)set current cell as a Fragment cell',\n       handler: () => toggle_slide_type('fragment')},\n      \"toggle-fragment\", \"RISE\");\n\n    actions.register(\n      {help   : '(un)set current cell as a Note cell',\n       handler: () => toggle_slide_type('notes')},\n      \"toggle-notes\", \"RISE\");\n\n    actions.register(\n      {help   : '(un)set current cell as a Skip cell',\n       handler: () => toggle_slide_type('skip')},\n      \"toggle-skip\", \"RISE\");\n\n\n    actions.register(\n      {help   : 'render all cells (all cells go to command mode)',\n       handler: () => Jupyter.notebook.get_cells().forEach(\n         cell => cell.render())},\n      \"render-all-cells\", \"RISE\");\n\n    actions.register(\n      {help   : 'edit all cells (all cells go to edit mode)',\n       handler: () => Jupyter.notebook.get_cells().forEach(\n         cell => cell.unrender())},\n      \"edit-all-cells\", \"RISE\");\n\n    // because the `Edit Keyboard Shortcuts` utility does not mention the\n    // actions prefix (i.e. 'RISE' in our case), we choose to make these two\n    // action names start with `rise-` even if it's a bit redundant.\n\n    // define an action that goes to the nbconfigurator page for rise\n    let nbconfigurator = function() {\n      let url = \"/nbextensions/?nbextension=rise/main\";\n      window.open(url, '_blank');\n    }\n\n    actions.register(\n      {help: 'open the nbconfigurator page for RISE',\n       handler: nbconfigurator},\n      \"rise-nbconfigurator\", \"RISE\");\n\n    // mostly for debug / information\n    actions.register(\n      {help   : 'output RISE configuration in console, for debugging mostly',\n       handler: showConfig},\n      \"rise-dump-config\", \"RISE\");\n    \n    let reveal_bindings = updateRevealBindings(reveal_default_bindings);\n    // register all reveal.js actions for keyboard bindings\n    for (const module of Object.keys(reveal_bindings)){\n      for (const action of Object.keys(reveal_bindings[module])){\n        let api_call = reveal_actions[module][action];\n        actions.register({\n          help: reveal_helpstr[module][action], \n          handler: api_call},\n          action, \"RISE\");\n        // console.log(`Registered jupyter action \\\"${action}\\\" to API call: ${api_call}`);\n      }\n    }\n    \n  }\n\n\n  // the entrypoint - call this to enter or exit reveal mode\n  function revealMode() {\n    // [Basthon]\n     // load css first\n    import(\"./main.css\");\n    // hide/show ribbon and help to not disturb RISE controls.\n    $(\"#ribbon\").toggle();\n    $(\"#life-ring\").toggle();\n\n    // We search for a class tag in the maintoolbar to check if reveal mode is \"on\".\n    // If the tag exits, we exit. Otherwise, we enter the reveal mode.\n    let tag = $('#maintoolbar').hasClass('reveal_tagging');\n\n    if (!tag) {\n      // Preparing the new reveal-compatible structure\n      let selected_slide = markupSlides($('div#notebook-container'));\n      // Adding the reveal stuff\n      Revealer(selected_slide);\n      // Minor modifications for usability\n      setupKeys(\"reveal_mode\");\n      buttonExit();\n      buttonHelp();\n      $('#maintoolbar').addClass('reveal_tagging');\n    } else {\n      let current_cell_index =\n          // first use current selection if relevant\n          Jupyter.notebook.get_selected_index()\n      // resort to first cell in visible slide otherwise\n          || reveal_cell_index(Jupyter.notebook);\n      Remover();\n      setupKeys(\"notebook_mode\");\n      $('#exit_b').remove();\n      $('#help_b').remove();\n      $('#maintoolbar').removeClass('reveal_tagging');\n      // Workaround... should be a better solution. Need to investigate codemirror\n      fixCellHeight();\n      //[basthon]\n      // this class interfer with our CSS theme\n      $('.reveal-viewport').removeClass('reveal-viewport');\n      // select and focus on current cell\n      Jupyter.notebook.select(current_cell_index);\n      // Need to delay the action a little bit so it actually focus the selected slide\n      setTimeout(() => Jupyter.notebook.get_selected_cell().ensure_focused(),\n                 complete_config.restore_timeout);\n    }\n  }\n\n  function autoSelectHook() {\n    let auto_select = complete_config.auto_select;\n    let cell_type =\n        (auto_select == \"code\") ? 'code'\n\t: (auto_select == \"first\") ? null\n\t: undefined;\n\n    /* turned off altogether */\n    if (cell_type === undefined) {\n      return;\n    }\n\n    let auto_select_fragment = complete_config.auto_select_fragment;\n    setTimeout(function(){\n      let current_cell_index = reveal_cell_index(\n        Jupyter.notebook, cell_type, auto_select_fragment);\n      // select and focus on current cell\n      if (current_cell_index)\n        Jupyter.notebook.select(current_cell_index);\n    }, complete_config.auto_select_timeout);\n  }\n\n  function addButtonsAndShortcuts() {\n\n    // create button\n    Jupyter.toolbar.add_buttons_group([{\n      action  : \"RISE:slideshow\",\n      icon    : complete_config.toolbar_icon,\n      id      : 'RISE',\n    }]);\n\n    //////// bind to keyboard shortcut\n    let shortcuts = complete_config.shortcuts;\n    for (let action_name in complete_config.shortcuts) {\n      let shortcut = shortcuts[action_name];\n      // ignore if shortcut is set to an empty string\n      if (shortcut) {\n        // console.log(`RISE: adding shortcut ${shortcut} for RISE:${action_name}`);\n        Jupyter.notebook.keyboard_manager.command_shortcuts.add_shortcut(\n          shortcut, `RISE:${action_name}`);\n      }\n    }\n  }\n\n  function showConfig() {\n    console.log(\"RISE configuration\", complete_config);\n    console.log(`Current notebook ${is_slideshow(Jupyter.notebook) ? \"is\" : \"not\"} a slideshow`);\n  }\n\n\n  /* load_jupyter_extension */\n  function setup() {\n    configLoaded()\n    //      .then(showConfig)\n      .then(registerJupyterActions)\n      .then(addButtonsAndShortcuts)\n      .then(autoLaunch)\n    ;\n\n  }\n\n  setup.load_ipython_extension = setup;\n  setup.load_jupyter_extension = setup;\n\n  return setup;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\ndefine([\n    'jquery',\n    'base/js/dialog',\n    'base/js/i18n',\n    'underscore',\n    'base/js/namespace'\n], function ($, dialog, i18n, _, IPython) {\n    'use strict';\n    $('#notebook_about').click(function () {\n        const sys_info = window.sys_info;\n        let textNb = \"Vous utilisez le Notebook de <b>Basthon</b>\";\n        textNb += \"<br>\";\n        textNb += `Identifiant de commit : <code>${sys_info['commit-hash']}</code>`;\n        textNb += \"<br>\";\n        textNb += `Date du commit : <code>${sys_info['commit-date']}</code>`;\n        let textKernel = \"Vous utilisez le noyau <b>Basthon</b>\";\n        textKernel += \"<br>\";\n        textKernel += `Langage du noyau : <code>${window.basthonLanguage}</code>`;\n        textKernel += \"<br>\";\n        textKernel += `Version du noyau : <code>${sys_info['kernel-version']}</code>`;\n        var body = $('<div/>');\n        body.append($('<h4/>').text(i18n.msg._('Current Notebook Information:')));\n        body.append($('<p/>').html(textNb));\n        body.append($('<h4/>').text(i18n.msg._('Current Kernel Information:')));\n        body.append($('<p/>').html(textKernel));\n        //[Basthon]\n        /*\n        // use underscore template to auto html escape\n        if (sys_info) {\n          var text = i18n.msg._('You are using Jupyter notebook.');\n          text = text + '<br/><br/>';\n          text = text + i18n.msg._('The version of the notebook server is: ');\n          text = text + _.template('<b><%- version %></b>')({ version: sys_info.notebook_version });\n          if (sys_info.commit_hash) {\n              text = text + _.template('-<%- hash %>')({ hash: sys_info.commit_hash });\n          }\n         text = text + '<br/>';\n         text = text + i18n.msg._('The server is running on this version of Python:');\n          text = text + _.template('<br/><pre>Python <%- pyver %></pre>')({ \n            pyver: sys_info.sys_version });\n          var kinfo = $('<div/>').attr('id', '#about-kinfo').text(i18n.msg._('Waiting for kernel to be available...'));\n          var body = $('<div/>');\n          body.append($('<h4/>').text(i18n.msg._('Server Information:')));\n          body.append($('<p/>').html(text));\n          body.append($('<h4/>').text(i18n.msg._('Current Kernel Information:')));\n          body.append(kinfo);\n        } else {\n          var text = i18n.msg._('Could not access sys_info variable for version information.');\n          var body = $('<div/>');\n          body.append($('<h4/>').text(i18n.msg._('Cannot find sys_info!')));\n          body.append($('<p/>').html(text));\n        }\n        */\n        dialog.modal({\n            title: i18n.msg._('About Jupyter Notebook'),\n            body: body,\n            buttons: { 'OK': {} }\n        });\n        //[Basthon]\n        /*\n        try {\n            IPython.notebook.session.kernel.kernel_info(function (data) {\n                kinfo.html($('<pre/>').text(data.content.banner));\n            });\n        } catch (e) {\n            kinfo.html($('<p/>').text(i18n.msg._('unable to contact kernel')));\n        }\n        */\n    });\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// How to pick action names:\n//\n// * First pick a noun and a verb for the action. For example, if the action is \"restart kernel,\" the verb is\n//   \"restart\" and the noun is \"kernel\".\n// * Omit terms like \"selected\" and \"active\" by default, so \"delete-cell\", rather than \"delete-selected-cell\".\n//   Only provide a scope like \"-all-\" if it is other than the default \"selected\" or \"active\" scope.\n// * If an action has a secondary action, separate the secondary action with \"-and-\", so\n//   \"restart-kernel-and-clear-output\".\n// * Don't ever use before/after as they have a temporal connotation that is confusing when used in a spatial\n//   context.\n// * Use above/below or previous/next to indicate spacial and sequential relationships.\n// * For dialogs, use a verb that indicates what the dialog will accomplish, such as \"confirm-restart-kernel\".\n\n\ndefine([\n    'jquery',\n    'base/js/events',\n    'base/js/i18n',\n], function($, events, i18n){\n    \"use strict\";\n\n    var warn_bad_name = function(name){\n        if(name !== \"\" && !name.match(/:/)){\n            console.warn('You are trying to use an action/command name, where the separator between prefix and name is not `:`\\n'+\n                         '\"'+name+'\"\\n'+\n                         'You are likely to not use the API in a correct way. Typically use the following:\\n'+\n                         '`var key = actions.register(<object>, \"<name>\", \"<prefix>\");` and reuse the `key` variable'+\n                         'instead of re-generating the key yourself.'\n                    );\n        }\n    };\n\n    var ActionHandler = function (env) {\n        this.env = env || {};\n        Object.seal(this);\n    };\n\n    /**\n     *  A bunch of predefined `Simple Actions` used by Jupyter.\n     *  `Simple Actions` have the following keys:\n     *  help (optional): a short string the describe the action.\n     *      will be used in various context, like as menu name, tool tips on buttons,\n     *      and short description in help menu.\n     *  help_index (optional): a string used to sort action in help menu.\n     *  icon (optional): a short string that represent the icon that have to be used with this\n     *  action. this should mainly correspond to a Font_awesome class.\n     *  handler : a function which is called when the action is activated. It will receive at first parameter\n     *      a dictionary containing various handle to element of the notebook.\n     *\n     *  action need to be registered with a **name** that can be use to refer to this action.\n     *\n     *  if `help` is not provided it will be derived by replacing any dash by space\n     *  in the **name** of the action. It is advised to provide a prefix to action name to\n     *  avoid conflict the prefix should be all lowercase and end with a dot `.`\n     *  in the absence of a prefix the behavior of the action is undefined.\n     *\n     *  All action provided by the Jupyter notebook are prefixed with `jupyter-notebook:`.\n     *\n     *  One can register extra actions or replace an existing action with another one is possible\n     *  but is considered undefined behavior.\n     *\n     **/\n    var _actions = {\n        'toggle-rtl-layout': {\n            cmd: i18n.msg._('toggle rtl layout'),\n            help: i18n.msg._('Toggle the screen directionality between left-to-right and right-to-left'),\n            handler: function () {\n              (document.body.getAttribute('dir')=='rtl') ? document.body.setAttribute('dir','ltr') : document.body.setAttribute('dir','rtl');\n            }\n        },\n        'edit-command-mode-keyboard-shortcuts': {\n            cmd: i18n.msg._('edit command mode keyboard shortcuts'),\n            help: i18n.msg._('Open a dialog to edit the command mode keyboard shortcuts'),\n            handler: function (env) {\n                env.notebook.show_shortcuts_editor();\n            }\n        },\n        'shutdown-kernel': {\n            help: 'Shutdown the kernel (no confirmation dialog)',\n            handler: function (env) {\n                env.notebook.shutdown_kernel({confirm: false});\n            }\n        },\n        'confirm-shutdown-kernel':{\n            icon: 'fa-repeat',\n            help_index : 'hb',\n            help: 'Shutdown the kernel (with confirmation dialog)',\n            handler : function (env) {\n                env.notebook.shutdown_kernel();\n            }\n        },\n        'restart-kernel': {\n            cmd: i18n.msg._('restart kernel'),\n            help: i18n.msg._('restart the kernel (no confirmation dialog)'),\n            handler: function (env) {\n                env.notebook.restart_kernel({confirm: false});\n            },\n        },\n        'confirm-restart-kernel':{\n            icon: 'fa-repeat',\n            help_index : 'hb',\n            cmd: i18n.msg._('confirm restart kernel'),\n            help: i18n.msg._('restart the kernel (with dialog)'),\n            handler : function (env) {\n                env.notebook.restart_kernel();\n            }\n        },\n        'restart-kernel-and-run-all-cells': {\n            cmd: i18n.msg._('restart kernel and run all cells'),\n            help: i18n.msg._('restart the kernel, then re-run the whole notebook (no confirmation dialog)'),\n            handler: function (env) {\n                env.notebook.restart_run_all({confirm: false});\n            }\n        },\n        'confirm-restart-kernel-and-run-all-cells': {\n            icon: 'fa-forward',\n            cmd: i18n.msg._('confirm restart kernel and run all cells'),\n            help: i18n.msg._('restart the kernel, then re-run the whole notebook (with dialog)'),\n            handler: function (env) {\n                env.notebook.restart_run_all();\n            }\n        },\n        'restart-kernel-and-clear-output': {\n            cmd: i18n.msg._('restart kernel and clear output'),\n            help: i18n.msg._('restart the kernel and clear all output (no confirmation dialog)'),\n            handler: function (env) {\n                env.notebook.restart_clear_output({confirm: false});\n            }\n        },\n        'confirm-restart-kernel-and-clear-output': {\n            cmd: i18n.msg._('confirm restart kernel and clear output'),\n            help: i18n.msg._('restart the kernel and clear all output (with dialog)'),\n            handler: function (env) {\n                env.notebook.restart_clear_output();\n            }\n        },\n        'interrupt-kernel':{\n            icon: 'fa-stop',\n            cmd: i18n.msg._('interrupt the kernel'),\n            help: i18n.msg._('interrupt the kernel'),\n            help_index : 'ha',\n            handler : function (env) {\n                env.notebook.kernel.interrupt();\n            }\n        },\n        'run-cell-and-select-next': {\n            cmd: i18n.msg._('run cell and select next'),\n            icon: 'fa-step-forward',\n            help: i18n.msg._('run cell, select below'),\n            help_index : 'ba',\n            handler : function (env) {\n                env.notebook.execute_cell_and_select_below();\n            }\n        },\n        'run-cell':{\n            cmd: i18n.msg._('run selected cells'),\n            help    : i18n.msg._('run selected cells'),\n            help_index : 'bb',\n            handler : function (env) {\n                env.notebook.execute_selected_cells();\n            }\n        },\n        'run-cell-and-insert-below':{\n            cmd: i18n.msg._('run cell and insert below'),\n            help    : i18n.msg._('run cell and insert below'),\n            help_index : 'bc',\n            handler : function (env) {\n                env.notebook.execute_cell_and_insert_below();\n            }\n        },\n        'run-all-cells': {\n            cmd: i18n.msg._('run all cells'),\n            help: i18n.msg._('run all cells'),\n            help_index: 'bd',\n            handler: function (env) {\n                env.notebook.execute_all_cells();\n            }\n        },\n        'run-all-cells-above':{\n            cmd: i18n.msg._('run all cells above'),\n            help: i18n.msg._('run all cells above'),\n            handler : function (env) {\n                env.notebook.execute_cells_above();\n            }\n        },\n        'run-all-cells-below':{\n            cmd: i18n.msg._('run all cells below'),\n            help: i18n.msg._('run all cells below'),\n            handler : function (env) {\n                env.notebook.execute_cells_below();\n            }\n        },\n        'enter-command-mode': {\n            cmd: i18n.msg._('enter command mode'),\n            help    : i18n.msg._('enter command mode'),\n            help_index : 'aa',\n            handler : function (env) {\n                env.notebook.command_mode();\n            }\n        },\n        'insert-image': {\n            cmd: i18n.msg._('insert image'),\n            help      : i18n.msg._('insert image'),\n            help_index : 'dz',\n            handler : function (env) {\n                env.notebook.insert_image();\n            }\n        },\n        'cut-cell-attachments': {\n            cmd: i18n.msg._('cut cell attachments'),\n            help    : i18n.msg._('cut cell attachments'),\n            help_index : 'dza',\n            handler: function (env) {\n                env.notebook.cut_cell_attachments();\n            }\n        },\n        'copy-cell-attachments': {\n            cmd: i18n.msg._('copy cell attachments'),\n            help    : i18n.msg._('copy cell attachments'),\n            help_index: 'dzb',\n            handler: function (env) {\n                env.notebook.copy_cell_attachments();\n            }\n        },\n        'paste-cell-attachments': {\n            cmd: i18n.msg._('paste cell attachments'),\n            help    : i18n.msg._('paste cell attachments'),\n            help_index: 'dzc',\n            handler: function (env) {\n                env.notebook.paste_cell_attachments();\n            }\n        },\n        'split-cell-at-cursor': {\n            cmd: i18n.msg._('split cell at cursor'),\n            help    : i18n.msg._('split cell at cursor'),\n            help_index : 'ea',\n            handler : function (env) {\n                env.notebook.split_cell();\n            }\n        },\n        'enter-edit-mode' : {\n            cmd: i18n.msg._('enter edit mode'),\n            help : i18n.msg._('enter edit mode'),\n            help_index : 'aa',\n            handler : function (env) {\n                env.notebook.edit_mode();\n            }\n        },\n        'select-previous-cell' : {\n            cmd: i18n.msg._('select previous cell'),\n            help: i18n.msg._('select cell above'),\n            help_index : 'da',\n            handler : function (env) {\n                var index = env.notebook.get_selected_index();\n                if (index !== 0 && index !== null) {\n                    env.notebook.select_prev(true);\n                    env.notebook.focus_cell();\n                }\n            }\n        },\n        'select-next-cell' : {\n            cmd: i18n.msg._('select next cell'),\n            help: i18n.msg._('select cell below'),\n            help_index : 'db',\n            handler : function (env) {\n                var index = env.notebook.get_selected_index();\n                if (index !== (env.notebook.ncells()-1) && index !== null) {\n                    env.notebook.select_next(true);\n                    env.notebook.focus_cell();\n                }\n            }\n        },\n        'extend-selection-above' : {\n            cmd: i18n.msg._('extend selection above'),\n            help: i18n.msg._('extend selected cells above'),\n            help_index : 'dc',\n            handler : function (env) {\n                env.notebook.extend_selection_by(-1);\n                // scroll into view,\n                // do not call notebook.focus_cell(), or\n                // all the selection get thrown away\n                env.notebook.get_selected_cell().element.focus();\n            }\n        },\n        'extend-selection-below' : {\n            cmd: i18n.msg._('extend selection below'),\n            help: i18n.msg._('extend selected cells below'),\n            help_index : 'dd',\n            handler : function (env) {\n                env.notebook.extend_selection_by(1);\n                // scroll into view,\n                // do not call notebook.focus_cell(), or\n                // all the selection get thrown away\n                env.notebook.get_selected_cell().element.focus();\n            }\n        },\n        'select-all' : {\n            cmd: i18n.msg._('select all'),\n            help: i18n.msg._('select all cells'),\n            help_index : 'de',\n            handler : function (env) {\n                env.notebook.select_all();\n                env.notebook.get_selected_cell().element.focus();\n            }\n        },\n        'cut-cell' : {\n            cmd: i18n.msg._('cut selected cells'),\n            help: i18n.msg._('cut selected cells'),\n            icon: 'fa-cut',\n            help_index : 'ee',\n            handler : function (env) {\n                var index = env.notebook.get_selected_index();\n                env.notebook.cut_cell();\n                env.notebook.select(index);\n            }\n        },\n        'copy-cell' : {\n            cmd: i18n.msg._('copy selected cells'),\n            help: i18n.msg._('copy selected cells'),\n            icon: 'fa-copy',\n            help_index : 'ef',\n            handler : function (env) {\n                env.notebook.copy_cell();\n            }\n        },\n        'paste-cell-replace' : {\n            help: 'paste cells replace',\n            handler : function (env) {\n                env.notebook.paste_cell_replace();\n            }\n        },\n        'paste-cell-above' : {\n            cmd: i18n.msg._('paste cells above'),\n            help: i18n.msg._('paste cells above'),\n            help_index : 'eg',\n            handler : function (env) {\n                env.notebook.paste_cell_above();\n            }\n        },\n        'paste-cell-below' : {\n            cmd: i18n.msg._('paste cells below'),\n            help: i18n.msg._('paste cells below'),\n            icon: 'fa-paste',\n            help_index : 'eh',\n            handler : function (env) {\n                env.notebook.paste_cell_below();\n            }\n        },\n        'insert-cell-above' : {\n            cmd: i18n.msg._('insert cell above'),\n            help: i18n.msg._('insert cell above'),\n            help_index : 'ec',\n            handler : function (env) {\n                env.notebook.insert_cell_above();\n                env.notebook.select_prev(true);\n                env.notebook.focus_cell();\n            }\n        },\n        'insert-cell-below' : {\n            cmd: i18n.msg._('insert cell below'),\n            help: i18n.msg._('insert cell below'),\n            icon : 'fa-plus',\n            help_index : 'ed',\n            handler : function (env) {\n                env.notebook.insert_cell_below();\n                env.notebook.select_next(true);\n                env.notebook.focus_cell();\n            }\n        },\n        'change-cell-to-code' : {\n            cmd: i18n.msg._('change cell to code'),\n            help    : i18n.msg._('change cell to code'),\n            help_index : 'ca',\n            handler : function (env) {\n                env.notebook.cells_to_code();\n            }\n        },\n        'change-cell-to-markdown' : {\n            cmd: i18n.msg._('change cell to markdown'),\n            help    : i18n.msg._('change cell to markdown'),\n            help_index : 'cb',\n            handler : function (env) {\n                env.notebook.cells_to_markdown();\n            }\n        },\n        'change-cell-to-raw' : {\n            cmd: i18n.msg._('change cell to raw'),\n            help    : i18n.msg._('change cell to raw'),\n            help_index : 'cc',\n            handler : function (env) {\n                env.notebook.cells_to_raw();\n            }\n        },\n        'change-cell-to-heading-1' : {\n            cmd: i18n.msg._('change cell to heading 1'),\n            help    : i18n.msg._('change cell to heading 1'),\n            help_index : 'cd',\n            handler : function (env) {\n                env.notebook.to_heading(undefined, 1);\n            }\n        },\n        'change-cell-to-heading-2' : {\n            cmd: i18n.msg._('change cell to heading 2'),\n            help    : i18n.msg._('change cell to heading 2'),\n            help_index : 'ce',\n            handler : function (env) {\n                env.notebook.to_heading(undefined, 2);\n            }\n        },\n        'change-cell-to-heading-3' : {\n            cmd: i18n.msg._('change cell to heading 3'),\n            help    : i18n.msg._('change cell to heading 3'),\n            help_index : 'cf',\n            handler : function (env) {\n                env.notebook.to_heading(undefined, 3);\n            }\n        },\n        'change-cell-to-heading-4' : {\n            cmd: i18n.msg._('change cell to heading 4'),\n            help    : i18n.msg._('change cell to heading 4'),\n            help_index : 'cg',\n            handler : function (env) {\n                env.notebook.to_heading(undefined, 4);\n            }\n        },\n        'change-cell-to-heading-5' : {\n            cmd: i18n.msg._('change cell to heading 5'),\n            help    : i18n.msg._('change cell to heading 5'),\n            help_index : 'ch',\n            handler : function (env) {\n                env.notebook.to_heading(undefined, 5);\n            }\n        },\n        'change-cell-to-heading-6' : {\n            cmd: i18n.msg._('change cell to heading 6'),\n            help    : i18n.msg._('change cell to heading 6'),\n            help_index : 'ci',\n            handler : function (env) {\n                env.notebook.to_heading(undefined, 6);\n            }\n        },\n        'toggle-cell-output-collapsed' : {\n            cmd: i18n.msg._('toggle cell output'),\n            help    : i18n.msg._('toggle output of selected cells'),\n            help_index : 'gb',\n            handler : function (env) {\n                env.notebook.toggle_cells_outputs();\n            }\n        },\n        'toggle-cell-output-scrolled' : {\n            cmd: i18n.msg._('toggle cell scrolling'),\n            help    : i18n.msg._('toggle output scrolling of selected cells'),\n            help_index : 'gc',\n            handler : function (env) {\n                env.notebook.toggle_cells_outputs_scroll();\n            }\n        },\n        'clear-cell-output' : {\n            cmd: i18n.msg._('clear cell output'),\n            help    : i18n.msg._('clear output of selected cells'),\n            handler : function (env) {\n                env.notebook.clear_cells_outputs();\n            }\n        },\n        'move-cell-down' : {\n            cmd: i18n.msg._('move cells down'),\n            help: i18n.msg._('move selected cells down'),\n            icon: 'fa-arrow-down',\n            help_index : 'eb',\n            handler : function (env) {\n                env.notebook.move_cell_down();\n            }\n        },\n        'move-cell-up' : {\n            cmd: i18n.msg._('move cells up'),\n            help: i18n.msg._('move selected cells up'),\n            icon: 'fa-arrow-up',\n            help_index : 'ea',\n            handler : function (env) {\n                env.notebook.move_cell_up();\n            }\n        },\n        'toggle-cell-line-numbers' : {\n            cmd: i18n.msg._('toggle line numbers'),\n            help    : i18n.msg._('toggle line numbers'),\n            help_index : 'ga',\n            handler : function (env) {\n                env.notebook.cell_toggle_line_numbers();\n            }\n        },\n        'show-keyboard-shortcuts' : {\n            cmd: i18n.msg._('show keyboard shortcuts'),\n            help    : i18n.msg._('show keyboard shortcuts'),\n            help_index : 'ge',\n            handler : function (env) {\n                env.quick_help.show_keyboard_shortcuts();\n            }\n        },\n        'delete-cell': {\n            cmd: i18n.msg._('delete cells'),\n            help: i18n.msg._('delete selected cells'),\n            help_index : 'ej',\n            handler : function (env) {\n                env.notebook.delete_cell();\n            }\n        },\n        'undo-cell-deletion' : {\n            cmd: i18n.msg._('undo cell deletion'),\n            help: i18n.msg._('undo cell deletion'),\n            help_index : 'ei',\n            handler : function (env) {\n                env.notebook.undelete_cell();\n            }\n        },\n        // TODO reminder\n        // open an issue, merge with above merge with last cell of notebook if at top.\n        'merge-cell-with-previous-cell' : {\n            cmd: i18n.msg._('merge cell with previous cell'),\n            help    : i18n.msg._('merge cell above'),\n            handler : function (env) {\n                env.notebook.merge_cell_above();\n            }\n        },\n        'merge-cell-with-next-cell' : {\n            cmd: i18n.msg._('merge cell with next cell'),\n            help    : i18n.msg._('merge cell below'),\n            help_index : 'ek',\n            handler : function (env) {\n                env.notebook.merge_cell_below();\n            }\n        },\n        'merge-selected-cells' : {\n            cmd: i18n.msg._('merge selected cells'),\n            help : i18n.msg._('merge selected cells'),\n            help_index: 'el',\n            handler: function(env) {\n                env.notebook.merge_selected_cells();\n            }\n        },\n        'merge-cells' : {\n            cmd: i18n.msg._('merge cells'),\n            help : i18n.msg._('merge selected cells, or current cell with cell below if only one cell is selected'),\n            help_index: 'el',\n            handler: function(env) {\n                var l = env.notebook.get_selected_cells_indices().length;\n                if(l == 1){\n                    env.notebook.merge_cell_below();\n                } else {\n                    env.notebook.merge_selected_cells();\n                }\n            }\n        },\n        'show-command-palette': {\n            help_index : 'aa',\n            cmd: i18n.msg._('show command pallette'),\n            help: i18n.msg._('open the command palette'),\n            icon: 'fa-keyboard-o',\n            handler : function(env){\n                env.notebook.show_command_palette();\n            }\n        },\n        'toggle-all-line-numbers': {\n            cmd: i18n.msg._('toggle all line numbers'),\n            help : i18n.msg._('toggles line numbers in all cells, and persist the setting'),\n            icon: 'fa-list-ol',\n            handler: function(env) {\n                var value = !env.notebook.line_numbers;\n                env.notebook.get_cells().map(function(c) {\n                    c.code_mirror.setOption('lineNumbers', value);\n                });\n                env.notebook.line_numbers = value;\n            }\n        },\n        'show-all-line-numbers': {\n            cmd: i18n.msg._('show all line numbers'),\n            help : i18n.msg._('show line numbers in all cells, and persist the setting'),\n            handler: function(env) {\n                env.notebook.get_cells().map(function(c) {\n                    c.code_mirror.setOption('lineNumbers', true);\n                });\n                env.notebook.line_numbers = true;\n            }\n        },\n        'hide-all-line-numbers': {\n            cmd: i18n.msg._('hide all line numbers'),\n            help : i18n.msg._('hide line numbers in all cells, and persist the setting'),\n            handler: function(env) {\n                env.notebook.get_cells().map(function(c) {\n                    c.code_mirror.setOption('lineNumbers', false);\n                });\n                env.notebook.line_numbers = false;\n            }\n        },\n        'toggle-header':{\n            cmd: i18n.msg._('toggle header'),\n            help: i18n.msg._('switch between showing and hiding the header'),\n            handler : function(env) {\n                $('#header-container').toggle();\n                $('.header-bar').toggle();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'show-header':{\n            cmd: i18n.msg._('show the header'),\n            help: i18n.msg._('show the header'),\n            handler : function(env) {\n                $('#header-container').show();\n                $('.header-bar').show();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'hide-header':{\n            cmd: i18n.msg._('hide the header'),\n            help: i18n.msg._('hide the header'),\n            handler : function(env) {\n                $('#header-container').hide();\n                $('.header-bar').hide();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'toggle-menubar':{\n            help: 'hide/show the menu bar',\n            handler : function(env) {\n                $('#menubar-container').toggle();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'show-menubar':{\n            help: 'show the menu bar',\n            handler : function(env) {\n                $('#menubar-container').show();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'hide-menubar':{\n            help: 'hide the menu bar',\n            handler : function(env) {\n                $('#menubar-container').hide();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'toggle-toolbar':{\n            cmd: i18n.msg._('toggle toolbar'),\n            help: i18n.msg._('switch between showing and hiding the toolbar'),\n            handler : function(env) {\n                $('div#maintoolbar').toggle();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'show-toolbar':{\n            cmd: i18n.msg._('show the toolbar'),\n            help: i18n.msg._('show the toolbar'),\n            handler : function(env) {\n                $('div#maintoolbar').show();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'hide-toolbar':{\n            cmd: i18n.msg._('hide the toolbar'),\n            help: i18n.msg._('hide the toolbar'),\n            handler : function(env) {\n                $('div#maintoolbar').hide();\n                events.trigger('resize-header.Page');\n            }\n        },\n        'close-pager': {\n            cmd: i18n.msg._('close the pager'),\n            help : i18n.msg._('close the pager'),\n            handler : function(env) {\n                // Collapse the page if it is open\n                if (env.pager && env.pager.expanded) {\n                    env.pager.collapse();\n                }\n            }\n        },\n        'auto-indent': {\n            cmd: i18n.msg._('automatically indent selection'),\n            help : i18n.msg._('automatically indent selection'),\n            handler : function(env) {\n              // Get selected cell\n              var selected_cell = env.notebook.get_selected_cell();\n              // Execute a CM command\n              selected_cell.code_mirror.execCommand('indentAuto');\n            }\n        },\n        'close-and-halt': {\n            cmd: i18n.msg._('shutdown kernel and close window'),\n            help : i18n.msg._('shutdown kernel and close window'),\n            handler : function(env) {\n                env.notebook.close_and_halt();\n            }\n        }\n    };\n\n    /**\n     * A bunch of `Advance actions` for Jupyter.\n     * Cf `Simple Action` plus the following properties.\n     *\n     * handler: first argument of the handler is the event that triggered the action\n     *      (typically keypress). The handler is responsible for any modification of the\n     *      event and event propagation.\n     *      Is also responsible for returning false if the event have to be further ignored,\n     *      true, to tell keyboard manager that it ignored the event.\n     *\n     *      the second parameter of the handler is the environment passed to Simple Actions\n     *\n     **/\n    var custom_ignore = {\n        'ignore':{\n            cmd: i18n.msg._('ignore'),\n            handler : function () {\n                return true;\n            }\n        },\n        'move-cursor-up':{\n            cmd: i18n.msg._('move cursor up'),\n            help: i18n.msg._(\"move cursor up\"),\n            handler : function (env, event) {\n                var index = env.notebook.get_selected_index();\n                var cell = env.notebook.get_cell(index);\n                var cm = env.notebook.get_selected_cell().code_mirror;\n                var cur = cm.getCursor();\n                if (cell && cell.at_top() && index !== 0 && cur.ch === 0) {\n                    if(event){\n                        event.preventDefault();\n                    }\n                    env.notebook.command_mode();\n                    env.notebook.select_prev(true);\n                    env.notebook.edit_mode();\n                    cm = env.notebook.get_selected_cell().code_mirror;\n                    cm.setCursor(cm.lastLine(), 0);\n                }\n                return false;\n            }\n        },\n        'move-cursor-down':{\n            cmd: i18n.msg._('move cursor down'),\n            help: i18n.msg._(\"move cursor down\"),\n            handler : function (env, event) {\n                var index = env.notebook.get_selected_index();\n                var cell = env.notebook.get_cell(index);\n                if (cell.at_bottom() && index !== (env.notebook.ncells()-1)) {\n                    if(event){\n                        event.preventDefault();\n                    }\n                    env.notebook.command_mode();\n                    env.notebook.select_next(true);\n                    env.notebook.edit_mode();\n                    var cm = env.notebook.get_selected_cell().code_mirror;\n                    cm.setCursor(0, 0);\n                }\n                return false;\n            }\n        },\n        'scroll-notebook-down': {\n            cmd: i18n.msg._('scroll notebook down'),\n            help: i18n.msg._(\"scroll notebook down\"),\n            handler: function(env, event) {\n                if(event){\n                    event.preventDefault();\n                }\n                return env.notebook.scroll_manager.scroll(1);\n            },\n        },\n        'scroll-notebook-up': {\n            cmd: i18n.msg._('scroll notebook up'),\n            help: i18n.msg._(\"scroll notebook up\"),\n            handler: function(env, event) {\n                if(event){\n                    event.preventDefault();\n                }\n                return env.notebook.scroll_manager.scroll(-1);\n            },\n        },\n        'scroll-cell-center': {\n            cmd: i18n.msg._('scroll cell center'),\n            help: i18n.msg._(\"Scroll the current cell to the center\"),\n            handler: function (env, event) {\n                if(event){\n                    event.preventDefault();\n                }\n                var cell = env.notebook.get_selected_index();\n                return env.notebook.scroll_cell_percent(cell, 50, 0);\n            }\n        },\n        'scroll-cell-top': {\n            cmd: i18n.msg._('scroll cell top'),\n            help: i18n.msg._(\"Scroll the current cell to the top\"),\n            handler: function (env, event) {\n                if(event){\n                    event.preventDefault();\n                }\n                var cell = env.notebook.get_selected_index();\n                return env.notebook.scroll_cell_percent(cell, 0, 0);\n            }\n        },\n        'duplicate-notebook':{\n            cmd: i18n.msg._('duplicate notebook'),\n            help: i18n.msg._(\"Create and open a copy of the current notebook\"),\n            handler : function (env, event) {\n                env.notebook.copy_notebook();\n            }\n        },\n        'trust-notebook':{\n            cmd: i18n.msg._('trust notebook'),\n            help: i18n.msg._(\"Trust the current notebook\"),\n            handler : function (env, event) {\n                env.notebook.trust_notebook();\n            }\n        },\n        'rename-notebook':{\n            cmd: i18n.msg._('rename notebook'),\n            help: i18n.msg._(\"Rename the current notebook\"),\n            handler : function (env, event) {\n                env.notebook.save_widget.rename_notebook({notebook: env.notebook});\n            }\n        },\n        'toggle-all-cells-output-collapsed':{\n            cmd: i18n.msg._('toggle all cells output collapsed'),\n            help: i18n.msg._(\"Toggle the hidden state of all output areas\"),\n            handler : function (env, event) {\n                env.notebook.toggle_all_output();\n            }\n        },\n        'toggle-all-cells-output-scrolled':{\n            cmd: i18n.msg._('toggle all cells output scrolled'),\n            help: i18n.msg._(\"Toggle the scrolling state of all output areas\"),\n            handler : function (env, event) {\n                env.notebook.toggle_all_output_scroll();\n            }\n        },\n\n        'clear-all-cells-output':{\n            cmd: i18n.msg._('clear all cells output'),\n            help: i18n.msg._(\"Clear the content of all the outputs\"),\n            handler : function (env, event) {\n                env.notebook.clear_all_output();\n            }\n        },\n        'save-notebook':{\n            cmd: i18n.msg._('save notebook'),\n            help: i18n.msg._(\"Save and Checkpoint\"),\n            help_index: 'fb',\n            icon: 'fa-save',\n            handler : function (env, event) {\n                env.notebook.save_checkpoint();\n                if(event){\n                    event.preventDefault();\n                }\n                return false;\n            }\n        },\n        'download-notebook':{\n            cmd: i18n.msg._('download notebook'),\n            help: i18n.msg._(\"Download this notebook\"),\n            help_index: 'fc',\n            icon: 'fa-save',\n            handler : function (env, event) {\n                env.notebook.basthonGUI.download();\n                if(event){\n                    event.preventDefault();\n                }\n                return false;\n            }\n        },\n        'open-notebook':{\n            cmd: i18n.msg._('open notebook, module or file'),\n            help: i18n.msg._(\"Open a notebook, load a module or a file\"),\n            help_index: 'fd',\n            icon: 'fa-folder-open-o',\n            handler : function (env, event) {\n                env.notebook.basthonGUI.openFile();\n                if(event){\n                    event.preventDefault();\n                }\n                return false;\n            }\n        },\n        'share-notebook':{\n            cmd: i18n.msg._('share notebook'),\n            help: i18n.msg._(\"Share this notebook\"),\n            icon: 'fa-share-alt-square',\n            help_index: 'fz',\n            handler : function (env, event) {\n                env.notebook.basthonGUI.share();\n                if(event){\n                    event.preventDefault();\n                }\n                return false;\n            }\n        },\n        'rollback':{\n            cmd: i18n.msg._('rollback notebook'),\n            help: i18n.msg._(\"Revenir à une version précédente du notebook\"),\n            icon: 'fa-undo',\n            help_index: 'fzz',\n            handler: function (env, event) {\n                (async () => {\n                    const ipynb = await env.notebook.basthonGUI.selectCheckpoint();\n                    if(ipynb != null) env.notebook.basthonGUI.setContent(ipynb);\n                })();\n                if(event){\n                    event.preventDefault();\n                }\n                return false;\n            }\n        },\n        'switch-theme':{\n            cmd: i18n.msg._('switch theme'),\n            help: i18n.msg._(\"Changer le theme du notebook (dark/light)\"),\n            icon: 'fa-adjust',\n            help_index: 'fzz',\n            handler: function (env, event) {\n                env.notebook.basthonGUI.switchDarkLight();\n                if(event){\n                    event.preventDefault();\n                }\n                return false;\n            }\n        },\n    };\n\n    // private stuff that prepend `jupyter-notebook:` to actions names\n    // and uniformize/fill in missing pieces in of an action.\n    var _prepare_handler = function(registry, subkey, source){\n        registry['jupyter-notebook:'+subkey] = {};\n        registry['jupyter-notebook:'+subkey].cmd = source[subkey].cmd;\n        registry['jupyter-notebook:'+subkey].help = source[subkey].help||subkey.replace(/-/g,' ');\n        registry['jupyter-notebook:'+subkey].help_index = source[subkey].help_index;\n        registry['jupyter-notebook:'+subkey].icon = source[subkey].icon;\n        return source[subkey].handler;\n    };\n\n    // Will actually generate/register all the Jupyter actions\n    var fun = function(){\n        var final_actions = {};\n        var k;\n        for(k in _actions){\n            if(_actions.hasOwnProperty(k)){\n                // Js closure are function level not block level need to wrap in a IIFE\n                // and append jupyter-notebook: to event name these things do intercept event so are wrapped\n                // in a function that return false.\n                var handler = _prepare_handler(final_actions, k, _actions);\n                (function(key, handler){\n                    final_actions['jupyter-notebook:'+key].handler = function(env, event){\n                        handler(env);\n                        if(event){\n                            event.preventDefault();\n                        }\n                        return false;\n                    };\n                })(k, handler);\n            }\n        }\n\n        for(k in custom_ignore){\n            // Js closure are function level not block level need to wrap in a IIFE\n            // same as above, but decide for themselves whether or not they intercept events.\n            if(custom_ignore.hasOwnProperty(k)){\n                handler = _prepare_handler(final_actions, k, custom_ignore);\n                (function(key, handler){\n                    final_actions['jupyter-notebook:'+key].handler = function(env, event){\n                        return handler(env, event);\n                    };\n                })(k, handler);\n            }\n        }\n\n        return final_actions;\n    };\n    ActionHandler.prototype._actions = fun();\n\n\n    /**\n     *  extend the environment variable that will be pass to handlers\n     **/\n    ActionHandler.prototype.extend_env = function(env){\n        for(var k in env){\n            this.env[k] = env[k];\n        }\n    };\n\n    ActionHandler.prototype.register = function(action, name, prefix){\n        /**\n         * Register an `action` with an optional name and prefix.\n         *\n         * if name and prefix are not given they will be determined automatically.\n         * if action if just a `function` it will be wrapped in an anonymous action.\n         *\n         * @return the full name to access this action .\n         **/\n        action = this.normalise(action);\n        if( !name ){\n            name = 'autogenerated-'+String(action.handler);\n        }\n        prefix = prefix || 'auto';\n        var full_name = prefix+':'+name;\n        this._actions[full_name] = action;\n        return full_name;\n\n    };\n\n\n    ActionHandler.prototype.normalise = function(data){\n        /**\n         * given an `action` or `function`, return a normalised `action`\n         * by setting all known attributes and removing unknown attributes;\n         **/\n        if(typeof(data) === 'function'){\n            data = {handler:data};\n        }\n        if(typeof(data.handler) !== 'function'){\n            throw new Error('unknown datatype, cannot register');\n        }\n        var _data = data;\n        data = {};\n        data.handler = _data.handler;\n        data.help = _data.help || '';\n        data.icon = _data.icon || '';\n        data.help_index = _data.help_index || '';\n        return data;\n    };\n\n    ActionHandler.prototype.get_name = function(name_or_data){\n        /**\n         * given an `action` or `name` of an action, return the name attached to this action.\n         * if given the name of and corresponding actions does not exist in registry, return `null`.\n         **/\n\n        if(typeof(name_or_data) === 'string'){\n            warn_bad_name(name_or_data);\n            if(this.exists(name_or_data)){\n                return name_or_data;\n            } else {\n                return null;\n            }\n        } else {\n            return this.register(name_or_data);\n        }\n    };\n\n    ActionHandler.prototype.get = function(name){\n        warn_bad_name(name);\n        return this._actions[name];\n    };\n\n    ActionHandler.prototype.call = function(name, event, env){\n        return this._actions[name].handler(env|| this.env, event);\n    };\n\n    ActionHandler.prototype.exists = function(name){\n        return (typeof(this._actions[name]) !== 'undefined');\n    };\n\n    return {init:ActionHandler};\n\n});\n","// Distributed under the terms of the Modified BSD License.\n\n/**\n *\n *\n * @module cell\n * @namespace cell\n * @class Cell\n */\n\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'codemirror/lib/codemirror',\n    'codemirror/addon/edit/matchbrackets',\n    'codemirror/addon/edit/closebrackets',\n    'codemirror/addon/comment/comment',\n    'services/config',\n], function($, utils, i18n, CodeMirror, cm_match, cm_closeb, cm_comment, configmod) {\n    \"use strict\";\n    \n    var overlayHack = CodeMirror.scrollbarModel.native.prototype.overlayHack;\n\n    CodeMirror.scrollbarModel.native.prototype.overlayHack = function () {\n        overlayHack.apply(this, arguments);\n        // Reverse `min-height: 18px` scrollbar hack on OS X\n        // which causes a dead area, making it impossible to click on the last line\n        // when there is horizontal scrolling to do and the \"show scrollbar only when scrolling\" behavior\n        // is enabled.\n        // This, in turn, has the undesirable behavior of never showing the horizontal scrollbar,\n        // even when it should, which is less problematic, at least.\n        if (/Mac/.test(navigator.platform)) {\n            this.horiz.style.minHeight = \"\";\n        }\n    };\n    \n    var Cell = function (options) {\n        /* Constructor\n         *\n         * The Base `Cell` class from which to inherit.\n         * @constructor\n         * @param:\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance\n         *          config: dictionary\n         *          keyboard_manager: KeyboardManager instance\n         */\n        options = options || {};\n        this.keyboard_manager = options.keyboard_manager;\n        this.events = options.events;\n        var config = options.config;\n        // superclass default overwrite our default\n        \n        this.selected = false;\n        this.anchor = false;\n        this.rendered = false;\n        this.mode = 'command';\n\n        // Metadata property\n        var that = this;\n        this._metadata = {};\n        Object.defineProperty(this, 'metadata', {\n            get: function() { return that._metadata; },\n            set: function(value) {\n                that._metadata = value;\n                if (that.celltoolbar) {\n                    that.celltoolbar.rebuild();\n                }\n            }\n        });\n\n\n        // backward compat.\n        Object.defineProperty(this, 'cm_config', {\n            get: function() {\n                console.warn(i18n.msg._(\"Warning: accessing Cell.cm_config directly is deprecated.\"));\n                return that._options.cm_config;\n            },\n        });\n\n        // load this from metadata later ?\n        this.user_highlight = 'auto';\n\n        // merge my class-specific config data with general cell-level config\n        var class_config_data = {};\n        if (this.class_config) {\n            class_config_data = this.class_config.get_sync();\n        }\n\n        var cell_config = new configmod.ConfigWithDefaults(options.config,\n            Cell.options_default, 'Cell');\n        var cell_config_data = cell_config.get_sync();\n\n        // this._options is a merge of SomeCell and Cell config data:\n        this._options = utils.mergeopt({}, cell_config_data, class_config_data);\n        this.placeholder = this._options.placeholder || '';\n\n        this.cell_id = utils.uuid();\n\n        // For JS VM engines optimization, attributes should be all set (even\n        // to null) in the constructor, and if possible, if different subclass\n        // have new attributes with same name, they should be created in the\n        // same order. Easiest is to create and set to null in parent class.\n\n        this.element = null;\n        this.cell_type = this.cell_type || null;\n        this.code_mirror = null;\n\n        // The nbformat only specifies attachments for textcell, but to avoid\n        // data loss when switching between cell types in the UI, all cells\n        // have an attachments property here. It is only saved to disk\n        // for textcell though (in toJSON)\n        this.attachments = {};\n\n        this.create_element();\n        if (this.element !== null) {\n            this.element.data(\"cell\", this);\n            this.bind_events();\n            this.init_classes();\n        }\n    };\n\n    Cell.options_default = {\n        cm_config : {\n            indentUnit : 4,\n            readOnly: false,\n            theme: \"default\",\n            extraKeys: {\n                \"Cmd-Right\": \"goLineRight\",\n                \"End\": \"goLineRight\",\n                \"Cmd-Left\": \"goLineLeft\",\n                \"Tab\": \"indentMore\",\n                \"Shift-Tab\" : \"indentLess\",\n                \"Cmd-/\" : \"toggleComment\",\n                \"Ctrl-/\" : \"toggleComment\",\n            }\n        }\n    };\n    \n    // FIXME: Workaround CM Bug #332 (Safari segfault on drag)\n    // by disabling drag/drop altogether on Safari\n    // https://github.com/codemirror/CodeMirror/issues/332    \n    if (utils.browser[0] == \"Safari\") {\n        Cell.options_default.cm_config.dragDrop = false;\n    }\n\n    /**\n     * Empty. Subclasses must implement create_element.\n     * This should contain all the code to create the DOM element in notebook\n     * and will be called by Base Class constructor.\n     * @method create_element\n     */\n    Cell.prototype.create_element = function () {\n    };\n\n    Cell.prototype.init_classes = function () {\n        /**\n         * Call after this.element exists to initialize the css classes\n         * related to selected, rendered and mode.\n         */\n        if (this.selected) {\n            this.element.addClass('selected');\n        } else {\n            this.element.addClass('unselected');\n        }\n        if (this.rendered) {\n            this.element.addClass('rendered');\n        } else {\n            this.element.addClass('unrendered');\n        }\n    };\n\n    /**\n     * trigger on focus and on click to bubble up to the notebook and\n     * potentially extend the selection if shift-click, contract the selection\n     * if just codemirror focus (so edit mode).\n     * We **might** be able to move that to notebook `handle_edit_mode`.\n     */\n    Cell.prototype._on_click = function (event) {\n        if (!this.selected) {\n            this.events.trigger('select.Cell', {'cell':this, 'extendSelection':event.shiftKey});\n        } else {\n            // I'm already part of the selection; contract selection to just me\n            this.events.trigger('select.Cell', {'cell': this});\n        }\n    };\n\n    /**\n     * Subclasses can implement override bind_events.\n     * Be careful to call the parent method when overwriting as it fires event.\n     * this will be triggered after create_element in constructor.\n     * @method bind_events\n     */\n    Cell.prototype.bind_events = function () {\n        var that = this;\n        // We trigger events so that Cell doesn't have to depend on Notebook.\n        that.element.click(function (event) {\n            that._on_click(event);\n        });\n        if (this.code_mirror) {\n            this.code_mirror.on(\"change\", function(cm, change) {\n                that.events.trigger(\"change.Cell\", {cell: that, change: change});\n                that.events.trigger(\"set_dirty.Notebook\", {value: true});\n            });\n        }\n        if (this.code_mirror) {\n            this.code_mirror.on('focus', function(cm, change) {\n                if (!that.selected) {\n                    that.events.trigger('select.Cell', {'cell':that});\n                }\n                that.events.trigger('edit_mode.Cell', {cell: that});\n            });\n        }\n        if (this.code_mirror) {\n            this.code_mirror.on('blur', function(cm, change) {\n                that.events.trigger('command_mode.Cell', {cell: that});\n            });\n        }\n\n        this.element.dblclick(function () {\n            if (that.selected === false) {\n                this.events.trigger('select.Cell', {'cell':that});\n            }\n        });\n    };\n    \n    /**\n     * This method gets called in CodeMirror's onKeyDown/onKeyPress\n     * handlers and is used to provide custom key handling.\n     *\n     * To have custom handling, subclasses should override this method, but still call it\n     * in order to process the Edit mode keyboard shortcuts.\n     *\n     * @method handle_codemirror_keyevent\n     * @param {CodeMirror} editor - The codemirror instance bound to the cell\n     * @param {event} event - key press event which either should or should not be handled by CodeMirror\n     * @return {Boolean} `true` if CodeMirror should ignore the event, `false` Otherwise\n     */\n    Cell.prototype.handle_codemirror_keyevent = function (editor, event) {\n        var shortcuts = this.keyboard_manager.edit_shortcuts;\n\n        var cur = editor.getCursor();\n        if((cur.line !== 0 || cur.ch !==0) && event.keyCode === 38){\n            event._ipkmIgnore = true;\n        }\n        var nLastLine = editor.lastLine();\n        if ((event.keyCode === 40) &&\n             ((cur.line !== nLastLine) ||\n               (cur.ch !== editor.getLineHandle(nLastLine).text.length))\n           ) {\n            event._ipkmIgnore = true;\n        }\n        // if this is an edit_shortcuts shortcut, the global keyboard/shortcut\n        // manager will handle it\n        if (shortcuts.handles(event)) {\n            return true;\n        }\n        \n        return false;\n    };\n\n\n    /**\n     * Triger typesetting of math by mathjax on current cell element\n     * @method typeset\n     */\n    Cell.prototype.typeset = function () {\n        utils.typeset(this.element);\n    };\n\n    /**\n     * handle cell level logic when a cell is selected\n     * @method select\n     * @return is the action being taken\n     */\n    Cell.prototype.select = function (moveanchor) {\n        // if anchor is true, set the move the anchor\n        moveanchor = (moveanchor === undefined)? true:moveanchor;\n        if(moveanchor){\n            this.anchor=true;\n        }\n\n        if (!this.selected) {\n            this.element.addClass('selected');\n            this.element.removeClass('unselected');\n            this.selected = true;\n            // disable 'insert image' menu item (specific cell types will enable\n            // it in their override select())\n            this.notebook.set_insert_image_enabled(false);\n            return true;\n        } else {\n            return false;\n        }\n    };\n\n    /**\n     * handle cell level logic when the cell is unselected\n     * @method unselect\n     * @return is the action being taken\n     */\n    Cell.prototype.unselect = function (moveanchor) {\n        // if anchor is true, remove also the anchor\n        moveanchor = (moveanchor === undefined)? true:moveanchor;\n        if (moveanchor){\n            this.anchor = false;\n        }\n        if (this.selected) {\n            this.element.addClass('unselected');\n            this.element.removeClass('selected');\n            this.selected = false;\n            return true;\n        } else {\n            return false;\n        }\n    };\n    \n\n    /**\n     * should be overwritten by subclass\n     * @method execute\n     */\n    Cell.prototype.execute = function () {\n        return;\n    };\n\n    /**\n     * handle cell level logic when a cell is rendered\n     * @method render\n     * @return is the action being taken\n     */\n    Cell.prototype.render = function () {\n        if (!this.rendered) {\n            this.element.addClass('rendered');\n            this.element.removeClass('unrendered');\n            this.rendered = true;\n            return true;\n        } else {\n            return false;\n        }\n    };\n\n    /**\n     * handle cell level logic when a cell is unrendered\n     * @method unrender\n     * @return is the action being taken\n     */\n    Cell.prototype.unrender = function () {\n        if (this.rendered) {\n            this.element.addClass('unrendered');\n            this.element.removeClass('rendered');\n            this.rendered = false;\n            return true;\n        } else {\n            return false;\n        }\n    };\n\n    /**\n     * Delegates keyboard shortcut handling to either Jupyter keyboard\n     * manager when in command mode, or CodeMirror when in edit mode\n     *\n     * @method handle_keyevent\n     * @param {CodeMirror} editor - The codemirror instance bound to the cell\n     * @param {event} - key event to be handled\n     * @return {Boolean} `true` if CodeMirror should ignore the event, `false` Otherwise\n     */\n    Cell.prototype.handle_keyevent = function (editor, event) {\n        if (this.mode === 'command') {\n            return true;\n        } else if (this.mode === 'edit') {\n            return this.handle_codemirror_keyevent(editor, event);\n        }\n    };\n\n    /**\n     * @method at_top\n     * @return {Boolean}\n     */\n    Cell.prototype.at_top = function () {\n        var cm = this.code_mirror;\n        var cursor = cm.getCursor();\n        if (cursor.line === 0 && cursor.ch === 0) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * @method at_bottom\n     * @return {Boolean}\n     * */\n    Cell.prototype.at_bottom = function () {\n        var cm = this.code_mirror;\n        var cursor = cm.getCursor();\n        if (cursor.line === (cm.lineCount()-1) && cursor.ch === cm.getLine(cursor.line).length) {\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * enter the command mode for the cell\n     * @method command_mode\n     * @return is the action being taken\n     */\n    Cell.prototype.command_mode = function () {\n        if (this.mode !== 'command') {\n            this.mode = 'command';\n            return true;\n        } else {\n            return false;\n        }\n    };\n\n    /**\n     * enter the edit mode for the cell\n     * @method command_mode\n     * @return is the action being taken\n     */\n    Cell.prototype.edit_mode = function () {\n        if (this.mode !== 'edit') {\n            this.mode = 'edit';\n            return true;\n        } else {\n            return false;\n        }\n    };\n\n    Cell.prototype.ensure_focused = function() {\n        if(this.element !== document.activeElement && !this.code_mirror.hasFocus()){\n            this.focus_cell();\n        }\n    };\n    \n    /**\n     * Focus the cell in the DOM sense\n     * @method focus_cell\n     */\n    Cell.prototype.focus_cell = function () {\n        this.element.focus();\n        this._on_click({});\n    };\n\n    /**\n     * Focus the editor area so a user can type\n     *\n     * NOTE: If codemirror is focused via a mouse click event, you don't want to\n     * call this because it will cause a page jump.\n     * @method focus_editor\n     */\n    Cell.prototype.focus_editor = function () {\n        this.refresh();\n        this.code_mirror.focus();\n    };\n\n    /**\n     * Refresh codemirror instance\n     * @method refresh\n     */\n    Cell.prototype.refresh = function () {\n        if (this.code_mirror) {\n            this.code_mirror.refresh();\n        }\n    };\n\n    /**\n     * should be overwritten by subclass\n     * @method get_text\n     */\n    Cell.prototype.get_text = function () {\n    };\n\n    /**\n     * should be overwritten by subclass\n     * @method set_text\n     * @param {string} text\n     */\n    Cell.prototype.set_text = function (text) {\n    };\n\n    /**\n     * should be overwritten by subclass\n     * serialise cell to json.\n     * @method toJSON\n     **/\n    Cell.prototype.toJSON = function () {\n        var data = {};\n        // deepcopy the metadata so copied cells don't share the same object\n        data.metadata = JSON.parse(JSON.stringify(this.metadata));\n        if (data.metadata.deletable) {\n            delete data.metadata.deletable;\n        }\n        if (data.metadata.editable) {\n            delete data.metadata.editable;\n        }\n        if (data.metadata.collapsed === false) {\n            delete data.metadata.collapsed;\n        }\n        data.cell_type = this.cell_type;\n        return data;\n    };\n\n    /**\n     * should be overwritten by subclass\n     * @method fromJSON\n     **/\n    Cell.prototype.fromJSON = function (data) {\n        if (data.metadata !== undefined) {\n            this.metadata = data.metadata;\n        }\n    };\n\n\n    /**\n     * can the cell be split into two cells (false if not deletable)\n     *\n     * @method is_splittable\n     **/\n    Cell.prototype.is_splittable = function () {\n        return this.is_deletable();\n    };\n\n\n    /**\n     * can the cell be merged with other cells (false if not deletable)\n     * @method is_mergeable\n     **/\n    Cell.prototype.is_mergeable = function () {\n        return this.is_deletable();\n    };\n\n    /**\n     * is the cell edtitable? only false (readonly) if\n     * metadata.editable is explicitly false -- everything else\n     * counts as true\n     *\n     * @method is_editable\n     **/\n    Cell.prototype.is_editable = function () {\n        if (this.metadata.editable === false) {\n            return false;\n        }\n        return true;\n    };\n\n    /**\n     * is the cell deletable? only false (undeletable) if\n     * metadata.deletable is explicitly false or if the cell is not\n     * editable -- everything else counts as true\n     *\n     * @method is_deletable\n     **/\n    Cell.prototype.is_deletable = function () {\n        if (this.metadata.deletable === false || !this.is_editable()) {\n            return false;\n        }\n        return true;\n    };\n\n    /**\n     * @return {String} - the text before the cursor\n     * @method get_pre_cursor\n     **/\n    Cell.prototype.get_pre_cursor = function () {\n        var cursor = this.code_mirror.getCursor();\n        var text = this.code_mirror.getRange({line:0, ch:0}, cursor);\n        text = text.replace(/^\\n+/, '').replace(/\\n+$/, '');\n        return text;\n    };\n\n\n    /**\n     * @return {String} - the text after the cursor\n     * @method get_post_cursor\n     **/\n    Cell.prototype.get_post_cursor = function () {\n        var cursor = this.code_mirror.getCursor();\n        var last_line_num = this.code_mirror.lineCount()-1;\n        var last_line_len = this.code_mirror.getLine(last_line_num).length;\n        var end = {line:last_line_num, ch:last_line_len};\n        var text = this.code_mirror.getRange(cursor, end);\n        text = text.replace(/^\\n+/, '').replace(/\\n+$/, '');\n        return text;\n    };\n\n    /**\n     * Show/Hide CodeMirror LineNumber\n     * @method show_line_numbers\n     *\n     * @param value {Bool}  show (true), or hide (false) the line number in CodeMirror\n     **/\n    Cell.prototype.show_line_numbers = function (value) {\n        this.code_mirror.setOption('lineNumbers', value);\n        this.code_mirror.refresh();\n    };\n\n    /**\n     * Toggle  CodeMirror LineNumber\n     * @method toggle_line_numbers\n     **/\n    Cell.prototype.toggle_line_numbers = function () {\n        var val = this.code_mirror.getOption('lineNumbers');\n        this.show_line_numbers(!val);\n    };\n\n    /**\n     * Force codemirror highlight mode\n     * @method force_highlight\n     * @param {object} - CodeMirror mode\n     **/\n    Cell.prototype.force_highlight = function(mode) {\n        this.user_highlight = mode;\n        this.auto_highlight();\n    };\n    \n    /**\n     * Trigger autodetection of highlight scheme for current cell\n     * @method auto_highlight\n     */\n    Cell.prototype.auto_highlight = function () {\n        this._auto_highlight(this.class_config.get_sync('highlight_modes'));\n    };\n    \n    /**\n     * Try to autodetect cell highlight mode, or use selected mode\n     * @methods _auto_highlight\n     * @private\n     * @param {String|object|undefined} - CodeMirror mode | 'auto'\n     **/\n    Cell.prototype._auto_highlight = function (modes) {\n        /**\n         *Here we handle manually selected modes\n         */\n        var that = this;\n        var mode;\n        if( this.user_highlight !== undefined &&  this.user_highlight != 'auto' )\n        {\n            mode = this.user_highlight;\n            CodeMirror.autoLoadMode(this.code_mirror, mode);\n            this.code_mirror.setOption('mode', mode);\n            return;\n        }\n        var current_mode = this.code_mirror.getOption('mode', mode);\n        var first_line = this.code_mirror.getLine(0);\n        // loop on every pairs\n        for(mode in modes) {\n            var regs = modes[mode].reg;\n            // only one key every time but regexp can't be keys...\n            for(var i=0; i<regs.length; i++) {\n                // here we handle non magic_modes.\n                // TODO :\n                // On 3.0 and below, these things were regex.\n                // But now should be string for json-able config. \n                // We should get rid of assuming they might be already \n                // in a later version of Jupyter.\n                var re = regs[i];\n                if(typeof(re) === 'string'){\n                    re = new RegExp(re);\n                }\n                if(first_line.match(re) !== null) {\n                    if(current_mode == mode){\n                        return;\n                    }\n                    if (mode.search('magic_') !== 0) {\n                        utils.requireCodeMirrorMode(mode, function (spec) {\n                            that.code_mirror.setOption('mode', spec);\n                        });\n                        return;\n                    }\n                    var magic_mode = mode;\n                    mode = magic_mode.substr(6);\n                    if(current_mode == magic_mode){\n                        return;\n                    }\n                    utils.requireCodeMirrorMode(mode, function (spec) {\n                        // Add an overlay mode to recognize the first line as \"magic\" instead\n                        // of the mode used for the rest of the cell.\n                        CodeMirror.defineMode(magic_mode, function(config) {\n                            var magicOverlay = {\n                                startState: function() {\n                                    return {firstMatched : false, inMagicLine: false};\n                                },\n                                token: function(stream, state) {\n                                    if(!state.firstMatched) {\n                                        state.firstMatched = true;\n                                        if (stream.match(\"%%\", false)) {\n                                            state.inMagicLine = true;\n                                        }\n                                    }\n                                    if (state.inMagicLine) {\n                                        stream.eat(function any(ch) { return true; });\n                                        if (stream.eol()) {\n                                            state.inMagicLine = false;\n                                        }\n                                        return \"magic\";\n                                    }\n                                    stream.skipToEnd();\n                                    return null;\n                                }\n                            };\n                            return CodeMirror.overlayMode(CodeMirror.getMode(config, spec), magicOverlay);\n                        });\n                        that.code_mirror.setOption('mode', magic_mode);\n                    });\n                    return;\n                }\n            }\n        }\n        // fallback on default\n        var default_mode;\n        try {\n            default_mode = this._options.cm_config.mode;\n        } catch(e) {\n            default_mode = 'text/plain';\n        }\n        if( current_mode === default_mode){\n            return;\n        }\n        this.code_mirror.setOption('mode', default_mode);\n    };\n\n    var UnrecognizedCell = function (options) {\n        /** Constructor for unrecognized cells */\n        Cell.apply(this, arguments);\n        this.cell_type = 'unrecognized';\n        this.celltoolbar = null;\n        this.data = {};\n        \n        Object.seal(this);\n    };\n\n    UnrecognizedCell.prototype = Object.create(Cell.prototype);\n    \n    \n    // cannot merge or split unrecognized cells\n    UnrecognizedCell.prototype.is_mergeable = function () {\n        return false;\n    };\n    \n    UnrecognizedCell.prototype.is_splittable = function () {\n        return false;\n    };\n    \n    UnrecognizedCell.prototype.toJSON = function () {\n        /**\n         * deepcopy the metadata so copied cells don't share the same object\n         */\n        return JSON.parse(JSON.stringify(this.data));\n    };\n\n    UnrecognizedCell.prototype.fromJSON = function (data) {\n        this.data = data;\n        if (data.metadata !== undefined) {\n            this.metadata = data.metadata;\n        } else {\n            data.metadata = this.metadata;\n        }\n        this.element.find('.inner_cell').find(\"a\").text(i18n.msg.sprintf(i18n.msg._(\"Unrecognized cell type: %s\"), data.cell_type));\n    };\n    \n    UnrecognizedCell.prototype.create_element = function () {\n        Cell.prototype.create_element.apply(this, arguments);\n        var cell = this.element = $(\"<div>\").addClass('cell unrecognized_cell');\n        cell.attr('tabindex','2');\n\n        var prompt = $('<div/>').addClass('prompt input_prompt');\n        cell.append(prompt);\n        var inner_cell = $('<div/>').addClass('inner_cell');\n        inner_cell.append(\n            $(\"<a>\")\n                .attr(\"href\", \"#\")\n                .text(i18n.msg._(\"Unrecognized cell type\"))\n        );\n        cell.append(inner_cell);\n        this.element = cell;\n    };\n\n    UnrecognizedCell.prototype.bind_events = function () {\n        Cell.prototype.bind_events.apply(this, arguments);\n        var cell = this;\n        \n        this.element.find('.inner_cell').find(\"a\").click(function () {\n            cell.events.trigger('unrecognized_cell.Cell', {cell: cell});\n        });\n    };\n\n    return {\n        Cell: Cell,\n        UnrecognizedCell: UnrecognizedCell\n    };\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/namespace',\n    'base/js/events',\n    'base/js/i18n'\n], function($, IPython, events, i18n) {\n    \"use strict\";\n\n    var CellToolbar = function (options) {\n        /**\n         * Constructor\n         *\n         * Parameters:\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance \n         *          cell: Cell instance\n         *          notebook: Notebook instance \n         *\n         *  TODO: This leaks, when cell are deleted\n         *  There is still a reference to each celltoolbars.\n         */\n        CellToolbar._instances.push(this);\n        this.notebook = options.notebook;\n        this.cell = options.cell;\n        this.create_element();\n        this.rebuild();\n        return this;\n    };\n\n\n    CellToolbar.prototype.create_element = function () {\n        this.inner_element = $('<div/>').addClass('celltoolbar');\n        this.element = $('<div/>').addClass('ctb_hideshow')\n            .append(this.inner_element);\n    };\n\n\n    // The default css style for the outer celltoolbar div\n    // (ctb_hideshow) is display: none.\n    // To show the cell toolbar, *both* of the following conditions must be met:\n    // - A parent container has class `ctb_global_show`\n    // - The celltoolbar has the class `ctb_show`\n    // This allows global show/hide, as well as per-cell show/hide.\n\n    CellToolbar.global_hide = function () {\n        $('body').removeClass('ctb_global_show');\n    };\n\n\n    CellToolbar.global_show = function () {\n        $('body').addClass('ctb_global_show');\n    };\n\n\n    CellToolbar.prototype.hide = function () {\n        this.element.removeClass('ctb_show');\n    };\n\n\n    CellToolbar.prototype.show = function () {\n        this.element.addClass('ctb_show');\n    };\n\n\n    /**\n     * Class variable that should contain a dict of all available callback\n     * we need to think of wether or not we allow nested namespace\n     * @property _callback_dict\n     * @private\n     * @static\n     * @type Dict\n     */\n    CellToolbar._callback_dict = {};\n\n\n    /**\n     * Class variable that should contain the reverse order list of the button\n     * to add to the toolbar of each cell\n     * @property _ui_controls_list\n     * @private\n     * @static\n     * @type List\n     */\n    CellToolbar._ui_controls_list = [];\n\n\n    /**\n     * Class variable that should contain the CellToolbar instances for each\n     * cell of the notebook\n     *\n     * @private\n     * @property _instances\n     * @static\n     * @type List\n     */\n    CellToolbar._instances = [];\n\n\n    /**\n     * keep a list of all the available presets for the toolbar\n     * @private\n     * @property _presets\n     * @static\n     * @type Dict\n     */\n    CellToolbar._presets = {};\n\n\n    // this is by design not a prototype.\n    /**\n     * Register a callback to create an UI element in a cell toolbar.\n     * @method register_callback\n     * @param name {String} name to use to refer to the callback. It is advised to use a prefix with the name\n     * for easier sorting and avoid collision\n     * @param callback {function(div, cell)} callback that will be called to generate the ui element\n     * @param [cell_types] {List_of_String|undefined} optional list of cell types. If present the UI element\n     * will be added only to cells of types in the list.\n     *\n     *\n     * The callback will receive the following element :\n     *\n     *    * a div in which to add element.\n     *    * the cell it is responsible from\n     *\n     * @example\n     *\n     * Example that create callback for a button that toggle between `true` and `false` label,\n     * with the metadata under the key 'foo' to reflect the status of the button.\n     *\n     *      // first param reference to a DOM div\n     *      // second param reference to the cell.\n     *      var toggle =  function(div, cell) {\n     *          var button_container = $(div)\n     *\n     *          // let's create a button that show the  current value of the metadata\n     *          var button = $('<div/>').button({label:String(cell.metadata.foo)});\n     *\n     *          // On click, change the metadata value and update the button label\n     *          button.click(function(){\n     *                      var v = cell.metadata.foo;\n     *                      cell.metadata.foo = !v;\n     *                      button.button(\"option\", \"label\", String(!v));\n     *                  })\n     *\n     *          // add the button to the DOM div.\n     *          button_container.append(button);\n     *      }\n     *\n     *      // now we register the callback under the name `foo` to give the\n     *      // user the ability to use it later\n     *      CellToolbar.register_callback('foo', toggle);\n     */\n    CellToolbar.register_callback = function(name, callback, cell_types) {\n        // Overwrite if it already exists.\n        CellToolbar._callback_dict[name] = cell_types ? {callback: callback, cell_types: cell_types} : callback;\n    };\n\n\n    /**\n     * Register a preset of UI element in a cell toolbar.\n     * Not supported Yet.\n     * @method register_preset\n     * @param name {String} name to use to refer to the preset. It is advised to use a prefix with the name\n     * for easier sorting and avoid collision\n     * @param  preset_list {List_of_String} reverse order of the button in the toolbar. Each String of the list\n     *          should correspond to a name of a registered callback.\n     *\n     * @private\n     * @example\n     *\n     *      CellToolbar.register_callback('foo.c1', function(div, cell){...});\n     *      CellToolbar.register_callback('foo.c2', function(div, cell){...});\n     *      CellToolbar.register_callback('foo.c3', function(div, cell){...});\n     *      CellToolbar.register_callback('foo.c4', function(div, cell){...});\n     *      CellToolbar.register_callback('foo.c5', function(div, cell){...});\n     *\n     *      CellToolbar.register_preset('foo.foo_preset1', ['foo.c1', 'foo.c2', 'foo.c5'])\n     *      CellToolbar.register_preset('foo.foo_preset2', ['foo.c4', 'foo.c5'])\n     */\n    CellToolbar.register_preset = function(name, preset_list, notebook) {\n        CellToolbar._presets[name] = preset_list;\n        events.trigger('preset_added.CellToolbar', {name: name});\n        // When \"register_callback\" is called by a custom extension, it may be executed after notebook is loaded.\n        // In that case, activate the preset if needed.\n        if (notebook && notebook.metadata && notebook.metadata.celltoolbar === name){\n            CellToolbar.activate_preset(name);\n        }\n    };\n\n    /**\n     * unregister the selected preset, \n     *\n     * return true if preset successfully unregistered\n     * false otherwise\n     *\n     **/\n    CellToolbar.unregister_preset = function(name){\n        if(CellToolbar._presets[name]){\n            delete CellToolbar._presets[name];\n            events.trigger('unregistered_preset.CellToolbar', {name: name});\n            return true\n        }\n        return false\n    }\n\n\n    /**\n     * List the names of the presets that are currently registered.\n     *\n     * @method list_presets\n     * @static\n     */\n    CellToolbar.list_presets = function() {\n        var keys = [];\n        for (var k in CellToolbar._presets) {\n            keys.push(k);\n        }\n        return keys;\n    };\n\n\n    /**\n     * Activate an UI preset from `register_preset`\n     *\n     * This does not update the selection UI.\n     *\n     * @method activate_preset\n     * @param preset_name {String} string corresponding to the preset name\n     *\n     * @static\n     * @private\n     * @example\n     *\n     *      CellToolbar.activate_preset('foo.foo_preset1');\n     */\n    CellToolbar.activate_preset = function(preset_name){\n        var preset = CellToolbar._presets[preset_name];\n\n        if(preset !== undefined){\n            CellToolbar._ui_controls_list = preset;\n            CellToolbar.rebuild_all();\n        }\n\n        events.trigger('preset_activated.CellToolbar', {name: preset_name});\n    };\n\n\n    /**\n     * This should be called on the class and not on a instance as it will trigger\n     * rebuild of all the instances.\n     * @method rebuild_all\n     * @static\n     *\n     */\n    CellToolbar.rebuild_all = function(){\n        for(var i=0; i < CellToolbar._instances.length; i++){\n            CellToolbar._instances[i].rebuild();\n        }\n    };\n\n    /**\n     * Rebuild all the button on the toolbar to update its state.\n     * @method rebuild\n     */\n    CellToolbar.prototype.rebuild = function(){\n        /**\n         * strip everything from the div\n         * which is probably inner_element\n         * or this.element.\n         */\n        this.inner_element.empty();\n        this.ui_controls_list = [];\n\n        var callbacks = CellToolbar._callback_dict;\n        var preset = CellToolbar._ui_controls_list;\n        // Yes we iterate on the class variable, not the instance one.\n        for (var i=0; i < preset.length; i++) {\n            var key = preset[i];\n            var callback = callbacks[key];\n            if (!callback) continue;\n\n            if (typeof callback === 'object') {\n                if (callback.cell_types.indexOf(this.cell.cell_type) === -1) continue;\n                callback = callback.callback;\n            }\n            \n            var local_div = $('<div/>').addClass('button_container');\n            try {\n                callback(local_div, this.cell, this);\n                this.ui_controls_list.push(key);\n            } catch (e) {\n                console.log(i18n.msg.sprintf(i18n.msg._(\"Error in cell toolbar callback %s\"), key), e);\n                continue;\n            }\n            // only append if callback succeeded.\n            this.inner_element.append(local_div);\n        }\n\n        // If there are no controls or the cell is a rendered TextCell hide the toolbar.\n        if (!this.ui_controls_list.length) {\n            this.hide();\n        } else {\n            this.show();\n        }\n    };\n\n\n    CellToolbar.utils = {};\n\n\n    /**\n     * A utility function to generate bindings between a checkbox and cell/metadata\n     * @method utils.checkbox_ui_generator\n     * @static\n     *\n     * @param name {string} Label in front of the checkbox\n     * @param setter {function( cell, newValue )}\n     *        A setter method to set the newValue\n     * @param getter {function( cell )}\n     *        A getter methods which return the current value.\n     *\n     * @return callback {function( div, cell )} Callback to be passed to `register_callback`\n     *\n     * @example\n     *\n     * An exmple that bind the subkey `slideshow.isSectionStart` to a checkbox with a `New Slide` label\n     *\n     *     var newSlide = CellToolbar.utils.checkbox_ui_generator('New Slide',\n     *          // setter\n     *          function(cell, value){\n     *              // we check that the slideshow namespace exist and create it if needed\n     *              if (cell.metadata.slideshow == undefined){cell.metadata.slideshow = {}}\n     *              // set the value\n     *              cell.metadata.slideshow.isSectionStart = value\n     *              },\n     *          // getter\n     *          function(cell){ var ns = cell.metadata.slideshow;\n     *              // if the slideshow namespace does not exist return `undefined`\n     *              // (will be interpreted as `false` by checkbox) otherwise\n     *              // return the value\n     *              return (ns == undefined)? undefined: ns.isSectionStart\n     *              }\n     *      );\n     *\n     *      CellToolbar.register_callback('newSlide', newSlide);\n     *\n     */\n    CellToolbar.utils.checkbox_ui_generator = function(name, setter, getter){\n        return function(div, cell, celltoolbar) {\n            var button_container = $(div);\n\n            var chkb = $('<input/>').attr('type', 'checkbox');\n            var lbl = $('<label/>').append($('<span/>').text(name));\n            chkb.attr(\"checked\", getter(cell));\n\n            chkb.click(function(){\n                        var v = getter(cell);\n                        setter(cell, !v);\n                        chkb.attr(\"checked\", !v);\n            });\n            button_container.append($('<span/>').append(lbl).append(chkb));\n        };\n    };\n\n\n    /**\n     * A utility function to generate bindings between a input field and cell/metadata\n     * @method utils.input_ui_generator\n     * @static\n     *\n     * @param name {string} Label in front of the input field\n     * @param setter {function( cell, newValue )}\n     *        A setter method to set the newValue\n     * @param getter {function( cell )}\n     *        A getter methods which return the current value.\n     *\n     * @return callback {function( div, cell )} Callback to be passed to `register_callback`\n     *\n     */\n    CellToolbar.utils.input_ui_generator = function(name, setter, getter){\n        return function(div, cell, celltoolbar) {\n            var button_container = $(div);\n\n            var text = $('<input/>').attr('type', 'text');\n            var lbl = $('<label/>').append($('<span/>').text(name));\n            text.attr(\"value\", getter(cell));\n\n            text.keyup(function(){\n                setter(cell, text.val());\n            });\n            button_container.append($('<span/>').append(lbl).append(text));\n            IPython.keyboard_manager.register_events(text);\n        };\n    };\n\n    /**\n     * A utility function to generate bindings between a dropdown list cell\n     * @method utils.select_ui_generator\n     * @static\n     *\n     * @param list_list {list_of_sublist} List of sublist of metadata value and name in the dropdown list.\n     *        subslit should contain 2 element each, first a string that woul be displayed in the dropdown list,\n     *        and second the corresponding value to  be passed to setter/return by getter. the corresponding value\n     *        should not be \"undefined\" or behavior can be unexpected.\n     * @param setter {function( cell, newValue )}\n     *        A setter method to set the newValue\n     * @param getter {function( cell )}\n     *        A getter methods which return the current value of the metadata.\n     * @param [label=\"\"] {String} optional label for the dropdown menu\n     *\n     * @return callback {function( div, cell )} Callback to be passed to `register_callback`\n     *\n     * @example\n     *\n     *      var select_type = CellToolbar.utils.select_ui_generator([\n     *              [\"<None>\"       , \"None\"      ],\n     *              [\"Header Slide\" , \"header_slide\" ],\n     *              [\"Slide\"        , \"slide\"        ],\n     *              [\"Fragment\"     , \"fragment\"     ],\n     *              [\"Skip\"         , \"skip\"         ],\n     *              ],\n     *              // setter\n     *              function(cell, value){\n     *                  // we check that the slideshow namespace exist and create it if needed\n     *                  if (cell.metadata.slideshow == undefined){cell.metadata.slideshow = {}}\n     *                  // set the value\n     *                  cell.metadata.slideshow.slide_type = value\n     *                  },\n     *              // getter\n     *              function(cell){ var ns = cell.metadata.slideshow;\n     *                  // if the slideshow namespace does not exist return `undefined`\n     *                  // (will be interpreted as `false` by checkbox) otherwise\n     *                  // return the value\n     *                  return (ns == undefined)? undefined: ns.slide_type\n     *                  }\n     *      CellToolbar.register_callback('slideshow.select', select_type);\n     *\n     */\n    CellToolbar.utils.select_ui_generator = function(list_list, setter, getter, label) {\n        label = label || \"\";\n        return function(div, cell, celltoolbar) {\n            var button_container = $(div);\n            var lbl = $(\"<label/>\").append($('<span/>').text(label));\n            var select = $('<select/>');\n            if(!cell.is_editable()){\n                select.attr(\"disabled\",\"disabled\")\n            }\n            for(var i=0; i < list_list.length; i++){\n                var opt = $('<option/>')\n                    .attr('value', list_list[i][1])\n                    .text(list_list[i][0]);\n                select.append(opt);\n            }\n            select.val(getter(cell));\n            select.change(function(){\n                        setter(cell, select.val());\n                    });\n            button_container.append($('<span/>').append(lbl).append(select));\n        };\n    };\n\n    // Backwards compatibility.\n    IPython.CellToolbar = CellToolbar;\n\n    return {'CellToolbar': CellToolbar};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'notebook/js/celltoolbar',\n    'base/js/dialog',\n    'base/js/i18n'\n], function($, celltoolbar, dialog, i18n) {\n    \"use strict\";\n\n    var CellToolbar = celltoolbar.CellToolbar;\n\n    var edit_attachments_dialog = function(cell) {\n        dialog.edit_attachments({\n          attachments: cell.attachments,\n          callback: function(attachments) {\n            cell.attachments = attachments;\n            // Force cell refresh\n            cell.unrender();\n            cell.render();\n          },\n          name: 'Cell',\n          notebook: cell.notebook,\n          keyboard_manager: cell.keyboard_manager\n        });\n    };\n\n    var add_dialog_button = function(div, cell) {\n        var button_container = $(div);\n        var button = $('<button />')\n            .addClass('btn btn-default btn-xs')\n            .text(i18n.msg._('Edit Attachments'))\n            .click( function() {\n              edit_attachments_dialog(cell);\n              return false;\n            });\n        button_container.append(button);\n    };\n\n    var register = function(notebook) {\n      CellToolbar.register_callback('attachments.edit', add_dialog_button);\n\n      var attachments_preset = [];\n      attachments_preset.push('attachments.edit');\n\n      CellToolbar.register_preset(i18n.msg._('Attachments'), attachments_preset, notebook);\n\n    };\n    return {'register' : register};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'notebook/js/celltoolbar',\n    'base/js/dialog',\n    'base/js/i18n'\n], function($, celltoolbar, dialog, i18n) {\n    \"use strict\";\n\n    var CellToolbar = celltoolbar.CellToolbar;\n\n    var raw_edit = function (cell , edit_metadata_button) {\n        dialog.edit_metadata({\n            md: cell.metadata,\n            callback: function (md) {\n                cell.metadata = md;\n            },\n            name: i18n.msg._('Cell'),\n            notebook: this.notebook,\n            keyboard_manager: this.keyboard_manager,\n            edit_metadata_button: edit_metadata_button\n        });\n    };\n\n    var add_raw_edit_button = function(div, cell) {\n        var button_container = $(div);\n        var button = $('<button/>')\n            .addClass(\"btn btn-default btn-xs\")\n            .text(i18n.msg._(\"Edit Metadata\"))\n            .click( function () {\n                raw_edit(cell, this);\n                return false;\n            });\n\n        button_container.append(button);\n    };\n\n    var register = function (notebook) {\n        CellToolbar.register_callback('default.rawedit', add_raw_edit_button);\n        raw_edit = $.proxy(raw_edit, {\n            notebook: notebook,\n            keyboard_manager: notebook.keyboard_manager\n        });\n\n        var example_preset = [];\n        example_preset.push('default.rawedit');\n\n        CellToolbar.register_preset(i18n.msg._('Edit Metadata'), example_preset, notebook);\n    };\n    return {'register': register};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'notebook/js/celltoolbar',\n    'base/js/dialog',\n    'base/js/keyboard',\n    'base/js/i18n'\n], function($, celltoolbar, dialog, keyboard, i18n) {\n    \"use strict\";\n\n  var CellToolbar = celltoolbar.CellToolbar;\n  var raw_cell_preset = [];\n\n  var select_type = CellToolbar.utils.select_ui_generator([\n    [i18n.msg._(\"None\"), \"-\"],\n    [\"LaTeX\", \"text/latex\"],\n    [\"reST\", \"text/restructuredtext\"],\n    [\"HTML\", \"text/html\"],\n    [\"Markdown\", \"text/markdown\"],\n    [\"Python\", \"text/x-python\"],\n    [i18n.msg._(\"Custom\"), \"dialog\"],\n\n    ],\n      // setter\n      function(cell, value) {\n        if (value === \"-\") {\n          delete cell.metadata.raw_mimetype;\n        } else if (value === 'dialog'){\n            var dialog = $('<div/>').append(\n                $(\"<p/>\")\n                    .text(i18n.msg._(\"Set the MIME type of the raw cell:\"))\n            ).append(\n                $(\"<br/>\")\n            ).append(\n                $('<input/>').attr('type','text').attr('size','25')\n                .val(cell.metadata.raw_mimetype || \"-\")\n            );\n            dialog.modal({\n                title: i18n.msg._(\"Raw Cell MIME Type\"),\n                body: dialog,\n                buttons : {\n                    \"Cancel\": {},\n                    \"OK\": {\n                        class: \"btn-primary\",\n                        click: function () {\n                            console.log(cell);\n                            cell.metadata.raw_mimetype = $(this).find('input').val();\n                            console.log(cell.metadata);\n                        }\n                    }\n                },\n                open : function (event, ui) {\n                    var that = $(this);\n                    // Upon ENTER, click the OK button.\n                    that.find('input[type=\"text\"]').keydown(function (event, ui) {\n                        if (event.which === keyboard.keycodes.enter) {\n                            that.find('.btn-primary').first().click();\n                            return false;\n                        }\n                    });\n                    that.find('input[type=\"text\"]').focus().select();\n                }\n            });\n        } else {\n          cell.metadata.raw_mimetype = value;\n        }\n      },\n      //getter\n      function(cell) {\n        return cell.metadata.raw_mimetype || \"\";\n      },\n      // name\n      i18n.msg._(\"Raw NBConvert Format\")\n  );\n\n  var register = function (notebook) {\n    CellToolbar.register_callback('raw_cell.select', select_type, ['raw']);\n    raw_cell_preset.push('raw_cell.select');\n\n    CellToolbar.register_preset(i18n.msg._('Raw Cell Format'), raw_cell_preset, notebook);\n  };\n  return {'register': register};\n\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'notebook/js/celltoolbar',\n    'base/js/i18n'\n], function(celltoolbar, i18n) {\n    \"use strict\";\n\n    var CellToolbar = celltoolbar.CellToolbar;\n    var slideshow_preset = [];\n\n    var select_type = CellToolbar.utils.select_ui_generator([\n            [\"-\"            ,\"-\"            ],\n            [i18n.msg._(\"Slide\")        ,\"slide\"        ],\n            [i18n.msg._(\"Sub-Slide\")    ,\"subslide\"     ],\n            [i18n.msg._(\"Fragment\")     ,\"fragment\"     ],\n            [i18n.msg._(\"Skip\")         ,\"skip\"         ],\n            [i18n.msg._(\"Notes\")        ,\"notes\"        ],\n            ],\n            // setter\n            function(cell, value){\n                // we check that the slideshow namespace exist and create it if needed\n                if (cell.metadata.slideshow === undefined){cell.metadata.slideshow = {};}\n                // set the value\n                cell.metadata.slideshow.slide_type = value;\n                },\n            // getter\n            function(cell){ var ns = cell.metadata.slideshow;\n                // if the slideshow namespace does not exist return `undefined`\n                // (will be interpreted as `false` by checkbox) otherwise\n                // return the value\n                return (ns === undefined)? undefined: ns.slide_type;\n                },\n            i18n.msg._(\"Slide Type\"));\n\n    var register = function (notebook) {\n        CellToolbar.register_callback('slideshow.select',select_type);\n        slideshow_preset.push('slideshow.select');\n\n        CellToolbar.register_preset(i18n.msg._('Slideshow'),slideshow_preset, notebook);\n    };\n    return {'register': register};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'notebook/js/celltoolbar',\n    'base/js/dialog',\n    'base/js/i18n'\n], function($, celltoolbar, dialog, i18n) {\n    \"use strict\";\n\n    var CellToolbar = celltoolbar.CellToolbar;\n\n    var array_difference = function(a, b) {\n        return a.filter(function(n) {\n            return b.indexOf(n) === -1;\n        });\n    };\n\n    var write_tag = function(cell, name, add) {\n        if (add) {\n            // Add to metadata\n            if (cell.metadata.tags === undefined) {\n                cell.metadata.tags = [];\n            } else if (cell.metadata.tags.indexOf(name) !== -1) {\n                // Tag already exists\n                return false;\n            }\n            cell.metadata.tags.push(name);\n        } else {\n            // Remove from metadata\n            if (!cell.metadata || !cell.metadata.tags) {\n                // No tags to remove\n                return false;\n            }\n            // Remove tag from tags list\n            var index = cell.metadata.tags.indexOf(name);\n            if (index !== -1) {\n                cell.metadata.tags.splice(index, 1);\n            }\n            // If tags list is empty, remove it\n            if (cell.metadata.tags.length === 0) {\n                delete cell.metadata.tags;\n            }\n        }\n        cell.events.trigger('set_dirty.Notebook', {value: true});\n        return true;\n    };\n\n    var preprocess_input = function(input) {\n        // Split on whitespace + commas:\n        return input.split(/[,\\s]+/)\n    };\n\n    var add_tag = function(cell, tag_container, on_remove) {\n        return function(name) {\n            if (name === '') {\n                // Skip empty strings\n                return;\n            }\n            // Write tag to metadata\n            var changed = write_tag(cell, name, true);\n\n            if (changed) {\n                // Make tag UI\n                var tag = make_tag(name, on_remove, cell.is_editable());\n                tag_container.append(tag);\n                var tag_map = jQuery.data(tag_container, \"tag_map\") || {};\n                tag_map[name] = tag;\n                jQuery.data(tag_container, 'tag_map', tag_map);\n            }\n        };\n    };\n\n    var remove_tag = function(cell, tag_container) {\n        return function(name) {\n            var changed = write_tag(cell, name, false);\n            if (changed) {\n                // Remove tag UI\n                var tag_map = jQuery.data(tag_container, \"tag_map\") || {};\n                var tag_UI = tag_map[name];\n                delete tag_map[name];\n                tag_UI.remove();\n            }\n        };\n    };\n\n    var init_tag_container = function(cell, tag_container, on_remove) {    \n        var tag_list = cell.metadata.tags || [];\n        if (!Array.isArray(tag_list)) {\n            // We cannot make tags UI for this cell!\n            // Maybe someone else used \"tags\" for something?\n            return false;  // Fail gracefully\n        }\n\n        var tag_map = {};\n        for (var i=0; i < tag_list.length; ++i) {\n            var tag_name = tag_list[i];\n            if (typeof tag_name !== 'string') {\n                // Unexpected type, disable toolbar for safety\n                return false;\n            }\n            var tag = make_tag(tag_name, on_remove, cell.is_editable());\n            tag_container.append(tag);\n            tag_map[tag_name] = tag;\n        }\n        jQuery.data(tag_container, 'tag_map', tag_map);\n        return true;\n    };\n\n    var make_tag = function(name, on_remove, is_editable) {\n        var tag_UI = $('<span/>')\n            .addClass('cell-tag')\n            .text(name);\n\n        if(is_editable){\n            var remove_button = $('<i/>')\n                .addClass('remove-tag-btn')\n                .addClass('fa fa-times')\n                .click(function () {\n                    on_remove(name);\n                    return false;\n                });\n            tag_UI.append(remove_button);\n        }\n        return tag_UI;\n    };\n\n    // Single edit with button to add tags\n    var add_tag_edit = function(div, cell, on_add, on_remove) {\n        var button_container = $(div);\n\n        var text = $('<input/>').attr('type', 'text');\n        var button = $('<button />')\n            .addClass('btn btn-default btn-xs')\n            .text(i18n.msg._('Add tag'))\n            .click(function() {\n                var tags = preprocess_input(text[0].value);\n                for (var i=0; i < tags.length; ++i) {\n                    on_add(tags[i]);\n                }\n                // Clear input after adding:\n                text[0].value = '';\n                return false;\n            });\n        // Wire enter in input to button click\n        text.keyup(function(event){\n            if(event.keyCode == 13){\n                button.click();\n            }\n        });\n        var input_container = $('<span/>')\n            .addClass('tags-input');\n        add_dialog_button(input_container, cell, on_add, on_remove);\n        button_container.append(input_container\n                .append(text)\n                .append(button)\n            );\n        IPython.keyboard_manager.register_events(text);\n    };\n\n    var tag_dialog = function(cell, on_add, on_remove) {\n        var tag_list = cell.metadata.tags || [];\n\n        var message =\n            i18n.msg._(\"Edit the list of tags below. All whitespace \" +\n            \"is treated as tag separators.\");\n\n        var textarea = $('<textarea/>')\n            .attr('aria-label', i18n.msg._('Edit the tags in the text area'))\n            .attr('rows', '13')\n            .attr('cols', '80')\n            .attr('name', 'tags')\n            .text(tag_list.join('\\n'));\n\n        var dialogform = $('<div/>').attr('title', i18n.msg._('Edit the tags'))\n            .append(\n                $('<form/>').append(\n                    $('<fieldset/>').append(\n                        $('<label/>')\n                        .attr('for','tags')\n                        .text(message)\n                        )\n                    .append($('<br/>'))\n                    .append(textarea)\n                    )\n            );\n\n        var modal_obj = dialog.modal({\n            title: i18n.msg._(\"Edit Tags\"),\n            body: dialogform,\n            default_button: \"Cancel\",\n            buttons: {\n                Cancel: {},\n                Edit: { class : \"btn-primary\",\n                    click: function() {\n                        var old_tags = cell.metadata.tags || [];\n                        var new_tags = preprocess_input(textarea[0].value);\n                        var added_tags = array_difference(new_tags, old_tags);\n                        var removed_tags = array_difference(old_tags, new_tags);\n                        for (var i=0; i < added_tags.length; ++i) {\n                            on_add(added_tags[i]);\n                        }\n                        for (var i=0; i < removed_tags.length; ++i) {\n                            on_remove(removed_tags[i]);\n                        }\n                    }\n                }\n            },\n            notebook: cell.notebook,\n            keyboard_manager: cell.keyboard_manager,\n        });\n    };\n\n    var add_dialog_button = function(container, cell, on_add, on_remove) {\n        var button = $('<button />')\n            .addClass('btn btn-default btn-xs tags-dialog-btn')\n            .text('...')\n            .click( function() {\n              tag_dialog(cell, on_add, on_remove);\n              return false;\n            });\n        container.append(button);\n    };\n\n    var add_tags_cellbar = function(div, cell) {\n        var button_container = $(div);\n\n        button_container.addClass('tags_button_container');\n\n        var tag_container = $('<span/>').\n            addClass('tag-container');\n        var on_remove = remove_tag(cell, tag_container);\n        var ok = init_tag_container(cell, tag_container, on_remove);\n        if (!ok) {\n            return;\n        }\n        button_container.append(tag_container);\n\n        var on_add = add_tag(cell, tag_container, on_remove);\n        if(cell.is_editable()){\n            add_tag_edit(div, cell, on_add, on_remove);\n        }\n    };\n\n    var register = function(notebook) {\n      CellToolbar.register_callback('tags.edit', add_tags_cellbar);\n\n      var tags_preset = [];\n      tags_preset.push('tags.edit');\n\n      CellToolbar.register_preset('Tags', tags_preset, notebook);\n\n    };\n    return {'register' : register};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/namespace',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/dialog'\n], function($, Jupyter, utils, i18n, dialog) {\n\nvar jcbprefix = '<pre class=\"jupyter-nb-cells-json\">';\nvar jcbsuffix = '</pre>';\n\nfunction store_json(cells, clipboard) {\n  // Firefox ignores application/json mime type, so put it in HTML as well.\n  // We also copy a text version so you can paste cell sources into a text editor\n  var j = JSON.stringify(cells);\n  var t = cells.map(function(c) {return c.source;}).join('\\n\\n');\n  clipboard.setData('text/plain', t);\n  clipboard.setData('text/html', jcbprefix + j + jcbsuffix);\n  clipboard.setData('application/json', j);\n}\n\nfunction load_json(clipboard) {\n  var s = clipboard.getData('text/html');\n  // System/browsers may add some more stuff before/after our content, so\n  // find where our prefix and suffix are.\n  var pix = s.indexOf(jcbprefix);\n  var six = s.lastIndexOf(jcbsuffix);\n  if (pix === -1 || six === -1) {\n    return null;\n  }\n  return JSON.parse(s.slice(pix + jcbprefix.length, six));\n}\n\nfunction isProgrammaticCopy(event) {\n  return (typeof(event.target.selectionStart) !== 'undefined'\n    && typeof(event.target.selectionEnd) !== 'undefined'\n    && ((event.target.selectionEnd - event.target.selectionStart) > 0));\n}\n\nfunction copy(event) {\n  if ((Jupyter.notebook.mode !== 'command') ||\n        // window.getSelection checks if text is selected, e.g. in output\n        !window.getSelection().isCollapsed ||\n        // Allow programmatic copy\n        isProgrammaticCopy(event)) {\n    return;\n  }\n  var selecn = Jupyter.notebook.get_selected_cells().map(\n    function(c) { return c.toJSON();});\n  store_json(selecn, event.clipboardData);\n  event.preventDefault();\n}\n\nfunction paste(event) {\n  if (Jupyter.notebook.mode !== 'command') {\n    return;\n  }\n  console.log(i18n.msg.sprintf(i18n.msg._('Clipboard types: %s'),event.clipboardData.types));\n  cells = load_json(event.clipboardData);\n  // console.log(cells);\n  // Does this JSON look like cells?\n  if (Array.isArray(cells) && (cells.length > 0) &&\n      cells[0].cell_type && cells[0].source) {\n    var first_inserted = null;\n    for (var i=0; i < cells.length; i++) {\n        var cell_data = cells[i];\n        var new_cell = Jupyter.notebook.insert_cell_above(cell_data.cell_type);\n        new_cell.fromJSON(cell_data);\n        if (first_inserted === null) {\n            first_inserted = new_cell;\n        }\n    }\n    first_inserted.focus_cell();\n  }\n  event.preventDefault();\n}\n\nfunction notebookOnlyEvent(callback) {\n    // Only call the callback to redirect the event if the notebook should be\n    // handling the events, at the discretion of the keyboard manager.\n    // If the focus is in a text widget or something (kbmanager disabled),\n    // allow the default event.\n    return function() {\n        if (Jupyter.keyboard_manager.enabled) {\n            callback.apply(this, arguments);\n        }\n    };\n}\n\nfunction needs_text_box_for_paste_event() {\n  // I know this is bad, but I don't know a better way to check this\n  return navigator.userAgent.indexOf('Firefox') !== -1;\n}\n\nfunction setup_paste_dialog() {\n  // Firefox only fires a paste event if the cursor is in a text input. So, on\n  // Ctrl-V, bring up a dialog with an invisible text box and catch the\n  // second Ctrl-V\n  var action = {\n      icon: 'fa-clipboard', // a font-awesome class used on buttons, etc\n      help    : i18n.msg._('Dialog for paste from system clipboard'),\n      help_index : 'zz',\n      handler : function () {\n        var entry_box = $('<input type=\"text\"/>');\n        entry_box.css('opacity', 0);\n        function paste_close_dlg(e) {\n          paste(e);\n          // There must be a better way to do this, but it's not any of:\n          // .hide(), .remove() or .dialog('close')\n          paste_dlg.find('.close').click();\n          document.removeEventListener('paste', paste_close_dlg);\n        }\n        document.addEventListener('paste', paste_close_dlg);\n        var cmdtrl = i18n.msg._('Ctrl-V');\n        if (utils.platform === 'MacOS') {\n            cmdtrl = i18n.msg._('Cmd-V');\n        }\n        var dialog_body = $(\"<div/>\").append(\"<p>\").append(i18n.msg.sprintf(i18n.msg._(\"Press %s again to paste\"),cmdtrl))\n            .append(\"<br/>\")\n            .append(\"<p><b>\")\n            .append(i18n.msg._(\"Why is this needed? \"))\n            .append(\"</b>\")\n            .append(i18n.msg._(\"We can't get paste events in this browser without a text box. \"))\n            .append(i18n.msg._(\"There's an invisible text box focused in this dialog.\"))\n            .append($(\"<form/>\").append(entry_box));\n\n        var paste_dlg = dialog.modal({\n            notebook: Jupyter.notebook,\n            keyboard_manager: Jupyter.keyboard_manager,\n            title : i18n.msg.sprintf(i18n.msg._(\"%s to paste\"),cmdtrl),\n            body : dialog_body,\n            open: function() {\n                entry_box.focus();\n            },\n            buttons : {\n                \"Cancel\" : {\n                    // click : function() { reject(\"Dialog cancelled\"); },\n                }\n            }\n        });\n      }\n  };\n  var full_action_name = Jupyter.actions.register(action, 'paste-dialog', 'system-clipboard');\n  Jupyter.keyboard_manager.command_shortcuts.add_shortcut('Cmdtrl-V', full_action_name);\n}\n\n// Set clipboard event listeners on the document.\nreturn {setup_clipboard_events: function() {\n  document.addEventListener('copy', notebookOnlyEvent(copy));\n  if (needs_text_box_for_paste_event()) {\n    setup_paste_dialog();\n  } else {\n    document.addEventListener('paste', notebookOnlyEvent(paste));\n  }\n}};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n/**\n *\n *\n * @module codecell\n * @namespace codecell\n * @class CodeCell\n */\n\n\ndefine([\n    'jquery',\n    'base/js/namespace',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/keyboard',\n    'services/config',\n    'notebook/js/cell',\n    'notebook/js/outputarea',\n    'notebook/js/completer',\n    'notebook/js/celltoolbar',\n    'codemirror/lib/codemirror',\n    'codemirror/mode/python/python',\n    'notebook/js/codemirror-ipython'\n], function(\n    $,\n    IPython,\n    utils,\n    i18n,\n    keyboard,\n    configmod,\n    cell,\n    outputarea,\n    completer,\n    celltoolbar,\n    CodeMirror,\n    cmpython,\n    cmip\n    ) {\n    \"use strict\";\n    \n    var Cell = cell.Cell;\n\n    /* local util for codemirror */\n    var posEq = function(a, b) {return a.line === b.line && a.ch === b.ch;};\n\n    /**\n     *\n     * function to delete until previous non blanking space character\n     * or first multiple of 4 tabstop.\n     * @private\n     */\n    CodeMirror.commands.delSpaceToPrevTabStop = function(cm){\n        var from = cm.getCursor(true), to = cm.getCursor(false), sel = !posEq(from, to);\n         if (sel) {\n            var ranges = cm.listSelections();\n            for (var i = ranges.length - 1; i >= 0; i--) {\n                var head = ranges[i].head;\n                var anchor = ranges[i].anchor;\n                cm.replaceRange(\"\", CodeMirror.Pos(head.line, head.ch), CodeMirror.Pos(anchor.line, anchor.ch));\n            }\n            return;\n        }\n        var cur = cm.getCursor(), line = cm.getLine(cur.line);\n        var tabsize = cm.getOption('tabSize');\n        var chToPrevTabStop = cur.ch-(Math.ceil(cur.ch/tabsize)-1)*tabsize;\n        from = {ch:cur.ch-chToPrevTabStop,line:cur.line};\n        var select = cm.getRange(from,cur);\n        if( select.match(/^\\ +$/) !== null){\n            cm.replaceRange(\"\",from,cur);\n        } else {\n            cm.deleteH(-1,\"char\");\n        }\n    };\n\n    var keycodes = keyboard.keycodes;\n\n    var CodeCell = function (kernel, options) {\n        /**\n         * Constructor\n         *\n         * A Cell conceived to write code.\n         *\n         * Parameters:\n         *  kernel: Kernel instance\n         *      The kernel doesn't have to be set at creation time, in that case\n         *      it will be null and set_kernel has to be called later.\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance \n         *          config: dictionary\n         *          keyboard_manager: KeyboardManager instance \n         *          notebook: Notebook instance\n         *          tooltip: Tooltip instance\n         */\n        this.kernel = kernel || null;\n        this.notebook = options.notebook;\n        this.collapsed = false;\n        this.events = options.events;\n        this.tooltip = options.tooltip;\n        this.config = options.config;\n        this.class_config = new configmod.ConfigWithDefaults(this.config,\n                                        CodeCell.options_default, 'CodeCell');\n\n        // create all attributed in constructor function\n        // even if null for V8 VM optimisation\n        this.input_prompt_number = null;\n        this.celltoolbar = null;\n        this.output_area = null;\n\n        this.last_msg_id = null;\n        this.completer = null;\n\n        Cell.apply(this,[{\n            config: options.config, \n            keyboard_manager: options.keyboard_manager, \n            events: this.events}]);\n\n        // Attributes we want to override in this subclass.\n        this.cell_type = \"code\";\n        var that  = this;\n        this.element.focusout(\n            function() { that.auto_highlight(); }\n        );\n    };\n\n    CodeCell.options_default = {\n        cm_config : {\n            extraKeys: {\n                \"Backspace\" : \"delSpaceToPrevTabStop\",\n            },\n            mode: 'text',\n            theme: 'ipython',\n            matchBrackets: true,\n            autoCloseBrackets: true\n        },\n        highlight_modes : {\n            'magic_javascript'    :{'reg':['^%%javascript']},\n            'magic_perl'          :{'reg':['^%%perl']},\n            'magic_ruby'          :{'reg':['^%%ruby']},\n            'magic_python'        :{'reg':['^%%python3?']},\n            'magic_shell'         :{'reg':['^%%bash']},\n            'magic_r'             :{'reg':['^%%R']},\n            'magic_text/x-cython' :{'reg':['^%%cython']},\n        },\n    };\n\n    CodeCell.msg_cells = {};\n\n    CodeCell.prototype = Object.create(Cell.prototype);\n    \n    /** @method create_element */\n    CodeCell.prototype.create_element = function () {\n        Cell.prototype.create_element.apply(this, arguments);\n        var that = this;\n\n        var cell =  $('<div></div>').addClass('cell code_cell');\n        cell.attr('tabindex','2');\n\n        var input = $('<div></div>').addClass('input');\n        this.input = input;\n\n        var prompt_container = $('<div/>').addClass('prompt_container');\n\n        var run_this_cell = $('<div></div>').addClass('run_this_cell');\n        run_this_cell.prop('title', 'Run this cell');\n        run_this_cell.append('<i class=\"fa-step-forward fa\"></i>');\n        run_this_cell.click(function (event) {\n            event.stopImmediatePropagation();\n            that.execute();\n        });\n\n        var prompt = $('<div/>').addClass('prompt input_prompt');\n        \n        var inner_cell = $('<div/>').addClass('inner_cell');\n        this.celltoolbar = new celltoolbar.CellToolbar({\n            cell: this, \n            notebook: this.notebook});\n        inner_cell.append(this.celltoolbar.element);\n        var input_area = $('<div/>').addClass('input_area').attr(\"aria-label\", i18n.msg._(\"Edit code here\"));\n        this.code_mirror = new CodeMirror(input_area.get(0), this._options.cm_config);\n        // In case of bugs that put the keyboard manager into an inconsistent state,\n        // ensure KM is enabled when CodeMirror is focused:\n        this.code_mirror.on('focus', function () {\n            if (that.keyboard_manager) {\n                that.keyboard_manager.enable();\n            }\n\n            that.code_mirror.setOption('readOnly', !that.is_editable());\n        });\n        this.code_mirror.on('keydown', $.proxy(this.handle_keyevent,this));\n        $(this.code_mirror.getInputField()).attr(\"spellcheck\", \"false\");\n        inner_cell.append(input_area);\n        prompt_container.append(prompt).append(run_this_cell);\n        input.append(prompt_container).append(inner_cell);\n\n        var output = $('<div></div>');\n        cell.append(input).append(output);\n        this.element = cell;\n        this.output_area = new outputarea.OutputArea({\n            config: this.config,\n            selector: output,\n            prompt_area: true,\n            events: this.events,\n            keyboard_manager: this.keyboard_manager,\n        });\n        this.completer = new completer.Completer(this, this.events);\n    };\n\n    /** @method bind_events */\n    CodeCell.prototype.bind_events = function () {\n        Cell.prototype.bind_events.apply(this, arguments);\n        var that = this;\n\n        this.element.focusout(\n            function() { that.auto_highlight(); }\n        );\n\n        this.events.on('kernel_restarting.Kernel', function() {\n            if (that.input_prompt_number === '*') {\n              that.set_input_prompt();\n            }\n        });\n    };\n\n\n    /**\n     *  This method gets called in CodeMirror's onKeyDown/onKeyPress\n     *  handlers and is used to provide custom key handling. Its return\n     *  value is used to determine if CodeMirror should ignore the event:\n     *  true = ignore, false = don't ignore.\n     *  @method handle_codemirror_keyevent\n     */\n\n    CodeCell.prototype.handle_codemirror_keyevent = function (editor, event) {\n\n        var that = this;\n        // whatever key is pressed, first, cancel the tooltip request before\n        // they are sent, and remove tooltip if any, except for tab again\n        var tooltip_closed = null;\n        if (event.type === 'keydown' && event.which !== keycodes.tab ) {\n            tooltip_closed = this.tooltip.remove_and_cancel_tooltip();\n        }\n\n        var cur = editor.getCursor();\n        if (event.keyCode === keycodes.enter){\n            this.auto_highlight();\n        }\n\n        if (event.which === keycodes.down && event.type === 'keypress' && this.tooltip.time_before_tooltip >= 0) {\n            // triger on keypress (!) otherwise inconsistent event.which depending on plateform\n            // browser and keyboard layout !\n            // Pressing '(' , request tooltip, don't forget to reappend it\n            // The second argument says to hide the tooltip if the docstring\n            // is actually empty\n            this.tooltip.pending(that, true);\n        } else if ( tooltip_closed && event.which === keycodes.esc && event.type === 'keydown') {\n            // If tooltip is active, cancel it.  The call to\n            // remove_and_cancel_tooltip above doesn't pass, force=true.\n            // Because of this it won't actually close the tooltip\n            // if it is in sticky mode. Thus, we have to check again if it is open\n            // and close it with force=true.\n            if (!this.tooltip._hidden) {\n                this.tooltip.remove_and_cancel_tooltip(true);\n            }\n            // If we closed the tooltip, don't let CM or the global handlers\n            // handle this event.\n            event.codemirrorIgnore = true;\n            event._ipkmIgnore = true;\n            event.preventDefault();\n            return true;\n        } else if (event.keyCode === keycodes.tab && event.type === 'keydown' && event.shiftKey) {\n                if (editor.somethingSelected() || editor.getSelections().length !== 1){\n                    var anchor = editor.getCursor(\"anchor\");\n                    var head = editor.getCursor(\"head\");\n                    if( anchor.line !== head.line){\n                        return false;\n                    }\n                }\n                var pre_cursor = editor.getRange({line:cur.line,ch:0},cur);\n                if (pre_cursor.trim() === \"\") {\n                    // Don't show tooltip if the part of the line before the cursor\n                    // is empty.  In this case, let CodeMirror handle indentation.\n                    return false;\n                } \n                this.tooltip.request(that);\n                event.codemirrorIgnore = true;\n                event.preventDefault();\n                return true;\n        } else if (event.keyCode === keycodes.tab && event.type === 'keydown') {\n            // Tab completion.\n            this.tooltip.remove_and_cancel_tooltip();\n\n            // completion does not work on multicursor, it might be possible though in some cases\n            if (editor.somethingSelected() || editor.getSelections().length > 1) {\n                return false;\n            }\n            var pre_cursor = editor.getRange({line:cur.line,ch:0},cur);\n            if (pre_cursor.trim() === \"\") {\n                // Don't autocomplete if the part of the line before the cursor\n                // is empty.  In this case, let CodeMirror handle indentation.\n                return false;\n            } else {\n                event.codemirrorIgnore = true;\n                event.preventDefault();\n                this.completer.startCompletion();\n                return true;\n            }\n        } \n        \n        // keyboard event wasn't one of those unique to code cells, let's see\n        // if it's one of the generic ones (i.e. check edit mode shortcuts)\n        return Cell.prototype.handle_codemirror_keyevent.apply(this, [editor, event]);\n    };\n\n    // Kernel related calls.\n\n    CodeCell.prototype.set_kernel = function (kernel) {\n        this.kernel = kernel;\n    };\n\n    /**\n     * Execute current code cell to the kernel\n     * @method execute\n     */\n    CodeCell.prototype.execute = function (stop_on_error) {\n        if (!this.kernel) {\n            console.log(i18n.msg._(\"Can't execute cell since kernel is not set.\"));\n            return;\n        }\n\n        if (stop_on_error === undefined) {\n            if (this.metadata !== undefined && \n                    this.metadata.tags !== undefined) {\n                if (this.metadata.tags.indexOf('raises-exception') !== -1) {\n                    stop_on_error = false;\n                } else {\n                    stop_on_error = true;\n                }\n            } else {\n               stop_on_error = true;\n            }\n        }\n\n        this.clear_output(false, true);\n        var old_msg_id = this.last_msg_id;\n        if (old_msg_id) {\n            this.kernel.clear_callbacks_for_msg(old_msg_id);\n            delete CodeCell.msg_cells[old_msg_id];\n            this.last_msg_id = null;\n        }\n        if (this.get_text().trim().length === 0) {\n            // nothing to do\n            this.set_input_prompt(null);\n            return;\n        }\n        this.set_input_prompt('*');\n        this.element.addClass(\"running\");\n        var callbacks = this.get_callbacks();\n        \n        this.last_msg_id = this.kernel.execute(this.get_text(), callbacks, {silent: false, store_history: true,\n            stop_on_error : stop_on_error});\n        CodeCell.msg_cells[this.last_msg_id] = this;\n        this.render();\n        this.events.trigger('execute.CodeCell', {cell: this});\n        var that = this;\n        function handleFinished(evt, data) {\n            if (that.kernel.id === data.kernel.id && that.last_msg_id === data.msg_id) {\n                    that.events.trigger('finished_execute.CodeCell', {cell: that});\n                that.events.off('finished_iopub.Kernel', handleFinished);\n              }\n        }\n        this.events.on('finished_iopub.Kernel', handleFinished);\n    };\n    \n    /**\n     * Construct the default callbacks for\n     * @method get_callbacks\n     */\n    CodeCell.prototype.get_callbacks = function () {\n        var that = this;\n        return {\n            clear_on_done: false,\n            shell : {\n                reply : $.proxy(this._handle_execute_reply, this),\n                payload : {\n                    set_next_input : $.proxy(this._handle_set_next_input, this),\n                    page : $.proxy(this._open_with_pager, this)\n                }\n            },\n            iopub : {\n                output : function() { \n                    that.events.trigger('set_dirty.Notebook', {value: true});\n                    that.output_area.handle_output.apply(that.output_area, arguments);\n                }, \n                clear_output : function() { \n                    that.events.trigger('set_dirty.Notebook', {value: true});\n                    that.output_area.handle_clear_output.apply(that.output_area, arguments);\n                }, \n            },\n            input : $.proxy(this._handle_input_request, this),\n        };\n    };\n    \n    CodeCell.prototype._open_with_pager = function (payload) {\n        this.events.trigger('open_with_text.Pager', payload);\n    };\n\n    /**\n     * @method _handle_execute_reply\n     * @private\n     */\n    CodeCell.prototype._handle_execute_reply = function (msg) {\n        this.set_input_prompt(msg.content.execution_count);\n        this.element.removeClass(\"running\");\n        this.events.trigger('set_dirty.Notebook', {value: true});\n    };\n\n    /**\n     * @method _handle_set_next_input\n     * @private\n     */\n    CodeCell.prototype._handle_set_next_input = function (payload) {\n        var data = {\n            cell: this,\n            text: payload.text,\n            replace: payload.replace,\n            clear_output: payload.clear_output,\n        };\n        this.events.trigger('set_next_input.Notebook', data);\n    };\n\n    /**\n     * @method _handle_input_request\n     * @private\n     */\n    CodeCell.prototype._handle_input_request = function (msg) {\n        this.output_area.append_raw_input(msg);\n    };\n\n\n    // Basic cell manipulation.\n\n    CodeCell.prototype.select = function () {\n        var cont = Cell.prototype.select.apply(this, arguments);\n        if (cont) {\n            this.code_mirror.refresh();\n            this.auto_highlight();\n        }\n        return cont;\n    };\n\n    CodeCell.prototype.render = function () {\n        var cont = Cell.prototype.render.apply(this, arguments);\n        // Always execute, even if we are already in the rendered state\n        return cont;\n    };\n    \n    CodeCell.prototype.select_all = function () {\n        var start = {line: 0, ch: 0};\n        var nlines = this.code_mirror.lineCount();\n        var last_line = this.code_mirror.getLine(nlines-1);\n        var end = {line: nlines-1, ch: last_line.length};\n        this.code_mirror.setSelection(start, end);\n    };\n\n\n    CodeCell.prototype.collapse_output = function () {\n        this.output_area.collapse();\n    };\n\n\n    CodeCell.prototype.expand_output = function () {\n        this.output_area.expand();\n        this.output_area.unscroll_area();\n    };\n\n    CodeCell.prototype.scroll_output = function () {\n        this.output_area.expand();\n        this.output_area.scroll_if_long();\n    };\n\n    CodeCell.prototype.toggle_output = function () {\n        this.output_area.toggle_output();\n    };\n\n    CodeCell.prototype.toggle_output_scroll = function () {\n        this.output_area.toggle_scroll();\n    };\n\n\n    CodeCell.input_prompt_classical = function (prompt_value, lines_number) {\n        var ns;\n        if (prompt_value === undefined || prompt_value === null) {\n            ns = \"&nbsp;\";\n        } else {\n            ns = encodeURIComponent(prompt_value);\n        }\n        return '<bdi>'+i18n.msg._('In')+'</bdi>[' + ns + ']:';\n    };\n\n    CodeCell.input_prompt_continuation = function (prompt_value, lines_number) {\n        var html = [CodeCell.input_prompt_classical(prompt_value, lines_number)];\n        for(var i=1; i < lines_number; i++) {\n            html.push(['...:']);\n        }\n        return html.join('<br/>');\n    };\n\n    CodeCell.input_prompt_function = CodeCell.input_prompt_classical;\n\n\n    CodeCell.prototype.set_input_prompt = function (number) {\n        var nline = 1;\n        if (this.code_mirror !== undefined) {\n           nline = this.code_mirror.lineCount();\n        }\n        this.input_prompt_number = number;\n        var prompt_html = CodeCell.input_prompt_function(this.input_prompt_number, nline);\n\n        // This HTML call is okay because the user contents are escaped.\n        this.element.find('div.input_prompt').html(prompt_html);\n        this.events.trigger('set_dirty.Notebook', {value: true});\n    };\n\n\n    CodeCell.prototype.clear_input = function () {\n        this.code_mirror.setValue('');\n    };\n\n\n    CodeCell.prototype.get_text = function () {\n        return this.code_mirror.getValue();\n    };\n\n\n    CodeCell.prototype.set_text = function (code) {\n        return this.code_mirror.setValue(code);\n    };\n\n\n    CodeCell.prototype.clear_output = function (wait, ignore_queue) {\n        this.events.trigger('clear_output.CodeCell', {cell: this});\n        this.output_area.clear_output(wait, ignore_queue);\n        this.set_input_prompt();\n    };\n\n\n    // JSON serialization\n\n    CodeCell.prototype.fromJSON = function (data) {\n        Cell.prototype.fromJSON.apply(this, arguments);\n        if (data.cell_type === 'code') {\n            if (data.source !== undefined) {\n                // [Basthon]\n                /* conditional added by Basthon to fix source as array issue */\n                if( Array.isArray(data.source) ) {\n                    data.source = data.source.join(\"\");\n                }\n                this.set_text(data.source);\n\n                // make this value the starting point, so that we can only undo\n                // to this state, instead of a blank cell\n                this.code_mirror.clearHistory();\n                this.auto_highlight();\n            }\n            this.set_input_prompt(data.execution_count);\n            // [Basthon] force output (execute_result and display_data) to be untrusted.\n            // This prevents JS code execution.\n            // this.output_area.trusted = data.metadata.trusted || false;\n            this.output_area.trusted = false;\n            this.output_area.fromJSON(data.outputs, data.metadata);\n        }\n    };\n\n\n    CodeCell.prototype.toJSON = function () {\n        var data = Cell.prototype.toJSON.apply(this);\n        data.source = this.get_text();\n        // is finite protect against undefined and '*' value\n        if (isFinite(this.input_prompt_number)) {\n            data.execution_count = this.input_prompt_number;\n        } else {\n            data.execution_count = null;\n        }\n        var outputs = this.output_area.toJSON();\n        data.outputs = outputs;\n        data.metadata.trusted = this.output_area.trusted;\n        if (this.output_area.collapsed) {\n            data.metadata.collapsed = this.output_area.collapsed;\n        } else {\n            delete data.metadata.collapsed;\n        }\n        if (this.output_area.scroll_state === 'auto') {\n            delete data.metadata.scrolled;\n        } else {\n            data.metadata.scrolled = this.output_area.scroll_state;\n        }\n        return data;\n    };\n\n    /**\n     * handle cell level logic when the cell is unselected\n     * @method unselect\n     * @return is the action being taken\n     */\n    CodeCell.prototype.unselect = function() {\n        var cont = Cell.prototype.unselect.apply(this, arguments);\n        if (cont) {\n            // When a code cell is unselected, make sure that the corresponding\n            // tooltip and completer to that cell is closed.\n            this.tooltip.remove_and_cancel_tooltip(true);\n            if (this.completer !== null) {\n                this.completer.close();\n            }\n        }\n        return cont;\n    };\n\n    // Backwards compatibility.\n    IPython.CodeCell = CodeCell;\n\n    return {'CodeCell': CodeCell};\n});\n","// IPython mode is just a slightly altered Python Mode with `?` beeing a extra\n// single operator. Here we define `ipython` mode in the require `python`\n// callback to auto-load python mode, which is more likely not the best things\n// to do, but at least the simple one for now.\n\ndefine(\n    [\"codemirror/lib/codemirror\",\n     \"codemirror/mode/python/python\"],\n    function(CodeMirror) {\n    \"use strict\";\n\n    CodeMirror.defineMode(\"ipython\", function(conf, parserConf) {\n        var pythonConf = {};\n        for (var prop in parserConf) {\n            if (parserConf.hasOwnProperty(prop)) {\n                pythonConf[prop] = parserConf[prop];\n            }\n        }\n        pythonConf.name = 'python';\n        pythonConf.singleOperators = new RegExp(\"^[\\\\+\\\\-\\\\*/%&|@\\\\^~<>!\\\\?]\");\n        if (pythonConf.version === 3) {\n            pythonConf.identifiers = new RegExp(\"^[_A-Za-z\\u00A1-\\uFFFF][_A-Za-z0-9\\u00A1-\\uFFFF]*\");\n        } else if (pythonConf.version === 2) {\n            pythonConf.identifiers = new RegExp(\"^[_A-Za-z][_A-Za-z0-9]*\");\n        }\n        return CodeMirror.getMode(conf, pythonConf);\n    }, 'python');\n\n    CodeMirror.defineMIME(\"text/x-ipython\", \"ipython\");\n    }\n);\n","// IPython GFM (GitHub Flavored Markdown) mode is just a slightly altered GFM\n// Mode with support for latex.\n//\n// Latex support was supported by Codemirror GFM as of\n//   https://github.com/codemirror/CodeMirror/pull/567\n// But was later removed in\n//   https://github.com/codemirror/CodeMirror/commit/d9c9f1b1ffe984aee41307f3e927f80d1f23590c\n\ndefine(\n    [\"codemirror/lib/codemirror\"\n     ,\"codemirror/addon/mode/multiplex\"\n     ,\"codemirror/mode/python/python\"\n     ,\"codemirror/mode/stex/stex\"\n    ],\n    function(CodeMirror){\n        \"use strict\";\n        \n    CodeMirror.defineMode(\"ipythongfm\", function(config, parserConfig) {\n\n        var gfm_mode = CodeMirror.getMode(config, \"gfm\");\n        var tex_mode = CodeMirror.getMode(config, \"stex\");\n\n        return CodeMirror.multiplexingMode(\n            gfm_mode,\n            // By defining the $$ delimiter before the $ delimiter we don't run\n            // into the problem that $$ is interpreted as two consecutive $.\n            {\n                open: \"$$\", close: \"$$\",\n                mode: tex_mode,\n                delimStyle: \"delimit\"\n            },\n            {\n                open: \"$\", close: \"$\",\n                mode: tex_mode,\n                delimStyle: \"delimit\"\n            },\n            {\n                open: \"\\\\(\", close: \"\\\\)\",\n                mode: tex_mode,\n                delimStyle: \"delimit\"\n            },\n            {\n                open: \"\\\\[\", close: \"\\\\]\",\n                mode: tex_mode,\n                delimStyle: \"delimit\"\n            }\n            // .. more multiplexed styles can follow here\n        );\n    }, 'gfm');\n\n    CodeMirror.defineMIME(\"text/x-ipythongfm\", \"ipythongfm\");\n    }\n);\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'jquery-typeahead',\n    'base/js/i18n',\n    'notebook/js/quickhelp'\n],function($, typeahead, i18n, QH){\n    \"use strict\";\n\n    /**\n     * Humanize the action name to be consumed by user.\n     * internally the actions anem are of the form\n     * <namespace>:<description-with-dashes>\n     * we drop <namespace> and replace dashes for space.\n     */\n    var humanize_action_id = function(str) {\n      return str.split(':')[1].replace(/-/g, ' ').replace(/_/g, '-');\n    };\n\n    /**\n     * given an action id return 'command-shortcut', 'edit-shortcut' or 'no-shortcut'\n     * for the action. This allows us to tag UI in order to visually distinguish\n     * wether an action have a keybinding or not.\n     **/\n    var get_mode_for_action_id = function(name, notebook) {\n      var shortcut = notebook.keyboard_manager.command_shortcuts.get_action_shortcut(name);\n      if (shortcut) {\n        return 'command-shortcut';\n      }\n      shortcut = notebook.keyboard_manager.edit_shortcuts.get_action_shortcut(name);\n      if (shortcut) {\n        return 'edit-shortcut';\n      }\n      return 'no-shortcut';\n    };\n\n    var CommandPalette = function(notebook) {\n        if(!notebook){\n          throw new Error(\"CommandPalette takes a notebook non-null mandatory argument\");\n        }\n\n        // typeahead lib need a specific layout with specific class names.\n        // the following just does that\n        var form = $('<form/>');\n        var container = $('<div/>').addClass('typeahead__container');\n        var field = $('<div/>').addClass('typeahead__field');\n        var input = $('<input/>').attr('type', 'search');\n\n        field\n          .append(\n            $('<span>').addClass('typeahead__query').append(\n              input\n            )\n          )\n          .append(\n            $('<span/>').addClass('typeahead__button').append(\n              $('<button/>').attr('type', 'submit').append(\n                $('<span/>').addClass('typeahead__search-icon')\n              )\n            )\n          );\n\n        container.append(field);\n        form.append(container);\n\n\n        var mod = $('<div/>').addClass('modal cmd-palette').append(\n          $('<div/>').addClass('modal-dialog')\n          .append(\n            $('<div/>').addClass('modal-content').append(\n              $('<div/>').addClass('modal-body')\n              .append(\n                form\n              )\n            )\n          )\n        )\n        // end setting up right layout\n        .modal({show: false, backdrop:true})\n        .on('shown.bs.modal', function () {\n              // click on button trigger de-focus on mouse up.\n              // or something like that.\n              setTimeout(function(){input.focus();}, 100);\n        });\n\n        notebook.keyboard_manager.disable();\n\n        var before_close = function() {\n          // little trick to trigger early in onsubmit\n          // when the action called pop-up a dialog\n          // insure this function is only called once\n          if (before_close.ok) {\n            return;\n          }\n          var cell = notebook.get_selected_cell();\n          if (cell) {\n            cell.select();\n          }\n          if (notebook.keyboard_manager) {\n            notebook.keyboard_manager.enable();\n            notebook.keyboard_manager.command_mode();\n          }\n          before_close.ok = true; // avoid double call.\n        };\n        \n        mod.on(\"hide.bs.modal\", before_close);\n        \n\n        // will be trigger when user select action\n        var onSubmit = function(node, query, result, resultCount) {\n          if (actions.indexOf(result.key) >= 0) {\n            before_close();\n            notebook.keyboard_manager.actions.call(result.key);\n          } else {\n            console.warning(\"No command \" + result.key);\n          }\n          mod.modal('hide');\n        };\n\n        /* Whenever a result is rendered, if there is only one resulting\n         * element then automatically select that element.\n         */\n        var onResult = function(node, query, result, resultCount) {\n            if (resultCount == 1) {\n                requestAnimationFrame(function() {\n                    $('.typeahead-list > li:nth-child(2)').addClass('active');\n                });\n            }\n        };\n\n        // generate structure needed for typeahead layout and ability to search\n        var src = {};\n\n        var actions = Object.keys(notebook.keyboard_manager.actions._actions);\n\n        for (var i = 0; i < actions.length; i++) {\n          var action_id = actions[i];\n          var action = notebook.keyboard_manager.actions.get(action_id);\n          var group = action_id.split(':')[0];\n\n          src[group] = src[group] || {\n            data: [],\n            display: 'display'\n          };\n\n          var short = notebook.keyboard_manager.command_shortcuts.get_action_shortcut(action_id) ||\n            notebook.keyboard_manager.edit_shortcuts.get_action_shortcut(action_id);\n          if (short) {\n            short = QH.humanize_sequence(short);\n          }\n\n          var display_text;\n          if (action.cmd) {\n              display_text = i18n.msg._(action.cmd);\n          } else {\n              display_text = humanize_action_id(action_id);\n          }\n\n          var help = null;\n          if (action.help) {\n              help = i18n.msg._(action.help);\n          }\n          \n          src[group].data.push({\n            display: display_text,\n            shortcut: short,\n            mode_shortcut: get_mode_for_action_id(action_id, notebook),\n            group: group,\n            icon: action.icon,\n            help: help,\n            key: action_id,\n          });\n        }\n\n        // now src is the right structure for typeahead\n\n        input.typeahead({\n          emptyTemplate: function(query) {\n            return $('<div>').text(\"No results found for \").append(\n                $('<code>').text(query)\n            );\n          },\n          maxItem: 1e3,\n          minLength: 0,\n          hint: true,\n          group: {\n            template:\"{{group}} command group\"\n          },\n          searchOnFocus: true,\n          mustSelectItem: true,\n          template: '<i class=\"fa fa-icon {{icon}}\"></i>{{display}}  <div title={{key}} class=\"pull-right {{mode_shortcut}}\">{{shortcut}}</div>',\n          order: \"asc\",\n          source: src,\n          callback: {\n            onSubmit: onSubmit,\n            onClickAfter: onSubmit,\n            onResult: onResult\n          },\n          debug: false,\n        });\n\n        mod.modal('show');\n    };\n    return {'CommandPalette': CommandPalette};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/keyboard',\n    'notebook/js/contexthint',\n    'codemirror/lib/codemirror',\n], function($, utils, keyboard, CodeMirror) {\n    \"use strict\";\n\n    // easier key mapping\n    var keycodes = keyboard.keycodes;\n\n    var prepend_n_prc = function(str, n) {\n        for( var i =0 ; i< n ; i++){\n            str = '%'+str ;\n        }\n        return str;\n    };\n\n    var _existing_completion = function(item, completion_array){\n        for( var i=0; i < completion_array.length; i++) {\n            if (completion_array[i].trim().substr(-item.length) == item) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    // what is the common start of all completions\n    function shared_start(B, drop_prct) {\n        if (B.length == 1) {\n            return B[0];\n        }\n        var A = [];\n        var common;\n        var min_lead_prct = 10;\n        for (var i = 0; i < B.length; i++) {\n            var str = B[i].str;\n            var localmin = 0;\n            if(drop_prct === true){\n                while ( str.substr(0, 1) == '%') {\n                    localmin = localmin+1;\n                    str = str.substring(1);\n                }\n            }\n            min_lead_prct = Math.min(min_lead_prct, localmin);\n            A.push(str);\n        }\n\n        if (A.length > 1) {\n            var tem1, tem2, s;\n            A = A.slice(0).sort();\n            tem1 = A[0];\n            s = tem1.length;\n            tem2 = A.pop();\n            while (s && tem2.indexOf(tem1) == -1) {\n                tem1 = tem1.substring(0, --s);\n            }\n            if (tem1 === \"\" || tem2.indexOf(tem1) !== 0) {\n                return {\n                    str:prepend_n_prc('', min_lead_prct),\n                    type: \"computed\",\n                    from: B[0].from,\n                    to: B[0].to\n                    };\n            }\n            return {\n                str: prepend_n_prc(tem1, min_lead_prct),\n                type: \"computed\",\n                from: B[0].from,\n                to: B[0].to\n            };\n        }\n        return null;\n    }\n\n\n    var Completer = function (cell, events) {\n        this.cell = cell;\n        this.editor = cell.code_mirror;\n        var that = this;\n        events.on('kernel_busy.Kernel', function () {\n            that.skip_kernel_completion = true;\n        });\n        events.on('kernel_idle.Kernel', function () {\n            that.skip_kernel_completion = false;\n        });\n    };\n\n    Completer.prototype.startCompletion = function () {\n        /**\n         * call for a 'first' completion, that will set the editor and do some\n         * special behavior like autopicking if only one completion available.\n         */\n        if (this.editor.somethingSelected()|| this.editor.getSelections().length > 1) return;\n        this.done = false;\n        // use to get focus back on opera\n        this.carry_on_completion(true);\n    };\n\n\n    // easy access for julia to monkeypatch\n    //\n    Completer.reinvoke_re = /[%0-9a-z._/\\\\:~-]/i;\n\n    Completer.prototype.reinvoke= function(pre_cursor, block, cursor){\n        return Completer.reinvoke_re.test(pre_cursor);\n    };\n\n    /**\n     *\n     * pass true as parameter if this is the first invocation of the completer\n     * this will prevent the completer to dismiss itself if it is not on a\n     * word boundary like pressing tab after a space, and make it autopick the\n     * only choice if there is only one which prevent from popping the UI.  as\n     * well as fast-forwarding the typing if all completion have a common\n     * shared start\n     **/\n    Completer.prototype.carry_on_completion = function (first_invocation) {\n        /**\n         * Pass true as parameter if you want the completer to autopick when\n         * only one completion. This function is automatically reinvoked at\n         * each keystroke with first_invocation = false\n         */\n        var cur = this.editor.getCursor();\n        var line = this.editor.getLine(cur.line);\n        var pre_cursor = this.editor.getRange({\n            line: cur.line,\n            ch: cur.ch - 1\n        }, cur);\n\n        // we need to check that we are still on a word boundary\n        // because while typing the completer is still reinvoking itself\n        // so dismiss if we are on a \"bad\" character\n        if (!this.reinvoke(pre_cursor) && !first_invocation) {\n            this.close();\n            return;\n        }\n\n        this.autopick = false;\n        if (first_invocation) {\n            this.autopick = true;\n        }\n\n        // We want a single cursor position.\n        if (this.editor.somethingSelected()|| this.editor.getSelections().length > 1) {\n            return;\n        }\n\n        // one kernel completion came back, finish_completing will be called with the results\n        // we fork here and directly call finish completing if kernel is busy\n        var cursor_pos = this.editor.indexFromPos(cur);\n        var text = this.editor.getValue();\n        cursor_pos = utils.js_idx_to_char_idx(cursor_pos, text);\n        if (this.skip_kernel_completion) {\n            this.finish_completing({ content: {\n                matches: [],\n                cursor_start: cursor_pos,\n                cursor_end: cursor_pos,\n            }});\n        } else {\n            this.cell.kernel.complete(text, cursor_pos,\n                $.proxy(this.finish_completing, this)\n            );\n        }\n    };\n\n    Completer.prototype.finish_completing = function (msg) {\n        /**\n         * let's build a function that wrap all that stuff into what is needed\n         * for the new completer:\n         */\n        var content = msg.content;\n        var start = content.cursor_start;\n        var end = content.cursor_end;\n        var matches = content.matches;\n        //console.log(content);\n\n        var cur = this.editor.getCursor();\n        if (end === null) {\n            // adapted message spec replies don't have cursor position info,\n            // interpret end=null as current position,\n            // and negative start relative to that\n            end = this.editor.indexFromPos(cur);\n            if (start === null) {\n                start = end;\n            } else if (start < 0) {\n                start = end + start;\n            }\n        } else {\n            // handle surrogate pairs\n            var text = this.editor.getValue();\n            end = utils.char_idx_to_js_idx(end, text);\n            start = utils.char_idx_to_js_idx(start, text);\n        }\n\n        var results = CodeMirror.contextHint(this.editor);\n        var filtered_results = [];\n        //remove results from context completion\n        //that are already in kernel completion\n        var i;\n        for (i=0; i < results.length; i++) {\n            if (!_existing_completion(results[i].str, matches)) {\n                filtered_results.push(results[i]);\n            }\n        }\n\n        // append the introspection result, in order, at at the beginning of\n        // the table and compute the replacement range from current cursor\n        // position and matched_text length.\n        var from = this.editor.posFromIndex(start);\n        var to = this.editor.posFromIndex(end);\n        for (i = matches.length - 1; i >= 0; --i) {\n            filtered_results.unshift({\n                str: matches[i],\n                type: \"introspection\",\n                from: from,\n                to: to\n            });\n        }\n\n        // one the 2 sources results have been merge, deal with it\n        this.raw_result = filtered_results;\n\n        // if empty result return\n        if (!this.raw_result || !this.raw_result.length) return;\n\n        // When there is only one completion, use it directly.\n        if (this.autopick && this.raw_result.length == 1) {\n            this.insert(this.raw_result[0]);\n            return;\n        }\n\n        if (this.raw_result.length == 1) {\n            // test if first and only completion totally matches\n            // what is typed, in this case dismiss\n            var str = this.raw_result[0].str;\n            var pre_cursor = this.editor.getRange({\n                line: cur.line,\n                ch: cur.ch - str.length\n            }, cur);\n            if (pre_cursor == str) {\n                this.close();\n                return;\n            }\n        }\n\n        if (!this.visible) {\n            this.complete = $('<div/>').addClass('completions');\n            this.complete.attr('id', 'complete');\n\n            // Currently webkit doesn't use the size attr correctly. See:\n            // https://code.google.com/p/chromium/issues/detail?id=4579\n            this.sel = $('<select/>')\n                .attr('tabindex', -1)\n                .attr('multiple', 'true');\n            this.complete.append(this.sel);\n            this.visible = true;\n            $('body').append(this.complete);\n\n            //build the container\n            var that = this;\n            this.sel.click(function () {\n                that.pick();\n                that.editor.focus();\n            });\n            this._handle_keydown = function (cm, event) {\n                that.keydown(event);\n            };\n            this.editor.on('keydown', this._handle_keydown);\n            this._handle_keypress = function (cm, event) {\n                that.keypress(event);\n            };\n            this.editor.on('keypress', this._handle_keypress);\n        }\n        this.sel.attr('size', Math.min(10, this.raw_result.length));\n\n        // After everything is on the page, compute the position.\n        // We put it above the code if it is too close to the bottom of the page.\n        var pos = this.editor.cursorCoords(\n            this.editor.posFromIndex(start)\n        );\n        var left = pos.left-3;\n        var top;\n        var cheight = this.complete.height();\n        var wheight = $(window).height();\n        if (pos.bottom+cheight+5 > wheight) {\n            top = pos.top-cheight-4;\n        } else {\n            top = pos.bottom+1;\n        }\n        this.complete.css('left', left + 'px');\n        this.complete.css('top', top + 'px');\n\n        // Clear and fill the list.\n        this.sel.text('');\n        this.build_gui_list(this.raw_result);\n        return true;\n    };\n\n    Completer.prototype.insert = function (completion) {\n        this.editor.replaceRange(completion.str, completion.from, completion.to);\n    };\n\n    Completer.prototype.build_gui_list = function (completions) {\n        var MAXIMUM_GUI_LIST_LENGTH = 1000;\n        for (var i = 0; i < completions.length && i < MAXIMUM_GUI_LIST_LENGTH; ++i) {\n            var opt = $('<option/>').text(completions[i].str).addClass(completions[i].type);\n            this.sel.append(opt);\n        }\n        this.sel.children().first().attr('selected', 'true');\n        this.sel.scrollTop(0);\n    };\n\n    Completer.prototype.close = function () {\n        this.done = true;\n        $('#complete').remove();\n        this.editor.off('keydown', this._handle_keydown);\n        this.editor.off('keypress', this._handle_keypress);\n        this.visible = false;\n    };\n\n    Completer.prototype.pick = function () {\n        this.insert(this.raw_result[this.sel[0].selectedIndex]);\n        this.close();\n    };\n\n    Completer.prototype.keydown = function (event) {\n        var code = event.keyCode;\n\n        // Enter\n        var options;\n        var index;\n        if (code == keycodes.enter) {\n            event.codemirrorIgnore = true;\n            event._ipkmIgnore = true;\n            event.preventDefault();\n            this.pick();\n        // Escape or backspace\n        } else if (code == keycodes.esc || code == keycodes.backspace) {\n            event.codemirrorIgnore = true;\n            event._ipkmIgnore = true;\n            event.preventDefault();\n            this.close();\n        } else if (code == keycodes.tab) {\n            //all the fastforwarding operation,\n            //Check that shared start is not null which can append with prefixed completion\n            // like %pylab , pylab have no shred start, and ff will result in py<tab><tab>\n            // to erase py\n            var sh = shared_start(this.raw_result, true);\n            if (sh.str !== '') {\n                this.insert(sh);\n            }\n            this.close();\n            this.carry_on_completion();\n        } else if (code == keycodes.up || code == keycodes.down) {\n            // need to do that to be able to move the arrow\n            // when on the first or last line ofo a code cell\n            event.codemirrorIgnore = true;\n            event._ipkmIgnore = true;\n            event.preventDefault();\n\n            options = this.sel.find('option');\n            index = this.sel[0].selectedIndex;\n            if (code == keycodes.up) {\n                index--;\n            }\n            if (code == keycodes.down) {\n                index++;\n            }\n            index = Math.min(Math.max(index, 0), options.length-1);\n            this.sel[0].selectedIndex = index;\n        } else if (code == keycodes.pageup || code == keycodes.pagedown) {\n            event.codemirrorIgnore = true;\n            event._ipkmIgnore = true;\n\n            options = this.sel.find('option');\n            index = this.sel[0].selectedIndex;\n            if (code == keycodes.pageup) {\n                index -= 10; // As 10 is the hard coded size of the drop down menu\n            } else {\n                index += 10;\n            }\n            index = Math.min(Math.max(index, 0), options.length-1);\n            this.sel[0].selectedIndex = index;\n        } else if (code == keycodes.left || code == keycodes.right) {\n            this.close();\n        }\n    };\n\n    Completer.prototype.keypress = function (event) {\n        /**\n         * FIXME: This is a band-aid.\n         * on keypress, trigger insertion of a single character.\n         * This simulates the old behavior of completion as you type,\n         * before events were disconnected and CodeMirror stopped\n         * receiving events while the completer is focused.\n         */\n        \n        var that = this;\n        var code = event.keyCode;\n        \n        // don't handle keypress if it's not a character (arrows on FF)\n        // or ENTER/TAB\n        if (event.charCode === 0 ||\n            code == keycodes.tab ||\n            code == keycodes.enter\n        ) return;\n        \n        this.close();\n        this.editor.focus();\n        setTimeout(function () {\n            that.carry_on_completion();\n        }, 50);\n    };\n\n    return {'Completer': Completer};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// highly adapted for codemiror jshint\ndefine(['codemirror/lib/codemirror'], function(CodeMirror) {\n    \"use strict\";\n\n    var forEach = function(arr, f) {\n        for (var i = 0, e = arr.length; i < e; ++i) f(arr[i]);\n    };\n\n    var arrayContains = function(arr, item) {\n        if (!Array.prototype.indexOf) {\n            var i = arr.length;\n            while (i--) {\n                if (arr[i] === item) {\n                    return true;\n                }\n            }\n            return false;\n        }\n        return arr.indexOf(item) != -1;\n    };\n\n    CodeMirror.contextHint = function (editor) {\n        // Find the token at the cursor\n        var cur = editor.getCursor(),\n            token = editor.getTokenAt(cur),\n            tprop = token;\n        // If it's not a 'word-style' token, ignore the token.\n        // If it is a property, find out what it is a property of.\n        var list = [];\n        var clist = getCompletions(token, editor);\n        for (var i = 0; i < clist.length; i++) {\n            list.push({\n                str: clist[i],\n                type: \"context\",\n                from: {\n                    line: cur.line,\n                    ch: token.start\n                },\n                to: {\n                    line: cur.line,\n                    ch: token.end\n                }\n            });\n        }\n        return list;\n    };\n\n    // find all 'words' of current cell\n    var getAllTokens = function (editor) {\n        var found = [];\n\n        // add to found if not already in it\n\n\n        function maybeAdd(str) {\n            if (!arrayContains(found, str)) found.push(str);\n        }\n\n        // loop through all token on all lines\n        var lineCount = editor.lineCount();\n        // loop on line\n        for (var l = 0; l < lineCount; l++) {\n            var line = editor.getLine(l);\n            //loop on char\n            for (var c = 1; c < line.length; c++) {\n                var tk = editor.getTokenAt({\n                    line: l,\n                    ch: c\n                });\n                // if token has a class, it has geat chances of beeing\n                // of interest. Add it to the list of possible completions.\n                // we could skip token of ClassName 'comment'\n                // or 'number' and 'operator'\n                if (tk.className !== null) {\n                    maybeAdd(tk.string);\n                }\n                // jump to char after end of current token\n                c = tk.end;\n            }\n        }\n        return found;\n    };\n\n    var getCompletions = function(token, editor) {\n        var candidates = getAllTokens(editor);\n        // filter all token that have a common start (but nox exactly) the length of the current token\n        var lambda = function (x) {\n                return (x.indexOf(token.string) === 0 && x != token.string);\n            };\n        var filterd = candidates.filter(lambda);\n        return filterd;\n    };\n\n    return {'contextHint': CodeMirror.contextHint};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'requirejs/require',\n    'base/js/namespace',\n    'base/js/dialog',\n    'base/js/utils',\n    'base/js/i18n',\n    '../../../../notebook/api/kernelspecs.json'\n], function($, requirejs, IPython, dialog, utils, i18n, kernelspecs) {\n    \"use strict\";\n    \n    var KernelSelector = function(selector, notebook) {\n        var that = this;\n        this.selector = selector;\n        this.notebook = notebook;\n        this.notebook.set_kernelselector(this);\n        this.events = notebook.events;\n        this.current_selection = null;\n        this.kernelspecs = {};\n        // Make the object globally available for user convenience & inspection\n        IPython.kernelselector = this;\n        this._finish_load = null;\n        this._loaded = false;\n        this.loaded = new Promise(function(resolve) {\n            that._finish_load = resolve;\n        });\n        if (this.selector !== undefined) {\n            this.element = $(selector);\n            this.request_kernelspecs();\n        }\n        this.bind_events();\n        \n        Object.seal(this);\n    };\n    \n    KernelSelector.prototype.request_kernelspecs = function() {\n        // Preliminary documentation for kernelspecs api is at \n        // https://github.com/ipython/ipython/wiki/IPEP-25%3A-Registry-of-installed-kernels#rest-api\n        // [Basthon]\n        // We load this directly at build time\n        return this._got_kernelspecs(kernelspecs);\n        var url = utils.url_path_join(this.notebook.base_url, 'api/kernelspecs');\n        const settings = { beforeSend: (xhr) => xhr.overrideMimeType(\"application/json\") };\n        utils.promising_ajax(url, settings).then($.proxy(this._got_kernelspecs, this));\n    };\n    \n    var _sorted_names = function(kernelspecs) {\n        // sort kernel names\n        return Object.keys(kernelspecs).sort(function (a, b) {\n            // sort by display_name\n            var da = kernelspecs[a].spec.display_name;\n            var db = kernelspecs[b].spec.display_name;\n            if (da === db) {\n                return 0;\n            } else if (da > db) {\n                return 1;\n            } else {\n                return -1;\n            }\n        });\n    };\n    \n    KernelSelector.prototype._got_kernelspecs = function(data) {\n        var that = this;\n        if(typeof data === 'string') {\n            data = JSON.parse(data);\n        }\n        this.kernelspecs = data.kernelspecs;\n\n        var change_kernel_submenu = $(\"#menu-change-kernel-submenu\");\n        var new_notebook_submenu = $(\"#menu-new-notebook-submenu\");\n        var keys = _sorted_names(data.kernelspecs);\n        \n        // [Basthon]\n        const url = new URL(window.location.href);\n        const baseURL = url.origin + url.pathname;\n        keys.map(function (key) {\n            // Create the Kernel > Change kernel submenu\n            var ks = data.kernelspecs[key];\n            change_kernel_submenu.append(\n                $(\"<li>\").attr(\"id\", \"kernel-submenu-\"+ks.name).append(\n                    $('<a>')\n                        .attr('href', `${baseURL}?kernel=${ks.name}`)\n                        //[Baston]\n                        /*.click( function () {\n                            that.set_kernel(ks.name);\n                        })*/\n                        .text(ks.spec.display_name)\n                )\n            );\n            // Create the File > New Notebook submenu\n            new_notebook_submenu.append(\n                $(\"<li>\").attr(\"id\", \"new-notebook-submenu-\"+ks.name).append(\n                    $('<a>')\n                        .attr('href', '#')\n                        .click( function () {\n                            that.new_notebook(ks.name);\n                        })\n                        .text(ks.spec.display_name)\n                )\n            );\n\n        });\n        // trigger loaded promise\n        this._loaded = true;\n        this._finish_load();\n    };\n    \n    KernelSelector.prototype._spec_changed = function (event, ks) {\n        /** event handler for spec_changed */\n        var that = this;\n        \n        // update selection\n        this.current_selection = ks.name;\n        \n        // put the current kernel at the top of File > New Notebook\n        var cur_kernel_entry = $(\"#new-notebook-submenu-\" + ks.name);\n        var parent = cur_kernel_entry.parent();\n        // do something only if there is more than one kernel\n        if (parent.children().length > 1) {\n            // first, sort back the submenu\n            parent.append(\n                parent.children(\"li[class!='divider']\").sort(\n                    function (a,b) {\n                        var da = $(\"a\",a).text();\n                        var db = $(\"a\",b).text();\n                        if (da === db) {\n                            return 0;\n                        } else if (da > db) {\n                            return 1;\n                        } else {\n                            return -1;\n                        }}));\n            // then, if there is no divider yet, add one\n            if (!parent.children(\"li[class='divider']\").length) {\n                parent.prepend($(\"<li>\").attr(\"class\",\"divider\"));\n            } \n            // finally, put the current kernel at the top\n            parent.prepend(cur_kernel_entry);\n        }\n        \n        // load logo\n        var logo_img = this.element.find(\"img.current_kernel_logo\");\n        $(\"#kernel_indicator\").find('.kernel_indicator_name').text(ks.spec.display_name);\n        if (ks.resources['logo-64x64']) {\n            logo_img.attr(\"src\", ks.resources['logo-64x64']);\n            logo_img.attr(\"title\", ks.spec.display_name);\n            logo_img.show();\n        } else {\n            logo_img.hide();\n        }\n        \n        // load kernel css\n        var css_url = ks.resources['kernel.css'];\n        if (css_url) {\n            $('#kernel-css').attr('href', css_url);\n        } else {\n            $('#kernel-css').attr('href', '');\n        }\n        \n        // load kernel js\n        if (ks.resources['kernel.js']) {\n\n            // Debug added for Notebook 4.2, please remove at some point in the\n            // future if the following does not append anymore when kernels\n            // have kernel.js\n            //\n            // > Uncaught (in promise) TypeError: require is not a function\n            // \n            console.info('Dynamically requiring kernel.js, `requirejs` is ', requirejs);\n            requirejs.requirejs([ks.resources['kernel.js']],\n                function (kernel_mod) {\n                    if (kernel_mod && kernel_mod.onload) {\n                        kernel_mod.onload();\n                    } else {\n                        console.warn(\"Kernel \" + ks.name + \" has a kernel.js file that does not contain \"+\n                                     \"any asynchronous module definition. This is undefined behavior \"+\n                                     \"and not recommended.\");\n                    }\n                }, function (err) {\n                    console.warn(\"Failed to load kernel.js from \", ks.resources['kernel.js'], err);\n                }\n            );\n            this.events.on('spec_changed.Kernel', function (evt, new_ks) {\n                if (ks.name != new_ks.name) {\n                    console.warn(\"kernelspec %s had custom kernel.js. Forcing page reload for %s.\",\n                        ks.name, new_ks.name);\n                    that.notebook.save_notebook().then(function () {\n                        window.location.reload();\n                    });\n                }\n            });\n        }\n    };\n\n    KernelSelector.prototype.set_kernel = function (selected) {\n        /** set the kernel by name, ensuring kernelspecs have been loaded, first \n        \n        kernel can be just a kernel name, or a notebook kernelspec metadata\n        (name, language, display_name).\n        */\n        var that = this;\n        if (typeof selected === 'string') {\n            selected = {\n                name: selected\n            };\n        }\n        if (this._loaded) {\n            this._set_kernel(selected);\n        } else {\n            return this.loaded.then(function () {\n                that._set_kernel(selected);\n            });\n        }\n    };\n\n    KernelSelector.prototype._set_kernel = function (selected) {\n        /** Actually set the kernel (kernelspecs have been loaded) */\n        if (selected.name === this.current_selection) {\n            // only trigger event if value changed\n            return;\n        }\n        var kernelspecs = this.kernelspecs;\n        var ks = kernelspecs[selected.name];\n        if (ks === undefined) {\n            var available = _sorted_names(kernelspecs);\n            var matches = [];\n            if (selected.language && selected.language.length > 0) {\n                available.map(function (name) {\n                    if (kernelspecs[name].spec.language.toLowerCase() === selected.language.toLowerCase()) {\n                        matches.push(name);\n                    }\n                });\n            }\n            if (matches.length === 1) {\n                ks = kernelspecs[matches[0]];\n                console.log(\"No exact match found for \" + selected.name +\n                    \", using only kernel that matches language=\" + selected.language, ks);\n                this.events.trigger(\"spec_match_found.Kernel\", {\n                    selected: selected,\n                    found: ks,\n                });\n            }\n            // if still undefined, trigger failure event\n            if (ks === undefined) {\n                this.events.trigger(\"spec_not_found.Kernel\", {\n                    selected: selected,\n                    matches: matches,\n                    available: available,\n                });\n                return;\n            }\n        }\n        if (this.notebook._session_starting &&\n            this.notebook.session.kernel.name !== ks.name) {\n            console.error(\"Cannot change kernel while waiting for pending session start.\");\n            return;\n        }\n        this.current_selection = ks.name;\n        this.events.trigger('spec_changed.Kernel', ks);\n    };\n    \n    KernelSelector.prototype._spec_not_found = function (event, data) {\n        var that = this;\n        var select = $(\"<select>\").addClass('form-control');\n        console.warn(\"Kernelspec not found:\", data);\n        var names;\n        if (data.matches.length > 1) {\n            names = data.matches;\n        } else {\n            names = data.available;\n        }\n        names.map(function (name) {\n            var ks = that.kernelspecs[name];\n            select.append(\n                $('<option/>').attr('value', ks.name).text(ks.spec.display_name || ks.name)\n            );\n        });\n        \n        var no_kernel_msg = i18n.msg.sprintf(i18n.msg._(\"Could not find a kernel matching %s. Please select a kernel:\"),\n                (data.selected.display_name || data.selected.name))\n        var body = $(\"<form>\").addClass(\"form-inline\").append(\n            $(\"<span>\").text(no_kernel_msg)\n        ).append(select);\n\n        // This statement is used simply so that message extraction\n        // will pick up the strings.  The actual setting of the text\n        // for the button is in dialog.js.\n        var button_labels = [ i18n.msg._(\"Continue Without Kernel\"), i18n.msg._(\"Set Kernel\"), i18n.msg._(\"OK\") ];\n        \n        dialog.modal({\n            title : i18n.msg._('Kernel not found'),\n            body : body,\n            buttons : {\n                'Continue Without Kernel' : {\n                    class : 'btn-danger',\n                    click : function () {\n                        that.events.trigger('no_kernel.Kernel');\n                    }\n                },\n                'Set Kernel' : {\n                    class : 'btn-primary',\n                    click : function () {\n                        that.set_kernel(select.val());\n                    }\n                }\n            }\n        });\n    };\n\n    KernelSelector.prototype.new_notebook = function (kernel_name) {\n        \n        /*\n          opening new notebook and setting _basthonEmptyContent\n          global variale to true to force empty notebook\n          (see Basthons's gui-base/src/main.ts).\n        */\n        var w = window.open(window.location.href);\n        w._basthonEmptyContent = true;\n        return w;\n\n        var w = window.open('', IPython._target);\n        // Create a new notebook in the same path as the current\n        // notebook's path.\n        var that = this;\n        var parent = utils.url_path_split(that.notebook.notebook_path)[0];\n        that.notebook.contents.new_untitled(parent, {type: \"notebook\"}).then(\n            function (data) {\n                var url = utils.url_path_join(\n                    that.notebook.base_url, 'notebooks',\n                    utils.encode_uri_components(data.path)\n                );\n                url += \"?kernel_name=\" + kernel_name;\n                w.location = url;\n            },\n            function(error) {\n                w.close();\n                dialog.modal({\n                    title : i18n.msg._('Creating Notebook Failed'),\n                    body : i18n.msg.sprintf(i18n.msg._(\"The error was: %s\"), error.message),\n                    buttons : {'OK' : {'class' : 'btn-primary'}}\n                });\n            }\n        );\n    };\n\n    KernelSelector.prototype.lock_switch = function() {\n        // should set a flag and display warning+reload if user want to\n        // re-change kernel. As UI discussion never finish\n        // making that a separate PR.\n        console.warn('switching kernel is not guaranteed to work !');\n    };\n\n    KernelSelector.prototype.bind_events = function() {\n        var that = this;\n        this.events.on('spec_changed.Kernel', $.proxy(this._spec_changed, this));\n        this.events.on('spec_not_found.Kernel', $.proxy(this._spec_not_found, this));\n        this.events.on('kernel_created.Session', function (event, data) {\n            that.set_kernel(data.kernel.name);\n        });\n        \n        var logo_img = this.element.find(\"img.current_kernel_logo\");\n        logo_img.on(\"load\", function() {\n            logo_img.show();\n        });\n        logo_img.on(\"error\", function() {\n            logo_img.hide();\n        });\n    };\n\n    return {'KernelSelector': KernelSelector};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n/**\n *\n *\n * @module keyboardmanager\n * @namespace keyboardmanager\n * @class KeyboardManager\n */\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/keyboard',\n], function($, utils, keyboard) {\n    \"use strict\";\n    \n    // Main keyboard manager for the notebook\n    var keycodes = keyboard.keycodes;\n\n    var KeyboardManager = function (options) {\n        /**\n         * A class to deal with keyboard event and shortcut\n         *\n         * @class KeyboardManager\n         * @constructor\n         * @param options {dict} Dictionary of keyword arguments :\n         *    @param options.events {$(Events)} instance \n         *    @param options.pager: {Pager}  pager instance\n         */\n        this.mode = 'command';\n        this.enabled = true;\n        this.pager = options.pager;\n        this.quick_help = undefined;\n        this.notebook = undefined;\n        this.last_mode = undefined;\n        this.bind_events();\n        this.env = {pager:this.pager};\n        this.actions = options.actions;\n        this.command_shortcuts = new keyboard.ShortcutManager(undefined, options.events, this.actions, this.env, options.config, 'command');\n        this.command_shortcuts._add_default_shortcuts(this.get_default_common_shortcuts());\n        this.command_shortcuts._add_default_shortcuts(this.get_default_command_shortcuts());\n        this.edit_shortcuts = new keyboard.ShortcutManager(undefined, options.events, this.actions, this.env);\n        this.edit_shortcuts._add_default_shortcuts(this.get_default_common_shortcuts());\n        this.edit_shortcuts._add_default_shortcuts(this.get_default_edit_shortcuts());\n\n\n        this.config = options.config;\n        var that = this;\n\n        this.config.loaded.then(function(){ \n            var edit_unbind;\n\n            try {\n                edit_unbind = that.config.data.keys.edit.unbind||[];\n            } catch (e) {\n                if (e instanceof TypeError) {\n                    edit_unbind = [];\n                } else {\n                    throw e;\n                }\n            }\n\n            edit_unbind.forEach(function(u){that.edit_shortcuts.remove_shortcut(u);});\n\n            var command_unbind;\n\n            try {\n                command_unbind = that.config.data.keys.command.unbind||[];\n            } catch (e) {\n                if (e instanceof TypeError) {\n                    command_unbind = [];\n                } else {\n                    throw e;\n                }\n            }\n\n            command_unbind.forEach(function(u){that.command_shortcuts.remove_shortcut(u);});\n\n            that.command_shortcuts.add_shortcuts( ((that.config.data.keys||{}).command||{}).bind);\n            that.edit_shortcuts.add_shortcuts(    ((that.config.data.keys||{}).edit   ||{}).bind);\n\n            }\n        );\n\n        Object.seal(this);\n    };\n\n\n\n\n    /**\n     * Return a dict of common shortcut\n     * @method get_default_common_shortcuts\n     *\n     * @example Example of returned shortcut\n     * ```\n     * 'shortcut-key': 'action-name'\n     * // a string representing the shortcut as dash separated value.\n     * // e.g. 'shift' , 'shift-enter', 'cmd-t'\n     *```\n     */\n    KeyboardManager.prototype.get_default_common_shortcuts = function() {\n        return {\n            'shift'       : 'jupyter-notebook:ignore',\n            'shift-enter' : 'jupyter-notebook:run-cell-and-select-next',\n            'ctrl-enter'  : 'jupyter-notebook:run-cell',\n            'alt-enter'   : 'jupyter-notebook:run-cell-and-insert-below',\n            // cmd on mac, ctrl otherwise\n            'cmdtrl-s'    : 'jupyter-notebook:save-notebook'\n        };\n    };\n\n    KeyboardManager.prototype.get_default_edit_shortcuts = function() {\n        return {\n            'cmdtrl-shift-p'      : 'jupyter-notebook:show-command-palette',\n            'cmdtrl-shift-f'      : 'jupyter-notebook:show-command-palette',\n            'esc'                 : 'jupyter-notebook:enter-command-mode',\n            'ctrl-m'              : 'jupyter-notebook:enter-command-mode',\n            'up'                  : 'jupyter-notebook:move-cursor-up',\n            'down'                : 'jupyter-notebook:move-cursor-down',\n            'ctrl-shift--'        : 'jupyter-notebook:split-cell-at-cursor',\n        };\n    };\n\n    KeyboardManager.prototype.get_default_command_shortcuts = function() {\n        return {\n            'cmdtrl-shift-p': 'jupyter-notebook:show-command-palette',\n            'cmdtrl-shift-f': 'jupyter-notebook:show-command-palette',\n            'shift-space': 'jupyter-notebook:scroll-notebook-up',\n            'shift-v' : 'jupyter-notebook:paste-cell-above',\n            'shift-m' : 'jupyter-notebook:merge-cells',\n            'shift-o' : 'jupyter-notebook:toggle-cell-output-scrolled',\n            'enter' : 'jupyter-notebook:enter-edit-mode',\n            'space' : 'jupyter-notebook:scroll-notebook-down',\n            'down' : 'jupyter-notebook:select-next-cell',\n            'i,i' : 'jupyter-notebook:interrupt-kernel',\n            '0,0' : 'jupyter-notebook:confirm-restart-kernel',\n            'd,d' : 'jupyter-notebook:delete-cell',\n            'esc': 'jupyter-notebook:close-pager',\n            'up' : 'jupyter-notebook:select-previous-cell',\n            'k' : 'jupyter-notebook:select-previous-cell',\n            'j' : 'jupyter-notebook:select-next-cell',\n            'shift-k': 'jupyter-notebook:extend-selection-above',\n            'shift-j': 'jupyter-notebook:extend-selection-below',\n            'shift-up': 'jupyter-notebook:extend-selection-above',\n            'shift-down': 'jupyter-notebook:extend-selection-below',\n            'cmdtrl-a': 'jupyter-notebook:select-all',\n            'x' : 'jupyter-notebook:cut-cell',\n            'c' : 'jupyter-notebook:copy-cell',\n            'v' : 'jupyter-notebook:paste-cell-below',\n            'a' : 'jupyter-notebook:insert-cell-above',\n            'b' : 'jupyter-notebook:insert-cell-below',\n            'y' : 'jupyter-notebook:change-cell-to-code',\n            'm' : 'jupyter-notebook:change-cell-to-markdown',\n            'r' : 'jupyter-notebook:change-cell-to-raw',\n            '1' : 'jupyter-notebook:change-cell-to-heading-1',\n            '2' : 'jupyter-notebook:change-cell-to-heading-2',\n            '3' : 'jupyter-notebook:change-cell-to-heading-3',\n            '4' : 'jupyter-notebook:change-cell-to-heading-4',\n            '5' : 'jupyter-notebook:change-cell-to-heading-5',\n            '6' : 'jupyter-notebook:change-cell-to-heading-6',\n            'o' : 'jupyter-notebook:toggle-cell-output-collapsed',\n            's' : 'jupyter-notebook:save-notebook',\n            'w' : 'jupyter-notebook:share-notebook',\n            'l' : 'jupyter-notebook:toggle-cell-line-numbers',\n            'shift-l' : 'jupyter-notebook:toggle-all-line-numbers',\n            'h' : 'jupyter-notebook:show-keyboard-shortcuts',\n            'z' : 'jupyter-notebook:undo-cell-deletion',\n            'q' : 'jupyter-notebook:close-pager',\n            'p' : 'jupyter-notebook:show-command-palette',\n        };\n    };\n\n    KeyboardManager.prototype.bind_events = function () {\n        var that = this;\n        $(document).keydown(function (event) {\n            if(event._ipkmIgnore===true||(event.originalEvent||{})._ipkmIgnore===true){\n                return false;\n            }\n            return that.handle_keydown(event);\n        });\n    };\n\n    KeyboardManager.prototype.set_notebook = function (notebook) {\n        this.notebook = notebook;\n        this.actions.extend_env({notebook:notebook});\n    };\n    \n    KeyboardManager.prototype.set_quickhelp = function (notebook) {\n        this.actions.extend_env({quick_help:notebook});\n    };\n\n\n    KeyboardManager.prototype.handle_keydown = function (event) {\n        /**\n         *  returning false from this will stop event propagation\n         **/\n\n        if (event.which === keycodes.esc) {\n            // Intercept escape at highest level to avoid closing\n            // websocket connection with firefox\n            event.preventDefault();\n        }\n        \n        if (!this.enabled) {\n            if (event.which === keycodes.esc) {\n                this.notebook.command_mode();\n                return false;\n            }\n            return true;\n        }\n        \n        if (this.mode === 'edit') {\n            return this.edit_shortcuts.call_handler(event);\n        } else if (this.mode === 'command') {\n            return this.command_shortcuts.call_handler(event);\n        }\n        return true;\n    };\n\n    KeyboardManager.prototype.edit_mode = function () {\n        this.last_mode = this.mode;\n        this.mode = 'edit';\n    };\n\n    KeyboardManager.prototype.command_mode = function () {\n        this.last_mode = this.mode;\n        this.mode = 'command';\n    };\n\n    KeyboardManager.prototype.enable = function () {\n        this.enabled = true;\n    };\n\n    KeyboardManager.prototype.disable = function () {\n        this.enabled = false;\n    };\n\n    KeyboardManager.prototype.register_events = function (e) {\n        e = $(e);\n        var that = this;\n        var handle_focus = function () {\n            that.disable();\n        };\n        var handle_blur = function () {\n            that.enable();\n        };\n        e.on('focusin', handle_focus);\n        e.on('focusout', handle_blur);\n        // TODO: Very strange. The focusout event does not seem fire for the \n        // bootstrap textboxes on FF25&26...  This works around that by \n        // registering focus and blur events recursively on all inputs within\n        // registered element.\n        e.find('input').blur(handle_blur);\n        e.on('DOMNodeInserted', function (event) {\n            var target = $(event.target);\n            if (target.is('input')) {\n                target.blur(handle_blur);\n            } else {\n                target.find('input').blur(handle_blur);    \n            }\n          });\n        // There are times (raw_input) where we remove the element from the DOM before\n        // focusout is called. In this case we bind to the remove event of jQueryUI,\n        // which gets triggered upon removal, iff it is focused at the time.\n        // is_focused must be used to check for the case where an element within\n        // the element being removed is focused.\n        e.on('remove', function () {\n            if (utils.is_focused(e[0])) {\n                that.enable();\n            }\n        });\n    };\n\n    return {'KeyboardManager': KeyboardManager};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    './toolbar',\n    './celltoolbar',\n    'base/js/i18n'\n], function($, toolbar, celltoolbar, i18n) {\n    \"use strict\";\n\n    var MainToolBar = function (selector, options) {\n        /**\n         * Constructor\n         *\n         * Parameters:\n         *  selector: string\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance\n         *          notebook: Notebook instance\n         **/\n        toolbar.ToolBar.apply(this, [selector, options] );\n        this.events = options.events;\n        this.notebook = options.notebook;\n        this._make();\n        Object.seal(this);\n    };\n\n    MainToolBar.prototype = Object.create(toolbar.ToolBar.prototype);\n\n    MainToolBar.prototype._make = function () {\n        var grps = [\n          [\n            ['jupyter-notebook:download-notebook',\n             'jupyter-notebook:open-notebook'],\n            'download_open_notebook'\n          ],\n          [\n            ['jupyter-notebook:share-notebook'],\n            'share_notebook'\n          ],\n          [\n            ['jupyter-notebook:rollback'],\n            'rollback'\n          ],\n          [\n            ['jupyter-notebook:insert-cell-below'],\n            'insert_above_below'],\n          [\n            ['jupyter-notebook:cut-cell',\n             'jupyter-notebook:copy-cell',\n             'jupyter-notebook:paste-cell-below'\n            ] ,\n            'cut_copy_paste'],\n          [\n            ['jupyter-notebook:move-cell-up',\n             'jupyter-notebook:move-cell-down'\n            ],\n            'move_up_down'],\n          [ [new toolbar.Button('jupyter-notebook:run-cell-and-select-next',\n                {label: i18n.msg._('Run')}),\n             'jupyter-notebook:interrupt-kernel',\n             'jupyter-notebook:confirm-restart-kernel',\n             'jupyter-notebook:confirm-restart-kernel-and-run-all-cells'\n            ],\n            'run_int'],\n         ['<add_celltype_list>'],\n         [\n           ['jupyter-notebook:show-command-palette'],\n           'cmd_palette'],\n         [\n             ['jupyter-notebook:switch-theme'],\n             'switch-theme'\n         ],\n        ];\n        this.construct(grps);\n    };\n\n    MainToolBar.prototype._pseudo_actions = {};\n\n    // add a cell type drop down to the maintoolbar.\n    // triggered when the pseudo action `<add_celltype_list>` is\n    // encountered when building a toolbar.\n    MainToolBar.prototype._pseudo_actions.add_celltype_list = function () {\n        var that = this;\n        var multiselect = $('<option/>').attr('value','multiselect').attr('disabled','').text('-');\n        var sel = $('<select/>')\n            .attr('id','cell_type')\n            .attr('aria-label', i18n.msg._('combobox, select cell type'))\n            .attr('role', 'combobox')\n            .addClass('form-control select-xs')\n            .append($('<option/>').attr('value','code').text(i18n.msg._('Code')))\n            .append($('<option/>').attr('value','markdown').text(i18n.msg._('Markdown')))\n            .append($('<option/>').attr('value','raw').text(i18n.msg._('Raw NBConvert')))\n            .append($('<option/>').attr('value','heading').text(i18n.msg._('Heading')))\n            .append(multiselect);\n        this.notebook.keyboard_manager.register_events(sel);\n        this.events.on('selected_cell_type_changed.Notebook', function (event, data) {\n            if (data.editable === false) {\n                sel.attr('disabled', true);\n            } else {\n                sel.removeAttr('disabled');\n            }\n\n            if (that.notebook.get_selected_cells_indices().length > 1) {\n                multiselect.show();\n                sel.val('multiselect');\n            } else {\n                multiselect.hide();\n                if (data.cell_type === 'heading') {\n                    sel.val('Markdown');\n                } else {\n                    sel.val(data.cell_type);\n                }\n            }\n        });\n        sel.change(function () {\n            var cell_type = $(this).val();\n            switch (cell_type) {\n            case 'code':\n                that.notebook.cells_to_code();\n                break;\n            case 'markdown':\n                that.notebook.cells_to_markdown();\n                break;\n            case 'raw':\n                that.notebook.cells_to_raw();\n                break;\n            case 'heading':\n                that.notebook._warn_heading();\n                that.notebook.to_heading();\n                sel.val('markdown');\n                break;\n            case 'multiselect':\n                break;\n            default:\n                console.log(i18n.msg._(\"unrecognized cell type:\"), cell_type);\n            }\n            that.notebook.focus_cell();\n        });\n        return sel;\n\n    };\n\n    return {'MainToolBar': MainToolBar};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/dialog',\n], function($, utils, i18n, dialog) {\n    \"use strict\";\n\n    var init = function () {\n        if (window.MathJax) {\n            // MathJax loaded\n            MathJax.Hub.Config({\n                tex2jax: {\n                    inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ],\n                    displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ],\n                    processEscapes: true,\n                    processEnvironments: true\n                },\n                MathML: {\n                    extensions: ['content-mathml.js']\n                },\n                // Center justify equations in code and markdown cells. Elsewhere\n                // we use CSS to left justify single line equations in code cells.\n                displayAlign: 'center',\n                \"HTML-CSS\": {\n                    availableFonts: [],\n                    imageFont: null,\n                    preferredFont: null,\n                    webFont: \"STIX-Web\",\n                    styles: {'.MathJax_Display': {\"margin\": 0}},\n                    linebreaks: { automatic: true }\n                },\n            });\n            MathJax.Hub.Configured();\n        } else {\n            // This statement is used simply so that message extraction\n            // will pick up the strings.  The actual setting of the text\n            // for the button is in dialog.js.\n            var button_labels = [ i18n.msg._(\"OK\") ];\n            // Don't have MathJax, but should. Show dialog.\n            dialog.modal({\n                title : i18n.msg.sprintf(i18n.msg._(\"Failed to retrieve MathJax from '%s'\",window.mathjax_url)),\n                body : $(\"<p/>\").addClass('dialog').text(\n                        i18n.msg._(\"Math/LaTeX rendering will be disabled.\")\n                    ),\n                buttons : {\n                    OK : {class: \"btn-danger\"}\n                }\n            });\n        }\n    };\n\n    // Some magic for deferring mathematical expressions to MathJax\n    // by hiding them from the Markdown parser.\n    // Some of the code here is adapted with permission from Davide Cervone\n    // under the terms of the Apache2 license governing the MathJax project.\n    // Other minor modifications are also due to StackExchange and are used with\n    // permission.\n\n    // MATHSPLIT contains the pattern for math delimiters and special symbols\n    // needed for searching for math in the text input.\n    var MATHSPLIT = /(\\$\\$?|\\\\(?:begin|end)\\{[a-z]*\\*?\\}|\\\\[{}$]|[{}]|(?:\\n\\s*)+|@@\\d+@@|\\\\\\\\(?:\\(|\\)|\\[|\\]))/i;\n\n    //  The math is in blocks i through j, so\n    //    collect it into one block and clear the others.\n    //  Replace &, <, and > by named entities.\n    //  For IE, put <br> at the ends of comments since IE removes \\n.\n    //  Clear the current math positions and store the index of the\n    //    math, then push the math string onto the storage array.\n    //  The preProcess function is called on all blocks if it has been passed in\n    var process_math = function (i, j, pre_process, math, blocks) {\n        var block = blocks.slice(i, j + 1).join(\"\").replace(/&/g, \"&amp;\") // use HTML entity for &\n        .replace(/</g, \"&lt;\") // use HTML entity for <\n        .replace(/>/g, \"&gt;\") // use HTML entity for >\n        ;\n        if (utils.browser === 'msie') {\n            block = block.replace(/(%[^\\n]*)\\n/g, \"$1<br/>\\n\");\n        }\n        while (j > i) {\n            blocks[j] = \"\";\n            j--;\n        }\n        blocks[i] = \"@@\" + math.length + \"@@\"; // replace the current block text with a unique tag to find later\n        if (pre_process){\n            block = pre_process(block);\n        }\n        math.push(block);\n        return blocks;\n    };\n\n    //  Break up the text into its component parts and search\n    //    through them for math delimiters, braces, linebreaks, etc.\n    //  Math delimiters must match and braces must balance.\n    //  Don't allow math to pass through a double linebreak\n    //    (which will be a paragraph).\n    //\n    var remove_math = function (text) {\n        var math = []; // stores math strings for later\n        var start;\n        var end;\n        var last;\n        var braces;\n\n        // Except for extreme edge cases, this should catch precisely those pieces of the markdown\n        // source that will later be turned into code spans. While MathJax will not TeXify code spans,\n        // we still have to consider them at this point; the following issue has happened several times:\n        //\n        //     `$foo` and `$bar` are varibales.  -->  <code>$foo ` and `$bar</code> are variables.\n\n        var hasCodeSpans = /`/.test(text),\n            de_tilde;\n        if (hasCodeSpans) {\n            var tilde = function (wholematch) {\n                return wholematch.replace(/\\$/g, \"~D\");\n            }\n            text = text.replace(/~/g, \"~T\")\n                       .replace(/(^|[^\\\\])(`+)([^\\n]*?[^`\\n])\\2(?!`)/gm, tilde)\n                       .replace(/^\\s{0,3}(`{3,})(.|\\n)*?\\1/gm, tilde);\n            de_tilde = function (text) {\n                return text.replace(/~([TD])/g, function (wholematch, character) {\n                                                    return { T: \"~\", D: \"$\" }[character];\n                                                });\n            };\n        } else {\n            de_tilde = function (text) { return text; };\n        }\n\n        var blocks = utils.regex_split(text.replace(/\\r\\n?/g, \"\\n\"),MATHSPLIT);\n\n        for (var i = 1, m = blocks.length; i < m; i += 2) {\n            var block = blocks[i];\n            if (block.charAt(0) === \"@\") {\n                //\n                //  Things that look like our math markers will get\n                //  stored and then retrieved along with the math.\n                //\n                blocks[i] = \"@@\" + math.length + \"@@\";\n                math.push(block);\n            }\n            else if (start) {\n                //\n                //  If we are in math, look for the end delimiter,\n                //    but don't go past double line breaks, and\n                //    and balance braces within the math.\n                //\n                if (block === end) {\n                    if (braces) {\n                        last = i;\n                    }\n                    else {\n                        blocks = process_math(start, i, de_tilde, math, blocks);\n                        start  = null;\n                        end    = null;\n                        last   = null;\n                    }\n                }\n                else if (block.match(/\\n.*\\n/)) {\n                    if (last) {\n                        i = last;\n                        blocks = process_math(start, i, de_tilde, math, blocks);\n                    }\n                    start = null;\n                    end = null;\n                    last = null;\n                    braces = 0;\n                }\n                else if (block === \"{\") {\n                    braces++;\n                }\n                else if (block === \"}\" && braces) {\n                    braces--;\n                }\n            }\n            else {\n                //\n                //  Look for math start delimiters and when\n                //    found, set up the end delimiter.\n                //\n                if (block === \"$\" || block === \"$$\") {\n                    start = i;\n                    end = block;\n                    braces = 0;\n                }\n                else if (block === \"\\\\\\\\\\(\" || block === \"\\\\\\\\\\[\") {\n                    start = i;\n                    end = block.slice(-1) === \"(\" ? \"\\\\\\\\\\)\" : \"\\\\\\\\\\]\";\n                    braces = 0;\n                }\n                else if (block.substr(1, 5) === \"begin\") {\n                    start = i;\n                    end = \"\\\\end\" + block.substr(6);\n                    braces = 0;\n                }\n            }\n        }\n        if (last) {\n            blocks = process_math(start, last, de_tilde, math, blocks);\n            start  = null;\n            end    = null;\n            last   = null;\n        }\n        return [de_tilde(blocks.join(\"\")), math];\n    };\n\n    //\n    //  Put back the math strings that were saved,\n    //    and clear the math array (no need to keep it around).\n    //\n    var replace_math = function (text, math) {\n        //\n        //  Replaces a math placeholder with its corresponding group.\n        //  The math delimiters \"\\\\(\", \"\\\\[\", \"\\\\)\" and \"\\\\]\" are replaced\n        //  removing one backslash in order to be interpreted correctly by MathJax.\n        //\n        var math_group_process = function (match, n) {\n            var math_group = math[n];\n\n            if (math_group.substr(0, 3) === \"\\\\\\\\\\(\"  && math_group.substr(math_group.length - 3) === \"\\\\\\\\\\)\") {\n                math_group = \"\\\\\\(\" + math_group.substring(3, math_group.length - 3) + \"\\\\\\)\";\n            } else if (math_group.substr(0, 3) === \"\\\\\\\\\\[\" && math_group.substr(math_group.length - 3) === \"\\\\\\\\\\]\") {\n                math_group = \"\\\\\\[\" + math_group.substring(3, math_group.length - 3) + \"\\\\\\]\";\n            }\n            \n            return math_group;\n        };\n\n        // Replace all the math group placeholders in the text\n        // with the saved strings.\n        text = text.replace(/@@(\\d+)@@/g, math_group_process);\n        \n        return text;\n    };\n\n    var mathjaxutils = {\n        init : init,\n        remove_math : remove_math,\n        replace_math : replace_math\n    };\n\n    return mathjaxutils;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/namespace',\n    'base/js/dialog',\n    'base/js/utils',\n    'base/js/i18n',\n    './celltoolbar',\n    './tour',\n    'moment',\n    'requirejs'\n], function($, IPython, dialog, utils, i18n, celltoolbar, tour, moment, requirejs) {\n    \"use strict\";\n\n    var MenuBar = function (selector, options) {\n        /**\n         * Constructor\n         *\n         * A MenuBar Class to generate the menubar of Jupyter notebook\n         *\n         * Parameters:\n         *  selector: string\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          notebook: Notebook instance\n         *          contents: ContentManager instance\n         *          events: $(Events) instance\n         *          save_widget: SaveWidget instance\n         *          quick_help: QuickHelp instance\n         *          base_url : string\n         *          notebook_path : string\n         *          notebook_name : string\n         *          config: ConfigSection instance\n         */\n        options = options || {};\n        this.base_url = options.base_url || utils.get_body_data(\"baseUrl\");\n        this.selector = selector;\n        this.notebook = options.notebook;\n        this.actions = this.notebook.keyboard_manager.actions;\n        this.contents = options.contents;\n        this.events = options.events;\n        this.save_widget = options.save_widget;\n        this.quick_help = options.quick_help;\n        this.actions = options.actions;\n        this.config = options.config;\n\n        try {\n            this.tour = new tour.Tour(this.notebook, this.events);\n        } catch (e) {\n            this.tour = undefined;\n            console.log(\"Failed to instantiate Notebook Tour\", e);\n        }\n\n        if (this.selector !== undefined) {\n            this.element = $(selector);\n            this.style();\n            this.add_bundler_items();\n            this.bind_events();\n        }\n    };\n\n    // TODO: This has definitively nothing to do with style ...\n    MenuBar.prototype.style = function () {\n        var that = this;\n        this.element.find(\"li\").click(function (event, ui) {\n                // The selected cell loses focus when the menu is entered, so we\n                // re-select it upon selection.\n                var i = that.notebook.get_selected_index();\n                that.notebook.select(i, false);\n            }\n        );\n    };\n    \n    MenuBar.prototype.add_bundler_items = function() {\n        var that = this;\n        this.config.loaded.then(function() {\n            var bundlers = that.config.data.bundlerextensions;\n            if(bundlers) {\n                // Stable sort the keys to ensure menu items don't hop around\n                var ids = Object.keys(bundlers).sort()\n                ids.forEach(function(bundler_id) {\n                    var bundler = bundlers[bundler_id];\n                    var group = that.element.find('#'+bundler.group+'_menu')\n                    \n                    // Validate menu item metadata\n                    if(!group.length) {\n                        console.warn('unknown group', bundler.group, 'for bundler ID', bundler_id, '; skipping');\n                        return;\n                    } else if(!bundler.label) {\n                        console.warn('no label for bundler ID', bundler_id, '; skipping');\n                        return;\n                    }\n                    \n                    // Insert menu item into correct group, click handler\n                    group.parent().removeClass('hidden');\n                    var $li = $('<li>')\n                        .appendTo(group);\n                    $('<a>')\n                        .attr('href', '#')\n                        .text(bundler.label)\n                        .appendTo($li)\n                        .on('click', that._bundle.bind(that, bundler_id))\n                        .appendTo($li);\n                });\n            }\n        });\n    };\n\n    MenuBar.prototype._new_window = function(url) {\n        var w = window.open('', IPython._target);\n        if (this.notebook.dirty && this.notebook.writable) {\n            this.notebook.save_notebook().then(function() {\n                w.location = url;\n            });\n        } else {\n            w.location = url;\n        }\n    };\n    \n    MenuBar.prototype._bundle = function(bundler_id) {\n        // Read notebook path and base url here in case they change\n        var notebook_path = utils.encode_uri_components(this.notebook.notebook_path);\n        var url = utils.url_path_join(\n            this.base_url,\n            'bundle',\n            notebook_path\n        ) + '?bundler=' + utils.encode_uri_components(bundler_id);\n\n        this._new_window(url);\n    };\n\n    MenuBar.prototype._nbconvert = function (format, download) {\n        download = download || false;\n        var notebook_path = utils.encode_uri_components(this.notebook.notebook_path);\n        var url = utils.url_path_join(\n            this.base_url,\n            'nbconvert',\n            format,\n            notebook_path\n        ) + \"?download=\" + download.toString();\n        \n        this._new_window(url);\n    };\n\n    MenuBar.prototype._size_header = function() {\n        /** \n         * Update header spacer size.\n         */\n        console.warn('`_size_header` is deprecated and will be removed in future versions.'+\n                     ' Please trigger the `resize-header.Page` manually if you rely on it.');\n        this.events.trigger('resize-header.Page');\n    };\n\n    MenuBar.prototype.bind_events = function () {\n        /**\n         *  File\n         */\n        var that = this;\n        \n        this.element.find('#open_notebook').click(function () {\n            that.notebook.basthonGUI.openFile();\n        });\n        this.element.find('#copy_notebook').click(function () {\n            that.notebook.copy_notebook();\n            return false;\n        });\n        this.element.find('#save_notebook_as').click(function() {\n            that.notebook.basthonGUI.download();\n            return false;\n        });\n        this.element.find('#restore_checkpoint').click(function() {\n            (async () => {\n                const ipynb = await that.notebook.basthonGUI.selectCheckpoint();\n                if(ipynb != null) that.notebook.basthonGUI.setContent(ipynb);\n            })();\n            return false;\n        });\n        \n        this.element.find('#print_preview').click(function () {\n            that._nbconvert('html', false);\n        });\n\n        this.element.find('#download_menu li').click(function (ev) {\n            that._nbconvert(ev.target.parentElement.getAttribute('id').substring(9), true);\n        });\n\n        this.events.on('trust_changed.Notebook', function (event, trusted) {\n            if (trusted) {\n                that.element.find('#trust_notebook')\n                    .addClass(\"disabled\").off('click')\n                    .find(\"a\").text(i18n.msg._(\"Trusted Notebook\"));\n            } else {\n                that.element.find('#trust_notebook')\n                    .removeClass(\"disabled\").on('click', function () {\n                        that.notebook.trust_notebook();\n                    })\n                    .find(\"a\").text(i18n.msg._(\"Trust Notebook\"));\n            }\n        });\n\n        // View\n        this._add_celltoolbar_list();\n\n        // Edit\n        this.element.find('#edit_nb_metadata').click(function () {\n            that.notebook.edit_metadata({\n                notebook: that.notebook,\n                keyboard_manager: that.notebook.keyboard_manager});\n        });\n\n        var id_actions_dict = {\n            '#trust_notebook' : 'trust-notebook',\n            '#rename_notebook' : 'rename-notebook',\n            '#find_and_replace' : 'find-and-replace',\n            '#save_checkpoint': 'save-notebook',\n            '#share_notebook': 'share-notebook',\n            '#rollback': 'rollback',\n            '#switch_theme': 'switch-theme',\n            '#shutdown_kernel': 'confirm-shutdown-kernel',\n            '#restart_kernel': 'confirm-restart-kernel',\n            '#restart_clear_output': 'confirm-restart-kernel-and-clear-output',\n            '#restart_run_all': 'confirm-restart-kernel-and-run-all-cells',\n            '#close_and_halt': 'close-and-halt',\n            '#int_kernel': 'interrupt-kernel',\n            '#cut_cell': 'cut-cell',\n            '#copy_cell': 'copy-cell',\n            '#delete_cell': 'delete-cell',\n            '#undelete_cell': 'undo-cell-deletion',\n            '#split_cell': 'split-cell-at-cursor',\n            '#merge_cell_above': 'merge-cell-with-previous-cell',\n            '#merge_cell_below': 'merge-cell-with-next-cell',\n            '#move_cell_up': 'move-cell-up',\n            '#move_cell_down': 'move-cell-down',\n            '#toggle_header': 'toggle-header',\n            '#toggle_toolbar': 'toggle-toolbar',\n            '#toggle_line_numbers': 'toggle-all-line-numbers',\n            '#insert_cell_above': 'insert-cell-above',\n            '#insert_cell_below': 'insert-cell-below',\n            '#run_cell': 'run-cell',\n            '#run_cell_select_below': 'run-cell-and-select-next',\n            '#run_cell_insert_below': 'run-cell-and-insert-below',\n            '#run_all_cells': 'run-all-cells',\n            '#run_all_cells_above': 'run-all-cells-above',\n            '#run_all_cells_below': 'run-all-cells-below',\n            '#to_code': 'change-cell-to-code',\n            '#to_markdown': 'change-cell-to-markdown',\n            '#to_raw': 'change-cell-to-raw',\n            '#toggle_current_output': 'toggle-cell-output-collapsed',\n            '#toggle_current_output_scroll': 'toggle-cell-output-scrolled',\n            '#clear_current_output': 'clear-cell-output',\n            '#toggle_all_output': 'toggle-all-cells-output-collapsed',\n            '#toggle_all_output_scroll': 'toggle-all-cells-output-scrolled',\n            '#clear_all_output': 'clear-all-cells-output',\n            '#cut_cell_attachments': 'cut-cell-attachments',\n            '#copy_cell_attachments': 'copy-cell-attachments',\n            '#paste_cell_attachments': 'paste-cell-attachments',\n            '#insert_image': 'insert-image',\n            '#edit_keyboard_shortcuts' : 'edit-command-mode-keyboard-shortcuts',\n        };\n\n        for(var idx in id_actions_dict){\n            if (!id_actions_dict.hasOwnProperty(idx)){\n                continue;\n            }\n            var id_act = 'jupyter-notebook:'+id_actions_dict[idx];\n            if(!that.actions.exists(id_act)){\n                console.warn('actions', id_act, 'does not exist, still binding it in case it will be defined later...');\n            }\n            // Immediately-Invoked Function Expression cause JS.\n            (function(that, id_act, idx){\n                that.element.find(idx).click(function(event){\n                    that.actions.call(id_act, event);\n                });\n            })(that, id_act, idx);\n        }\n\n        \n        // Kernel\n        this.element.find('#reconnect_kernel').click(function () {\n            that.notebook.kernel.reconnect();\n        });\n        // Help\n        if (this.tour) {\n            this.element.find('#notebook_tour').click(function () {\n                that.tour.start();\n            });\n        } else {\n            this.element.find('#notebook_tour').addClass(\"disabled\");\n        }\n        this.element.find('#keyboard_shortcuts').click(function () {\n            that.quick_help.show_keyboard_shortcuts();\n        });\n        \n        this.update_restore_checkpoint(null);\n        \n        this.events.on('checkpoints_listed.Notebook', function (event, data) {\n            that.update_restore_checkpoint(that.notebook.checkpoints);\n        });\n        \n        this.events.on('checkpoint_created.Notebook', function (event, data) {\n            that.update_restore_checkpoint(that.notebook.checkpoints);\n        });\n        \n        this.events.on('notebook_loaded.Notebook', function() {\n            var langinfo = that.notebook.metadata.language_info || {};\n            that.update_nbconvert_script(langinfo);\n        });\n        \n        this.events.on('kernel_ready.Kernel', function(event, data) {\n            var langinfo = data.kernel.info_reply.language_info || {};\n            that.update_nbconvert_script(langinfo);\n            that.add_kernel_help_links(data.kernel.info_reply.help_links || []);\n        });\n    };\n    \n    MenuBar.prototype._add_celltoolbar_list = function () {\n        var that = this;\n        var submenu = $(\"#menu-cell-toolbar-submenu\");\n        \n        function preset_added(event, data) {\n            var name = data.name;\n            submenu.append(\n                $(\"<li/>\")\n                .attr('data-name', encodeURIComponent(name))\n                .append(\n                    $(\"<a/>\")\n                    .attr('href', '#')\n                    .text(name)\n                    .click(function () {\n                        if (name ==='None') {\n                            celltoolbar.CellToolbar.global_hide();\n                            delete that.notebook.metadata.celltoolbar;\n                        } else {\n                            celltoolbar.CellToolbar.global_show();\n                            celltoolbar.CellToolbar.activate_preset(name, that.events);\n                            that.notebook.metadata.celltoolbar = name;\n                        }\n                        that.notebook.focus_cell();\n                    })\n                )\n            );\n        }\n        \n        // Setup the existing presets\n        var presets = celltoolbar.CellToolbar.list_presets();\n        preset_added(null, {name: i18n.msg._(\"None\")});\n        presets.map(function (name) {\n            preset_added(null, {name: name});\n        });\n\n        // Setup future preset registrations\n        this.events.on('preset_added.CellToolbar', preset_added);\n        \n        // Handle unregistered presets\n        this.events.on('unregistered_preset.CellToolbar', function (event, data) {\n            submenu.find(\"li[data-name='\" + encodeURIComponent(data.name) + \"']\").remove();\n        });\n    };\n\n    MenuBar.prototype.update_restore_checkpoint = function(checkpoints) {\n        var ul = this.element.find(\"#restore_checkpoint\").find(\"ul\");\n        ul.empty();\n        if (!checkpoints || checkpoints.length === 0) {\n            ul.append(\n                $(\"<li/>\")\n                .addClass(\"disabled\")\n                .append(\n                    $(\"<a/>\")\n                    .text(i18n.msg._(\"No checkpoints\"))\n                )\n            );\n            return;\n        }\n        \n        var that = this;\n        checkpoints.map(function (checkpoint) {\n            var d = new Date(checkpoint.last_modified);\n            ul.append(\n                $(\"<li/>\").append(\n                    $(\"<a/>\")\n                    .attr(\"href\", \"#\")\n                    .text(moment(d).format(\"LLLL\"))\n                    .click(function () {\n                        that.notebook.restore_checkpoint_dialog(checkpoint);\n                    })\n                )\n            );\n        });\n    };\n    \n    MenuBar.prototype.update_nbconvert_script = function(langinfo) {\n        /**\n         * Set the 'Download as foo' menu option for the relevant language.\n         */\n        var el = this.element.find('#download_script');\n        \n        // Set menu entry text to e.g. \"Python (.py)\"\n        var langname = (langinfo.name || 'Script');\n        langname = langname.charAt(0).toUpperCase()+langname.substr(1); // Capitalise\n        el.find('a').text(langname + ' ('+(langinfo.file_extension || 'txt')+')');\n    };\n\n    MenuBar.prototype.add_kernel_help_links = function(help_links) {\n        /** add links from kernel_info to the help menu */\n        var divider = $(\"#kernel-help-links\");\n        if (divider.length === 0) {\n            // insert kernel help section above about link\n            var about = $(\"#notebook_about\").parent();\n            divider = $(\"<li>\")\n                .attr('id', \"kernel-help-links\")\n                .addClass('divider');\n            about.prev().before(divider);\n        }\n        // remove previous entries\n        while (!divider.next().hasClass('divider')) {\n            divider.next().remove();\n        }\n        if (help_links.length === 0) {\n            // no help links, remove the divider\n            divider.remove();\n            return;\n        }\n        var cursor = divider;\n        help_links.map(function (link) {\n            cursor.after($(\"<li>\")\n                .append($(\"<a>\")\n                    .attr('target', '_blank')\n                    .attr('title', i18n.msg._('Opens in a new window'))\n                    .attr('href', requirejs.requirejs.toUrl(link.url))\n                    .append($(\"<i>\")\n                        .addClass(\"fa fa-external-link menu-icon pull-right\")\n                    )\n                    .append($(\"<span>\")\n                        .text(link.text)\n                    )\n                )\n            );\n            cursor = cursor.next();\n        });\n        \n    };\n\n    return {'MenuBar': MenuBar};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n/**\n * @module notebook\n */\n\"use strict\";\ndefine([\n    'jquery',\n    'base/js/namespace',\n    'underscore',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/dialog',\n    './cell',\n    './textcell',\n    './codecell',\n    'moment',\n    'services/config',\n    'services/sessions/session',\n    './celltoolbar',\n    'marked',\n    'codemirror/lib/codemirror',\n    'codemirror/addon/runmode/runmode',\n    './mathjaxutils',\n    'base/js/keyboard',\n    './tooltip',\n    './celltoolbarpresets/default',\n    './celltoolbarpresets/rawcell',\n    './celltoolbarpresets/slideshow',\n    './celltoolbarpresets/attachments',\n    './celltoolbarpresets/tags',\n    './scrollmanager',\n    './commandpalette',\n    './shortcuteditor'\n], function (\n    $,\n    IPython,\n    _,\n    utils,\n    i18n,\n    dialog,\n    cellmod,\n    textcell,\n    codecell,\n    moment,\n    configmod,\n    session,\n    celltoolbar,\n    marked,\n    CodeMirror,\n    runMode,\n    mathjaxutils,\n    keyboard,\n    tooltip,\n    default_celltoolbar,\n    rawcell_celltoolbar,\n    slideshow_celltoolbar,\n    attachments_celltoolbar,\n    tags_celltoolbar,\n    scrollmanager,\n    commandpalette,\n    shortcuteditor\n) {\n\n    var ShortcutEditor = shortcuteditor.ShortcutEditor;\n\n    var _SOFT_SELECTION_CLASS = 'jupyter-soft-selected';\n\n    function soft_selected(cell){\n        return cell.element.hasClass(_SOFT_SELECTION_CLASS);\n    }\n\n    /**\n     * Contains and manages cells.\n     * @class Notebook\n     * @param {string}          selector\n     * @param {object}          options - Dictionary of keyword arguments.  \n     * @param {jQuery}          options.events - selector of Events\n     * @param {KeyboardManager} options.keyboard_manager\n     * @param {Contents}        options.contents\n     * @param {SaveWidget}      options.save_widget\n     * @param {object}          options.config\n     * @param {string}          options.base_url\n     * @param {string}          options.notebook_path\n     * @param {string}          options.notebook_name\n     */\n    function Notebook(selector, options) {\n        this.basthonGUI = options.basthonGUI;\n        this.config = options.config;\n        this.config.loaded.then(this.validate_config.bind(this));\n        this.class_config = new configmod.ConfigWithDefaults(this.config, \n                                        Notebook.options_default, 'Notebook');\n        this.base_url = options.base_url;\n        this.notebook_path = options.notebook_path;\n        this.notebook_name = options.notebook_name;\n        this.events = options.events;\n        this.keyboard_manager = options.keyboard_manager;\n        this.contents = options.contents;\n        this.save_widget = options.save_widget;\n        this.tooltip = new tooltip.Tooltip(this.events);\n        this.ws_url = options.ws_url;\n        this._session_starting = false;\n        this.last_modified = null;\n        // debug 484\n        this._last_modified = 'init';\n        // Firefox workaround\n        this._ff_beforeunload_fired = false;\n\n        //  Create default scroll manager.\n        this.scroll_manager = new scrollmanager.ScrollManager(this);\n\n        // TODO: This code smells (and the other `= this` line a couple lines down)\n        // We need a better way to deal with circular instance references.\n        this.keyboard_manager.notebook = this;\n        this.save_widget.notebook = this;\n        \n        mathjaxutils.init();\n\n        if (marked) {\n            marked.setOptions({\n                gfm : true,\n                tables: true,\n                // FIXME: probably want central config for CodeMirror theme when we have js config\n                langPrefix: \"cm-s-ipython language-\",\n                highlight: function(code, lang, callback) {\n                    if (!lang) {\n                        // no language, no highlight\n                        if (callback) {\n                            callback(null, code);\n                            return;\n                        } else {\n                            return code;\n                        }\n                    }\n                    utils.requireCodeMirrorMode(lang, function (spec) {\n                        var el = document.createElement(\"div\");\n                        var mode = CodeMirror.getMode({}, spec);\n                        if (!mode) {\n                            console.log(\"No CodeMirror mode: \" + lang);\n                            callback(null, code);\n                            return;\n                        }\n                        try {\n                            CodeMirror.runMode(code, spec, el);\n                            callback(null, el.innerHTML);\n                        } catch (err) {\n                            console.log(\"Failed to highlight \" + lang + \" code\", err);\n                            callback(err, code);\n                        }\n                    }, function (err) {\n                        console.log(\"No CodeMirror mode: \" + lang);\n                        console.log(\"Require CodeMirror mode error: \" + err);\n                        callback(null, code);\n                    });\n                }\n            });\n        }\n\n        this.element = $(selector);\n        this.element.scroll();\n        this.element.data(\"notebook\", this);\n        this.session = null;\n        this.kernel = null;\n        this.kernel_busy = false;\n        this.clipboard = null;\n        this.clipboard_attachments = null;\n        this.undelete_backup_stack = [];\n        this.paste_enabled = false;\n        this.paste_attachments_enabled = false;\n        this.writable = false;\n        // It is important to start out in command mode to match the initial mode\n        // of the KeyboardManager.\n        this.mode = 'command';\n        this.set_dirty(false);\n        this.metadata = {};\n        this._checkpoint_after_save = false;\n        this.last_checkpoint = null;\n        this.checkpoints = [];\n        this.autosave_interval = 0;\n        this.autosave_timer = null;\n        // autosave *at most* every two minutes\n        this.minimum_autosave_interval = 120000;\n        this.notebook_name_blacklist_re = /[\\/\\\\:]/;\n        this.nbformat = 4; // Increment this when changing the nbformat\n        this.nbformat_minor = this.current_nbformat_minor = 1; // Increment this when changing the nbformat\n        this.codemirror_mode = 'text';\n        this.create_elements();\n        this.bind_events();\n        this.kernel_selector = null;\n        this.dirty = null;\n        this.trusted = null;\n        this._changed_on_disk_dialog = null;\n        this._fully_loaded = false;\n\n        // Trigger cell toolbar registration.\n        default_celltoolbar.register(this);\n        rawcell_celltoolbar.register(this);\n        slideshow_celltoolbar.register(this);\n        attachments_celltoolbar.register(this);\n        tags_celltoolbar.register(this);\n        \n        var that = this;\n\n        Object.defineProperty(this, 'line_numbers', {\n            get: function() {\n                var d = that.config.data || {};\n                var cmc =  (d['Cell'] || {}) ['cm_config'] || {};\n                return cmc['lineNumbers'] || false;\n            },\n            set: function(value) {\n                that.config.update({\n                    'Cell': {\n                        'cm_config': {\n                            'lineNumbers':value\n                        }\n                    }\n                });\n            }\n        });\n        \n        Object.defineProperty(this, 'header', {\n            get: function() {\n                return that.class_config.get_sync('Header');\n            },\n            set: function(value) {\n                that.class_config.set('Header', value);\n            }\n        });\n                \n        Object.defineProperty(this, 'toolbar', {\n            get: function() {\n                return that.class_config.get_sync('Toolbar');\n            },\n            set: function(value) {\n                that.class_config.set('Toolbar', value);\n            }\n        });\n        \n        this.class_config.get('Header').then(function(header) {\n            if (header === false) {\n                that.keyboard_manager.actions.call('jupyter-notebook:hide-header');\n            }\n        });\n        \n        this.class_config.get('Toolbar').then(function(toolbar) {\n          if (toolbar === false) {\n              that.keyboard_manager.actions.call('jupyter-notebook:hide-toolbar');\n          }\n        });\n        \n        // prevent assign to miss-typed properties.\n        Object.seal(this);\n    }\n\n    Notebook.options_default = {\n        // can be any cell type, or the special values of\n        // 'above', 'below', or 'selected' to get the value from another cell.\n        default_cell_type: 'code',\n        Header: true,\n        Toolbar: true,\n        kill_kernel: false\n    };\n\n    Notebook.prototype.validate_config = function() {\n        var code_cell = this.config.data['CodeCell'] || {};\n        var cm_keymap = (code_cell['cm_config'] || {})['keyMap'];\n        if (cm_keymap && CodeMirror.keyMap[cm_keymap] === undefined) {\n            console.warn('CodeMirror keymap not found, ignoring: ' + cm_keymap);\n            delete code_cell.cm_config.keyMap;\n        }\n    };\n\n    /**\n     * Create an HTML and CSS representation of the notebook.\n     */\n    Notebook.prototype.create_elements = function () {\n        var that = this;\n        this.element.attr('tabindex','-1');\n        this.container = $(\"<div/>\").addClass(\"container\").attr(\"id\", \"notebook-container\");\n        // We add this end_space div to the end of the notebook div to:\n        // i) provide a margin between the last cell and the end of the notebook\n        // ii) to prevent the div from scrolling up when the last cell is being\n        // edited, but is too low on the page, which browsers will do automatically.\n        var end_space = $('<div/>')\n            .addClass('end_space');\n        end_space.dblclick(function () {\n            var ncells = that.ncells();\n            that.insert_cell_below('code',ncells-1);\n        });\n        this.element.append(this.container);\n        this.container.after(end_space);\n    };\n\n    /**\n     * Bind JavaScript events: key presses and custom Jupyter events.\n     */\n    Notebook.prototype.bind_events = function () {\n        var that = this;\n\n\n        this.events.on('set_next_input.Notebook', function (event, data) {\n            if (data.replace) {\n                data.cell.set_text(data.text);\n                if (data.clear_output !== false) {\n                  // default (undefined) is true to preserve prior behavior\n                  data.cell.clear_output();\n                }\n            } else {\n                var index = that.find_cell_index(data.cell);\n                var new_cell = that.insert_cell_below('code',index);\n                new_cell.set_text(data.text);\n            }\n            that.dirty = true;\n        });\n\n        this.events.on('unrecognized_cell.Cell', function () {\n            that.warn_nbformat_minor();\n        });\n\n        this.events.on('unrecognized_output.OutputArea', function () {\n            that.warn_nbformat_minor();\n        });\n\n        this.events.on('set_dirty.Notebook', function (event, data) {\n            that.dirty = data.value;\n        });\n\n        this.events.on('trust_changed.Notebook', function (event, trusted) {\n            that.trusted = trusted;\n        });\n\n        this.events.on('select.Cell', function (event, data) {\n            var index = that.find_cell_index(data.cell);\n            that.select(index, !data.extendSelection);\n        });\n\n        this.events.on('edit_mode.Cell', function (event, data) {\n            that.handle_edit_mode(data.cell);\n        });\n\n        this.events.on('command_mode.Cell', function (event, data) {\n            that.handle_command_mode(data.cell);\n        });\n        \n        this.events.on('spec_changed.Kernel', function(event, data) {\n            var existing_spec = that.metadata.kernelspec;\n            that.metadata.kernelspec = {\n                name: data.name,\n                display_name: data.spec.display_name,\n                language: data.spec.language,\n            };\n            if (!existing_spec || ! _.isEqual(existing_spec, that.metadata.kernelspec)) {\n                that.set_dirty(true);\n            }\n            // start a new session\n            that.start_session(data.name);\n        });\n\n        this.events.on('kernel_ready.Kernel', function(event, data) {\n            var kinfo = data.kernel.info_reply;\n            if (!kinfo.language_info) {\n                delete that.metadata.language_info;\n                return;\n            }\n            var existing_info = that.metadata.language_info;\n            var langinfo = kinfo.language_info;\n            that.metadata.language_info = langinfo;\n            if (!existing_info || ! _.isEqual(existing_info, langinfo)) {\n                that.set_dirty(true);\n            }\n            // Mode 'null' should be plain, unhighlighted text.\n            var cm_mode = langinfo.codemirror_mode || langinfo.name || 'null';\n            that.set_codemirror_mode(cm_mode);\n        });\n        \n        this.events.on('kernel_idle.Kernel', function () {\n            that.kernel_busy = false;\n        });\n        \n        this.events.on('kernel_busy.Kernel', function () {\n            that.kernel_busy = true;\n        });\n\n        var collapse_time = function (time) {\n            var app_height = $('#ipython-main-app').height(); // content height\n            var splitter_height = $('div#pager_splitter').outerHeight(true);\n            var new_height = app_height - splitter_height;\n            that.element.animate({height : new_height + 'px'}, time);\n        };\n\n        this.element.bind('collapse_pager', function (event, extrap) {\n            var time = (extrap !== undefined) ? ((extrap.duration !== undefined ) ? extrap.duration : 'fast') : 'fast';\n            collapse_time(time);\n        });\n\n        var expand_time = function (time) {\n            var app_height = $('#ipython-main-app').height(); // content height\n            var splitter_height = $('div#pager_splitter').outerHeight(true);\n            var pager_height = $('div#pager').outerHeight(true);\n            var new_height = app_height - pager_height - splitter_height;\n            that.element.animate({height : new_height + 'px'}, time);\n        };\n\n        this.element.bind('expand_pager', function (event, extrap) {\n            var time = (extrap !== undefined) ? ((extrap.duration !== undefined ) ? extrap.duration : 'fast') : 'fast';\n            expand_time(time);\n        });\n\n\n        // Firefox 22 broke $(window).on(\"beforeunload\")\n        // I'm not sure why or how.\n        window.onbeforeunload = function () {\n            /* Make kill kernel configurable.\n            example in custom.js:\n                var notebook = Jupyter.notebook;\n                var config = notebook.config;\n                var patch = {\n                    Notebook:{\n                        kill_kernel: true\n                    }\n                };\n                config.update(patch);\n            */\n            var kill_kernel = that.class_config.get_sync(\"kill_kernel\");\n            if (kill_kernel) {\n                that.session.delete();\n            }\n\n            if ( utils.browser[0] === \"Firefox\") {\n                // Workaround ancient Firefox bug showing beforeunload twice: https://bugzilla.mozilla.org/show_bug.cgi?id=531199\n                if (that._ff_beforeunload_fired) {\n                    return; // don't show twice on FF\n                }\n                that._ff_beforeunload_fired = true;\n                // unset flag immediately after dialog is dismissed\n                setTimeout(function () {\n                    that._ff_beforeunload_fired = false;\n                }, 1);\n            }\n            // if we are autosaving, trigger an autosave on nav-away.\n            // still warn, because if we don't the autosave may fail.\n            if (that.dirty) {\n                // [basthon] we always save in this case\n                that.basthonGUI.backup();\n                return;\n                if ( that.autosave_interval ) {\n                    // schedule autosave in a timeout\n                    // this gives you a chance to forcefully discard changes\n                    // by reloading the page if you *really* want to.\n                    // the timer doesn't start until you *dismiss* the dialog.\n                    setTimeout(function () {\n                        if (that.dirty) {\n                            that.save_notebook();\n                        }\n                    }, 1000);\n                    return i18n.msg._(\"Autosave in progress, latest changes may be lost.\");\n                } else {\n                    return i18n.msg._(\"Unsaved changes will be lost.\");\n                }\n            }\n            // [basthon] disable message showing\n            return;\n            // if the kernel is busy, prompt the user if he’s sure\n            if (that.kernel_busy) {\n                return i18n.msg._(\"The Kernel is busy, outputs may be lost.\");\n            }\n            // IE treats null as a string.  Instead just return which will avoid the dialog.\n            return;\n        };\n    };\n\n    Notebook.prototype.show_command_palette = function() {\n        new commandpalette.CommandPalette(this);\n    };\n\n    Notebook.prototype.show_shortcuts_editor = function() {\n        new ShortcutEditor(this);\n    };\n\n    /**\n     * Trigger a warning dialog about missing functionality from newer minor versions\n     */\n    Notebook.prototype.warn_nbformat_minor = function () {\n        var v = 'v' + this.nbformat + '.';\n        var orig_vs = v + this.nbformat_minor;\n        var this_vs = v + this.current_nbformat_minor;\n        var msg = i18n.msg.sprintf(i18n.msg._(\"This notebook is version %1$s, but we only fully support up to %2$s.\"),\n                orig_vs,this_vs) + \" \" +\n                i18n.msg._(\"You can still work with this notebook, but cell and output types introduced in later notebook versions will not be available.\");\n\n        // This statement is used simply so that message extraction\n        // will pick up the strings.  The actual setting of the text\n        // for the button is in dialog.js.\n        var button_labels = [ \n            i18n.msg._(\"OK\"),\n            i18n.msg._(\"Restart and Run All Cells\"),\n            i18n.msg._(\"Restart and Clear All Outputs\"),\n            i18n.msg._(\"Restart\"),\n            i18n.msg._(\"Continue Running\"),\n            i18n.msg._(\"Reload\"),\n            i18n.msg._(\"Cancel\"),\n            i18n.msg._(\"Overwrite\"),\n            i18n.msg._(\"Trust\"),\n            i18n.msg._(\"Revert\")];\n        \n        dialog.modal({\n            notebook: this,\n            keyboard_manager: this.keyboard_manager,\n            title : i18n.msg._(\"Newer Notebook\"),\n            body : msg,\n            buttons : {\n                OK : {\n                    \"class\" : \"btn-danger\"\n                }\n            }\n        });\n    };\n\n    /**\n     * Set the dirty flag, and trigger the set_dirty.Notebook event\n     */\n    Notebook.prototype.set_dirty = function (value) {\n        if (value === undefined) {\n            value = true;\n        }\n        if (this.dirty === value) {\n            return;\n        }\n        this.events.trigger('set_dirty.Notebook', {value: value});\n    };\n\n    /**\n     * Scroll the top of the page to a given cell.\n     * \n     * @param {integer}  index - An index of the cell to view\n     * @param {integer}  time - Animation time in milliseconds\n     * @return {integer} Pixel offset from the top of the container\n     */\n    Notebook.prototype.scroll_to_cell = function (index, time) {\n        return this.scroll_cell_percent(index, 0, time);\n    };\n\n    /**\n     * Scroll the middle of the page to a given cell.\n     *\n     * @param {integer}  index - An index of the cell to view\n     * @param {integer}  percent - 0-100, the location on the screen to scroll.\n     *                   0 is the top, 100 is the bottom.\n     * @param {integer}  time - Animation time in milliseconds\n     * @return {integer} Pixel offset from the top of the container\n     */\n    Notebook.prototype.scroll_cell_percent = function (index, percent, time) {\n        var cells = this.get_cells();\n        time = time || 0;\n        percent = percent || 0;\n        index = Math.min(cells.length-1,index);\n        index = Math.max(0             ,index);\n        var sme = this.scroll_manager.element;\n        var h = sme.height();\n        var st = sme.scrollTop();\n        var t = sme.offset().top;\n        var ct = cells[index].element.offset().top;\n        var scroll_value =  st + ct - (t + 0.01 * percent * h);\n        this.scroll_manager.element.animate({scrollTop:scroll_value}, time);\n        return scroll_value;\n    };\n\n    /**\n     * Scroll to the bottom of the page.\n     */\n    Notebook.prototype.scroll_to_bottom = function () {\n        this.scroll_manager.element.animate({scrollTop:this.element.get(0).scrollHeight}, 0);\n    };\n\n    /**\n     * Scroll to the top of the page.\n     */\n    Notebook.prototype.scroll_to_top = function () {\n        this.scroll_manager.element.animate({scrollTop:0}, 0);\n    };\n\n    // Edit Notebook metadata\n\n    /**\n     * Display a dialog that allows the user to edit the Notebook's metadata.\n     */\n    Notebook.prototype.edit_metadata = function () {\n        var that = this;\n        dialog.edit_metadata({\n            md: this.metadata, \n            callback: function (new_md) {\n                if(!_.isEqual(that.metadata, new_md)){\n                    that.set_dirty(true);\n                }\n                that.metadata = new_md;\n            },\n            name: 'Notebook',\n            notebook: this,\n            keyboard_manager: this.keyboard_manager});\n    };\n\n    // Cell indexing, retrieval, etc.\n\n    /**\n     * Get all cell elements in the notebook.\n     * \n     * @return {jQuery} A selector of all cell elements\n     */\n    Notebook.prototype.get_cell_elements = function () {\n        var container = this.container || $('#notebook-container');\n        return container.find(\".cell\").not('.cell .cell');\n    };\n\n    /**\n     * Get a particular cell element.\n     * \n     * @param {integer} index An index of a cell to select\n     * @return {jQuery} A selector of the given cell.\n     */\n    Notebook.prototype.get_cell_element = function (index) {\n        var result = null;\n        var e = this.get_cell_elements().eq(index);\n        if (e.length !== 0) {\n            result = e;\n        }\n        return result;\n    };\n\n    /**\n     * Try to get a particular cell by msg_id.\n     * \n     * @param {string} msg_id A message UUID\n     * @return {Cell} Cell or null if no cell was found.\n     */\n    Notebook.prototype.get_msg_cell = function (msg_id) {\n        return codecell.CodeCell.msg_cells[msg_id] || null;\n    };\n\n    /**\n     * Count the cells in this notebook.\n     * \n     * @return {integer} The number of cells in this notebook\n     */\n    Notebook.prototype.ncells = function () {\n        return this.get_cell_elements().length;\n    };\n\n    /**\n     * Get all Cell objects in this notebook.\n     * \n     * @return {Array} This notebook's Cell objects\n     */\n    Notebook.prototype.get_cells = function () {\n        // TODO: we are often calling cells as cells()[i], which we should optimize\n        // to cells(i) or a new method.\n        return this.get_cell_elements().toArray().map(function (e) {\n            return $(e).data(\"cell\");\n        });\n    };\n\n    /**\n     * Get a Cell objects from this notebook.\n     * \n     * @param {integer} index - An index of a cell to retrieve\n     * @return {Cell} Cell or null if no cell was found.\n     */\n    Notebook.prototype.get_cell = function (index) {\n        var result = null;\n        var ce = this.get_cell_element(index);\n        if (ce !== null) {\n            result = ce.data('cell');\n        }\n        return result;\n    };\n\n    /**\n     * Get the cell below a given cell.\n     * \n     * @param {Cell} cell\n     * @return {Cell} the next cell or null if no cell was found.\n     */\n    Notebook.prototype.get_next_cell = function (cell) {\n        var result = null;\n        var index = this.find_cell_index(cell);\n        if (this.is_valid_cell_index(index+1)) {\n            result = this.get_cell(index+1);\n        }\n        return result;\n    };\n    \n    /**\n     * Toggles the display of line numbers in all cells.\n     */\n    Notebook.prototype.toggle_all_line_numbers = function () {\n        this.line_numbers = !this.line_numbers;\n    };\n\n    /**\n     * Get the cell above a given cell.\n     * \n     * @param {Cell} cell\n     * @return {Cell} The previous cell or null if no cell was found.\n     */\n    Notebook.prototype.get_prev_cell = function (cell) {\n        var result = null;\n        var index = this.find_cell_index(cell);\n        if (index !== null && index > 0) {\n            result = this.get_cell(index-1);\n        }\n        return result;\n    };\n    \n    /**\n     * Get the numeric index of a given cell.\n     * \n     * @param {Cell} cell\n     * @return {integer} The cell's numeric index or null if no cell was found.\n     */\n    Notebook.prototype.find_cell_index = function (cell) {\n        var result = null;\n        this.get_cell_elements().filter(function (index) {\n            if ($(this).data(\"cell\") === cell) {\n                result = index;\n            }\n        });\n        return result;\n    };\n\n    /**\n     * Return given index if defined, or the selected index if not.\n     * \n     * @param {integer} [index] - A cell's index\n     * @return {integer} cell index\n     */\n    Notebook.prototype.index_or_selected = function (index) {\n        var i;\n        if (index === undefined || index === null) {\n            i = this.get_selected_index();\n            if (i === null) {\n                i = 0;\n            }\n        } else {\n            i = index;\n        }\n        return i;\n    };\n\n\n    Notebook.prototype.get_selected_cells = function () {\n        return this.get_cells().filter(function(cell, index){ return cell.selected || soft_selected(cell) || cell.anchor;});\n    };\n\n    Notebook.prototype.get_selected_cells_indices = function () {\n\n        var result = [];\n        this.get_cells().filter(function (cell, index) {\n            if (cell.selected || soft_selected(cell) || cell.anchor) {\n                result.push(index);\n            }\n        });\n        return result;\n    };\n\n\n    /**\n     * Get the currently selected cell.\n     * \n     * @return {Cell} The selected cell\n     */\n    Notebook.prototype.get_selected_cell = function () {\n        var index = this.get_selected_index();\n        return this.get_cell(index);\n    };\n\n    /**\n     * Check whether a cell index is valid.\n     * \n     * @param {integer} index - A cell index\n     * @return True if the index is valid, false otherwise\n     */\n    Notebook.prototype.is_valid_cell_index = function (index) {\n        if (index !== null && index >= 0 && index < this.ncells()) {\n            return true;\n        } else {\n            return false;\n        }\n    };\n\n    /**\n     * Returns the index of the cell that the selection is currently anchored on.\n     *\n     * @return {integer} Index of first cell selected in selection\n     */\n    Notebook.prototype.get_anchor_index = function () {\n        var result = null;\n        this.get_cell_elements().filter(function (index) {\n            if ($(this).data(\"cell\").anchor === true) {\n                result = index;\n            }\n        });\n        return result;\n    };\n\n    /**\n     * Get the index of the currently selected cell.\n     *\n     * @return {integer} The selected cell's numeric index\n     */\n    Notebook.prototype.get_selected_index = function () {\n        var result = null;\n        this.get_cell_elements().filter(function (index) {\n            if ($(this).data(\"cell\").selected === true) {\n                result = index;\n            }\n        });\n        return result;\n    };\n\n\n    // Cell selection.\n\n    Notebook.prototype.extend_selection_by = function(delta) {\n        var index = this.get_selected_index();\n        // do not move anchor\n        return this.select(index+delta, false);\n    };\n\n\n    Notebook.prototype.update_soft_selection = function(){\n        var i1 = this.get_selected_index();\n        var i2 = this.get_anchor_index();\n        var low  = Math.min(i1, i2);\n        var high = Math.max(i1, i2);\n        this.get_cells().map(function(cell, index, all){\n            if( low <= index && index <= high && low !== high){\n                cell.element.addClass(_SOFT_SELECTION_CLASS);\n            } else {\n                cell.element.removeClass(_SOFT_SELECTION_CLASS);\n            }\n        });\n    };\n\n\n    Notebook.prototype.select_all = function(){\n        this.select(0, true);\n        this.select(this.ncells()-1, false);\n    };\n\n    Notebook.prototype._contract_selection = function(){\n        var i = this.get_selected_index();\n        this.select(i, true);\n    };\n\n    /**\n     * Programmatically select a cell.\n     * \n     * @param {integer} index - A cell's index\n     * @param {boolean} moveanchor – whether to move the selection\n     *               anchor, default to true.\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype.select = function (index, moveanchor) {\n        moveanchor = (moveanchor===undefined)? true : moveanchor;\n\n        if (this.is_valid_cell_index(index)) {\n            var sindex = this.get_selected_index();\n            if (sindex !== null && index !== sindex) {\n                // If we are about to select a different cell, make sure we are\n                // first in command mode.\n                if (this.mode !== 'command') {\n                    this.command_mode();\n                }\n                this.get_cell(sindex).unselect(moveanchor);\n            }\n            if(moveanchor){\n                this.get_cell(this.get_anchor_index()).unselect(moveanchor);\n            }\n            var cell = this.get_cell(index);\n            cell.select(moveanchor);\n            this.update_soft_selection();\n            if (cell.cell_type === 'heading') {\n                this.events.trigger('selected_cell_type_changed.Notebook',\n                    {\n                        'cell_type': cell.cell_type,\n                        'level': cell.level,\n                        'editable': cell.is_editable()\n                    }\n                );\n            } else {\n                this.events.trigger('selected_cell_type_changed.Notebook',\n                    {\n                        'cell_type': cell.cell_type,\n                        'editable': cell.is_editable()\n                    }\n                );\n            }\n        }\n        return this;\n    };\n\n    /**\n     * Programmatically select the next cell.\n     *\n     * @param {bool} moveanchor – whether to move the selection\n     *               anchor, default to true.\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype.select_next = function (moveanchor) {\n        var index = this.get_selected_index();\n        this.select(index+1, moveanchor);\n        return this;\n    };\n\n    /**\n     * Programmatically select the previous cell.\n     *\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype.select_prev = function (moveanchor) {\n        var index = this.get_selected_index();\n        this.select(index-1, moveanchor);\n        return this;\n    };\n\n\n    // Edit/Command mode\n\n    /**\n     * Gets the index of the cell that is in edit mode.\n     *\n     * @return {integer} index\n     */\n    Notebook.prototype.get_edit_index = function () {\n        var result = null;\n        this.get_cell_elements().filter(function (index) {\n            if ($(this).data(\"cell\").mode === 'edit') {\n                result = index;\n            }\n        });\n        return result;\n    };\n\n    /**\n     * Handle when a a cell blurs and the notebook should enter command mode.\n     *\n     * @param {Cell} [cell] - Cell to enter command mode on.\n     */\n    Notebook.prototype.handle_command_mode = function (cell) {\n        if (this.mode !== 'command') {\n            cell.command_mode();\n            this.mode = 'command';\n            this.events.trigger('command_mode.Notebook');\n            this.keyboard_manager.command_mode();\n        }\n    };\n\n    /**\n     * Make the notebook enter command mode.\n     */\n    Notebook.prototype.command_mode = function () {\n        var cell = this.get_cell(this.get_edit_index());\n        if (cell && this.mode !== 'command') {\n            // We don't call cell.command_mode, but rather blur the CM editor\n            // which will trigger the call to handle_command_mode.\n            cell.code_mirror.getInputField().blur();\n        }\n    };\n\n    /**\n     * Handle when a cell fires it's edit_mode event.\n     *\n     * @param {Cell} [cell] Cell to enter edit mode on.\n     */\n    Notebook.prototype.handle_edit_mode = function (cell) {\n        this._contract_selection();\n        if (cell && this.mode !== 'edit') {\n            cell.edit_mode();\n            this.mode = 'edit';\n            this.events.trigger('edit_mode.Notebook');\n            this.keyboard_manager.edit_mode();\n        }\n    };\n\n    /**\n     * Make a cell enter edit mode.\n     */\n    Notebook.prototype.edit_mode = function () {\n        this._contract_selection();\n        var cell = this.get_selected_cell();\n        if (cell && this.mode !== 'edit') {\n            cell.unrender();\n            cell.focus_editor();\n        }\n    };\n    \n    /**\n     * Ensure either cell, or codemirror is focused. Is none \n     * is focused, focus the cell.\n     */\n    Notebook.prototype.ensure_focused = function(){\n        var cell = this.get_selected_cell();\n        if (cell === null) {return;}  // No cell is selected\n        cell.ensure_focused();\n    };\n\n    /**\n     * Focus the currently selected cell.\n     */\n    Notebook.prototype.focus_cell = function () {\n        var cell = this.get_selected_cell();\n        if (cell === null) {return;}  // No cell is selected\n        cell.focus_cell();\n    };\n\n    // Cell movement\n\n    /**\n     * Move the current selection up, keeping the same cells selected\n     * No op if the selection is at the beginning of the notebook\n     */\n    Notebook.prototype.move_selection_up = function(){\n        // actually will move the cell before the selection, after the selection\n        var indices = this.get_selected_cells_indices();\n        var first = indices[0];\n        var last = indices[indices.length - 1];\n\n        var selected = this.get_selected_index();\n        var anchored = this.get_anchor_index();\n\n        if (first === 0){\n            return;\n        }\n        var tomove = this.get_cell_element(first - 1);\n        var pivot = this.get_cell_element(last);\n\n        tomove.detach();\n        pivot.after(tomove);\n\n        this.get_cell(selected-1).focus_cell();\n        this.select(anchored - 1);\n        this.select(selected - 1, false);\n    };\n\n    /**\n     * Move the current selection down, keeping the same cells selected.\n     * No op if the selection is at the end of the notebook\n     */\n    Notebook.prototype.move_selection_down = function(){\n        // actually will move the cell after the selection, before the selection\n        var indices = this.get_selected_cells_indices();\n        var first = indices[0];\n        var last = indices[indices.length - 1];\n\n        var selected = this.get_selected_index();\n        var anchored = this.get_anchor_index();\n\n        if(!this.is_valid_cell_index(last + 1)){\n            return;\n        }\n        var tomove = this.get_cell_element(last + 1);\n        var pivot = this.get_cell_element(first);\n\n        tomove.detach();\n        pivot.before(tomove);\n\n        this.get_cell(selected+1).focus_cell();\n        this.select(first);\n        this.select(anchored + 1);\n        this.select(selected + 1, false);\n    };\n\n    /**\n     * Move given (or selected) cell up and select it.\n     * \n     * @param {integer} [index] - cell index\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype.move_cell_up = function (index) {\n        console.warn('Notebook.move_cell_up is deprecated as of v4.1 and will be removed in v5.0');\n\n        if(index === undefined){\n            this.move_selection_up();\n            return this;\n        }\n        \n        var i = this.index_or_selected(index);\n        if (this.is_valid_cell_index(i) && i > 0) {\n            var pivot = this.get_cell_element(i-1);\n            var tomove = this.get_cell_element(i);\n            if (pivot !== null && tomove !== null) {\n                tomove.detach();\n                pivot.before(tomove);\n                this.select(i-1);\n                var cell = this.get_selected_cell();\n                cell.focus_cell();\n            }\n            this.set_dirty(true);\n        }\n        return this;\n    };\n\n\n    /**\n     * Move given (or selected) cell down and select it.\n     * \n     * @param {integer} [index] - cell index\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype.move_cell_down = function (index) {\n        console.warn('Notebook.move_cell_down is deprecated as of v4.1 and will be removed in v5.0');\n\n        if(index === undefined){\n            this.move_selection_down();\n            return this;\n        }\n        \n        var i = this.index_or_selected(index);\n        if (this.is_valid_cell_index(i) && this.is_valid_cell_index(i+1)) {\n            var pivot = this.get_cell_element(i+1);\n            var tomove = this.get_cell_element(i);\n            if (pivot !== null && tomove !== null) {\n                tomove.detach();\n                pivot.after(tomove);\n                this.select(i+1);\n                var cell = this.get_selected_cell();\n                cell.focus_cell();\n            }\n        }\n        this.set_dirty();\n        return this;\n    };\n\n\n    // Insertion, deletion.\n\n    /**\n     * Delete a cell from the notebook without any precautions\n     * Needed to reload checkpoints and other things like that.\n     * \n     * @param {integer} [index] - cell's numeric index\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype._unsafe_delete_cell = function (index) {\n        var i = this.index_or_selected(index);\n        var cell = this.get_cell(i);\n\n        $('#undelete_cell').addClass('disabled');\n        $('#undelete_cell > a').attr('aria-disabled','true');\n        if (this.is_valid_cell_index(i)) {\n            var old_ncells = this.ncells();\n            var ce = this.get_cell_element(i);\n            ce.remove();\n            this.set_dirty(true);\n        }\n        return this;\n    };\n\n\n    /**\n     * Delete cells from the notebook\n     *\n     * @param {Array} [indices] - the numeric indices of cells to delete.\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype.delete_cells = function(indices) {\n        if (indices === undefined) {\n            indices = this.get_selected_cells_indices();\n        }\n\n        var undelete_backup = {\n            cells: [],\n            below: false,\n            index: 0,\n        };\n\n        var cursor_ix_before = this.get_selected_index();\n        var deleting_before_cursor = 0;\n        for (var i=0; i < indices.length; i++) {\n            if (!this.get_cell(indices[i]).is_deletable()) {\n                // If any cell is marked undeletable, cancel\n                return this;\n            }\n\n            if (indices[i] < cursor_ix_before) {\n                deleting_before_cursor++;\n            }\n        }\n\n        // If we started deleting cells from the top, the later indices would\n        // get offset. We sort them into descending order to avoid that.\n        indices.sort(function(a, b) {return b-a;});\n        for (i=0; i < indices.length; i++) {\n            var cell = this.get_cell(indices[i]);\n            undelete_backup.cells.push(cell.toJSON());\n            this.get_cell_element(indices[i]).remove();\n            this.events.trigger('delete.Cell', {'cell': cell, 'index': indices[i]});\n        }\n\n        var new_ncells = this.ncells();\n        // Always make sure we have at least one cell.\n        if (new_ncells === 0) {\n            this.insert_cell_below('code');\n            new_ncells = 1;\n        }\n\n        var cursor_ix_after = this.get_selected_index();\n        if (cursor_ix_after === null) {\n            // Selected cell was deleted\n            cursor_ix_after = cursor_ix_before - deleting_before_cursor;\n            if (cursor_ix_after >= new_ncells) {\n                cursor_ix_after = new_ncells - 1;\n                undelete_backup.below = true;\n            }\n            this.select(cursor_ix_after);\n        }\n\n        // Check if the cells were after the cursor\n        for (i=0; i < indices.length; i++) {\n            if (indices[i] > cursor_ix_before) {\n                undelete_backup.below = true;\n            }\n        }\n\n        // This will put all the deleted cells back in one location, rather than\n        // where they came from. It will do until we have proper undo support.\n        undelete_backup.index = cursor_ix_after;\n        $('#undelete_cell').removeClass('disabled');\n        $('#undelete_cell > a').attr('aria-disabled','false');\n        this.undelete_backup_stack.push(undelete_backup);\n        this.set_dirty(true);\n\n        return this;\n    };\n\n    /**\n     * Delete a cell from the notebook.\n     * \n     * @param {integer} [index] - cell's numeric index\n     * @return {Notebook} This notebook\n     */\n    Notebook.prototype.delete_cell = function (index) {\n        if (index === undefined) {\n            return this.delete_cells();\n        } else {\n            return this.delete_cells([index]);\n        }\n    };\n\n    /**\n     * Restore the most recently deleted cells.\n     */\n    Notebook.prototype.undelete_cell = function() {\n        if (this.undelete_backup_stack.length > 0) {\n            var undelete_backup = this.undelete_backup_stack.pop();\n            var i, cell_data, new_cell, insert;\n            if (undelete_backup.below) {\n                insert = $.proxy(this.insert_cell_below, this);\n            } else {\n                insert = $.proxy(this.insert_cell_above, this);\n            }\n            for (i=0; i < undelete_backup.cells.length; i++) {\n                cell_data = undelete_backup.cells[i];\n                new_cell = insert(cell_data.cell_type, undelete_backup.index);\n                new_cell.fromJSON(cell_data);\n            }\n\n            this.set_dirty(true);\n        }\n        if (this.undelete_backup_stack.length === 0) {\n            $('#undelete_cell').addClass('disabled');\n            $('#undelete_cell > a').attr('aria-disabled','true');\n        }\n    };\n\n    /**\n     * Insert a cell so that after insertion the cell is at given index.\n     *\n     * If cell type is not provided, it will default to the type of the\n     * currently active cell.\n     *\n     * Similar to insert_above, but index parameter is mandatory.\n     *\n     * Index will be brought back into the accessible range [0,n].\n     *\n     * @param {string} [type] - in ['code','markdown', 'raw'], defaults to 'code'\n     * @param {integer} [index] - a valid index where to insert cell\n     * @return {Cell|null} created cell or null\n     */\n    Notebook.prototype.insert_cell_at_index = function(type, index){\n\n        var ncells = this.ncells();\n        index = Math.min(index, ncells);\n        index = Math.max(index, 0);\n        var cell = null;\n        type = type || this.class_config.get_sync('default_cell_type');\n        if (type === 'above') {\n            if (index > 0) {\n                type = this.get_cell(index-1).cell_type;\n            } else {\n                type = 'code';\n            }\n        } else if (type === 'below') {\n            if (index < ncells) {\n                type = this.get_cell(index).cell_type;\n            } else {\n                type = 'code';\n            }\n        } else if (type === 'selected') {\n            type = this.get_selected_cell().cell_type;\n        }\n\n        if (ncells === 0 || this.is_valid_cell_index(index) || index === ncells) {\n            var cell_options = {\n                events: this.events, \n                config: this.config, \n                keyboard_manager: this.keyboard_manager, \n                notebook: this,\n                tooltip: this.tooltip\n            };\n            switch(type) {\n            case 'code':\n                cell = new codecell.CodeCell(this.kernel, cell_options);\n                cell.set_input_prompt();\n                break;\n            case 'markdown':\n                cell = new textcell.MarkdownCell(cell_options);\n                break;\n            case 'raw':\n                cell = new textcell.RawCell(cell_options);\n                break;\n            default:\n                console.log(\"Unrecognized cell type: \", type, cellmod);\n                cell = new cellmod.UnrecognizedCell(cell_options);\n            }\n\n            if(this._insert_element_at_index(cell.element,index)) {\n                cell.render();\n                this.events.trigger('create.Cell', {'cell': cell, 'index': index});\n                cell.refresh();\n                // We used to select the cell after we refresh it, but there\n                // are now cases were this method is called where select is\n                // not appropriate. The selection logic should be handled by the\n                // caller of the the top level insert_cell methods.\n                this.set_dirty(true);\n            }\n        }\n        return cell;\n\n    };\n\n    /**\n     * Insert an element at given cell index.\n     *\n     * @param {HTMLElement} element - a cell element\n     * @param {integer}     [index] - a valid index where to inser cell\n     * @returns {boolean}   success\n     */\n    Notebook.prototype._insert_element_at_index = function(element, index){\n        if (element === undefined){\n            return false;\n        }\n\n        var ncells = this.ncells();\n\n        if (ncells === 0) {\n            // special case append if empty\n            this.container.append(element);\n        } else if ( ncells === index ) {\n            // special case append it the end, but not empty\n            this.get_cell_element(index-1).after(element);\n        } else if (this.is_valid_cell_index(index)) {\n            // otherwise always somewhere to append to\n            this.get_cell_element(index).before(element);\n        } else {\n            return false;\n        }\n        \n        this.undelete_backup_stack.map(function (undelete_backup) {\n            if (index < undelete_backup.index) {\n                undelete_backup.index += 1;\n            }\n        });\n        this.set_dirty(true);\n        return true;\n    };\n\n    /**\n     * Insert a cell of given type above given index, or at top\n     * of notebook if index smaller than 0.\n     *\n     * @param {string}     [type] - cell type\n     * @param {integer}    [index] - defaults to the currently selected cell\n     * @return {Cell|null} handle to created cell or null\n     */\n    Notebook.prototype.insert_cell_above = function (type, index) {\n        if (index === null || index === undefined) {\n            index = Math.min(this.get_selected_index(index), this.get_anchor_index());\n        }\n        return this.insert_cell_at_index(type, index);\n    };\n\n    /**\n     * Insert a cell of given type below given index, or at bottom\n     * of notebook if index greater than number of cells\n     *\n     * @param {string}     [type] - cell type\n     * @param {integer}    [index] - defaults to the currently selected cell\n     * @return {Cell|null} handle to created cell or null\n     */\n    Notebook.prototype.insert_cell_below = function (type, index) {\n        if (index === null || index === undefined) {            \n            index = Math.max(this.get_selected_index(index), this.get_anchor_index());\n        }\n        return this.insert_cell_at_index(type, index+1);\n    };\n\n\n    /**\n     * Insert cell at end of notebook\n     *\n     * @param {string} type - cell type\n     * @return {Cell|null} handle to created cell or null\n     */\n    Notebook.prototype.insert_cell_at_bottom = function (type){\n        var len = this.ncells();\n        return this.insert_cell_below(type,len-1);\n    };\n    \n    /**\n     * Turn one or more cells into code.\n     *\n     * @param {Array} indices - cell indices to convert\n     */\n    Notebook.prototype.cells_to_code = function (indices) {\n        if (indices === undefined){\n            indices = this.get_selected_cells_indices();\n        }\n        \n        for (var i=0; i <indices.length; i++){\n            this.to_code(indices[i]);\n        }\n    };\n\n    /**\n     * Turn a cell into a code cell.\n     * \n     * @param {integer} [index] - cell index\n     */\n    Notebook.prototype.to_code = function (index) {\n        var i = this.index_or_selected(index);\n        if (this.is_valid_cell_index(i)) {\n            var source_cell = this.get_cell(i);\n            if (!(source_cell instanceof codecell.CodeCell) && source_cell.is_editable()) {\n                var target_cell = this.insert_cell_below('code',i);\n                var text = source_cell.get_text();\n                if (text === source_cell.placeholder) {\n                    text = '';\n                }\n                //metadata\n                target_cell.metadata = source_cell.metadata;\n                // attachments (we transfer them so they aren't lost if the\n                // cell is turned back into markdown)\n                target_cell.attachments = source_cell.attachments;\n\n                target_cell.set_text(text);\n                // make this value the starting point, so that we can only undo\n                // to this state, instead of a blank cell\n                target_cell.code_mirror.clearHistory();\n                source_cell.element.remove();\n                this.select(i);\n                var cursor = source_cell.code_mirror.getCursor();\n                target_cell.code_mirror.setCursor(cursor);\n                this.set_dirty(true);\n            }\n        }\n    };\n\n    /**\n     * Turn one or more cells into Markdown.\n     *\n     * @param {Array} indices - cell indices to convert\n     */\n     Notebook.prototype.cells_to_markdown = function (indices) {\n        if (indices === undefined) {\n            indices = this.get_selected_cells_indices();\n        }\n\n        for(var i=0; i < indices.length; i++) {\n            this.to_markdown(indices[i]);\n        }\n     };\n\n    /**\n     * Turn a cell into a Markdown cell.\n     * \n     * @param {integer} [index] - cell index\n     */\n    Notebook.prototype.to_markdown = function (index) {\n        var i = this.index_or_selected(index);\n        if (this.is_valid_cell_index(i)) {\n            var source_cell = this.get_cell(i);\n\n            if (!(source_cell instanceof textcell.MarkdownCell) && source_cell.is_editable()) {\n                var target_cell = this.insert_cell_below('markdown',i);\n                var text = source_cell.get_text();\n\n                if (text === source_cell.placeholder) {\n                    text = '';\n                }\n                // metadata\n                target_cell.metadata = source_cell.metadata;\n                target_cell.attachments = source_cell.attachments;\n\n                // We must show the editor before setting its contents\n                target_cell.unrender();\n                target_cell.set_text(text);\n                // make this value the starting point, so that we can only undo\n                // to this state, instead of a blank cell\n                target_cell.code_mirror.clearHistory();\n                source_cell.element.remove();\n                this.select(i);\n                if ((source_cell instanceof textcell.TextCell) && source_cell.rendered) {\n                    target_cell.render();\n                }\n                var cursor = source_cell.code_mirror.getCursor();\n                target_cell.code_mirror.setCursor(cursor);\n                this.set_dirty(true);\n            }\n        }\n    };\n\n    /**\n     * Turn one or more cells into a raw text cell.\n     *\n     * @param {Array} indices - cell indices to convert\n     */\n     Notebook.prototype.cells_to_raw = function (indices) {\n        if (indices === undefined) {\n            indices = this.get_selected_cells_indices();\n        }\n\n        for(var i=0; i < indices.length; i++) {\n            this.to_raw(indices[i]);\n        }\n     };\n\n    /**\n     * Turn a cell into a raw text cell.\n     * \n     * @param {integer} [index] - cell index\n     */\n    Notebook.prototype.to_raw = function (index) {\n        var i = this.index_or_selected(index);\n        if (this.is_valid_cell_index(i)) {\n            var target_cell = null;\n            var source_cell = this.get_cell(i);\n\n            if (!(source_cell instanceof textcell.RawCell) && source_cell.is_editable()) {\n                target_cell = this.insert_cell_below('raw',i);\n                var text = source_cell.get_text();\n                if (text === source_cell.placeholder) {\n                    text = '';\n                }\n                //metadata\n                target_cell.metadata = source_cell.metadata;\n                // attachments (we transfer them so they aren't lost if the\n                // cell is turned back into markdown)\n                target_cell.attachments = source_cell.attachments;\n\n                // We must show the editor before setting its contents\n                target_cell.unrender();\n                target_cell.set_text(text);\n                // make this value the starting point, so that we can only undo\n                // to this state, instead of a blank cell\n                target_cell.code_mirror.clearHistory();\n                source_cell.element.remove();\n                this.select(i);\n                var cursor = source_cell.code_mirror.getCursor();\n                target_cell.code_mirror.setCursor(cursor);\n                this.set_dirty(true);\n            }\n        }\n    };\n    \n    /**\n     * Warn about heading cell support removal.\n     */\n    Notebook.prototype._warn_heading = function () {\n        dialog.modal({\n            notebook: this,\n            keyboard_manager: this.keyboard_manager,\n            title : i18n.msg._(\"Use markdown headings\"),\n            body : $(\"<p/>\").text(\n                i18n.msg._('Jupyter no longer uses special heading cells. ' + \n                'Instead, write your headings in Markdown cells using # characters:')\n            ).append($('<pre/>').text(\n                i18n.msg._('## This is a level 2 heading')\n            )),\n            buttons : {\n                \"OK\" : {}\n            }\n        });\n    };\n    \n    /**\n     * Turn a cell into a heading containing markdown cell.\n     * \n     * @param {integer} [index] - cell index\n     * @param {integer} [level] - heading level (e.g., 1 for h1)\n     */\n    Notebook.prototype.to_heading = function (index, level) {\n        this.to_markdown(index);\n        level = level || 1;\n        var i = this.index_or_selected(index);\n        if (this.is_valid_cell_index(i)) {\n            var cell = this.get_cell(i);\n            cell.set_heading_level(level);\n            this.set_dirty(true);\n        }\n    };\n\n\n    // Cut/Copy/Paste\n\n    /**\n     * Enable the UI elements for pasting cells.\n     */\n    Notebook.prototype.enable_paste = function () {\n        var that = this;\n        if (!this.paste_enabled) {\n            $('#paste_cell_replace').removeClass('disabled')\n                .on('click', function () {that.keyboard_manager.actions.call(\n                    'jupyter-notebook:paste-cell-replace');});\n            $('#paste_cell_replace > a').attr('aria-disabled', 'false'); \n            $('#paste_cell_above').removeClass('disabled')\n                .on('click', function () {that.keyboard_manager.actions.call(\n                    'jupyter-notebook:paste-cell-above');});\n            $('#paste_cell_above > a').attr('aria-disabled', 'false'); \n            $('#paste_cell_below').removeClass('disabled')\n                .on('click', function () {that.keyboard_manager.actions.call(\n                    'jupyter-notebook:paste-cell-below');});\n            $('#paste_cell_below > a').attr('aria-disabled', 'false');         \n            this.paste_enabled = true;\n        }\n    };\n\n    /**\n     * Disable the UI elements for pasting cells.\n     */\n    Notebook.prototype.disable_paste = function () {\n        if (this.paste_enabled) {\n            $('#paste_cell_replace').addClass('disabled').off('click');\n            $('#paste_cell_replace > a').attr('aria-disabled', 'true'); \n            $('#paste_cell_above').addClass('disabled').off('click');\n            $('#paste_cell_above > a').attr('aria-disabled', 'true'); \n            $('#paste_cell_below').addClass('disabled').off('click');\n            $('#paste_cell_below > a').attr('aria-disabled', 'true'); \n            this.paste_enabled = false;\n        }\n    };\n\n    /**\n     * Cut a cell.\n     */\n    Notebook.prototype.cut_cell = function () {\n        this.copy_cell();\n        this.delete_cell();\n    };\n\n    /**\n     * Copy cells.\n     */\n    Notebook.prototype.copy_cell = function () {\n        var cells = this.get_selected_cells();\n        if (cells.length === 0) {\n            cells = [this.get_selected_cell()];\n        }\n        \n        this.clipboard = [];\n        var cell_json;\n        for (var i=0; i < cells.length; i++) {\n            cell_json = cells[i].toJSON();\n            if (cell_json.metadata.deletable !== undefined) {\n                delete cell_json.metadata.deletable;\n            }\n            this.clipboard.push(cell_json);\n        }\n        this.enable_paste();\n    };\n\n    /**\n     * Replace the selected cell with the cells in the clipboard.\n     */\n    Notebook.prototype.paste_cell_replace = function () {\n\n        if (!(this.clipboard !== null && this.paste_enabled)) {\n            return;\n        }\n\n        var selected =  this.get_selected_cells_indices();\n        var insertion_index = selected[0];\n        this.delete_cells(selected);\n\n        for (var i=this.clipboard.length-1; i >= 0; i--) {\n            var cell_data = this.clipboard[i];\n            var new_cell = this.insert_cell_at_index(cell_data.cell_type, insertion_index);\n            new_cell.fromJSON(cell_data);\n        }\n\n        this.select(insertion_index+this.clipboard.length-1);\n    };\n\n    /**\n     * Paste cells from the clipboard above the selected cell.\n     */\n    Notebook.prototype.paste_cell_above = function () {\n        if (this.clipboard !== null && this.paste_enabled) {\n            var first_inserted = null;\n            for (var i=0; i < this.clipboard.length; i++) {\n                var cell_data = this.clipboard[i];\n                var new_cell = this.insert_cell_above(cell_data.cell_type);\n                new_cell.fromJSON(cell_data);\n                if (first_inserted === null) {\n                    first_inserted = new_cell;\n                }\n            }\n            first_inserted.focus_cell();\n        }\n    };\n\n    /**\n     * Paste cells from the clipboard below the selected cell.\n     */\n    Notebook.prototype.paste_cell_below = function () {\n        if (this.clipboard !== null && this.paste_enabled) {\n            var first_inserted = null;\n            for (var i = this.clipboard.length-1; i >= 0; i--) {\n                var cell_data = this.clipboard[i];\n                var new_cell = this.insert_cell_below(cell_data.cell_type);\n                new_cell.fromJSON(cell_data);\n                if (first_inserted === null) {\n                    first_inserted = new_cell;\n                }\n            }\n            first_inserted.focus_cell();\n        }\n    };\n    \n    /**\n     * Re-render the output of a CodeCell.\n     */\n    Notebook.prototype.render_cell_output = function (code_cell) {\n        var cell_data = code_cell.toJSON();\n        var cell_index = this.find_cell_index(code_cell);\n        var trusted = code_cell.output_area.trusted;\n        this.clear_output(cell_index);\n        code_cell.output_area.trusted = trusted;\n        code_cell.fromJSON(cell_data);\n    };\n\n    // Split/merge\n\n    /**\n     * Split the selected cell into two cells.\n     */\n    Notebook.prototype.split_cell = function () {\n        var cell = this.get_selected_cell();\n        if (cell.is_splittable()) {\n            var texta = cell.get_pre_cursor();\n            var textb = cell.get_post_cursor();\n            // current cell becomes the second one\n            // so we don't need to worry about selection\n            cell.set_text(textb);\n            // create new cell with same type\n            var new_cell = this.insert_cell_above(cell.cell_type);\n            // Unrender the new cell so we can call set_text.\n            new_cell.unrender();\n            new_cell.set_text(texta);\n            // duplicate metadata\n            new_cell.metadata = JSON.parse(JSON.stringify(cell.metadata));\n        }\n    };\n\n    /**\n     * Merge a series of cells into one\n     *\n     * @param {Array} indices - the numeric indices of the cells to be merged\n     * @param {boolean} into_last - merge into the last cell instead of the first\n     */\n    Notebook.prototype.merge_cells = function(indices, into_last) {\n        if (indices.length <= 1) {\n            return;\n        }\n\n        // Check if trying to merge above on topmost cell or wrap around\n        // when merging above, see #330\n        if (indices.filter(function(item) {return item < 0;}).length > 0) {\n            return;\n        }\n\n        for (var i=0; i < indices.length; i++) {\n            if (!this.get_cell(indices[i]).is_mergeable()) {\n                return;\n            }\n        }\n        var target = this.get_cell(into_last ? indices.pop() : indices.shift());\n\n        // Get all the cells' contents\n        var contents = [];\n        for (i=0; i < indices.length; i++) {\n            contents.push(this.get_cell(indices[i]).get_text());\n        }\n        if (into_last) {\n            contents.push(target.get_text());\n        } else {\n            contents.unshift(target.get_text());\n        }\n\n        // Update the contents of the target cell\n        if (target instanceof codecell.CodeCell) {\n            target.set_text(contents.join('\\n\\n'));\n        } else {\n            var was_rendered = target.rendered;\n            target.unrender(); // Must unrender before we set_text.\n            target.set_text(contents.join('\\n\\n'));\n            if (was_rendered) {\n                // The rendered state of the final cell should match\n                // that of the original selected cell;\n                target.render();\n            }\n        }\n\n        // Delete the other cells\n        this.delete_cells(indices);\n        \n        // Reset the target cell's undo history\n        target.code_mirror.clearHistory();\n\n        this.select(this.find_cell_index(target));\n    };\n\n    /**\n     * Merge the selected range of cells\n     */\n    Notebook.prototype.merge_selected_cells = function() {\n        this.merge_cells(this.get_selected_cells_indices());\n    };\n\n    /**\n     * Merge the selected cell into the cell above it.\n     */\n    Notebook.prototype.merge_cell_above = function () {\n        var index = this.get_selected_index();\n        this.merge_cells([index-1, index], true);\n    };\n\n    /**\n     * Merge the selected cell into the cell below it.\n     */\n    Notebook.prototype.merge_cell_below = function () {\n        var index = this.get_selected_index();\n        this.merge_cells([index, index+1], false);\n    };\n\n    /**\n     * Set the global (CSS) theme.\n     *\n     * Possible values are:\n     * \"ipython\" (aka \"light\")\n     * \"darcula\" (aka \"darck\")\n     */\n    Notebook.prototype.set_theme = function (theme) {\n        // theme aliases\n        const alias = {\n            \"dark\": \"darcula\",\n            \"light\": \"ipython\",\n        };\n        theme = alias[theme] ?? theme;\n        // dynamic theme load\n        switch(theme) {\n            case \"darcula\":\n                import(\"codemirror/theme/darcula.css\");\n                import(\"css/darcula-patch.css\");\n                break;\n        }\n        // codemirror default config update (new cell creation)\n        let cm_config = codecell.CodeCell?.options_default?.cm_config;\n        if( cm_config != null ) cm_config.theme = theme;\n        cm_config = textcell.TextCell?.options_default?.cm_config;\n        if( cm_config != null ) cm_config.theme = theme === \"ipython\" ? undefined : theme;\n        // change codemirror theme for all existing cells\n        for( const cell of this.get_cells() ) {\n            cell.code_mirror?.setOption?.(\"theme\", theme);\n        }\n        // replace class 'cm-s-ipython' and 'cm-s-darcula' with 'cm-s-${theme}'\n        const old_class = `cm-s-${theme === 'darcula' ? 'ipython' : 'darcula'}`;\n        const new_class = `cm-s-${theme}`;\n        const elements = Array.from(document.getElementsByClassName(old_class));\n        for (const e of elements) {\n            const cl = e.classList;\n            cl.add(new_class);\n            cl.remove(old_class);\n        }\n        // tell marked to use the right theme in codemirror\n        marked.setOptions({ langPrefix: `${new_class} language-`});\n        // change CSS variables values using data-theme attribute\n        document.documentElement.setAttribute('data-theme', theme);\n    }\n\n    /**\n     * Get the actual CSS theme (light/dark).\n     */\n    Notebook.prototype.theme = function () {\n        const theme = document.documentElement.getAttribute('data-theme');\n        const dark = theme === \"darcula\";\n        return dark ? \"dark\" : \"light\";\n    }\n\n    /**\n     * Switch the global (CSS) theme between light and dark.\n     */\n    Notebook.prototype.switch_theme = function () {\n        const new_theme = this.theme() === \"light\" ? \"dark\" : \"light\";\n        this.set_theme(new_theme);\n    }\n\n    // Attachments handling\n\n    /**\n     * Shows a dialog letting the user pick an image from her computer and\n     * insert it into the edited markdown cell\n     */\n    Notebook.prototype.insert_image = function () {\n        var that = this;\n        var cell = this.get_selected_cell();\n        // The following should not happen as the menu item is greyed out\n        // when those conditions are not fulfilled (see MarkdownCell\n        // unselect/select/unrender handlers)\n        if (cell.cell_type !== 'markdown') {\n            console.log('Error: insert_image called on non-markdown cell');\n            return;\n        }\n        if (cell.rendered) {\n            console.log('Error: insert_image called on rendered cell');\n            return;\n        }\n        dialog.insert_image({\n            callback: function(file) {\n                cell.edit_mode();\n                cell.insert_inline_image_from_blob(file);\n            },\n            notebook: this,\n            keyboard_manager: this.keyboard_manager\n        });\n    };\n\n    /**\n     * Cut the attachments of a cell\n     */\n    Notebook.prototype.cut_cell_attachments = function() {\n        var cell = this.get_selected_cell();\n        if (cell.attachments !== undefined) {\n            this.clipboard_attachments = cell.attachments;\n            this.enable_attachments_paste();\n            delete cell.attachments;\n            cell.unrender();\n            cell.render();\n        }\n    };\n\n    /**\n     * Copy the attachments of a cell\n     */\n    Notebook.prototype.copy_cell_attachments = function() {\n        var cell = this.get_selected_cell();\n        if (cell.attachments !== undefined) {\n          // Do a deep copy of attachments to avoid subsequent modification\n          // to the cell to modify the clipboard\n          this.clipboard_attachments = $.extend(true, {}, cell.attachments);\n          this.enable_attachments_paste();\n        }\n    };\n\n    /**\n     * Paste the attachments in the clipboard into the currently selected\n     * cell\n     */\n    Notebook.prototype.paste_cell_attachments = function() {\n        if (this.clipboard_attachments !== null &&\n            this.paste_attachments_enabled) {\n            var cell = this.get_selected_cell();\n            if (cell.attachments === undefined) {\n              cell.attachments = {};\n            }\n            // Do a deep copy so we can paste multiple times\n            $.extend(true, cell.attachments, this.clipboard_attachments);\n            cell.unrender();\n            cell.render();\n        }\n    };\n\n    /**\n     * Disable the \"Paste Cell Attachments\" menu item\n     */\n    Notebook.prototype.disable_attachments_paste = function () {\n        if (this.paste_attachments_enabled) {\n            $('#paste_cell_attachments').addClass('disabled');\n            $('#paste_cell_attachments > a').attr('disabled','true');\n            this.paste_attachments_enabled = false;\n        }\n    };\n\n    /**\n     * Enable the \"Paste Cell Attachments\" menu item\n     */\n    Notebook.prototype.enable_attachments_paste = function () {\n        if (!this.paste_attachments_enabled) {\n            $('#paste_cell_attachments').removeClass('disabled');\n            $('#paste_cell_attachments > a').attr('aria-disabled','false');\n            this.paste_attachments_enabled = true;\n        }\n    };\n\n    /**\n     * Enable/disable the \"Insert image\" menu item\n     */\n    Notebook.prototype.set_insert_image_enabled = function(enabled) {\n        if (enabled) {\n            $('#insert_image').removeClass('disabled');\n            $('#insert_image > a').attr('aria-disabled', 'false');\n        } else {\n            $('#insert_image').addClass('disabled');\n            $('#insert_image > a').attr('aria-disabled', 'true');\n        }\n    };\n\n    // Cell collapsing and output clearing\n\n    /**\n     * Hide a cell's output.\n     * \n     * @param {integer} index - cell index\n     */\n    Notebook.prototype.collapse_output = function (index) {\n        var i = this.index_or_selected(index);\n        var cell = this.get_cell(i);\n        if (cell !== null && (cell instanceof codecell.CodeCell)) {\n            cell.collapse_output();\n            this.set_dirty(true);\n        }\n    };\n\n    /**\n     * Hide each code cell's output area.\n     */\n    Notebook.prototype.collapse_all_output = function () {\n        this.get_cells().map(function (cell) {\n            if (cell instanceof codecell.CodeCell) {\n                cell.collapse_output();\n            }\n        });\n        // this should not be set if the `collapse` key is removed from nbformat\n        this.set_dirty(true);\n    };\n\n    /**\n     * Show a cell's output.\n     * \n     * @param {integer} index - cell index\n     */\n    Notebook.prototype.expand_output = function (index) {\n        var i = this.index_or_selected(index);\n        var cell = this.get_cell(i);\n        if (cell !== null && (cell instanceof codecell.CodeCell)) {\n            cell.expand_output();\n            this.set_dirty(true);\n        }\n    };\n\n    /**\n     * Expand each code cell's output area, and remove scrollbars.\n     */\n    Notebook.prototype.expand_all_output = function () {\n        this.get_cells().map(function (cell) {\n            if (cell instanceof codecell.CodeCell) {\n                cell.expand_output();\n            }\n        });\n        // this should not be set if the `collapse` key is removed from nbformat\n        this.set_dirty(true);\n    };\n\n    /**\n     * Clear the selected CodeCell's output area.\n     * \n     * @param {integer} index - cell index\n     */\n    Notebook.prototype.clear_output = function (index) {\n        var i = this.index_or_selected(index);\n        var cell = this.get_cell(i);\n        if (cell !== null && (cell instanceof codecell.CodeCell)) {\n            cell.clear_output();\n            this.set_dirty(true);\n        }\n    };\n\n    /**\n     * Clear multiple selected CodeCells' output areas.\n     *\n     */\n    Notebook.prototype.clear_cells_outputs = function(indices) {\n        if (!indices) {\n           indices = this.get_selected_cells_indices();\n        }\n\n        for (var i = 0; i < indices.length; i++){\n            this.clear_output(indices[i]);\n        }\n    };\n\n    /**\n     * Clear each code cell's output area.\n     */\n    Notebook.prototype.clear_all_output = function () {\n        this.get_cells().map(function (cell) {\n            if (cell instanceof codecell.CodeCell) {\n                cell.clear_output();\n            }\n        });\n        this.set_dirty(true);\n    };\n\n    /**\n     * Scroll the selected CodeCell's output area.\n     * \n     * @param {integer} index - cell index\n     */\n    Notebook.prototype.scroll_output = function (index) {\n        var i = this.index_or_selected(index);\n        var cell = this.get_cell(i);\n        if (cell !== null && (cell instanceof codecell.CodeCell)) {\n            cell.scroll_output();\n            this.set_dirty(true);\n        }\n    };\n\n    /**\n     * Expand each code cell's output area and add a scrollbar for long output.\n     */\n    Notebook.prototype.scroll_all_output = function () {\n        this.get_cells().map(function (cell, i) {\n            if (cell instanceof codecell.CodeCell) {\n                cell.scroll_output();\n            }\n        });\n        // this should not be set if the `collapse` key is removed from nbformat\n        this.set_dirty(true);\n    };\n\n    /** \n     * Toggle whether a cell's output is collapsed or expanded.\n     * \n     * @param {integer} index - cell index\n     */\n    Notebook.prototype.toggle_output = function (index) {\n        var i = this.index_or_selected(index);\n        var cell = this.get_cell(i);\n        if (cell !== null && (cell instanceof codecell.CodeCell)) {\n            cell.toggle_output();\n            this.set_dirty(true);\n        }\n    };\n\n    /**\n     * Toggle whether all selected cells' outputs are collapsed or expanded.\n     *\n     * @param {integer} indices - the indices of the cells to toggle\n     */\n    Notebook.prototype.toggle_cells_outputs = function(indices) {\n        if (!indices) {\n            indices = this.get_selected_cells_indices();\n        }\n\n        for (var i = 0; i < indices.length; i++){\n            this.toggle_output(indices[i]);\n        }\n    };\n\n    /**\n     * Toggle the output of all cells.\n     */\n    Notebook.prototype.toggle_all_output = function () {\n        this.get_cells().map(function (cell) {\n            if (cell instanceof codecell.CodeCell) {\n                cell.toggle_output();\n            }\n        });\n        // this should not be set if the `collapse` key is removed from nbformat\n        this.set_dirty(true);\n    };\n\n    /**\n     * Toggle a scrollbar for long cell outputs.\n     * \n     * @param {integer} index - cell index\n     */\n    Notebook.prototype.toggle_output_scroll = function (index) {\n        var i = this.index_or_selected(index);\n        var cell = this.get_cell(i);\n        if (cell !== null && (cell instanceof codecell.CodeCell)) {\n            cell.toggle_output_scroll();\n            this.set_dirty(true);\n        }\n    };\n\n    /**\n     * Toggle a scrollbar for selected long cells' outputs.\n     *\n     * @param {integer} indices - the indices of the cells to toggle\n     */\n    Notebook.prototype.toggle_cells_outputs_scroll = function(indices) {\n        if (!indices) {\n            indices = this.get_selected_cells_indices();\n        }\n\n        for (var i = 0; i < indices.length; i++){\n            this.toggle_output_scroll(indices[i]);\n        }\n    };\n\n    /**\n     * Toggle the scrolling of long output on all cells.\n     */\n    Notebook.prototype.toggle_all_output_scroll = function () {\n        this.get_cells().map(function (cell) {\n            if (cell instanceof codecell.CodeCell) {\n                cell.toggle_output_scroll();\n            }\n        });\n        // this should not be set if the `collapse` key is removed from nbformat\n        this.set_dirty(true);\n    };\n\n    // Other cell functions: line numbers, ...\n\n    /**\n     * Toggle line numbers in the selected cell's input area.\n     */\n    Notebook.prototype.cell_toggle_line_numbers = function() {\n        this.get_selected_cells().map(function(cell){cell.toggle_line_numbers();});\n    };\n\n\n    //dispatch codemirror mode to all cells.\n    Notebook.prototype._dispatch_mode = function(spec, newmode){\n        this.codemirror_mode = newmode;\n        codecell.CodeCell.options_default.cm_config.mode = newmode;\n        this.get_cells().map(function(cell) {\n            if (cell.cell_type === 'code'){\n                cell.code_mirror.setOption('mode', spec);\n                // This is currently redundant, because cm_config ends up as\n                // codemirror's own .options object, but I don't want to\n                // rely on that.\n                cell._options.cm_config.mode = spec;\n            }\n        });\n\n    };\n\n    // roughly try to check mode equality\n    var _mode_equal = function(mode1, mode2){\n        return ((mode1||{}).name||mode1)===((mode2||{}).name||mode2);\n    };\n    \n    /**\n     * Set the codemirror mode for all code cells, including the default for\n     * new code cells.\n     * Set the mode to 'null' (no highlighting) if it can't be found.\n     */\n    Notebook.prototype.set_codemirror_mode = function(newmode){\n        // if mode is the same don't reset,\n        // to avoid n-time re-highlighting.\n        if (_mode_equal(newmode, this.codemirror_mode)) {\n            return;\n        }\n        \n        var that = this;\n        utils.requireCodeMirrorMode(newmode, function (spec) {\n            that._dispatch_mode(spec, newmode);\n        }, function(){\n            // on error don't dispatch the new mode as re-setting it later will not work.\n            // don't either set to null mode if it has been changed in the meantime\n            if( _mode_equal(newmode, that.codemirror_mode) ){\n                that._dispatch_mode('null','null');\n            }\n        });\n    };\n\n    // Session related things\n\n    /**\n     * Start a new session and set it on each code cell.\n     */\n    Notebook.prototype.start_session = function (kernel_name) {\n        if (this._session_starting) {\n            throw new session.SessionAlreadyStarting();\n        }\n        this._session_starting = true;\n\n        var options = {\n            base_url: this.base_url,\n            ws_url: this.ws_url,\n            notebook_path: this.notebook_path,\n            notebook_name: this.notebook_name,\n            kernel_name: kernel_name,\n            notebook: this\n        };\n\n        var success = $.proxy(this._session_started, this);\n        var failure = $.proxy(this._session_start_failed, this);\n\n        if (this.session && this.session.kernel) {\n            this.session.restart(options, success, failure);\n        } else {\n            this.session = new session.Session(options);\n            this.session.start(success, failure);\n        }\n    };\n\n\n    /**\n     * Once a session is started, link the code cells to the kernel and pass the \n     * comm manager to the widget manager.\n     */\n    Notebook.prototype._session_started = function (){\n        this._session_starting = false;\n        this.kernel = this.session.kernel;\n        var ncells = this.ncells();\n        for (var i=0; i<ncells; i++) {\n            var cell = this.get_cell(i);\n            if (cell instanceof codecell.CodeCell) {\n                cell.set_kernel(this.session.kernel);\n            }\n        }\n        // select (give focus to) first cell in edit mode\n        if(ncells > 0) {\n            this.select(0);\n            this.edit_mode();\n        }\n    };\n\n    /**\n     * Called when the session fails to start.\n     */\n    Notebook.prototype._session_start_failed = function(jqxhr, status, error){\n        this._session_starting = false;\n        utils.log_ajax_error(jqxhr, status, error);\n    };\n    \n    /**\n     * Prompt the user to restart the kernel and re-run everything.\n     * if options.confirm === false, no confirmation dialog is shown.\n     */\n    Notebook.prototype.restart_run_all = function (options) {\n        var that = this;\n        var restart_options = {};\n        restart_options.confirm = (options || {}).confirm;\n        restart_options.dialog = {\n            notebook: that,\n            keyboard_manager: that.keyboard_manager,\n            title : i18n.msg._(\"Restart kernel and re-run the whole notebook?\"),\n            body : $(\"<p/>\").text(\n                i18n.msg._('Are you sure you want to restart the current kernel and re-execute the whole notebook?  All variables and outputs will be lost.')\n            ),\n            buttons : {\n                \"Restart and Run All Cells\" : {\n                    \"class\" : \"btn-danger\",\n                    \"click\" : function () {\n                        that.execute_all_cells();\n                    },\n                },\n            }\n        };\n        return this._restart_kernel(restart_options);\n    };\n\n    /**\n     * Prompt the user to restart the kernel and clear output.\n     * if options.confirm === false, no confirmation dialog is shown.\n     */\n    Notebook.prototype.restart_clear_output = function (options) {\n        var that = this;\n        var restart_options = {};\n        restart_options.confirm = (options || {}).confirm;\n        restart_options.dialog = {\n            notebook: that,\n            keyboard_manager: that.keyboard_manager,\n            title : i18n.msg._(\"Restart kernel and clear all output?\"),\n            body : $(\"<p/>\").text(\n                i18n.msg._('Do you want to restart the current kernel and clear all output?  All variables and outputs will be lost.')\n            ),\n            buttons : {\n                \"Restart and Clear All Outputs\" : {\n                    \"class\" : \"btn-danger\",\n                    \"click\" : function (){\n                        that.clear_all_output();\n                    },\n                },\n            }\n        };\n        return this._restart_kernel(restart_options);\n    };\n\n    /**\n     * Prompt the user to restart the kernel.\n     * if options.confirm === false, no confirmation dialog is shown.\n     */\n    Notebook.prototype.shutdown_kernel = function (options) {\n        var that = this;\n        var shutdown_options = {};\n        shutdown_options.confirm = (options || {}).confirm;\n        shutdown_options.dialog = {\n            title : \"Shutdown kernel?\",\n            body : $(\"<p/>\").text(\n                i18n.msg._('Do you want to shutdown the current kernel?  All variables will be lost.')\n            ),\n            buttons : {\n                \"Shutdown\" : {\n                    \"class\" : \"btn-danger\",\n                    \"click\" : function () {},\n                },\n            }\n        };\n        shutdown_options.kernel_action = function() {\n            that.session.delete();\n        };\n        return this._restart_kernel(shutdown_options);\n    };\n\n    Notebook.prototype.restart_kernel = function (options) {\n        var restart_options = {};\n        restart_options.confirm = (options || {}).confirm;\n        restart_options.dialog = {\n            title : i18n.msg._(\"Restart kernel?\"),\n            body : $(\"<p/>\").text(\n                i18n.msg._('Do you want to restart the current kernel?  All variables will be lost.')\n            ),\n            buttons : {\n                \"Restart\" : {\n                    \"class\" : \"btn-danger\",\n                    \"click\" : function () {},\n                },\n            }\n        };\n        return this._restart_kernel(restart_options);\n    };\n    \n    // inner implementation of restart dialog & promise\n    Notebook.prototype._restart_kernel = function (options) {\n        var that = this;\n        options = options || {};\n        var resolve_promise, reject_promise;\n        var promise = new Promise(function (resolve, reject){\n            resolve_promise = resolve;\n            reject_promise = reject;\n        });\n        \n        function restart_and_resolve () {\n            that.kernel.restart(function () {\n                // resolve when the kernel is *ready* not just started\n                that.events.one('kernel_ready.Kernel', resolve_promise);\n            }, reject_promise);\n        }\n\n        var do_kernel_action = options.kernel_action || restart_and_resolve;\n        /* [Basthon] */\n        // added to support kernel restart\n        do_kernel_action = function () {\n            that.basthonGUI.kernelRestart();\n            resolve_promise();\n        };\n       \n        // no need to confirm if the kernel is not connected\n        if (options.confirm === false || !that.kernel.is_connected()) {\n            var default_button = options.dialog.buttons[Object.keys(options.dialog.buttons)[0]];\n            promise.then(default_button.click);\n            do_kernel_action();\n            return promise;\n        }\n        options.dialog.notebook = this;\n        options.dialog.keyboard_manager = this.keyboard_manager;\n        // add 'Continue running' cancel button\n        var buttons = {\n            \"Continue Running\": {},\n        };\n        // hook up button.click actions after restart promise resolves\n        Object.keys(options.dialog.buttons).map(function (key) {\n            var button = buttons[key] = options.dialog.buttons[key];\n            var click = button.click;\n            button.click = function () {\n                promise.then(click);\n                do_kernel_action();\n            };\n        });\n        options.dialog.buttons = buttons;\n        dialog.modal(options.dialog);\n        return promise;\n    };\n\n    /**\n     * \n     * Halt the kernel and close the notebook window\n     */\n    Notebook.prototype.close_and_halt = function () {\n        var close_window = function () {\n            /**\n             * allow closing of new tabs in Chromium, impossible in FF\n             */\n                window.open('', '_self', '');\n                window.close();\n        };\n            // finish with close on success or failure\n            this.session.delete(close_window, close_window);\n    };\n    \n    /**\n     * Execute cells corresponding to the given indices.\n     *\n     * @param {Array} indices - indices of the cells to execute\n     */\n    Notebook.prototype.execute_cells = function (indices) {\n        if (indices.length === 0) {\n            return;\n        }\n\n        var cell;\n        for (var i = 0; i < indices.length; i++) {\n            cell = this.get_cell(indices[i]);\n            cell.execute();\n        }\n\n        this.select(indices[indices.length - 1]);\n        this.command_mode();\n        this.set_dirty(true);\n    };\n\n    /**\n     * Execute or render cell outputs and go into command mode.\n     */\n    Notebook.prototype.execute_selected_cells = function () {\n        this.execute_cells(this.get_selected_cells_indices());\n    };\n\n    \n    /**\n     * Alias for execute_selected_cells, for backwards compatibility --\n     * previously, doing \"Run Cell\" would only ever run a single cell (hence\n     * `execute_cell`), but now it runs all marked cells, so that's the\n     * preferable function to use. But it is good to keep this function to avoid\n     * breaking existing extensions, etc.\n     */\n    Notebook.prototype.execute_cell = function () {\n        this.execute_selected_cells();\n    };\n\n    /**\n     * Execute or render cell outputs and insert a new cell below.\n     */\n    Notebook.prototype.execute_cell_and_insert_below = function () {\n        var indices = this.get_selected_cells_indices();\n        var cell_index;\n        if (indices.length > 1) {\n            this.execute_cells(indices);\n            cell_index = Math.max.apply(Math, indices);\n        } else {\n            var cell = this.get_selected_cell();\n            cell_index = this.find_cell_index(cell);\n            cell.execute();\n        }\n\n        // If we are at the end always insert a new cell and return\n        if (cell_index === (this.ncells()-1)) {\n            this.command_mode();\n            this.insert_cell_below();\n            this.select(cell_index+1);\n            this.edit_mode();\n            this.scroll_to_bottom();\n            this.set_dirty(true);\n            return;\n        }\n\n        this.command_mode();\n        this.insert_cell_below();\n        this.select(cell_index+1);\n        this.edit_mode();\n        this.set_dirty(true);\n    };\n\n    /**\n     * Execute or render cell outputs and select the next cell.\n     */\n    Notebook.prototype.execute_cell_and_select_below = function () {\n        var indices = this.get_selected_cells_indices();\n        var cell_index;\n        if (indices.length > 1) {\n            this.execute_cells(indices);\n            cell_index = Math.max.apply(Math, indices);\n        } else {\n            var cell = this.get_selected_cell();\n            cell_index = this.find_cell_index(cell);\n            cell.execute();\n        }\n\n        // If we are at the end always insert a new cell and return\n        if (cell_index === (this.ncells()-1)) {\n            this.command_mode();\n            this.insert_cell_below();\n            this.select(cell_index+1);\n            this.edit_mode();\n            this.scroll_to_bottom();\n            this.set_dirty(true);\n            return;\n        }\n\n        this.command_mode();\n        this.select(cell_index+1);\n        this.focus_cell();\n        this.set_dirty(true);\n    };\n\n    /**\n     * Execute all cells below the selected cell.\n     */\n    Notebook.prototype.execute_cells_below = function () {\n        this.execute_cell_range(this.get_selected_index(), this.ncells());\n        this.scroll_to_bottom();\n    };\n\n    /**\n     * Execute all cells above the selected cell.\n     */\n    Notebook.prototype.execute_cells_above = function () {\n        this.execute_cell_range(0, this.get_selected_index());\n    };\n\n    /**\n     * Execute all cells.\n     */\n    Notebook.prototype.execute_all_cells = function () {\n        this.execute_cell_range(0, this.ncells());\n        this.scroll_to_bottom();\n    };\n\n    /**\n     * Execute a contiguous range of cells.\n     * \n     * @param {integer} start - index of the first cell to execute (inclusive)\n     * @param {integer} end - index of the last cell to execute (exclusive)\n     */\n    Notebook.prototype.execute_cell_range = function (start, end) {\n        this.command_mode();\n        var indices = [];\n        for (var i=start; i<end; i++) {\n            indices.push(i);\n        }\n        this.execute_cells(indices);\n    };\n\n    // Persistance and loading\n\n    /**\n     * Getter method for this notebook's name.\n     * \n     * @return {string} This notebook's name (excluding file extension)\n     */\n    Notebook.prototype.get_notebook_name = function () {\n        return utils.splitext(this.notebook_name)[0];\n    };\n\n    /**\n     * Setter method for this notebook's name.\n     *\n     * @param {string} name\n     */\n    Notebook.prototype.set_notebook_name = function (name) {\n        var parent = utils.url_path_split(this.notebook_path)[0];\n        this.notebook_name = name;\n        this.notebook_path = utils.url_path_join(parent, name);\n    };\n\n    /**\n     * Check that a notebook's name is valid.\n     * \n     * @param {string} nbname - A name for this notebook\n     * @return {boolean} True if the name is valid, false if invalid\n     */\n    Notebook.prototype.test_notebook_name = function (nbname) {\n        nbname = nbname || '';\n        return nbname.length > 0 && !this.notebook_name_blacklist_re.test(nbname);\n    };\n\n    /**\n     Move the unused attachments garbage collection logic to TextCell.toJSON.\n     * Load a notebook from JSON (.ipynb).\n     *\n     * @param {object} data - JSON representation of a notebook\n     */\n    Notebook.prototype.fromJSON = function (data) {\n        var content = data.content;\n        if(content === undefined) {\n            content = data;\n        }\n\n        var ncells = this.ncells();\n        var i;\n        for (i=0; i<ncells; i++) {\n            // Always delete cell 0 as they get renumbered as they are deleted.\n            this._unsafe_delete_cell(0);\n        }\n        // Save the metadata and name.\n        this.metadata = content.metadata;\n        this.notebook_name = data.name ?? \"Untitled.ipynb\";\n        this.notebook_path = data.path ?? \"Untitled.ipynb\";\n        var trusted = true;\n        \n        // Set the codemirror mode from language_info metadata\n        if (this.metadata.language_info !== undefined) {\n            var langinfo = this.metadata.language_info;\n            // Mode 'null' should be plain, unhighlighted text.\n            var cm_mode = langinfo.codemirror_mode || langinfo.name || 'null';\n            this.set_codemirror_mode(cm_mode);\n        }\n        \n        var new_cells = content.cells;\n        ncells = new_cells.length;\n        var cell_data = null;\n        var new_cell = null;\n        for (i=0; i<ncells; i++) {\n            cell_data = new_cells[i];\n            new_cell = this.insert_cell_at_index(cell_data.cell_type, i);\n            new_cell.fromJSON(cell_data);\n            if (new_cell.cell_type === 'code' && !new_cell.output_area.trusted) {\n                trusted = false;\n            }\n        }\n        if (trusted !== this.trusted) {\n            this.trusted = trusted;\n            this.events.trigger(\"trust_changed.Notebook\", trusted);\n        }\n    };\n\n    /**\n     * Dump this notebook into a JSON-friendly object.\n     * \n     * @return {object} A JSON-friendly representation of this notebook.\n     */\n    Notebook.prototype.toJSON = function () {\n        // remove the conversion indicator, which only belongs in-memory\n        delete this.metadata.orig_nbformat;\n        delete this.metadata.orig_nbformat_minor;\n\n        var cells = this.get_cells();\n        var ncells = cells.length;\n        var cell_array = new Array(ncells);\n        var trusted = true;\n        for (var i=0; i<ncells; i++) {\n            var cell = cells[i];\n            if (cell.cell_type === 'code' && !cell.output_area.trusted) {\n                trusted = false;\n            }\n            cell_array[i] = cell.toJSON(true);\n        }\n        var data = {\n            cells: cell_array,\n            metadata: this.metadata,\n            nbformat: this.nbformat,\n            nbformat_minor: this.nbformat_minor\n        };\n        if (trusted !== this.trusted) {\n            this.trusted = trusted;\n            this.events.trigger(\"trust_changed.Notebook\", trusted);\n        }\n        return data;\n    };\n\n    /**\n     * Start an autosave timer which periodically saves the notebook.\n     * \n     * @param {integer} interval - the autosave interval in milliseconds\n     */\n    Notebook.prototype.set_autosave_interval = function (interval) {\n        var that = this;\n        // clear previous interval, so we don't get simultaneous timers\n        if (this.autosave_timer) {\n            clearInterval(this.autosave_timer);\n        }\n        if (!this.writable) {\n            // disable autosave if not writable\n            interval = 0;\n        }\n        \n        this.autosave_interval = this.minimum_autosave_interval = interval;\n        if (interval) {\n            this.autosave_timer = setInterval(function() {\n                if (that.dirty) {\n                    that.save_notebook();\n                }\n            }, interval);\n            this.events.trigger(\"autosave_enabled.Notebook\", interval);\n        } else {\n            this.autosave_timer = null;\n            this.events.trigger(\"autosave_disabled.Notebook\");\n        }\n    };\n    \n    /**\n     * Save this notebook on the server. This becomes a notebook instance's\n     * .save_notebook method *after* the entire notebook has been loaded.\n     *\n     */\n    Notebook.prototype.save_notebook = function (check_last_modified) {\n        if (check_last_modified === undefined) {\n            check_last_modified = true;\n        }\n\n        var error;\n        if (!this._fully_loaded) {\n            error = new Error(\"Load failed, save is disabled\");\n            this.events.trigger('notebook_save_failed.Notebook', error);\n            return Promise.reject(error);\n        } else if (!this.writable) {\n            // [Basthon]\n            // this is triggered by CTRL+S\n            this.basthonGUI.download();\n            return Promise.resolve();\n            error = new Error(\"Notebook is read-only\");\n            this.events.trigger('notebook_save_failed.Notebook', error);\n            return Promise.reject(error);\n        }\n\n        // Trigger an event before save, which allows listeners to modify\n        // the notebook as needed.\n        this.events.trigger('before_save.Notebook');\n\n        // Create a JSON model to be sent to the server.\n        var model = {\n            type : \"notebook\",\n            content : this.toJSON()\n        };\n        // time the ajax call for autosave tuning purposes.\n        var start =  new Date().getTime();\n\n        var that = this;\n        var _save = function () {\n            return that.contents.save(that.notebook_path, model).then(\n                $.proxy(that.save_notebook_success, that, start),\n                function (error) {\n                    that.events.trigger('notebook_save_failed.Notebook', error);\n                    // This hasn't handled the error, so propagate it up\n                    return Promise.reject(error);\n                }\n            );\n        };\n\n        if (check_last_modified) {\n            return this.contents.get(this.notebook_path, {content: false}).then(\n                function (data) {\n                    var last_modified = new Date(data.last_modified);\n                    var last_modified_check_margin = (that.config.data['last_modified_check_margin'] || 0.5) * 1000; // 500 ms\n                    // We want to check last_modified (disk) > that.last_modified (our last save)\n                    // In some cases the filesystem reports an inconsistent time,\n                    // so we allow 0.5 seconds difference before complaining.\n                    // This is configurable in nbconfig/notebook.json as `last_modified_check_margin`.\n                    if ((last_modified.getTime() - that.last_modified.getTime()) > last_modified_check_margin) {  \n                        console.warn(\"Last saving was done on `\"+that.last_modified+\"`(\"+that._last_modified+\"), \"+\n                                    \"while the current file seem to have been saved on `\"+data.last_modified+\"`\");\n                        if (that._changed_on_disk_dialog !== null) {\n                            // update save callback on the confirmation button\n                            that._changed_on_disk_dialog.find('.save-confirm-btn').click(_save);\n                            //Rebind Click Event on Reload\n                            that._changed_on_disk_dialog.find('.btn-warning').click(function () {window.location.reload()});\n                            // redisplay existing dialog\n                            that._changed_on_disk_dialog.modal('show');\n                        } else {\n                          // create new dialog\n                          that._changed_on_disk_dialog = dialog.modal({\n                            notebook: that,\n                            keyboard_manager: that.keyboard_manager,\n                            title: i18n.msg._(\"Notebook changed\"),\n                            body: i18n.msg._(\"The notebook file has changed on disk since the last time we opened or saved it. \"\n                                  + \"Do you want to overwrite the file on disk with the version open here, or load \"\n                                  + \"the version on disk (reload the page)?\"),\n                            buttons: {\n                                Reload: {\n                                    class: 'btn-warning',\n                                    click: function() {\n                                        window.location.reload();\n                                    }\n                                },\n                                Cancel: {},\n                                Overwrite: {\n                                    class: 'btn-danger save-confirm-btn',\n                                    click: function () {\n                                        _save();\n                                    }\n                                },\n                            }\n                          });\n                        }\n                    } else {\n                        return _save();\n                    }\n                }, function () {\n                    // maybe it has been deleted or renamed? Go ahead and save.\n                    return _save();\n                }\n            );\n        } else {\n            return _save();\n        }\n    };\n    \n    /**\n     * Success callback for saving a notebook.\n     * \n     * @param {integer} start - Time when the save request start\n     * @param {object}  data - JSON representation of a notebook\n     */\n    Notebook.prototype.save_notebook_success = function (start, data) {\n        this.set_dirty(false);\n        this.last_modified = new Date(data.last_modified);\n        // debug 484\n        this._last_modified = 'save-success:'+data.last_modified;\n        if (data.message) {\n            // save succeeded, but validation failed.\n            var body = $(\"<div>\");\n            var title = i18n.msg._(\"Notebook validation failed\");\n\n            body.append($(\"<p>\").text(\n                i18n.msg._(\"The save operation succeeded,\" +\n                \" but the notebook does not appear to be valid.\" +\n                \" The validation error was:\")\n            )).append($(\"<div>\").addClass(\"validation-error\").append(\n                $(\"<pre>\").text(data.message)\n            ));\n            dialog.modal({\n                notebook: this,\n                keyboard_manager: this.keyboard_manager,\n                title: title,\n                body: body,\n                buttons : {\n                    OK : {\n                        \"class\" : \"btn-primary\"\n                    }\n                }\n            });\n        }\n        this.events.trigger('notebook_saved.Notebook');\n        this._update_autosave_interval(start);\n        if (this._checkpoint_after_save) {\n            this.create_checkpoint();\n            this._checkpoint_after_save = false;\n        }\n        return data;\n    };\n\n    Notebook.prototype.save_notebook_as = function() {\n        var that = this;\n        var current_dir = utils.get_body_data('notebookPath').split('/').slice(0, -1).join(\"/\");\n        current_dir = current_dir? current_dir + \"/\": \"\";\n        var dialog_body = $('<div/>').append(\n            $('<p/>').addClass('save-message')\n                .text(i18n.msg._('Enter a notebook path relative to notebook dir'))\n        ).append(\n            $('<br/>')\n        ).append(\n            $('<input/>').attr('type','text').attr('size','25')\n            .attr('data-testid', 'save-as')\n            .addClass('form-control')\n        );\n\n        var d = dialog.modal({\n            title: 'Save As',\n            body: dialog_body,\n            keyboard_manager: this.keyboard_manager,\n            notebook: this,\n            buttons: {\n                Cancel: {},\n                Save: {\n                    class: 'btn-primary',\n                    click: function() {\n                        var nb_path = d.find('input').val();\n                        var nb_name = nb_path.split('/').slice(-1).pop();\n                        // If notebook name does not contain extension '.ipynb' add it\n                        var ext = utils.splitext(nb_name)[1];\n                        if (ext === '') {\n                            nb_name = nb_name + '.ipynb';\n                            nb_path = nb_path + '.ipynb';\n                        }\n                        var save_thunk = function() {\n                            var model = {\n                                'type': 'notebook',\n                                'content': that.toJSON(),\n                                'name': nb_name\n                            };\n                            return that.contents.save(nb_path, model)\n                                .then(function(data) {\n                                    d.modal('hide');\n                                    that.notebook_name = data.name;\n                                    that.notebook_path = data.path;\n                                    that.session.rename_notebook(data.path);\n                                    that.events.trigger('notebook_renamed.Notebook', data);\n                                }, function(error) {\n                                    var msg = i18n.msg._(error.message || 'Unknown error saving notebook');\n                                    $(\".save-message\").html(\n                                        $(\"<span>\")\n                                            .attr(\"style\", \"color:red;\")\n                                            .text(msg)\n                                    );\n                                });\n                        };\n                        that.contents.get(nb_path, {type: 'notebook', content: false}).then(function(data) {\n                            var warning_body = $('<div/>').append(\n                                $(\"<p/>\").text(i18n.msg._('Notebook with that name exists.')));\n                            dialog.modal({\n                                title: 'Save As',\n                                body: warning_body,\n                                buttons: {Cancel: {},\n                                Overwrite: {\n                                    class: 'btn-warning',\n                                    click: function() {\n                                        return save_thunk();\n                                    }\n                                }\n                            }\n                            });\n                        }, function(err) {\n                            return save_thunk();\n                        });\n                        return false;\n                    }\n                },\n            },\n            open : function () {\n                d.find('input[type=\"text\"]').keydown(function (event) {\n                    if (event.which === keyboard.keycodes.enter) {\n                        d.find('.btn-primary').first().click();\n                        return false;\n                    }\n                });\n                d.find('input[type=\"text\"]').val(current_dir).focus();\n             }\n         });\n    };\n\n    /**\n     * Update the autosave interval based on the duration of the last save.\n     * \n     * @param {integer} start - when the save request started\n     */\n    Notebook.prototype._update_autosave_interval = function (start) {\n        var duration = (new Date().getTime() - start);\n        if (this.autosave_interval) {\n            // new save interval: higher of 10x save duration or parameter (default 30 seconds)\n            var interval = Math.max(10 * duration, this.minimum_autosave_interval);\n            // ceil to 10 seconds, otherwise we will be setting a new interval too often\n            // do not round or anything below 5000ms will desactivate saving.\n            interval = 10000 * Math.ceil(interval / 10000);\n            // set new interval, if it's changed\n            if (interval !== this.autosave_interval) {\n                this.set_autosave_interval(interval);\n            }\n        }\n    };\n\n    /**\n     * Explicitly trust the output of this notebook.\n     */\n    Notebook.prototype.trust_notebook = function (from_notification) {\n        var body = $(\"<div>\").append($(\"<p>\")\n            .text(i18n.msg._(\"A trusted Jupyter notebook may execute hidden malicious code when you open it. \" +\n                    \"Selecting trust will immediately reload this notebook in a trusted state. \" +\n                    \"For more information, see the Jupyter security documentation: \"))\n            .append($(\"<a>\").attr(\"href\", \"https://jupyter-notebook.readthedocs.io/en/latest/security.html\")\n                .text(i18n.msg._(\"here\"))\n            )\n        );\n\n        var nb = this;\n        dialog.modal({\n            notebook: this,\n            keyboard_manager: this.keyboard_manager,\n            title: i18n.msg._(\"Trust this notebook?\"),\n            body: body,\n            focus_button: from_notification,\n\n            buttons: {\n                Cancel : {},\n                Trust : {\n                    class : \"btn-danger\",\n                    click : function () {\n                        var cells = nb.get_cells();\n                        for (var i = 0; i < cells.length; i++) {\n                            var cell = cells[i];\n                            if (cell.cell_type === 'code') {\n                                cell.output_area.trusted = true;\n                            }\n                        }\n                        // If its write only and dirty, save before \n                        // trusting\n                        var pr;\n                        if(nb.writable && nb.dirty) {\n                            pr = nb.save_notebook();\n                        }\n                        else {\n                            pr = Promise.resolve();\n                        }\n                        return pr.then(function() {                            \n                            nb.contents.trust(nb.notebook_path)\n                            .then(function() {\n                                nb.events.trigger(\"trust_changed.Notebook\", true);\n                                window.location.reload();\n                            }, function(err) {\n                                console.log(err);\n                            });\n                        });\n                    }\n                }\n            }\n        });\n    };\n\n    /**\n     * Make a copy of the current notebook.\n     * If the notebook has unsaved changes, it is saved first.\n     */\n    Notebook.prototype.copy_notebook = function () {\n        var that = this;\n        var base_url = this.base_url;\n        var w = window.open('', IPython._target);\n        var parent = utils.url_path_split(this.notebook_path)[0];\n        var p;\n        if (this.dirty && this.writable) {\n            p = this.save_notebook(true);\n        } else {\n            p = Promise.resolve();\n        }\n        return p.then(function () {\n            return that.contents.copy(that.notebook_path, parent).then(\n                function (data) {\n                    w.location = utils.url_path_join(\n                        base_url, 'notebooks', utils.encode_uri_components(data.path)\n                    );\n                },\n                function(error) {\n                    w.close();\n                    that.events.trigger('notebook_copy_failed', error);\n                }\n            );\n        });\n    };\n    \n    /**\n     * Ensure a filename has the right extension\n     * Returns the filename with the appropriate extension, appending if necessary.\n     */\n    Notebook.prototype.ensure_extension = function (name) {\n        var ext = utils.splitext(this.notebook_path)[1];\n        if (ext.length && name.slice(-ext.length) !== ext) {\n            name = name + ext;\n        }\n        return name;\n    };\n\n    /**\n     * Rename the notebook.\n     * @param  {string} new_name\n     * @return {Promise} promise that resolves when the notebook is renamed.\n     */\n    Notebook.prototype.rename = function (new_name) {\n        new_name = this.ensure_extension(new_name);\n\n        var that = this;\n        var parent = utils.url_path_split(this.notebook_path)[0];\n        var new_path = utils.url_path_join(parent, new_name);\n        return this.contents.rename(this.notebook_path, new_path).then(\n            function (json) {\n                that.notebook_name = json.name;\n                that.notebook_path = json.path;\n                that.last_modified = new Date(json.last_modified);\n                // debug 484\n                that._last_modified = json.last_modified;\n                that.session.rename_notebook(json.path);\n                that.events.trigger('notebook_renamed.Notebook', json);\n            }\n        );\n    };\n\n    /**\n     * Delete this notebook\n     */\n    Notebook.prototype.delete = function () {\n        this.contents.delete(this.notebook_path);\n    };\n\n    /**\n     * Request a notebook's data from the server.\n     * \n     * @param {string} notebook_path - A notebook to load\n     */\n    Notebook.prototype.load_notebook = function (notebook_path) {\n        this.notebook_path = notebook_path;\n        this.notebook_name = utils.url_path_split(this.notebook_path)[1];\n        this.events.trigger('notebook_loading.Notebook');\n        this.contents.get(notebook_path, {type: 'notebook'}).then(\n            $.proxy(this.load_notebook_success, this),\n            $.proxy(this.load_notebook_error, this)\n        );\n    };\n\n    /**\n     * Success callback for loading a notebook from the server.\n     * \n     * Load notebook data from the JSON response.\n     * \n     * @param {object} data JSON representation of a notebook\n     */\n    Notebook.prototype.load_notebook_success = function (data) {\n        var failed, msg;\n        try {\n            this.fromJSON(data);\n        } catch (e) {\n            failed = e;\n            console.error(\"Notebook failed to load from JSON:\", e);\n        }\n        if (failed || data.message) {\n            // *either* fromJSON failed or validation failed\n            var body = $(\"<div>\");\n            var title;\n            if (failed) {\n                title = i18n.msg._(\"Notebook failed to load\");\n                body.append($(\"<p>\").text(\n                    i18n.msg._(\"The error was: \")\n                )).append($(\"<div>\").addClass(\"js-error\").text(\n                    failed.toString()\n                )).append($(\"<p>\").text(\n                    i18n.msg._(\"See the error console for details.\")\n                ));\n            } else {\n                title = i18n.msg._(\"Notebook validation failed\");\n            }\n\n            if (data.message) {\n                if (failed) {\n                    msg = i18n.msg._(\"The notebook also failed validation:\");\n                } else {\n                    msg = i18n.msg._(\"An invalid notebook may not function properly.\" +\n                    \" The validation error was:\");\n                }\n                body.append($(\"<p>\").text(\n                    msg\n                )).append($(\"<div>\").addClass(\"validation-error\").append(\n                    $(\"<pre>\").text(data.message)\n                ));\n            }\n\n            dialog.modal({\n                notebook: this,\n                keyboard_manager: this.keyboard_manager,\n                title: title,\n                body: body,\n                buttons : {\n                    OK : {\n                        \"class\" : \"btn-primary\"\n                    }\n                }\n            });\n        }\n        if (this.ncells() === 0) {\n            this.insert_cell_below('code');\n            this.edit_mode(0);\n        } else {\n            this.select(0);\n            this.handle_command_mode(this.get_cell(0));\n        }\n        this.set_dirty(false);\n        this.scroll_to_top();\n        this.writable = data.writable || false;\n        this.last_modified = new Date(data.last_modified);\n        // debug 484\n        this._last_modified = 'load-success:'+data.last_modified;\n        var nbmodel = data.content;\n        if(nbmodel === undefined) {\n            nbmodel = data;\n        }\n        var orig_nbformat = nbmodel.metadata.orig_nbformat;\n        var orig_nbformat_minor = nbmodel.metadata.orig_nbformat_minor;\n        if (orig_nbformat !== undefined && nbmodel.nbformat !== orig_nbformat) {\n            var oldmsg = i18n.msg._(\"This notebook has been converted from an older notebook format\" +\n            \" to the current notebook format v(%s).\");\n            var newmsg = i18n.msg._(\"This notebook has been converted from a newer notebook format\" +\n            \" to the current notebook format v(%s).\");\n            if (nbmodel.nbformat > orig_nbformat) {\n                msg = i18n.msg.sprintf(oldmsg,nbmodel.nbformat);\n            } else {\n                msg = i18n.msg.sprintf(newmsg,nbmodel.nbformat);\n            }\n            msg += \" \";\n            msg += i18n.msg._(\"The next time you save this notebook, the \" +\n            \"current notebook format will be used.\");\n            \n            msg += \" \";\n            if (nbmodel.nbformat > orig_nbformat) {\n                msg += i18n.msg._(\"Older versions of Jupyter may not be able to read the new format.\");\n            } else {\n                msg += i18n.msg._(\"Some features of the original notebook may not be available.\");\n            }\n            msg += \" \";\n            msg += i18n.msg._(\"To preserve the original version, close the \" +\n                \"notebook without saving it.\");\n            dialog.modal({\n                notebook: this,\n                keyboard_manager: this.keyboard_manager,\n                title : i18n.msg._(\"Notebook converted\"),\n                body : msg,\n                buttons : {\n                    OK : {\n                        class : \"btn-primary\"\n                    }\n                }\n            });\n        } else if (this.nbformat_minor < nbmodel.nbformat_minor) {\n            this.nbformat_minor = nbmodel.nbformat_minor;\n        }\n\n        if (this.session === null) {\n            var kernel_name = utils.get_url_param('kernel_name');\n            if (kernel_name) {\n                this.kernel_selector.set_kernel(kernel_name);\n            } else if (this.metadata.kernelspec) {\n                this.kernel_selector.set_kernel(this.metadata.kernelspec);\n            } else if (this.metadata.language) {\n                // compat with IJulia, IHaskell, and other early kernels\n                // adopters that where setting a language metadata.\n                this.kernel_selector.set_kernel({\n                    name: i18n.msg._(\"(No name)\"),\n                    language: this.metadata.language\n                  });\n                // this should be stored in kspec now, delete it.\n                // remove once we do not support notebook v3 anymore.\n                delete this.metadata.language;\n            } else {\n                // setting kernel via set_kernel above triggers start_session,\n                // otherwise start a new session with the server's default kernel\n                // spec_changed events will fire after kernel is loaded\n                this.start_session();\n            }\n        }\n        // load our checkpoint list\n        // [Basthon] do not list checkpoints since we don't have any\n        //this.list_checkpoints();\n        \n        // load toolbar state\n        if (this.metadata.celltoolbar) {\n            celltoolbar.CellToolbar.global_show();\n            celltoolbar.CellToolbar.activate_preset(this.metadata.celltoolbar);\n        } else {\n            celltoolbar.CellToolbar.global_hide();\n        }\n        \n        if (!this.writable) {\n            this.set_autosave_interval(0);\n            this.events.trigger('notebook_read_only.Notebook');\n        }\n        \n        // now that we're fully loaded, it is safe to restore save functionality\n        this._fully_loaded = true;\n        this.events.trigger('notebook_loaded.Notebook');\n    };\n\n    Notebook.prototype.set_kernelselector = function(k_selector){\n        this.kernel_selector = k_selector;\n    };\n\n    /**\n     * Failure callback for loading a notebook from the server.\n     * \n     * @param {Error} error\n     */\n    Notebook.prototype.load_notebook_error = function (error) {\n        var isSanitized = true;\n        this.events.trigger('notebook_load_failed.Notebook', error);\n        var msg;\n        if (error.name === utils.XHR_ERROR && error.xhr.status === 500) {\n            utils.log_ajax_error(error.xhr, error.xhr_status, error.xhr_error);\n            msg = i18n.msg.sprintf(i18n.msg._(\"An unknown error occurred while loading this notebook. \" +\n            \"This version can load notebook formats %s or earlier. See the server log for details.\",\n            \"v\" + this.nbformat));\n        } else {\n            msg = error.message;\n            console.warn('Error stack trace while loading notebook was:');\n            console.warn(error.stack);\n        }\n        if (navigator.cookieEnabled == false){\n            msg = i18n.msg._(\"Jupyter requires cookies to work; please enable cookies\" +\n                \" and refresh page. <a href=\\\"https://www.wikihow.com/Enable-Cookies-in-Your-Internet-Web-Browser\\\"> Learn more about enabling cookies. </a>\");\n            isSanitized = false;\n        }\n        dialog.modal({\n            notebook: this,\n            keyboard_manager: this.keyboard_manager,\n            title: i18n.msg._(\"Error loading notebook\"),\n            body : msg,\n            buttons : {\n                \"Close\": {\n                    class : 'btn-danger',\n                    click : function () {\n                        window.close();\n                    }\n                }\n              },\n              sanitize: isSanitized\n          \n        });\n    };\n\n    /*********************  checkpoint-related  ********************/\n    \n    /**\n     * Save the notebook then immediately create a checkpoint.\n     */\n    Notebook.prototype.save_checkpoint = function () {\n        this._checkpoint_after_save = true;\n        return this.save_notebook(true);\n    };\n    \n    /**\n     * Add a checkpoint for this notebook.\n     */\n    Notebook.prototype.add_checkpoint = function (checkpoint) {\n        var found = false;\n        for (var i = 0; i < this.checkpoints.length; i++) {\n            var existing = this.checkpoints[i];\n            if (existing.id === checkpoint.id) {\n                found = true;\n                this.checkpoints[i] = checkpoint;\n                break;\n            }\n        }\n        if (!found) {\n            this.checkpoints.push(checkpoint);\n        }\n        this.last_checkpoint = this.checkpoints[this.checkpoints.length - 1];\n    };\n    \n    /**\n     * List checkpoints for this notebook.\n     */\n    Notebook.prototype.list_checkpoints = function () {\n        var that = this;\n        this.contents.list_checkpoints(this.notebook_path).then(\n            $.proxy(this.list_checkpoints_success, this),\n            function(error) {\n                that.events.trigger('list_checkpoints_failed.Notebook', error);\n            }\n        );\n    };\n\n    /**\n     * Success callback for listing checkpoints.\n     * \n     * @param {object} data - JSON representation of a checkpoint\n     */\n    Notebook.prototype.list_checkpoints_success = function (data) {\n        this.checkpoints = data;\n        if (data.length) {\n            this.last_checkpoint = data[data.length - 1];\n        } else {\n            this.last_checkpoint = null;\n        }\n        this.events.trigger('checkpoints_listed.Notebook', [data]);\n    };\n\n    /**\n     * Create a checkpoint of this notebook on the server from the most recent save.\n     */\n    Notebook.prototype.create_checkpoint = function () {\n        var that = this;\n        this.contents.create_checkpoint(this.notebook_path).then(\n            $.proxy(this.create_checkpoint_success, this),\n            function (error) {\n                that.events.trigger('checkpoint_failed.Notebook', error);\n            }\n        );\n    };\n\n    /**\n     * Success callback for creating a checkpoint.\n     * \n     * @param {object} data - JSON representation of a checkpoint\n     */\n    Notebook.prototype.create_checkpoint_success = function (data) {\n        this.add_checkpoint(data);\n        this.events.trigger('checkpoint_created.Notebook', data);\n    };\n\n    /**\n     * Display the restore checkpoint dialog\n     * @param  {string} checkpoint ID\n     */\n    Notebook.prototype.restore_checkpoint_dialog = function (checkpoint) {\n        var that = this;\n        checkpoint = checkpoint || this.last_checkpoint;\n        if ( ! checkpoint ) {\n            console.log(\"restore dialog, but no checkpoint to restore to!\");\n            return;\n        }\n        var body = $('<div/>').append(\n            $('<p/>').addClass(\"p-space\").text(\n                i18n.msg._(\"Are you sure you want to revert the notebook to \" +\n                \"the latest checkpoint?\")\n            ).append(\n                $(\"<strong/>\").text(\" \"+i18n.msg._(\"This cannot be undone.\"))\n            )\n        ).append(\n            $('<p/>').addClass(\"p-space\").text(i18n.msg._(\"The checkpoint was last updated at:\"))\n        ).append(\n            $('<p/>').addClass(\"p-space\").text(\n                moment(checkpoint.last_modified).format('LLLL') +\n                ' ('+moment(checkpoint.last_modified).fromNow()+')'// Long form:  Tuesday, January 27, 2015 12:15 PM\n            ).css(\"text-align\", \"center\")\n        );\n        \n        dialog.modal({\n            notebook: this,\n            keyboard_manager: this.keyboard_manager,\n            title : i18n.msg._(\"Revert notebook to checkpoint\"),\n            body : body,\n            default_button: \"Cancel\",\n            buttons : {\n                Cancel: {},\n                Revert : {\n                    class : \"btn-danger\",\n                    click : function () {\n                        that.restore_checkpoint(checkpoint.id);\n                    }\n                }\n            }\n        });\n    };\n    \n    /**\n     * Restore the notebook to a checkpoint state.\n     * \n     * @param {string} checkpoint ID\n     */\n    Notebook.prototype.restore_checkpoint = function (checkpoint) {\n        this.events.trigger('notebook_restoring.Notebook', checkpoint);\n        var that = this;\n        this.contents.restore_checkpoint(this.notebook_path, checkpoint).then(\n            $.proxy(this.restore_checkpoint_success, this),\n            function (error) {\n                that.events.trigger('checkpoint_restore_failed.Notebook', error);\n            }\n        );\n    };\n    \n    /**\n     * Success callback for restoring a notebook to a checkpoint.\n     */\n    Notebook.prototype.restore_checkpoint_success = function () {\n        this.events.trigger('checkpoint_restored.Notebook');\n        this.load_notebook(this.notebook_path);\n    };\n\n    /**\n     * Delete a notebook checkpoint.\n     * \n     * @param {string} checkpoint ID\n     */\n    Notebook.prototype.delete_checkpoint = function (checkpoint) {\n        this.events.trigger('notebook_restoring.Notebook', checkpoint);\n        var that = this;\n        this.contents.delete_checkpoint(this.notebook_path, checkpoint).then(\n            $.proxy(this.delete_checkpoint_success, this),\n            function (error) {\n                that.events.trigger('checkpoint_delete_failed.Notebook', error);\n            }\n        );\n    };\n    \n    /**\n     * Success callback for deleting a notebook checkpoint.\n     */\n    Notebook.prototype.delete_checkpoint_success = function () {\n        this.events.trigger('checkpoint_deleted.Notebook');\n        this.load_notebook(this.notebook_path);\n    };\n\n    return {Notebook: Notebook};\n});\n","define([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/dialog',\n    'base/js/notificationarea',\n    'moment'\n], function($, utils, i18n, dialog, notificationarea, moment) {\n    \"use strict\";\n\n    var NotificationArea = notificationarea.NotificationArea;\n    \n    var NotebookNotificationArea = function(selector, options) {\n        NotificationArea.apply(this, [selector, options]);\n        this.save_widget = options.save_widget;\n        this.notebook = options.notebook;\n        this.keyboard_manager = options.keyboard_manager;\n    };\n    \n    NotebookNotificationArea.prototype = Object.create(NotificationArea.prototype);\n    \n    /**\n     * Initialize the default set of notification widgets.\n     *\n     * @method init_notification_widgets\n     */\n    NotebookNotificationArea.prototype.init_notification_widgets = function () {\n        /* [Basthon]: no notification at all */\n        /*\n        this.init_kernel_notification_widget();\n        this.init_notebook_notification_widget();\n        this.init_trusted_notebook_notification_widget();\n        */\n    };\n\n    /**\n     * Initialize the notification widget for kernel status messages.\n     *\n     * @method init_kernel_notification_widget\n     */\n    NotebookNotificationArea.prototype.init_kernel_notification_widget = function () {\n        var that = this;\n        var knw = this.widget('kernel');\n        var $kernel_ind_icon = $(\"#kernel_indicator_icon\");\n        var $modal_ind_icon = $(\"#modal_indicator\");\n        var $readonly_ind_icon = $('#readonly-indicator');\n        var $body = $('body');\n        var busy_favicon_timer = -1;\n        \n        var set_busy_favicon = function(on) {\n            if (on) {\n                // Only show the busy icon if execution lasts > 1s\n                // This is to avoid rapidly switching icons and making lots of\n                // HTTP requests.\n                clearTimeout(busy_favicon_timer);\n                busy_favicon_timer = setTimeout(function() {\n                    utils.change_favicon('static/base/images/favicon-busy-1.ico');\n                }, 1000);\n            } else {\n                clearTimeout(busy_favicon_timer);\n                utils.change_favicon('static/base/images/favicon-notebook.ico');\n            }\n        };\n\n        // Listen for the notebook loaded event.  Set readonly indicator.\n        this.events.on('notebook_loaded.Notebook', function() {\n            if (that.notebook.writable) {\n                $readonly_ind_icon.hide();\n            } else {\n                $readonly_ind_icon.show();\n            }\n        });\n\n        // Command/Edit mode\n        this.events.on('edit_mode.Notebook', function () {\n            that.save_widget.update_document_title();\n            $body.addClass('edit_mode');\n            $body.removeClass('command_mode');\n            $modal_ind_icon.attr('title',i18n.msg._('Edit Mode'));\n        });\n\n        this.events.on('command_mode.Notebook', function () {\n            that.save_widget.update_document_title();\n            $body.removeClass('edit_mode');\n            $body.addClass('command_mode');\n            $modal_ind_icon.attr('title',i18n.msg._('Command Mode'));\n        });\n\n        // Implicitly start off in Command mode, switching to Edit mode will trigger event\n        $modal_ind_icon.addClass('modal_indicator').attr('title',i18n.msg._('Command Mode'));\n        $body.addClass('command_mode');\n\n        // Kernel events\n\n        // this can be either kernel_created.Kernel or kernel_created.Session\n        this.events.on('kernel_created.Kernel kernel_created.Session', function () {\n            knw.info(i18n.msg._(\"Kernel Created\"), 500);\n        });\n\n        this.events.on('kernel_reconnecting.Kernel', function () {\n            knw.warning(i18n.msg._(\"Connecting to kernel\"));\n        });\n\n        this.events.on('kernel_connection_dead.Kernel', function (evt, info) {\n            knw.danger(i18n.msg._(\"Not Connected\"), undefined, function () {\n                // schedule reconnect a short time in the future, don't reconnect immediately\n                setTimeout($.proxy(info.kernel.reconnect, info.kernel), 500);\n            }, {title: i18n.msg._('click to reconnect')});\n        });\n\n        this.events.on('kernel_connected.Kernel', function () {\n            knw.info(\"Connected\", 500);\n            // trigger busy in the status to clear broken-link state immediately\n            // a kernel_ready event will come when the kernel becomes responsive.\n            $kernel_ind_icon\n                .attr('class', 'kernel_busy_icon')\n                .attr('title', i18n.msg._('Kernel Connected'));\n        });\n\n        this.events.on('kernel_restarting.Kernel', function () {\n            that.save_widget.update_document_title();\n            knw.set_message(i18n.msg._(\"Restarting kernel\"), 2000);\n        });\n\n        this.events.on('kernel_autorestarting.Kernel', function (evt, info) {\n            // Only show the dialog on the first restart attempt. This\n            // number gets tracked by the `Kernel` object and passed\n            // along here, because we don't want to show the user 5\n            // dialogs saying the same thing (which is the number of\n            // times it tries restarting).\n            if (info.attempt === 1) {\n\n                dialog.kernel_modal({\n                    notebook: that.notebook,\n                    keyboard_manager: that.keyboard_manager,\n                    title: i18n.msg._(\"Kernel Restarting\"),\n                    body: i18n.msg._(\"The kernel appears to have died. It will restart automatically.\"),\n                    buttons: {\n                        OK : {\n                            class : \"btn-primary\"\n                        }\n                    }\n                });\n            }\n\n            that.save_widget.update_document_title();\n            knw.danger(i18n.msg._(\"Dead kernel\"));\n            $kernel_ind_icon.attr('class','kernel_dead_icon').attr('title',i18n.msg._('Kernel Dead'));\n        });\n\n        this.events.on('kernel_interrupting.Kernel', function () {\n            knw.set_message(i18n.msg._(\"Interrupting kernel\"), 2000);\n        });\n\n        this.events.on('kernel_disconnected.Kernel', function () {\n            $kernel_ind_icon\n                .attr('class', 'kernel_disconnected_icon')\n                .attr('title', i18n.msg._('No Connection to Kernel'));\n        });\n\n        this.events.on('kernel_connection_failed.Kernel', function (evt, info) {\n            // only show the dialog if this is the first failed\n            // connect attempt, because the kernel will continue\n            // trying to reconnect and we don't want to spam the user\n            // with messages\n            if (info.attempt === 1) {\n\n                var msg = i18n.msg._(\"A connection to the notebook server could not be established.\" +\n                        \" The notebook will continue trying to reconnect. Check your\" +\n                        \" network connection or notebook server configuration.\");\n\n                var the_dialog = dialog.kernel_modal({\n                    title: i18n.msg._(\"Connection failed\"),\n                    body: msg,\n                    keyboard_manager: that.keyboard_manager,\n                    notebook: that.notebook,\n                    buttons : {\n                        \"OK\": {}\n                    }\n                });\n\n                // hide the dialog on reconnect if it's still visible\n                var dismiss = function () {\n                    the_dialog.modal('hide');\n                }\n                that.events.on(\"kernel_connected.Kernel\", dismiss);\n                the_dialog.on(\"hidden.bs.modal\", function () {\n                    // clear handler on dismiss\n                    that.events.off(\"kernel_connected.Kernel\", dismiss);\n                });\n            }\n        });\n\n        this.events.on('kernel_killed.Kernel kernel_killed.Session', function () {\n            that.save_widget.update_document_title();\n            knw.warning(i18n.msg._(\"No kernel\"));\n            $kernel_ind_icon.attr('class','kernel_busy_icon').attr('title',i18n.msg._('Kernel is not running'));\n        });\n\n        this.events.on('kernel_dead.Kernel', function () {\n        // This statement is used simply so that message extraction\n        // will pick up the strings.  The actual setting of the text\n        // for the button is in dialog.js.\n        var button_labels = [ i18n.msg._(\"Don't Restart\"), i18n.msg._(\"Try Restarting Now\"), i18n.msg._(\"OK\")];\n\n            var showMsg = function () {\n\n                var msg = i18n.msg._('The kernel has died, and the automatic restart has failed.' +\n                        ' It is possible the kernel cannot be restarted. ' +\n                        'If you are not able to restart the kernel, you will still be able to save' +\n                        ' the notebook, but running code will no longer work until the notebook' +\n                        ' is reopened.');\n\n                dialog.kernel_modal({\n                    title: i18n.msg._(\"Dead kernel\"),\n                    body : msg,\n                    keyboard_manager: that.keyboard_manager,\n                    notebook: that.notebook,\n                    default_button: \"Don't Restart\",\n                    buttons : {\n                        \"Don't Restart\": {},\n                        \"Try Restarting Now\": {\n                            class: \"btn-danger\",\n                            click: function () {\n                                that.notebook.start_session();\n                            }\n                        }\n                    }\n                });\n\n                return false;\n            };\n\n            that.save_widget.update_document_title();\n            knw.danger(i18n.msg._(\"Dead kernel\"), undefined, showMsg);\n            $kernel_ind_icon.attr('class','kernel_dead_icon').attr('title',i18n.msg._('Kernel Dead'));\n\n            showMsg();\n        });\n        \n        this.events.on(\"no_kernel.Kernel\", function (evt, data) {\n            $(\"#kernel_indicator\").find('.kernel_indicator_name').text(i18n.msg._(\"No Kernel\"));\n        });\n\n        this.events.on('kernel_dead.Session', function (evt, info) {\n            var full = info.xhr.responseJSON.message;\n            var short = info.xhr.responseJSON.short_message || 'Kernel error';\n            var traceback = info.xhr.responseJSON.traceback;\n\n            var showMsg = function () {\n                var msg = $('<div/>').append($('<p/>').text(full));\n                var cm, cm_elem, cm_open;\n\n                if (traceback) {\n                    cm_elem = $('<div/>')\n                        .css('margin-top', '1em')\n                        .css('padding', '1em')\n                        .addClass('output_scroll');\n                    msg.append(cm_elem);\n                    cm = new CodeMirror(cm_elem.get(0), {\n                        mode:  \"python\",\n                        readOnly : true\n                    });\n                    cm.setValue(traceback);\n                    cm_open = $.proxy(cm.refresh, cm);\n                }\n\n                dialog.kernel_modal({\n                    title: i18n.msg._(\"Failed to start the kernel\"),\n                    body : msg,\n                    keyboard_manager: that.keyboard_manager,\n                    notebook: that.notebook,\n                    open: cm_open,\n                    buttons : {\n                        \"OK\": { class: 'btn-primary' }\n                    }\n                });\n\n                return false;\n            };\n\n            that.save_widget.update_document_title();\n            $kernel_ind_icon.attr('class','kernel_dead_icon').attr('title',i18n.msg._('Kernel Dead'));\n            knw.danger(short, undefined, showMsg);\n        });\n        \n        this.events.on('kernel_starting.Kernel kernel_created.Session', function () {\n            // window.document.title='(Starting) '+window.document.title;\n            $kernel_ind_icon.attr('class','kernel_busy_icon').attr('title',i18n.msg._('Kernel Busy'));\n            knw.set_message(i18n.msg._(\"Kernel starting, please wait...\"));\n            set_busy_favicon(true);\n        });\n\n        this.events.on('kernel_ready.Kernel', function () {\n            // that.save_widget.update_document_title();\n            $kernel_ind_icon.attr('class','kernel_idle_icon').attr('title',i18n.msg._('Kernel Idle'));\n            knw.info(i18n.msg._(\"Kernel ready\"), 500);\n            set_busy_favicon(false);\n        });\n\n        this.events.on('kernel_idle.Kernel', function () {\n            // that.save_widget.update_document_title();\n            $kernel_ind_icon.attr('class','kernel_idle_icon').attr('title',i18n.msg._('Kernel Idle'));\n            set_busy_favicon(false);\n        });\n\n        this.events.on('kernel_busy.Kernel', function () {\n            // window.document.title='(Busy) '+window.document.title;\n            $kernel_ind_icon.attr('class','kernel_busy_icon').attr('title',i18n.msg._('Kernel Busy'));\n            set_busy_favicon(true);\n        });\n\n        this.events.on('spec_match_found.Kernel', function (evt, data) {\n            that.widget('kernelspec').info(i18n.msg._(\"Using kernel: \") + data.found.spec.display_name, 3000, undefined, {\n                title: i18n.msg.sprintf(i18n.msg._(\"Only candidate for language: %1$s was %2$s.\"),\n                        data.selected.language, data.found.spec.display_name)\n            });\n        });\n\n        \n        // Start the kernel indicator in the busy state, and send a kernel_info request.\n        // When the kernel_info reply arrives, the kernel is idle.\n        $kernel_ind_icon.attr('class','kernel_busy_icon').attr('title',i18n.msg._('Kernel Busy'));\n    };\n\n    /**\n     * Initialize the notification widget for notebook status messages.\n     *\n     * @method init_notebook_notification_widget\n     */\n    NotebookNotificationArea.prototype.init_notebook_notification_widget = function () {\n        var nnw = this.widget('notebook');\n\n        // Notebook events\n        this.events.on('notebook_loading.Notebook', function () {\n            nnw.set_message(i18n.msg._(\"Loading notebook\"),500);\n        });\n        this.events.on('notebook_loaded.Notebook', function () {\n            nnw.set_message(i18n.msg._(\"Notebook loaded\"),500);\n        });\n        this.events.on('notebook_saving.Notebook', function () {\n            nnw.set_message(i18n.msg._(\"Saving notebook\"),500);\n        });\n        this.events.on('notebook_saved.Notebook', function () {\n            nnw.set_message(i18n.msg._(\"Notebook saved\"),2000);\n        });\n        this.events.on('notebook_save_failed.Notebook', function (evt, error) {\n            nnw.warning(error.message || i18n.msg._(\"Notebook save failed\"));\n        });\n        this.events.on('notebook_copy_failed.Notebook', function (evt, error) {\n            nnw.warning(error.message || i18n.msg._(\"Notebook copy failed\"));\n        });\n        \n        // Checkpoint events\n        this.events.on('checkpoint_created.Notebook', function (evt, data) {\n            var msg = i18n.msg._(\"Checkpoint created\");\n            if (data.last_modified) {\n                var d = new Date(data.last_modified);\n                msg = msg + \": \" + moment(d).format(\"HH:mm:ss\");\n            }\n            nnw.set_message(msg, 2000);\n        });\n        this.events.on('checkpoint_failed.Notebook', function () {\n            nnw.warning(i18n.msg._(\"Checkpoint failed\"));\n        });\n        this.events.on('checkpoint_deleted.Notebook', function () {\n            nnw.set_message(i18n.msg._(\"Checkpoint deleted\"), 500);\n        });\n        this.events.on('checkpoint_delete_failed.Notebook', function () {\n            nnw.warning(i18n.msg._(\"Checkpoint delete failed\"));\n        });\n        this.events.on('checkpoint_restoring.Notebook', function () {\n            nnw.set_message(i18n.msg._(\"Restoring to checkpoint...\"), 500);\n        });\n        this.events.on('checkpoint_restore_failed.Notebook', function () {\n            nnw.warning(i18n.msg._(\"Checkpoint restore failed\"));\n        });\n\n        // Autosave events\n        this.events.on('autosave_disabled.Notebook', function () {\n            nnw.set_message(i18n.msg._(\"Autosave disabled\"), 2000);\n        });\n        this.events.on('autosave_enabled.Notebook', function (evt, interval) {\n            nnw.set_message(i18n.msg.sprintf(i18n.msg._(\"Saving every %d sec.\"), interval / 1000) , 1000);\n        });\n    };\n\n    /**\n     * Initialize the notification widget for trusted notebook messages.\n     *\n     * @method init_trusted_notebook_notification_widget\n     */\n    NotebookNotificationArea.prototype.init_trusted_notebook_notification_widget = function () {\n        var that = this;\n        var tnw = this.widget('trusted');\n\n        // Notebook trust events\n        this.events.on('trust_changed.Notebook', function (event, trusted) {\n            if (trusted) {\n                tnw.set_message(i18n.msg._(\"Trusted\"), undefined, function() {\n                  return false;\n                }, {'title':'Javascript enabled for notebook display'});\n                // don't allow 'Trusted' button to be clicked\n                $(tnw.selector).attr('disabled', true);\n                $(tnw.selector).css('cursor', 'help');\n            } else {\n                tnw.set_message(i18n.msg._(\"Not Trusted\"), undefined, function() {\n                  that.notebook.trust_notebook(\"#notification_trusted\");\n                  return false;\n                }, {'title':'Javascript disabled for notebook display'});\n                $(tnw.selector).attr('role', 'button');\n            }\n        });\n    };\n\n    return {'NotebookNotificationArea': NotebookNotificationArea};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/security',\n    'base/js/keyboard',\n    'services/config',\n    'notebook/js/mathjaxutils',\n    'marked',\n], function($, utils, i18n, security, keyboard, configmod, mathjaxutils, marked) {\n    \"use strict\";\n\n    /**\n     * @class OutputArea\n     *\n     * @constructor\n     */\n\n    var OutputArea = function (options) {\n        this.config = options.config;\n        this.selector = options.selector;\n        this.events = options.events;\n        this.keyboard_manager = options.keyboard_manager;\n        this.wrapper = $(options.selector);\n        this.outputs = [];\n        this.collapsed = false;\n        this.scrolled = false;\n        this.scroll_state = 'auto';\n        this.trusted = true;\n        this.clear_queued = null;\n        if (options.prompt_area === undefined) {\n            this.prompt_area = true;\n        } else {\n            this.prompt_area = options.prompt_area;\n        }\n        this._display_id_targets = {};\n        this.create_elements();\n        this.style();\n        this.bind_events();\n        this.class_config = new configmod.ConfigWithDefaults(this.config,\n                                        OutputArea.config_defaults, 'OutputArea');\n\n        this.handle_appended = utils.throttle(this.handle_appended.bind(this));\n    };\n\n    OutputArea.config_defaults = {\n        stream_chunk_size: 8192, // chunk size for stream output\n    };\n    \n    /**\n     * Class prototypes\n     **/\n\n    OutputArea.prototype.create_elements = function () {\n        var element = this.element = $(\"<div/>\");\n        // wrap element in safe trigger,\n        // so that errors (e.g. in widget extensions) are logged instead of\n        // breaking everything.\n        this.element._original_trigger = this.element.trigger;\n        this.element.trigger = function (name, data) {\n            try {\n                this._original_trigger.apply(this, arguments);\n            } catch (e) {\n                console.error(\"Exception in event handler for \" + name, e, arguments);\n            }\n        }\n        this.collapse_button = $(\"<div/>\");\n        this.prompt_overlay = $(\"<div/>\");\n        this.wrapper.append(this.prompt_overlay);\n        this.wrapper.append(this.element);\n        this.wrapper.append(this.collapse_button);\n    };\n\n\n    OutputArea.prototype.style = function () {\n        this.collapse_button.hide();\n        if (!this.prompt_area) {\n            this.prompt_overlay.hide();\n        }\n        \n        this.wrapper.addClass('output_wrapper');\n        this.element.addClass('output');\n        \n        this.collapse_button.addClass(\"btn btn-default output_collapsed\");\n        this.collapse_button.attr('title', i18n.msg._('click to expand output'));\n        this.collapse_button.text('. . .');\n        \n        this.prompt_overlay.addClass('out_prompt_overlay prompt');\n        this.prompt_overlay.attr('title', i18n.msg._('click to expand output; double click to hide output'));\n        \n        this.expand();\n    };\n\n    /**\n     * Should the OutputArea scroll?\n     * Returns whether the height (in lines) exceeds the current threshold.\n     * Threshold will be OutputArea.minimum_scroll_threshold if scroll_state=true (manually requested)\n     * or OutputArea.auto_scroll_threshold if scroll_state='auto'.\n     * This will always return false if scroll_state=false (scroll disabled).\n     *\n     */\n    OutputArea.prototype._should_scroll = function () {\n        var threshold;\n        if (this.scroll_state === false) {\n            return false;\n        } else if (this.scroll_state === true) {\n            threshold = OutputArea.minimum_scroll_threshold;\n        } else {\n            threshold = OutputArea.auto_scroll_threshold;\n        }\n        if (threshold <=0) {\n            return false;\n        }\n        // line-height from https://stackoverflow.com/questions/1185151\n        var fontSize = this.element.css('font-size') || '14px';\n        var lineHeight = Math.floor((parseFloat(fontSize.replace('px','')) || 14) * 1.3);\n        return (this.element.height() > threshold * lineHeight);\n    };\n\n\n    OutputArea.prototype.bind_events = function () {\n        var that = this;\n        this.prompt_overlay.dblclick(function () { that.toggle_output(); });\n        this.prompt_overlay.click(function () { that.toggle_scroll(); });\n\n        this.element.on('resizeOutput', function () {\n            // maybe scroll output,\n            // if it's grown large enough and hasn't already been scrolled.\n            if (!that.scrolled && that._should_scroll()) {\n                that.scroll_area();\n            }\n        });\n        this.collapse_button.click(function () {\n            that.expand();\n        });\n    };\n\n\n    OutputArea.prototype.collapse = function () {\n        if (!this.collapsed) {\n            this.element.hide();\n            this.prompt_overlay.hide();\n            if (this.element.html()){\n                this.collapse_button.show();\n            }\n            this.collapsed = true;\n            // collapsing output clears scroll state\n            this.scroll_state = 'auto';\n        }\n    };\n\n\n    OutputArea.prototype.expand = function () {\n        if (this.collapsed) {\n            this.collapse_button.hide();\n            this.element.show();\n            if (this.prompt_area) {\n                this.prompt_overlay.show();\n            }\n            this.collapsed = false;\n            this.scroll_if_long();\n        }\n    };\n\n\n    OutputArea.prototype.toggle_output = function () {\n        if (this.collapsed) {\n            this.expand();\n        } else {\n            this.collapse();\n        }\n    };\n\n\n    OutputArea.prototype.scroll_area = function () {\n        this.element.addClass('output_scroll');\n        this.prompt_overlay.attr('title', i18n.msg._('click to unscroll output; double click to hide'));\n        this.scrolled = true;\n    };\n\n\n    OutputArea.prototype.unscroll_area = function () {\n        this.element.removeClass('output_scroll');\n        this.prompt_overlay.attr('title', i18n.msg._('click to scroll output; double click to hide'));\n        this.scrolled = false;\n    };\n\n    /**\n     * Scroll OutputArea if height exceeds a threshold.\n     *\n     * Threshold is OutputArea.minimum_scroll_threshold if scroll_state = true,\n     * OutputArea.auto_scroll_threshold if scroll_state='auto'.\n     *\n     **/\n    OutputArea.prototype.scroll_if_long = function () {\n        var should_scroll = this._should_scroll();\n        if (!this.scrolled && should_scroll) {\n            // only allow scrolling long-enough output\n            this.scroll_area();\n        } else if (this.scrolled && !should_scroll) {\n            // scrolled and shouldn't be\n            this.unscroll_area();\n        }\n    };\n\n\n    OutputArea.prototype.toggle_scroll = function () {\n        if (this.scroll_state == 'auto') {\n            this.scroll_state = !this.scrolled;\n        } else {\n            this.scroll_state = !this.scroll_state;\n        }\n        if (this.scrolled) {\n            this.unscroll_area();\n        } else {\n            // only allow scrolling long-enough output\n            this.scroll_if_long();\n        }\n    };\n\n\n    // typeset with MathJax if MathJax is available\n    OutputArea.prototype.typeset = function () {\n        utils.typeset(this.element);\n    };\n\n\n    OutputArea.prototype.handle_output = function (msg) {\n        var json = {};\n        var msg_type = json.output_type = msg.header.msg_type;\n        var content = msg.content;\n        switch(msg_type) {\n        case \"stream\" :\n            json.text = content.text;\n            json.name = content.name;\n            break;\n        case \"execute_result\":\n            json.execution_count = content.execution_count;\n        case \"update_display_data\":\n        case \"display_data\":\n            json.transient = content.transient;\n            json.data = content.data;\n            json.metadata = content.metadata;\n            break;\n        case \"error\":\n            json.ename = content.ename;\n            json.evalue = content.evalue;\n            json.traceback = content.traceback;\n            break;\n        default:\n            console.error(\"unhandled output message\", msg);\n            return;\n        }\n        this.append_output(json);\n    };\n    \n    // Declare mime type as constants\n    var MIME_JAVASCRIPT = 'application/javascript';\n    var MIME_HTML = 'text/html';\n    var MIME_MARKDOWN = 'text/markdown';\n    var MIME_LATEX = 'text/latex';\n    var MIME_SVG = 'image/svg+xml';\n    var MIME_PNG = 'image/png';\n    var MIME_JPEG = 'image/jpeg';\n    var MIME_GIF = 'image/gif';\n    var MIME_PDF = 'application/pdf';\n    var MIME_TEXT = 'text/plain';\n    \n    \n    OutputArea.output_types = [\n        MIME_JAVASCRIPT,\n        MIME_HTML,\n        MIME_MARKDOWN,\n        MIME_LATEX,\n        MIME_SVG,\n        MIME_PNG,\n        MIME_JPEG,\n        MIME_GIF,\n        MIME_PDF,\n        MIME_TEXT,\n    ];\n\n    OutputArea.prototype.validate_mimebundle = function (bundle) {\n        /** scrub invalid outputs */\n        if (typeof bundle.data !== 'object') {\n            console.warn(\"mimebundle missing data\", bundle);\n            bundle.data = {};\n        }\n        if (typeof bundle.metadata !== 'object') {\n            console.warn(\"mimebundle missing metadata\", bundle);\n            bundle.metadata = {};\n        }\n        var data = bundle.data;\n        $.map(OutputArea.output_types, function(key){\n            if ((key.indexOf('application/') === -1 || key.indexOf('json') === -1) &&\n                data[key] !== undefined &&\n                typeof data[key] !== 'string'\n            ) {\n                console.log(\"Invalid type for \" + key, data[key]);\n                delete data[key];\n            }\n        });\n        return bundle;\n    };\n    \n    OutputArea.prototype.append_output = function (json) {\n        this.expand();\n        \n        if (this.clear_queued) {\n            this.clear_output(false);\n            this._needs_height_reset = true;\n        }\n\n        var record_output = true;\n        switch(json.output_type) {\n            case 'update_display_data':\n                record_output = false;\n                json = this.validate_mimebundle(json);\n                this.update_display_data(json);\n                return;\n            case 'execute_result':\n                json = this.validate_mimebundle(json);\n                this.append_execute_result(json);\n                break;\n            case 'stream':\n                // append_stream might have merged the output with earlier stream output\n                record_output = this.append_stream(json);\n                break;\n            case 'error':\n                this.append_error(json);\n                break;\n            case 'display_data':\n                // append handled below\n                json = this.validate_mimebundle(json);\n                break;\n            default:\n                console.log(\"unrecognized output type: \" + json.output_type);\n                this.append_unrecognized(json);\n        }\n\n        if (json.output_type === 'display_data') {\n            var that = this;\n            this.append_display_data(json, this.handle_appended);\n        } else {\n            this.handle_appended();\n        }\n\n        if (record_output) {\n            this.outputs.push(json);\n        }\n\n        this.events.trigger('output_added.OutputArea', {\n            output: json,\n            output_area: this,\n        });\n    };\n\n    OutputArea.prototype.handle_appended = function () {\n        if (this._needs_height_reset) {\n            this.element.height('');\n            this._needs_height_reset = false;\n        }\n\n        this.element.trigger('resizeOutput', {output_area: this});\n    };\n\n    OutputArea.prototype.create_output_area = function () {\n        var oa = $(\"<div/>\").addClass(\"output_area\");\n        if (this.prompt_area) {\n            oa.append($('<div/>').addClass('run_this_cell'));\n            oa.append($('<div/>').addClass('prompt'));\n        }\n        return oa;\n    };\n\n\n    function _get_metadata_key(metadata, key, mime) {\n        var mime_md = metadata[mime];\n        // mime-specific higher priority\n        if (mime_md && mime_md[key] !== undefined) {\n            return mime_md[key];\n        }\n        // fallback on global\n        return metadata[key];\n    }\n\n    OutputArea.prototype.create_output_subarea = function(md, classes, mime) {\n        var subarea = $('<div/>').addClass('output_subarea').addClass(classes);\n        if (_get_metadata_key(md, 'isolated', mime)) {\n            // Create an iframe to isolate the subarea from the rest of the\n            // document\n            var iframe = $('<iframe/>').addClass('box-flex1');\n            iframe.css({'height':1, 'width':'100%', 'display':'block'});\n            iframe.attr('frameborder', 0);\n            iframe.attr('scrolling', 'auto');\n\n            // Once the iframe is loaded, the subarea is dynamically inserted\n            iframe.on('load', function() {\n                // Workaround needed by Firefox, to properly render svg inside\n                // iframes, see https://stackoverflow.com/questions/10177190/\n                // svg-dynamically-added-to-iframe-does-not-render-correctly\n                this.contentDocument.open();\n\n                // Insert the subarea into the iframe\n                // We must directly write the html. When using Jquery's append\n                // method, javascript is evaluated in the parent document and\n                // not in the iframe document.  At this point, subarea doesn't\n                // contain any user content.\n                this.contentDocument.write(subarea.html());\n\n                this.contentDocument.close();\n\n                var body = this.contentDocument.body;\n                // Adjust the iframe height automatically\n                iframe.height(body.scrollHeight + 'px');\n            });\n\n            // Elements should be appended to the inner subarea and not to the\n            // iframe\n            iframe.append = function(that) {\n                subarea.append(that);\n            };\n\n            return iframe;\n        } else {\n            return subarea;\n        }\n    };\n\n\n    OutputArea.prototype._append_javascript_error = function (err, element) {\n        /**\n         * display a message when a javascript error occurs in display output\n         */\n        var msg = i18n.msg._(\"Javascript error adding output!\");\n        if ( element === undefined ) return;\n        element\n            .append($('<div/>').text(msg).addClass('js-error'))\n            .append($('<div/>').text(err.toString()).addClass('js-error'))\n            .append($('<div/>').text(i18n.msg._('See your browser Javascript console for more details.')).addClass('js-error'));\n    };\n    \n    OutputArea.prototype._safe_append = function (toinsert, toreplace) {\n        /**\n         * safely append an item to the document\n         * this is an object created by user code,\n         * and may have errors, which should not be raised\n         * under any circumstances.\n         */\n        try {\n            if (toreplace) {\n                toreplace.replaceWith(toinsert);\n            } else {\n                this.element.append(toinsert);\n            }\n        } catch(err) {\n            console.error(err);\n            // Create an actual output_area and output_subarea, which creates\n            // the prompt area and the proper indentation.\n            toinsert = this.create_output_area();\n            var subarea = $('<div/>').addClass('output_subarea');\n            toinsert.append(subarea);\n            this._append_javascript_error(err, subarea);\n            this.element.append(toinsert);\n        }\n\n        // Notify others of changes.\n        this.element.trigger('changed', {output_area: this});\n    };\n\n    OutputArea.output_prompt_classical = function(prompt_value) {\n        var message = i18n.msg._('Out') + '[%s]:';\n        return $('<bdi>').text(i18n.msg.sprintf(message, prompt_value));\n    };\n\n    OutputArea.output_prompt_function = OutputArea.output_prompt_classical;\n\n    OutputArea.prototype.append_execute_result = function (json) {\n        var n = json.execution_count || ' ';\n        var toinsert = this.create_output_area();\n        this._record_display_id(json, toinsert);\n        if (this.prompt_area) {\n            toinsert.find('div.prompt')\n                    .addClass('output_prompt')\n                    .empty()\n                    .append(OutputArea.output_prompt_function(n));\n        }\n        var inserted = this.append_mime_type(json, toinsert);\n        if (inserted) {\n            inserted.addClass('output_result');\n        }\n        this._safe_append(toinsert);\n        // If we just output latex, typeset it.\n        if ((json.data[MIME_LATEX] !== undefined) ||\n            (json.data[MIME_HTML] !== undefined) ||\n            (json.data[MIME_MARKDOWN] !== undefined)) {\n            this.typeset();\n        }\n    };\n\n\n    OutputArea.prototype.append_error = function (json) {\n        var tb = json.traceback;\n        if (tb !== undefined && tb.length > 0) {\n            var s = '';\n            var len = tb.length;\n            for (var i=0; i<len; i++) {\n                s = s + tb[i] + '\\n';\n            }\n            s = s + '\\n';\n            var toinsert = this.create_output_area();\n            var append_text = OutputArea.append_map[MIME_TEXT];\n            if (append_text) {\n                append_text.apply(this, [s, {}, toinsert]).addClass('output_error');\n            }\n            this._safe_append(toinsert);\n        }\n    };\n\n\n    OutputArea.prototype.append_stream = function (json) {\n        // [Basthon]\n        if( Array.isArray(json.text) )\n            json.text = json.text.join(\"\");\n        var text = json.text;\n        if (typeof text !== 'string') {\n            console.error(\"Stream output is invalid (missing text)\", json);\n            return false;\n        }\n        var subclass = \"output_\"+json.name;\n\n        if (this.outputs.length > 0){\n            // have at least one output to consider\n            var last = this.outputs[this.outputs.length-1];\n            if (last.output_type == 'stream' && json.name == last.name){\n                if (last.text.length > this.class_config.get_sync('stream_chunk_size')) {\n                    // don't keep extending long blocks\n                    var last_newline_idx = last.text.lastIndexOf('\\n');\n                    // if the last stream output doesn't end on a newline,\n                    // split on last newline and take the tail with the new output\n                    if (last_newline_idx !== -1 && last_newline_idx !== last.text.length - 1) {\n                        // truncate last.text to its last newline,\n                        // and take the tail with the new output.\n                        var tail = last.text.slice(last_newline_idx + 1);\n                        last.text = last.text.slice(0, last_newline_idx + 1);\n                        // we changed last's content, so we have to re-render it\n                        text = json.text = tail + json.text;\n                        var pre = this.element.find('div.'+subclass).last().find('pre');\n                        var html = utils.fixConsole(last.text);\n                        html = utils.autoLinkUrls(html);\n                        pre.html(html);\n                    }\n                } else {\n                    // latest output was in the same stream,\n                    // so append to it instead of making a new output.\n                    // escape ANSI & HTML specials:\n                    last.text = utils.fixOverwrittenChars(last.text + json.text);\n                    var pre = this.element.find('div.'+subclass).last().find('pre');\n                    var html = utils.fixConsole(last.text);\n                    html = utils.autoLinkUrls(html);\n                    // The only user content injected with this HTML call is\n                    // escaped by the fixConsole() method.\n                    pre.html(html);\n                    // return false signals that we merged this output with the previous one,\n                    // and the new output shouldn't be recorded.\n                    return false;\n                }\n            }\n        }\n\n        if (!text.replace(\"\\r\", \"\")) {\n            // text is nothing (empty string, \\r, etc.)\n            // so don't append any elements, which might add undesirable space\n            // return true to indicate the output should be recorded.\n            return true;\n        }\n\n        // If we got here, attach a new div\n        var toinsert = this.create_output_area();\n        var append_text = OutputArea.append_map[MIME_TEXT];\n        if (append_text) {\n            append_text.apply(this, [text, {}, toinsert]).addClass(\"output_stream \" + subclass);\n        }\n        this._safe_append(toinsert);\n        return true;\n    };\n\n\n    OutputArea.prototype.append_unrecognized = function (json) {\n        var that = this;\n        var toinsert = this.create_output_area();\n        var subarea = $('<div/>').addClass('output_subarea output_unrecognized');\n        toinsert.append(subarea);\n        subarea.append(\n            $(\"<a>\")\n                .attr(\"href\", \"#\")\n                .text(i18n.msg.sprintf(i18n.msg._(\"Unrecognized output: %s\"),json.output_type))\n                .click(function () {\n                    that.events.trigger('unrecognized_output.OutputArea', {output: json});\n                })\n        );\n        this._safe_append(toinsert);\n    };\n\n\n    OutputArea.prototype.update_display_data = function (json, handle_inserted) {\n        var oa = this;\n        var targets;\n        var display_id = (json.transient || {}).display_id;\n        if (!display_id) {\n            console.warn(\"Handling update_display with no display_id\", json);\n            return;\n        }\n        targets = this._display_id_targets[display_id];\n        if (!targets) {\n            console.warn(\"No targets for display_id\", display_id, json);\n            return;\n        }\n        // we've seen it before, update output data\n        targets.map(function (target) {\n            oa.outputs[target.index].data = json.data;\n            oa.outputs[target.index].metadata = json.metadata;\n            var toinsert = oa.create_output_area();\n            if (oa.append_mime_type(json, toinsert, handle_inserted)) {\n                oa._safe_append(toinsert, target.element);\n            }\n            target.element = toinsert;\n        });\n\n        // If we just output something that could contain latex, typeset it.\n        if ((json.data[MIME_LATEX] !== undefined) ||\n            (json.data[MIME_HTML] !== undefined) ||\n            (json.data[MIME_MARKDOWN] !== undefined)) {\n            this.typeset();\n        }\n        this.events.trigger('output_updated.OutputArea', {\n            output: json,\n            output_area: this,\n        });\n    };\n\n    OutputArea.prototype._record_display_id = function (json, element) {\n        // record display_id of a display_data / execute_result\n        var display_id = (json.transient || {}).display_id;\n        if (!display_id) return;\n        // it has a display_id;\n        var targets = this._display_id_targets[display_id];\n        if (!targets) {\n            targets = this._display_id_targets[display_id] = [];\n        }\n        targets.push({\n            index: this.outputs.length,\n            element: element,\n        });\n    };\n    \n    OutputArea.prototype.append_display_data = function (json, handle_inserted) {\n        var toinsert = this.create_output_area();\n        this._record_display_id(json, toinsert);\n        if (this.append_mime_type(json, toinsert, handle_inserted)) {\n            this._safe_append(toinsert);\n            // If we just output latex, typeset it.\n            if ((json.data[MIME_LATEX] !== undefined) ||\n                (json.data[MIME_HTML] !== undefined) ||\n                (json.data[MIME_MARKDOWN] !== undefined)) {\n                this.typeset();\n            }\n        }\n    };\n\n    OutputArea.safe_outputs = {};\n    OutputArea.safe_outputs[MIME_TEXT] = true;\n    OutputArea.safe_outputs[MIME_LATEX] = true;\n    OutputArea.safe_outputs[MIME_PNG] = true;\n    OutputArea.safe_outputs[MIME_JPEG] = true;\n    OutputArea.safe_outputs[MIME_GIF] = true;\n\n    OutputArea.prototype.append_mime_type = function (json, element, handle_inserted) {\n        for (var i=0; i < OutputArea.display_order.length; i++) {\n            var type = OutputArea.display_order[i];\n            var append = OutputArea.append_map[type];\n            if ((json.data[type] !== undefined) && append) {\n                var md = json.metadata || {};\n                var value = json.data[type];\n                var toinsert;\n                if (!this.trusted && !OutputArea.safe_outputs[type]) {\n                    // not trusted, sanitize HTML\n                    if (type===MIME_HTML || type==='text/svg') {\n                        var parsed = $(security.sanitize_html_and_parse(value));\n                        toinsert = append.apply(this, [parsed, md, element, handle_inserted]);\n                    } else {\n                        // don't display if we don't know how to sanitize it\n                        console.log(\"Ignoring untrusted \" + type + \" output.\");\n                        continue;\n                    }\n                } else {\n                    toinsert = append.apply(this, [value, md, element, handle_inserted]);\n                }\n\n                // Since only the png and jpeg mime types call the inserted\n                // callback, if the mime type is something other we must call the \n                // inserted callback only when the element is actually inserted\n                // into the DOM.  Use a timeout of 0 to do this.\n                if ([MIME_PNG, MIME_JPEG, MIME_GIF].indexOf(type) < 0 && handle_inserted !== undefined) {\n                    setTimeout(handle_inserted, 0);\n                }\n                this.events.trigger('output_appended.OutputArea', [type, value, md, toinsert]);\n                return toinsert;\n            }\n        }\n        return null;\n    };\n\n\n    var append_html = function (html, md, element) {\n        var type = MIME_HTML;\n        var toinsert = this.create_output_subarea(md, \"output_html rendered_html\", type);\n        this.keyboard_manager.register_events(toinsert);\n        toinsert.append(html);\n        dblclick_to_reset_size(toinsert.find('img'));\n        element.append(toinsert);\n        return toinsert;\n    };\n\n\n    var append_markdown = function(markdown, md, element) {\n        var type = MIME_MARKDOWN;\n        var toinsert = this.create_output_subarea(md, \"output_markdown rendered_html\", type);\n        var text_and_math = mathjaxutils.remove_math(markdown);\n        var text = text_and_math[0];\n        var math = text_and_math[1];\n        // Prevent marked from returning inline styles for table cells\n        var renderer = new marked.Renderer();\n        renderer.tablecell = function (content, flags) {\n          var type = flags.header ? 'th' : 'td';\n          var style = flags.align == null ? '': ' style=\"text-align: ' + flags.align + '\"';\n          var start_tag = '<' + type + style + '>';\n          var end_tag = '</' + type + '>\\n';\n          return start_tag + content + end_tag;\n        };\n        marked.parse(text, { renderer: renderer }, function (err, html) {\n            html = mathjaxutils.replace_math(html, math);\n            toinsert.append(html);\n        });\n        dblclick_to_reset_size(toinsert.find('img'));\n        element.append(toinsert);\n        return toinsert;\n    };\n\n\n    var append_javascript = function (js, md, element) {\n        /**\n         * We just eval the JS code, element appears in the local scope.\n         */\n        var type = MIME_JAVASCRIPT;\n        var toinsert = this.create_output_subarea(md, \"output_javascript rendered_html\", type);\n        this.keyboard_manager.register_events(toinsert);\n        element.append(toinsert);\n\n        // Fix for ipython/issues/5293, make sure `element` is the area which\n        // output can be inserted into at the time of JS execution.\n        element = toinsert;\n        try {\n            eval(js);\n        } catch(err) {\n            console.log(err);\n            this._append_javascript_error(err, toinsert);\n        }\n        return toinsert;\n    };\n\n\n    var append_text = function (data, md, element) {\n        var type = MIME_TEXT;\n        var toinsert = this.create_output_subarea(md, \"output_text\", type);\n        data = utils.fixOverwrittenChars(data);\n        // escape ANSI & HTML specials in plaintext:\n        data = utils.fixConsole(data);\n        data = utils.autoLinkUrls(data);\n        // The only user content injected with this HTML call is\n        // escaped by the fixConsole() method.\n        toinsert.append($(\"<pre/>\").html(data));\n        element.append(toinsert);\n        return toinsert;\n    };\n\n\n    var append_svg = function (svg_html, md, element) {\n        var type = MIME_SVG;\n        var toinsert = this.create_output_subarea(md, \"output_svg\", type);\n\n        // Get the svg element from within the HTML. \n        // One svg is supposed, but could embed other nested svgs\n        var svg = $($('<div \\>').html(svg_html).find('svg')[0]);\n        var svg_area = $('<div />');\n        var width = svg.attr('width');\n        var height = svg.attr('height');\n        svg\n            .width('100%')\n            .height('100%');\n        svg_area\n            .width(width)\n            .height(height);\n\n        svg_area.append(svg);\n        toinsert.append(svg_area);\n        element.append(toinsert);\n\n        return toinsert;\n    };\n\n    function dblclick_to_reset_size (img) {\n        /**\n         * Double-click on an image toggles confinement to notebook width\n         *\n         * img: jQuery element\n         */\n\n        img.dblclick(function () {\n            // dblclick toggles *raw* size, disabling max-width confinement.\n            if (img.hasClass('unconfined')) {\n                img.removeClass('unconfined');\n            } else {\n                img.addClass('unconfined');\n            }\n        });\n    }\n    \n    var set_width_height = function (img, md, mime) {\n        /**\n         * set width and height of an img element from metadata\n         */\n        var height = _get_metadata_key(md, 'height', mime);\n        if (height !== undefined) img.attr('height', height);\n        var width = _get_metadata_key(md, 'width', mime);\n        if (width !== undefined) img.attr('width', width);\n        if (_get_metadata_key(md, 'unconfined', mime)) {\n            img.addClass('unconfined');\n        }\n    };\n    \n    var append_png = function (png, md, element, handle_inserted) {\n        var type = MIME_PNG;\n        var toinsert = this.create_output_subarea(md, \"output_png\", type);\n        var img = $(\"<img/>\");\n        if (handle_inserted !== undefined) {\n            img.on('load', function(){\n                handle_inserted(img);\n            });\n        }\n        img[0].src = 'data:image/png;base64,'+ png;\n        set_width_height(img, md, type);\n        dblclick_to_reset_size(img);\n        toinsert.append(img);\n        element.append(toinsert);\n        return toinsert;\n    };\n\n\n    var append_jpeg = function (jpeg, md, element, handle_inserted) {\n        var type = MIME_JPEG;\n        var toinsert = this.create_output_subarea(md, \"output_jpeg\", type);\n        var img = $(\"<img/>\");\n        if (handle_inserted !== undefined) {\n            img.on('load', function(){\n                handle_inserted(img);\n            });\n        }\n        img[0].src = 'data:image/jpeg;base64,'+ jpeg;\n        set_width_height(img, md, type);\n        dblclick_to_reset_size(img);\n        toinsert.append(img);\n        element.append(toinsert);\n        return toinsert;\n    };\n    \n    var append_gif = function (gif, md, element, handle_inserted) {\n        var type = MIME_GIF;\n        var toinsert = this.create_output_subarea(md, \"output_gif\", type);\n        var img = $(\"<img/>\");\n        if (handle_inserted !== undefined) {\n            img.on('load', function(){\n                handle_inserted(img);\n            });\n        }\n        img[0].src = 'data:image/gif;base64,'+ gif;\n        set_width_height(img, md, type);\n        dblclick_to_reset_size(img);\n        toinsert.append(img);\n        element.append(toinsert);\n        return toinsert;\n    };\n\n\n    var append_pdf = function (pdf, md, element) {\n        var type = MIME_PDF;\n        var toinsert = this.create_output_subarea(md, \"output_pdf\", type);\n        var a = $('<a/>').attr('href', 'data:application/pdf;base64,'+pdf);\n        a.attr('target', '_blank');\n        a.text('View PDF');\n        toinsert.append(a);\n        element.append(toinsert);\n        return toinsert;\n     };\n\n    var append_latex = function (latex, md, element) {\n        /**\n         * This method cannot do the typesetting because the latex first has to\n         * be on the page.\n         */\n        var type = MIME_LATEX;\n        var toinsert = this.create_output_subarea(md, \"output_latex\", type);\n        toinsert.text(latex);\n        element.append(toinsert);\n        return toinsert;\n    };\n    \n    OutputArea.prototype.append_raw_input = function (msg) {\n        var that = this;\n        this.expand();\n        var content = msg.content;\n        var area = this.create_output_area();\n        \n        // disable any other raw_inputs, if they are left around\n        $(\"div.output_subarea.raw_input_container\").remove();\n        \n        var input_type = content.password ? 'password' : 'text';\n        \n        area.append(\n            $(\"<div/>\")\n            .addClass(\"box-flex1 output_subarea raw_input_container\")\n            .append(\n                $(\"<pre/>\")\n                .addClass(\"raw_input_prompt\")\n                .html(utils.fixConsole(content.prompt))\n                .append(\n                    $(\"<input/>\")\n                    .addClass(\"raw_input\")\n                    .attr('type', input_type)\n                    .attr('enterkeyhint', \"done\")\n                    .attr(\"size\", 47)\n                    .keydown(function (event, ui) {\n                        // make sure we submit on enter,\n                        // and don't re-execute the *cell* on shift-enter\n                        if (event.which === keyboard.keycodes.enter) {\n                            that._submit_raw_input();\n                            return false;\n                        }\n                    })\n                )\n            )\n        );\n        \n        this.element.append(area);\n        var raw_input = area.find('input.raw_input');\n        // Register events that enable/disable the keyboard manager while raw\n        // input is focused.\n        this.keyboard_manager.register_events(raw_input);\n        // Note, the following line used to read raw_input.focus().focus().\n        // This seemed to be needed otherwise only the cell would be focused.\n        // But with the modal UI, this seems to work fine with one call to focus().\n        raw_input.focus();\n    };\n\n    OutputArea.prototype._submit_raw_input = function (evt) {\n        var container = this.element.find(\"div.raw_input_container\");\n        var theprompt = container.find(\"pre.raw_input_prompt\");\n        var theinput = container.find(\"input.raw_input\");\n        var value = theinput.val();\n        var echo  = value;\n        // don't echo if it's a password\n        if (theinput.attr('type') == 'password') {\n            echo = '········';\n        }\n        var content = {\n            output_type : 'stream',\n            name : 'stdout',\n            text : theprompt.text() + echo + '\\n'\n        };\n        // remove form container\n        container.parent().remove();\n        // replace with plaintext version in stdout\n        this.append_output(content);\n        this.events.trigger('send_input_reply.Kernel', value);\n    };\n\n\n    OutputArea.prototype.handle_clear_output = function (msg) {\n        /**\n         * msg spec v4 had stdout, stderr, display keys\n         * v4.1 replaced these with just wait\n         * The default behavior is the same (stdout=stderr=display=True, wait=False),\n         * so v4 messages will still be properly handled,\n         * except for the rarely used clearing less than all output.\n         */\n        this.clear_output(msg.content.wait || false);\n    };\n\n\n    OutputArea.prototype.clear_output = function(wait, ignore_clear_queue) {\n        if (Basthon.pendingInput()) {\n            throw new Error(\"Impossible d'exécuter l'action : un champ d'entrée est en attente.\");\n        }\n\n        if (wait) {\n\n            // If a clear is queued, clear before adding another to the queue.\n            if (this.clear_queued) {\n                this.clear_output(false);\n            }\n\n            this.clear_queued = true;\n        } else {\n\n            // Fix the output div's height if the clear_output is waiting for\n            // new output (it is being used in an animation).\n            if (!ignore_clear_queue && this.clear_queued) {\n                // this.element.height() rounds the height, so we get the exact value\n                var height = this.element[0].getBoundingClientRect().height;\n                this.element.height(height);\n                this.clear_queued = false;\n            }\n            \n            // Clear all\n            // Remove load event handlers from img tags because we don't want\n            // them to fire if the image is never added to the page.\n            this.element.find('img').off('load');\n            this.element.trigger('clearing', {output_area: this});\n            this.element.html(\"\");\n\n            // Notify others of changes.\n            this.element.trigger('changed', {output_area: this});\n            this.element.trigger('cleared', {output_area: this});\n            \n            this.outputs = [];\n            this._display_id_targets = {};\n            this.trusted = true;\n            this.unscroll_area();\n            this.expand();\n            return;\n        }\n    };\n\n\n    // JSON serialization\n\n    OutputArea.prototype.fromJSON = function (outputs, metadata) {\n        var len = outputs.length;\n        metadata = metadata || {};\n\n        for (var i=0; i<len; i++) {\n            this.append_output(outputs[i]);\n        }\n        if (metadata.collapsed !== undefined) {\n            if (metadata.collapsed) {\n                this.collapse();\n            } else {\n                this.expand();\n            }\n        }\n        if (metadata.scrolled !== undefined) {\n            this.scroll_state = metadata.scrolled;\n            if (metadata.scrolled) {\n                this.scroll_if_long();\n            } else {\n                this.unscroll_area();\n            }\n        }\n    };\n\n    /**\n     * Return for-saving version of outputs.\n     * Excludes transient values.\n     */\n    OutputArea.prototype.toJSON = function () {\n        return this.outputs.map(function (out) {\n            var out2 = {};\n            Object.keys(out).map(function (key) {\n                if (key != 'transient') {\n                    out2[key] = out[key];\n                }\n            });\n            return out2;\n        });\n    };\n\n    /**\n     * Class properties\n     **/\n\n    /**\n     * Threshold to trigger autoscroll when the OutputArea is resized,\n     * typically when new outputs are added.\n     *\n     * Behavior is undefined if autoscroll is lower than minimum_scroll_threshold,\n     * unless it is < 0, in which case autoscroll will never be triggered\n     *\n     * @property auto_scroll_threshold\n     * @type Number\n     * @default 100\n     *\n     **/\n    OutputArea.auto_scroll_threshold = 100;\n\n    /**\n     * Lower limit (in lines) for OutputArea to be made scrollable. OutputAreas\n     * shorter than this are never scrolled.\n     *\n     * @property minimum_scroll_threshold\n     * @type Number\n     * @default 20\n     *\n     **/\n    OutputArea.minimum_scroll_threshold = 20;\n\n\n    OutputArea.display_order = [\n        MIME_JAVASCRIPT,\n        MIME_HTML,\n        MIME_MARKDOWN,\n        MIME_LATEX,\n        MIME_SVG,\n        MIME_PNG,\n        MIME_JPEG,\n        MIME_GIF,\n        MIME_PDF,\n        MIME_TEXT\n    ];\n\n    OutputArea.append_map = {};\n    OutputArea.append_map[MIME_TEXT] = append_text;\n    OutputArea.append_map[MIME_HTML] = append_html;\n    OutputArea.append_map[MIME_MARKDOWN] = append_markdown;\n    OutputArea.append_map[MIME_SVG] = append_svg;\n    OutputArea.append_map[MIME_PNG] = append_png;\n    OutputArea.append_map[MIME_JPEG] = append_jpeg;\n    OutputArea.append_map[MIME_GIF] = append_gif;\n    OutputArea.append_map[MIME_LATEX] = append_latex;\n    OutputArea.append_map[MIME_JAVASCRIPT] = append_javascript;\n    OutputArea.append_map[MIME_PDF] = append_pdf;\n    \n    OutputArea.prototype.mime_types = function () {\n        return OutputArea.display_order;\n    };\n    \n    OutputArea.prototype.register_mime_type = function (mimetype, append, options) {\n        if (mimetype && typeof(append) === 'function') {\n            OutputArea.output_types.push(mimetype);\n            if (options.safe) OutputArea.safe_outputs[mimetype] = true;\n            OutputArea.display_order.splice(options.index || 0, 0, mimetype);\n            OutputArea.append_map[mimetype] = append;\n        }\n    };\n\n    return {'OutputArea': OutputArea};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'jquery-ui'\n], function($, utils, i18n) {\n    \"use strict\";\n\n    var Pager = function (pager_selector, options) {\n        /**\n         * Constructor\n         *\n         * Parameters:\n         *  pager_selector: string\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance\n         */\n        this.events = options.events;\n        this.pager_element = $(pager_selector);\n        this.pager_button_area = $('#pager-button-area');\n        this._default_end_space = 100;\n        this.pager_element.resizable({handles: 'n', resize: $.proxy(this._resize, this)});\n        this.expanded = false;\n        this.create_button_area();\n        this.bind_events();\n    };\n\n    Pager.prototype.create_button_area = function(){\n        var that = this;\n        this.pager_button_area.append(\n            $('<a>').attr('role', \"button\")\n                    .attr('title',i18n.msg._(\"Open the pager in an external window\"))\n                    .addClass('ui-button')\n                    .click(function(){that.detach();})\n                    .append(\n                        $('<span>').addClass(\"ui-icon ui-icon-extlink\")\n                    )\n        );\n        this.pager_button_area.append(\n            $('<a>').attr('role', \"button\")\n                    .attr('title',i18n.msg._(\"Close the pager\"))\n                    .addClass('ui-button')\n                    .click(function(){that.collapse();})\n                    .append(\n                        $('<span>').addClass(\"ui-icon ui-icon-close\")\n                    )\n        );\n    };\n\n\n    Pager.prototype.bind_events = function () {\n        var that = this;\n\n        this.pager_element.bind('collapse_pager', function (event, extrap) {\n            // Animate hiding of the pager.\n            var time = (extrap && extrap.duration) ? extrap.duration : 'fast';\n            that.pager_element.animate({\n                height: 'toggle'\n            }, {\n                duration: time,\n                done: function() {\n                    $('.end_space').css('height', that._default_end_space);\n                }\n            });\n        });\n\n        this.pager_element.bind('expand_pager', function (event, extrap) {\n            // Clear the pager's height attr if it's set.  This allows the\n            // pager to size itself according to its contents.\n            that.pager_element.height('initial');\n\n            // Animate the showing of the pager\n            var time = (extrap && extrap.duration) ? extrap.duration : 'fast';\n            that.pager_element.show(time, function() {\n                // Explicitly set pager height once the pager has shown itself.\n                // This allows the pager-contents div to use percentage sizing.\n                that.pager_element.height(that.pager_element.height());\n                that._resize();\n                \n                // HACK: Less horrible, but still horrible hack to force the\n                // pager to show it's scrollbars on FireFox. ipython/ipython/#8853\n                that.pager_element.css('position', 'relative');\n                window.requestAnimationFrame(function() { /* Wait one frame */                    \n                    that.pager_element.css('position', '');\n                });\n            });\n        });\n\n        this.events.on('open_with_text.Pager', function (event, payload) {\n            // FIXME: support other mime types with generic mimebundle display\n            // mechanism\n            if (payload.data['text/html'] && payload.data['text/html'] !== \"\") {\n                that.clear();\n                that.expand();\n                that.append(payload.data['text/html']);\n            } else if (payload.data['text/plain'] && payload.data['text/plain'] !== \"\") {\n                that.clear();\n                that.expand();\n                that.append_text(payload.data['text/plain']);\n            }\n        });\n    };\n\n\n    Pager.prototype.collapse = function (extrap) {\n        if (this.expanded === true) {\n            this.expanded = false;\n            this.pager_element.trigger('collapse_pager', extrap);\n        }\n    };\n\n\n    Pager.prototype.expand = function (extrap) {\n        if (this.expanded !== true) {\n            this.expanded = true;\n            this.pager_element.trigger('expand_pager', extrap);\n        }\n    };\n\n\n    Pager.prototype.toggle = function () {\n        if (this.expanded === true) {\n            this.collapse();\n        } else {\n            this.expand();\n        }\n    };\n\n\n    Pager.prototype.clear = function (text) {\n        this.pager_element.find(\".container\").empty();\n    };\n\n    Pager.prototype.detach = function(){\n        var w = window.open(\"\",\"_blank\");\n        $(w.document.head)\n        .append(\n                $('<link>')\n                .attr('rel',\"stylesheet\")\n                .attr('href', utils.url_path_join(utils.get_body_data('baseUrl'), \"static/style/style.min.css\"))\n                .attr('type',\"text/css\")\n        )\n        .append(\n                $('<title>').text(i18n.msg._(\"Jupyter Pager\"))\n        );\n        var pager_body = $(w.document.body);\n        pager_body.css('overflow','scroll');\n\n        pager_body.append(this.pager_element.clone().children());\n        w.document.close();\n        this.collapse();\n    };\n\n    Pager.prototype.append_text = function (text) {\n        /**\n         * The only user content injected with this HTML call is escaped by\n         * the fixConsole() method.\n         */\n        this.pager_element.find(\".container\").append($('<pre/>').html(utils.fixConsole(utils.fixOverwrittenChars(text))));\n    };\n\n    Pager.prototype.append = function (htm) {\n        /**\n         * The only user content injected with this HTML call is escaped by\n         * the fixConsole() method.\n         */\n        this.pager_element.find(\".container\").append(htm);\n    };\n\n\n    Pager.prototype._resize = function() {\n        /**\n         * Update document based on pager size.\n         */\n        \n        // Make sure the padding at the end of the notebook is large\n        // enough that the user can scroll to the bottom of the \n        // notebook.\n        $('.end_space').css('height', Math.max(this.pager_element.height(), this._default_end_space));\n    };\n\n    return {'Pager': Pager};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// Define promises for notebook events.\n\ndefine(['base/js/events', 'base/js/promises'], function(events, promises) {\n    \"use strict\";\n\n    // Promise to be resolved when the notebook is *initially* loaded.\n    // The event may fire again if the notebook is reloaded later, but this\n    // promise only tracks the initial load.\n    promises.notebook_loaded = new Promise(function(resolve, reject) {\n        events.one('notebook_loaded.Notebook', function() {\n            resolve();\n        });\n        events.one('notebook_load_failed.Notebook', function() {\n            reject();\n        });\n    });\n\n    return promises;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/dialog',\n    'underscore'\n], function($, utils, i18n, dialog, _) {\n    \"use strict\";\n\n    var platform = utils.platform;\n\n    var QuickHelp = function (options) {\n        /**\n         * Constructor\n         *\n         * Parameters:\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance\n         *          keyboard_manager: KeyboardManager instance\n         *          notebook: Notebook instance\n         */\n        this.keyboard_manager = options.keyboard_manager;\n        this.notebook = options.notebook;\n        this.keyboard_manager.quick_help = this;\n        this.events = options.events;\n    };\n\n    var cmd_ctrl = 'Ctrl-';\n    var platform_specific;\n\n    if (platform === 'MacOS') {\n        // Mac OS X specific\n        cmd_ctrl = 'Cmd-';\n        platform_specific = [\n            { shortcut: \"Cmd-Up\", help:i18n.msg._(\"go to cell start\") },\n            { shortcut: \"Cmd-Down\", help:i18n.msg._(\"go to cell end\") },\n            { shortcut: \"Alt-Left\", help:i18n.msg._(\"go one word left\") },\n            { shortcut: \"Alt-Right\", help:i18n.msg._(\"go one word right\") },\n            { shortcut: \"Alt-Backspace\", help:i18n.msg._(\"delete word before\") },\n            { shortcut: \"Alt-Delete\", help:i18n.msg._(\"delete word after\") },\n            { shortcut: \"Cmd-Shift-z\", help:i18n.msg._(\"redo\") },\n            { shortcut: \"Cmd-Shift-u\", help:i18n.msg._(\"redo selection\") },\n            { shortcut: \"Ctrl-k\", help:i18n.msg._(\"emacs-style line kill\") },\n            { shortcut: \"Cmd-Backspace\", help:i18n.msg._(\"delete line left of cursor\") },\n            { shortcut: \"Cmd-Delete\", help:i18n.msg._(\"delete line right of cursor\") }\n        ];\n    } else {\n        // PC specific\n        platform_specific = [\n            { shortcut: \"Ctrl-Home\", help:i18n.msg._(\"go to cell start\") },\n            { shortcut: \"Ctrl-Up\", help:i18n.msg._(\"go to cell start\") },\n            { shortcut: \"Ctrl-End\", help:i18n.msg._(\"go to cell end\") },\n            { shortcut: \"Ctrl-Down\", help:i18n.msg._(\"go to cell end\") },\n            { shortcut: \"Ctrl-Left\", help:i18n.msg._(\"go one word left\") },\n            { shortcut: \"Ctrl-Right\", help:i18n.msg._(\"go one word right\") },\n            { shortcut: \"Ctrl-Backspace\", help:i18n.msg._(\"delete word before\")},\n            { shortcut: \"Ctrl-Delete\", help:i18n.msg._(\"delete word after\")},\n            { shortcut: \"Ctrl-y\", help:i18n.msg._(\"redo\")},\n            { shortcut: \"Alt-u\", help:i18n.msg._(\"redo selection\") }\n        ];\n    }\n\n    var cm_shortcuts = [\n        { shortcut:\"Tab\", help:i18n.msg._(\"code completion or indent\") },\n        { shortcut:\"Shift-Tab\", help:i18n.msg._(\"tooltip\") },\n        { shortcut: cmd_ctrl + \"]\", help:i18n.msg._(\"indent\") },\n        { shortcut: cmd_ctrl + \"[\", help:i18n.msg._(\"dedent\") },\n        { shortcut: cmd_ctrl + \"a\", help:i18n.msg._(\"select all\") },\n        { shortcut: cmd_ctrl + \"z\", help:i18n.msg._(\"undo\") },\n        { shortcut: cmd_ctrl + \"/\", help:i18n.msg._(\"comment\") },\n        { shortcut: cmd_ctrl + \"d\", help:i18n.msg._(\"delete whole line\") },\n        { shortcut: cmd_ctrl + \"u\", help:i18n.msg._(\"undo selection\") },\n        { shortcut: \"Insert\", help:i18n.msg._(\"toggle overwrite flag\") }\n    ].concat( platform_specific );\n    \n    var mac_humanize_map = {\n        // all these are unicode, will probably display badly on anything except macs.\n        // these are the standard symbol that are used in MacOS native menus\n        // cf https://apple.stackexchange.com/questions/55727/\n        // for htmlentities and/or unicode value\n        'cmd':'⌘',\n        'shift':'⇧',\n        'alt':'⌥',\n        'up':'↑',\n        'down':'↓',\n        'left':'←',\n        'right':'→',\n        'eject':'⏏',\n        'tab':'⇥',\n        'backtab':'⇤',\n        'capslock':'⇪',\n        'esc':'esc',\n        'ctrl':'⌃',\n        'enter':'↩',\n        'pageup':'⇞',\n        'pagedown':'⇟',\n        'home':'↖',\n        'end':'↘',\n        'altenter':'⌤',\n        'space':'␣',\n        'delete':'⌦',\n        'backspace':'⌫',\n        'apple':'',\n    };\n\n    var default_humanize_map = {\n        'shift':i18n.msg._('Shift'),\n        'alt':i18n.msg._('Alt'),\n        'up':i18n.msg._('Up'),\n        'down':i18n.msg._('Down'),\n        'left':i18n.msg._('Left'),\n        'right':i18n.msg._('Right'),\n        'tab':i18n.msg._('Tab'),\n        'capslock':i18n.msg._('Caps Lock'),\n        'esc':i18n.msg._('Esc'),\n        'ctrl':i18n.msg._('Ctrl'),\n        'enter':i18n.msg._('Enter'),\n        'pageup':i18n.msg._('Page Up'),\n        'pagedown':i18n.msg._('Page Down'),\n        'home':i18n.msg._('Home'),\n        'end':i18n.msg._('End'),\n        'space':i18n.msg._('Space'),\n        'backspace':i18n.msg._('Backspace'),\n        '-':i18n.msg._('Minus')\n        };\n    \n    var humanize_map;\n\n    if (platform === 'MacOS'){\n        humanize_map = mac_humanize_map;\n    } else {\n        humanize_map = default_humanize_map;\n    }\n\n    var special_case = { pageup: i18n.msg._(\"PageUp\"), pagedown: i18n.msg._(\"Page Down\") };\n    \n    function humanize_key(key){\n        if (key.length === 1){\n            return key.toUpperCase();\n        }\n\n        key = humanize_map[key.toLowerCase()]||key;\n        \n        if (key.indexOf(',') === -1){\n            return  ( special_case[key] ? special_case[key] : key.charAt(0).toUpperCase() + key.slice(1) );\n        }\n    }\n\n    // return an **html** string of the keyboard shortcut\n    // for human eyes consumption.\n    // the sequence is a string, comma separated linkt of shortcut,\n    // where the shortcut is a list of dash-joined keys.\n    // Each shortcut will be wrapped in <kbd> tag, and joined by comma is in a\n    // sequence.\n    //\n    // Depending on the platform each shortcut will be normalized, with or without dashes.\n    // and replace with the corresponding unicode symbol for modifier if necessary.\n    function humanize_sequence(sequence){\n        var joinchar = ',';\n        var hum = _.map(sequence.replace(/meta/g, 'cmd').split(','), humanize_shortcut).join(joinchar);\n        return hum;\n    }\n\n    function _humanize_sequence(sequence){\n        var joinchar = ',';\n        var hum = _.map(sequence.replace(/meta/g, 'cmd').split(','), _humanize_shortcut).join(joinchar);\n        return hum;\n    }\n\n    function _humanize_shortcut(shortcut){\n        var joinchar = '-';\n        if (platform === 'MacOS'){\n            joinchar = '';\n        }\n        return _.map(shortcut.split('-'), humanize_key ).join(joinchar);\n    }\n\n    function humanize_shortcut(shortcut){\n        return '<kbd>'+_humanize_shortcut(shortcut)+'</kbd>';\n    }\n    \n\n    QuickHelp.prototype.show_keyboard_shortcuts = function () {\n        /**\n         * toggles display of keyboard shortcut dialog\n         */\n        var that = this;\n        if ( this.force_rebuild ) {\n            this.shortcut_dialog.remove();\n            delete(this.shortcut_dialog);\n            this.force_rebuild = false;\n        }\n        if ( this.shortcut_dialog ){\n            // if dialog is already shown, close it\n            $(this.shortcut_dialog).modal(\"toggle\");\n            return;\n        }\n        var element = $('<div/>');\n\n        // The documentation\n        var doc = $('<div/>').addClass('alert alert-info');\n        doc.append(i18n.msg._('The Jupyter Notebook has two different keyboard input modes.'))\n           .append(' ')\n           .append(i18n.msg._('<b>Edit mode</b> allows you to type code or text into a cell and is indicated by a green cell border.'))\n           .append(' ')\n           .append(i18n.msg._('<b>Command mode</b> binds the keyboard to notebook level commands and is indicated by a grey cell border with a blue left margin.')\n        );\n        element.append(doc);\n        if (platform === 'MacOS') {\n            doc = $('<div/>').addClass('alert alert-info');\n            var key_div = this.build_key_names();\n            doc.append(key_div);\n            element.append(doc);\n        }\n\n        // Command mode\n        var cmd_div = this.build_command_help();\n        element.append(cmd_div);\n\n        // Edit mode\n        var edit_div = this.build_edit_help(cm_shortcuts);\n        element.append(edit_div);\n\n        // This statement is used simply so that message extraction\n        // will pick up the strings.  The actual setting of the text\n        // for the button is in dialog.js.\n        var button_labels = [ i18n.msg._(\"Close\") ];\n\n        this.shortcut_dialog = dialog.modal({\n            title : i18n.msg._(\"Keyboard shortcuts\"),\n            body : element,\n            destroy : false,\n            buttons : {\n                Close : {}\n            },\n            notebook: this.notebook,\n            keyboard_manager: this.keyboard_manager,\n        });\n        this.shortcut_dialog.addClass(\"modal_stretch\");\n        \n        this.events.on('rebuild.QuickHelp', function() { that.force_rebuild = true;});\n    };\n\n    QuickHelp.prototype.build_key_names = function () {\n       var key_names_mac =  [{ shortcut:\"⌘\", help:i18n.msg._(\"Command\") },\n                    { shortcut:\"⌃\", help:i18n.msg._(\"Control\") },\n                    { shortcut:\"⌥\", help:i18n.msg._(\"Option\") },\n                    { shortcut:\"⇧\", help:i18n.msg._(\"Shift\") },\n                    { shortcut:\"↩\", help:i18n.msg._(\"Return\") },\n                    { shortcut:\"␣\", help:i18n.msg._(\"Space\") },\n                    { shortcut:\"⇥\", help:i18n.msg._(\"Tab\") }];\n        var i, half, n;\n        var div = $('<div/>').append('Mac OS X modifier keys:');\n        var sub_div = $('<div/>').addClass('container-fluid');\n        var col1 = $('<div/>').addClass('col-md-6');\n        var col2 = $('<div/>').addClass('col-md-6');\n        n = key_names_mac.length;\n        half = ~~(n/2);\n        for (i=0; i<half; i++) { col1.append(\n                build_one(key_names_mac[i])\n                ); }\n        for (i=half; i<n; i++) { col2.append(\n                build_one(key_names_mac[i])\n                ); }\n        sub_div.append(col1).append(col2);\n        div.append(sub_div);\n        return div;\n    };\n\n\n    QuickHelp.prototype.build_command_help = function () {\n        var that = this;\n        var command_shortcuts = this.keyboard_manager.command_shortcuts.help();\n        var cmdkey = '<kbd>'+i18n.msg._('Esc')+'</kbd>';\n        var div = build_div('<h4>'+i18n.msg.sprintf(i18n.msg._('Command Mode (press %s to enable)'),cmdkey)+'</h4>', command_shortcuts);\n        var edit_button = $('<button/>')\n            .text(i18n.msg._(\"Edit Shortcuts\"))\n            .addClass('btn btn-xs btn-default pull-right')\n            .attr('href', '#')\n            .attr('title', i18n.msg._('edit command-mode keyboard shortcuts'))\n            .click(function () {\n                // close this dialog\n                $(that.shortcut_dialog).modal(\"toggle\");\n                // and open the next one\n                $(that.shortcut_dialog).on('hidden.bs.modal', function (e) {\n                    that.keyboard_manager.actions.call(\n                        'jupyter-notebook:edit-command-mode-keyboard-shortcuts'\n                    );\n                });\n            });\n        div.find('h4').append(edit_button);\n        return div;\n    };\n\n    \n    QuickHelp.prototype.build_edit_help = function (cm_shortcuts) {\n        var edit_shortcuts = this.keyboard_manager.edit_shortcuts.help();\n        var enterkey = '<kbd>'+i18n.msg._('Enter')+'</kbd>';\n        edit_shortcuts = $.merge($.merge([], cm_shortcuts), edit_shortcuts);\n        return build_div('<h4>'+i18n.msg.sprintf(i18n.msg._('Edit Mode (press %s to enable)'),enterkey)+'</h4>', edit_shortcuts);\n    };\n\n    var build_one = function (s) {\n        var help = s.help;\n        var shortcut = '';\n        if(s.shortcut){\n            shortcut = humanize_sequence(s.shortcut);\n        }\n        return $('<div>').addClass('quickhelp').\n            append($('<span/>').addClass('shortcut_key').append($(shortcut))).\n            append($('<span/>').addClass('shortcut_descr').text(' : ' + help));\n\n    };\n\n    var build_div = function (title, shortcuts) {\n        \n        // Remove jupyter-notebook:ignore shortcuts.\n        shortcuts = shortcuts.filter(function(shortcut) {\n            if (shortcut.help === 'ignore') {\n                return false;\n            } else {\n                return true;\n            }\n        });\n        \n        var i, half, n;\n        var div = $('<div/>').append($(title));\n        var sub_div = $('<div/>').addClass('container-fluid');\n        var col1 = $('<div/>').addClass('col-md-6');\n        var col2 = $('<div/>').addClass('col-md-6');\n        n = shortcuts.length;\n        half = ~~(n/2);  // Truncate :)\n        for (i=0; i<half; i++) { col1.append( build_one(shortcuts[i]) ); }\n        for (i=half; i<n; i++) { col2.append( build_one(shortcuts[i]) ); }\n        sub_div.append(col1).append(col2);\n        div.append(sub_div);\n        return div;\n    };\n\n    return {'QuickHelp': QuickHelp,\n      humanize_shortcut: humanize_shortcut,\n      humanize_sequence: humanize_sequence,\n      _humanize_sequence: _humanize_sequence,\n  };\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'base/js/dialog',\n    'base/js/keyboard',\n    'moment',\n    'bidi/bidi',\n], function($, utils, i18n, dialog, keyboard, moment, bidi) {\n    \"use strict\";\n\n    var SaveWidget = function (selector, options) {\n        /**\n         * TODO: Remove circular ref.\n         */\n        this.notebook = undefined;\n        this.selector = selector;\n        this.events = options.events;\n        this._checkpoint_date = undefined;\n        this.keyboard_manager = options.keyboard_manager;\n        if (this.selector !== undefined) {\n            this.element = $(selector);\n            this.bind_events();\n        }\n    };\n\n\n    SaveWidget.prototype.bind_events = function () {\n        var that = this;\n        this.element.find('span.filename').click(function () {\n            that.rename_notebook({notebook: that.notebook});\n        });\n        this.events.on('notebook_loaded.Notebook', function () {\n            that.update_notebook_name();\n            that.update_document_title();\n        });\n        this.events.on('notebook_saved.Notebook', function () {\n            that.update_notebook_name();\n            that.update_document_title();\n        });\n        this.events.on('notebook_renamed.Notebook', function () {\n            that.update_notebook_name();\n            that.update_document_title();\n            that.update_address_bar();\n        });\n        this.events.on('notebook_save_failed.Notebook', function () {\n            that.set_save_status(i18n.msg._('Autosave Failed!'));\n        });\n        this.events.on('notebook_read_only.Notebook', function () {\n            // [Basthon] no 'read only'\n            // that.set_save_status('(read only)');\n            that.set_save_status('');\n            // disable future set_save_status\n            that.set_save_status = function () {};\n        });\n        this.events.on('checkpoints_listed.Notebook', function (event, data) {\n            that._set_last_checkpoint(data[0]);\n        });\n\n        this.events.on('checkpoint_created.Notebook', function (event, data) {\n            that._set_last_checkpoint(data);\n        });\n        this.events.on('set_dirty.Notebook', function (event, data) {\n            that.set_autosaved(data.value);\n        });\n    };\n\n    // This statement is used simply so that message extraction\n    // will pick up the strings.  The actual setting of the text\n    // for the button is in dialog.js.\n    var button_labels = [ i18n.msg._(\"Cancel\"), i18n.msg._(\"Rename\"), i18n.msg._(\"OK\")];\n\n    SaveWidget.prototype.rename_notebook = function (options) {\n        options = options || {};\n        var that = this;\n        var dialog_body = $('<div/>').append(\n            $(\"<p/>\").addClass(\"rename-message\")\n                .text(i18n.msg._('Enter a new notebook name:'))\n        ).append(\n            $(\"<br/>\")\n        ).append(\n            $('<input/>').attr('type','text').attr('size','25').addClass('form-control')\n            .val(options.notebook.get_notebook_name())\n        );\n        var d = dialog.modal({\n            title: i18n.msg._(\"Rename Notebook\"),\n            body: dialog_body,\n            notebook: options.notebook,\n            keyboard_manager: this.keyboard_manager,\n            default_button: \"Cancel\",\n            buttons : {\n                \"Cancel\": {},\n                \"Rename\": {\n                    class: \"btn-primary\",\n                    click: function () {\n                        var new_name = d.find('input').val();\n                        if (!options.notebook.test_notebook_name(new_name)) {\n                            d.find('.rename-message').text(i18n.msg._(\n                                \"Invalid notebook name. Notebook names must have 1 or more characters and can contain any characters except :/\\\\. Please enter a new notebook name:\")\n                            );\n                            return false;\n                        } else {\n                            d.find('.rename-message').text(i18n.msg._(\"Renaming...\"));\n                            d.find('input[type=\"text\"]').prop('disabled', true);\n                            that.notebook.rename(new_name).then(\n                                function () {\n                                    d.modal('hide');\n                                }, function (error) {\n                                    d.find('.rename-message').text(error.message || i18n.msg._('Unknown error'));\n                                    d.find('input[type=\"text\"]').prop('disabled', false).focus().select();\n                                }\n                            );\n                            return false;\n                        }\n                    }\n                }\n            },\n            open : function () {\n                /**\n                 * Upon ENTER, click the OK button.\n                 */\n                d.find('input[type=\"text\"]').keydown(function (event) {\n                    if (event.which === keyboard.keycodes.enter) {\n                        d.find('.btn-primary').first().click();\n                        return false;\n                    }\n                });\n                d.find('input[type=\"text\"]').focus().select();\n            }\n        });\n    };\n\n\n    SaveWidget.prototype.update_notebook_name = function () {\n        var nbname = this.notebook.get_notebook_name();\n        nbname = bidi.applyBidi(nbname);\n        this.element.find('span.filename').text(nbname);\n    };\n\n\n    SaveWidget.prototype.update_document_title = function () {\n        var nbname = this.notebook.get_notebook_name();\n        document.title = nbname + ' - Jupyter Notebook';\n    };\n\n    SaveWidget.prototype.update_address_bar = function(){\n        var base_url = this.notebook.base_url;\n        var path = this.notebook.notebook_path;\n        var state = {path : path};\n        window.history.replaceState(state, \"\", utils.url_path_join(\n            base_url,\n            \"notebooks\",\n            utils.encode_uri_components(path))\n        );\n    };\n\n\n    SaveWidget.prototype.set_save_status = function (msg) {\n        this.element.find('span.autosave_status').text(msg);\n    };\n\n    SaveWidget.prototype._set_last_checkpoint = function (checkpoint) {\n        if (checkpoint) {\n            this._checkpoint_date = new Date(checkpoint.last_modified);\n        } else {\n            this._checkpoint_date = null;\n        }\n        this._render_checkpoint();\n    };\n    \n    SaveWidget.prototype._render_checkpoint = function () {\n        /** actually set the text in the element, from our _checkpoint value\n        \n        called directly, and periodically in timeouts.\n        */\n        this._schedule_render_checkpoint();\n        var el = this.element.find('span.checkpoint_status');\n        if (!this._checkpoint_date) {\n            el.text('').attr('title', i18n.msg._('no checkpoint'));\n            return;\n        }\n        var chkd = moment(this._checkpoint_date);\n        var long_date = chkd.format('llll');\n        var human_date;\n        var tdelta = Math.ceil(new Date() - this._checkpoint_date);\n        if (tdelta < utils.time.milliseconds.d){\n            // less than 24 hours old, use relative date\n            human_date = chkd.fromNow();\n        } else {\n            // otherwise show calendar\n            // <Today | yesterday|...> at hh,mm,ss\n            human_date = chkd.calendar();\n        }\n        \n        el.text(i18n.msg.sprintf(i18n.msg._('Last Checkpoint: %s'),human_date)).attr('title', long_date);\n    };\n\n    \n    SaveWidget.prototype._schedule_render_checkpoint = function () {\n        /** schedule the next update to relative date\n        \n        periodically updated, so short values like 'a few seconds ago' don't get stale.\n        */\n        if (!this._checkpoint_date) {\n            return;\n        }\n        if ((this._checkpoint_timeout)) {\n            clearTimeout(this._checkpoint_timeout);\n        }\n        var dt = Math.ceil(new Date() - this._checkpoint_date);\n        this._checkpoint_timeout = setTimeout(\n            $.proxy(this._render_checkpoint, this),\n            utils.time.timeout_from_dt(dt)\n        );\n    };\n\n    SaveWidget.prototype.set_autosaved = function (dirty) {\n        if (dirty) {\n            this.set_save_status(i18n.msg._(\"(unsaved changes)\"));\n        } else {\n            this.set_save_status(i18n.msg._(\"(autosaved)\"));\n        }\n    };\n\n    return {'SaveWidget': SaveWidget};\n\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\ndefine(['jquery'], function($) {\n    \"use strict\";\n\n    var ScrollManager = function(notebook, options) {\n        /**\n         * Public constructor.\n         */\n        this.notebook = notebook;\n        this.element = $('#site');\n        options = options || {};\n        this.animation_speed = options.animation_speed || 250; //ms\n    };\n\n    ScrollManager.prototype.onScroll = function (func, rate) {\n        /**\n         * Register a function to be called when the page is scrolled, throttled\n         * at a particular rate limit.\n         */\n         rate = rate || 100; // default rate limit\n         this.element.scroll(function () {\n             clearTimeout(func._timeout);\n             func._timeout = setTimeout(func, rate);\n         });\n    };\n\n    ScrollManager.prototype.scroll = function (delta) {\n        /**\n         * Scroll the document.\n         *\n         * Parameters\n         * ----------\n         * delta: integer\n         *  direction to scroll the document.  Positive is downwards. \n         *  Unit is one page length.\n         */\n        this.scroll_some(delta);\n        return false;\n    };\n\n    ScrollManager.prototype.scroll_to = function(selector) {\n        /**\n         * Scroll to an element in the notebook.\n         */\n        this.element.animate({'scrollTop': $(selector).offset().top + this.element.scrollTop() - this.element.offset().top}, this.animation_speed);\n    };\n\n    ScrollManager.prototype.scroll_some = function(pages) {\n        /**\n         * Scroll up or down a given number of pages.\n         *\n         * Parameters\n         * ----------\n         * pages: integer\n         *  number of pages to scroll the document, may be positive or negative.\n         */\n        this.element.animate({'scrollTop': this.element.scrollTop() + pages * this.element.height()}, this.animation_speed);\n    };\n\n    ScrollManager.prototype.get_first_visible_cell = function() {\n        /**\n         * Gets the index of the first visible cell in the document.\n         *\n         * First, attempt to be smart by guessing the index of the cell we are\n         * scrolled to.  Then, walk from there up or down until the right cell \n         * is found.  To guess the index, get the top of the last cell, and\n         * divide that by the number of cells to get an average cell height.  \n         * Then divide the scroll height by the average cell height.\n         */\n        var cell_count = this.notebook.ncells();\n        var first_cell_top = this.notebook.get_cell(0).element.offset().top;\n        var last_cell_top = this.notebook.get_cell(cell_count-1).element.offset().top;\n        var avg_cell_height = (last_cell_top - first_cell_top) / cell_count;\n        var i = Math.ceil(this.element.scrollTop() / avg_cell_height);\n        i = Math.min(Math.max(i , 0), cell_count - 1);\n\n        while (this.notebook.get_cell(i).element.offset().top - first_cell_top < this.element.scrollTop() && i < cell_count - 1) {\n            i += 1;\n        } \n\n        while (this.notebook.get_cell(i).element.offset().top - first_cell_top > this.element.scrollTop() - 50 && i >= 0) {\n            i -= 1;\n        } \n        return Math.min(i + 1, cell_count - 1);\n    };\n\n    ScrollManager.prototype.is_cell_visible = function (cell) {\n        var cell_rect = cell.element[0].getBoundingClientRect();\n        var scroll_rect = this.element[0].getBoundingClientRect();\n        return ((cell_rect.top <= scroll_rect.bottom) && (cell_rect.bottom >= scroll_rect.top));\n    };\n\n\n    var TargetScrollManager = function(notebook, options) {\n        /**\n         * Public constructor.\n         */\n        ScrollManager.apply(this, [notebook, options]);\n    };\n    TargetScrollManager.prototype = Object.create(ScrollManager.prototype);\n\n    TargetScrollManager.prototype.is_target = function (index) {\n        /**\n         * Check if a cell should be a scroll stop.\n         *\n         * Returns `true` if the cell is a cell that the scroll manager\n         * should scroll to.  Otherwise, false is returned. \n         *\n         * Parameters\n         * ----------\n         * index: integer\n         *  index of the cell to test.\n         */\n        return false;\n    };\n\n    TargetScrollManager.prototype.scroll = function (delta) {\n        /**\n         * Scroll the document.\n         *\n         * Parameters\n         * ----------\n         * delta: integer\n         *  direction to scroll the document.  Positive is downwards.\n         *  Units are targets.\n         *\n         * Try to scroll to the next slide.\n         */\n        var cell_count = this.notebook.ncells();\n        var selected_index = this.get_first_visible_cell() + delta;\n        while (0 <= selected_index && selected_index < cell_count && !this.is_target(selected_index)) {\n            selected_index += delta;\n        }\n\n        if (selected_index < 0 || cell_count <= selected_index) {\n            return ScrollManager.prototype.scroll.apply(this, [delta]);\n        } else {\n            this.scroll_to(this.notebook.get_cell(selected_index).element);\n            \n            // Cancel browser keyboard scroll.\n            return false;\n        }\n    };\n\n\n    var SlideScrollManager = function(notebook, options) {\n        /**\n         * Public constructor.\n         */\n        TargetScrollManager.apply(this, [notebook, options]);\n    };\n    SlideScrollManager.prototype = Object.create(TargetScrollManager.prototype);\n\n    SlideScrollManager.prototype.is_target = function (index) {\n        var cell = this.notebook.get_cell(index);\n        return cell.metadata && cell.metadata.slideshow && \n            cell.metadata.slideshow.slide_type && \n            (cell.metadata.slideshow.slide_type === \"slide\" ||\n            cell.metadata.slideshow.slide_type === \"subslide\");\n    };\n\n\n    var HeadingScrollManager = function(notebook, options) {\n        /**\n         * Public constructor.\n         */\n        ScrollManager.apply(this, [notebook, options]);\n        options = options || {};\n        this._level = options.heading_level || 1;\n    };\n    HeadingScrollManager.prototype = Object.create(ScrollManager.prototype);\n\n    HeadingScrollManager.prototype.scroll = function (delta) {\n        /**\n         * Scroll the document.\n         *\n         * Parameters\n         * ----------\n         * delta: integer\n         *  direction to scroll the document.  Positive is downwards.\n         *  Units are headers.\n         *\n         * Get all of the header elements that match the heading level or are of\n         * greater magnitude (a smaller header number).\n         */\n        var headers = $();\n        var i;\n        for (i = 1; i <= this._level; i++) {\n            headers = headers.add('#notebook-container h' + i);\n        }\n\n        // Find the header the user is on or below.\n        var first_cell_top = this.notebook.get_cell(0).element.offset().top;\n        var current_scroll = this.element.scrollTop();\n        var header_scroll = 0;\n        i = -1;\n        while (current_scroll >= header_scroll && i < headers.length) {\n            if (++i < headers.length) {\n                header_scroll = $(headers[i]).offset().top - first_cell_top;\n            }\n        }\n        i--;\n\n        // Check if the user is below the header.\n        if (i < 0 || current_scroll > $(headers[i]).offset().top - first_cell_top + 30) {\n            // Below the header, count the header as a target.\n            if (delta < 0) {\n                delta += 1;\n            }\n        }\n        i += delta;\n\n        // Scroll!\n        if (0 <= i && i < headers.length) {\n            this.scroll_to(headers[i]);\n            return false;\n        } else {\n            // Default to the base's scroll behavior when target header doesn't\n            // exist.\n            return ScrollManager.prototype.scroll.apply(this, [delta]);\n        }\n    };\n\n    // Return namespace for require.js loads\n    return {\n        'ScrollManager': ScrollManager,\n        'SlideScrollManager': SlideScrollManager,\n        'HeadingScrollManager': HeadingScrollManager,\n        'TargetScrollManager': TargetScrollManager\n    };\n});\n","define([\n    'jquery',\n    'base/js/dialog',\n    'base/js/i18n'\n], function($, dialog, i18n){\n  \"use strict\";\n\n  /**\n   * escape a Regular expression to act as  a pure search string.\n   * though it will still have the case sensitivity options and all\n   * the benefits\n   **/\n  function escapeRegExp(string){\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n  }\n\n  /**\n   * Compute the model of the preview for the search and replace.\n   * It might not be perfectly accurate if matches overlap...\n   * Parameter:\n   *   sre: the string that will become the Search Regular Expression\n   *   arr: a list of string on which the match will be applied.\n   *   isCaseSensitive: should the match be CaseSensitive\n   *   RegExOrNot: a `RegExOrNot` object.\n   *   replace: the replacement string for the matching `sre`\n   * Return: a tuple of 2 value:\n   *   1) array of [before match, match, replacement, after match]\n   *      where before and after match are cut to a reasonable length after the match.\n   *   2) Boolean, whether the matching has been aborted because one of the element of\n   *      arr have too many matches.\n   **/\n  var compute_preview_model = function(sre, arr, isCaseSensitive, RegExpOrNot, replace){\n    var html = [];\n    // and create an array of\n    // before_match, match , replacement, after_match\n    var aborted = false;\n    var replacer_reg = new RegExpOrNot(sre);\n    for(var r=0; r < arr.length; r++){\n      var current_line = arr[r];\n      var match_abort = getMatches(sre, current_line, isCaseSensitive, RegExpOrNot);\n      aborted = aborted || match_abort[1];\n      var matches = match_abort[0];\n      for(var mindex=0; mindex < matches.length ; mindex++){\n        var start = matches[mindex][0];\n        var stop = matches[mindex][1];\n        var initial = current_line.slice(start, stop);\n        var replaced = initial.replace(replacer_reg, replace);\n        // that might be better as a dictionary\n        html.push([cutBefore(current_line.slice(0, start)),\n                   initial,\n                   replaced,\n                   cutAfter(current_line.slice(stop), 30-(stop-start))]);\n      }\n    }\n    return [html, aborted];\n  };\n\n  /**\n   * Build the preview model where things matched and their replacement values\n   * are wrapped in tags with correct CSS classes.\n   * Parameter:\n   *   body: jQuery element into which the preview will be build\n   *   aborted : have the model been aborted (Boolean) use to tell the user\n   *      that the preview might not show all the replacements\n   *   html: array of model created by compute_preview_model\n   *   replace: Boolean: whether we are actually replacing with something or just matching.\n   **/\n  var build_preview = function(body, aborted, html, replace){\n    body.empty();\n    if(aborted){\n      var warnmsg = i18n.msg.sprintf(i18n.msg._(\"Warning: too many matches (%d). Some changes might not be shown or applied.\"),html.length);\n      body.append($('<p/>').addClass('bg-warning').text(warnmsg));\n    } else {\n      var matchmsg = i18n.msg.sprintf(i18n.msg.ngettext(\"%d match\",\"%d matches\",html.length),html.length);\n      body.append($('<p/>').text(matchmsg));\n    }\n    for(var rindex=0; rindex<html.length; rindex++){\n      var pre = $('<pre/>')\n        .append(html[rindex][0])\n        .append($('<span/>').addClass('match').text(html[rindex][1]));\n      if(replace){\n        pre.append($('<span/>').addClass('insert').text(html[rindex][2]));\n        pre.addClass('replace');\n      }\n      pre.append(html[rindex][3]);\n      body.append(pre);\n    }\n  };\n\n  /**\n   * Given a string, return only the beginning, with potentially an ellipsis\n   * at the end.\n   **/\n  var cutAfter = function(string, n){\n    n=n||10;\n    while(n<10){\n      n+=15;\n    }\n    if(string.length > n+3){\n        return string.slice(0, n)+'...';\n    }\n    return string;\n  };\n\n  /**\n   * Given a string, return only the end, with potentially an ellipsis\n   * at the beginning.\n   **/\n  var cutBefore = function(string){\n    if(string.length > 33){\n        return '...'+string.slice(-30);\n    }\n    return string;\n  };\n\n  /**\n   * Find all occurrences of `re` in `string`, match in a `caseSensitive`\n   * manner or not, and determine whether `re` is a RegExp or not depending of\n   * the type of object passed as `r`.\n   *\n   * Return a tuple\n   *  1) list of matches [start, stop] indexes in the string.\n   *  2) abort Boolean, if more that 100 matches and the matches were aborted.\n   **/\n  var getMatches = function(re, string, caseSensitive, r){\n    var extra = caseSensitive ? '':'i';\n    extra = '';\n    try {\n      re = r(re, 'g'+extra);// have to global or infinite loop\n    } catch (e){\n      return [[], false];\n    }\n    var res = [];\n    var match;\n    var escape_hatch = 0;\n    var abort = false;\n    while((match = re.exec(string)) !== null) {\n        res.push([match.index, match.index+match[0].length]);\n        escape_hatch++;\n        if(escape_hatch > 100){\n          console.warn(i18n.msg._(\"More than 100 matches, aborting\"));\n          abort = true;\n          break;\n        }\n    }\n    return [res, abort];\n  };\n\n  // main function\n  /**\n   * Search N' Replace action handler.\n   **/\n  var snr = function(env, event) {\n      \n    var isRegExpButton = $('<button/>')\n      .attr('type', 'button')\n      .attr('id', 'isreg')\n      .addClass(\"btn btn-default btn-sm\")\n      .attr('data-toggle','button')\n      .css('font-weight', 'bold')\n      .attr('title', i18n.msg._('Use regex (JavaScript regex syntax)'))\n      .text('.*');\n\n      var allCellsButton = $('<button/>')\n      .append($('<i/>').addClass('fa fa-arrows-v'))\n      .attr('id', 'findreplace_allcells_btn')\n      .attr('type', 'button')\n      .addClass(\"btn btn-default btn-sm\")\n      .attr('data-toggle','button')\n      .attr('title', i18n.msg._('Replace in all cells'));\n\n    var isCaseSensitiveButton = $('<button/>')\n      .attr('type', 'button')\n      .addClass(\"btn btn-default btn-sm\")\n      .attr('data-toggle','button')\n      .attr('tabindex', '0')\n      .attr('title', i18n.msg._('Match case'))\n      .css('font-weight', 'bold')\n      .text('Aa');\n     \n    var search  = $(\"<input/>\")\n      .addClass('form-control input-sm')\n      .attr('id', 'findreplace_find_inp')\n      .attr('placeholder',i18n.msg._('Find'));\n\n    var findFormGroup = $('<div/>').addClass('form-group');\n    findFormGroup.append(\n        $('<div/>').addClass('input-group')\n        .append(\n            $('<div/>').addClass('input-group-btn')\n                .append(isCaseSensitiveButton)\n                .append(isRegExpButton)\n                .append(allCellsButton)\n        )\n        .append(search)\n    )\n\n    var replace = $(\"<input/>\")\n      .attr('id', 'findreplace_replace_inp')\n      .addClass('form-control input-sm')\n      .attr('placeholder',i18n.msg._('Replace'));\n    var replaceFormGroup = $('<div/>').addClass('form-group');\n    replaceFormGroup.append(replace);\n\n    var body = $('<div/>').attr('id', 'replace-preview');\n     \n    var form = $('<form/>').attr('id', 'find-and-replace')\n    form.append(findFormGroup);\n    form.append(replaceFormGroup);\n    form.append(body);\n\n    // return whether the search is case sensitive\n    var isCaseSensitive = function(){\n      var value =  isCaseSensitiveButton.attr('aria-pressed') == 'true';\n      return value;\n    };\n\n    // return whether the search is RegExp based, or\n    // plain string matching.\n    var isReg = function(){\n      var value =  isRegExpButton.attr('aria-pressed') == 'true';\n      return value;\n    };\n\n    var allCells = function(){\n      return (allCellsButton.attr('aria-pressed') == 'true');\n    };\n\n\n    // return a Pseudo RegExp object that acts\n    // either as a plain RegExp Object, or as a pure string matching.\n    // automatically set the flags for case sensitivity from the UI\n    var RegExpOrNot = function(str, flags){\n      if (!isCaseSensitive()){\n        flags = (flags || '')+'i';\n      }\n      if (isRegExpButton.attr('aria-pressed') === 'true'){\n        return new RegExp(str, flags);\n      } else {\n        return new RegExp(escapeRegExp(str), flags);\n      }\n    };\n\n\n    var onError = function(body){\n      body.empty();\n      body.append($('<p/>').text(i18n.msg._('No matches, invalid or empty regular expression')));\n    };\n\n    var get_cells = function(env){\n      if(allCells()){\n        return env.notebook.get_cells();\n      } else {\n        return env.notebook.get_selected_cells();\n      }\n    };\n\n    var get_all_text = function(cells) {\n      var arr = [];\n      for (var c = 0; c < cells.length; c++) {\n        arr = arr.concat(cells[c].code_mirror.getValue().split('\\n'));\n      }\n      return arr;\n    };\n    /**\n     * callback triggered anytime a change is made to the\n     * request, case sensitivity, isregex, search or replace\n     * modification.\n     **/\n    var onChange = function(){\n\n      var sre = search.val();\n      // abort on invalid RE\n      if (!sre) {\n        return onError(body);\n      }\n      try {\n        new RegExpOrNot(sre);\n      } catch (e) {\n        return onError(body);\n      }\n\n      // might want to warn if replace is empty\n      var replaceValue = replace.val();\n      var lines = get_all_text(get_cells(env));\n\n      var _hb = compute_preview_model(sre, lines, isCaseSensitive(), RegExpOrNot, replaceValue);\n      var html = _hb[0];\n      var aborted = _hb[1];\n\n      build_preview(body, aborted, html, replaceValue);\n\n      // done on type return false not to submit form\n      return false;\n    };\n\n    var onsubmit = function(event) {\n      var sre = search.val();\n      var replaceValue = replace.val();\n      if (!sre) {\n        return false;\n      }\n      // should abort on invalid RegExp.\n\n      // need to be multi line if we want to directly replace in codemirror.\n      // or need to split/replace/join\n      var reg = RegExpOrNot(sre, 'gm');\n      var cells = get_cells(env);\n      for (var c = 0; c < cells.length; c++) {\n        var cell = cells[c];\n        var oldvalue = cell.code_mirror.getValue();\n        var newvalue = oldvalue.replace(reg , replaceValue);\n        cell.code_mirror.setValue(newvalue);\n        if (cell.cell_type === 'markdown') {\n          cell.rendered = false;\n          cell.render();\n        }\n      }\n    };\n\n    // wire-up the UI\n\n    isRegExpButton.click(function(){\n      search.focus();\n      setTimeout(function(){onChange();}, 100);\n    });\n\n    isCaseSensitiveButton.click(function(){\n      search.focus();\n      setTimeout(function(){onChange();}, 100);\n    });\n\n    allCellsButton.click(function(){\n      replace.focus();\n      setTimeout(function(){onChange();}, 100);\n    });\n\n\n    search.keypress(function (e) {\n      if (e.which == 13) {//enter\n        replace.focus();\n      }\n    });\n\n    search.on('input', onChange);\n    replace.on('input',  onChange);\n\n    // This statement is used simply so that message extraction\n    // will pick up the strings.  The actual setting of the text\n    // for the button is in dialog.js.\n    var button_labels = [ i18n.msg._(\"Replace All\")];\n\n    var mod = dialog.modal({\n      show: false,\n      title: i18n.msg._(\"Find and Replace\"),\n      body:form,\n      keyboard_manager: env.notebook.keyboard_manager,\n      buttons:{\n        'Replace All':{ class: \"btn-primary\",\n            click: function(event){onsubmit(event); return true;},\n            id: \"findreplace_replaceall_btn\",\n        }\n      },\n      open: function(){\n        search.focus();\n      }\n    });\n\n    replace.keypress(function (e) {\n      if (e.which == 13) {//enter\n        onsubmit();\n        mod.modal('hide');\n      }\n    });\n    mod.modal('show');\n  };\n\n\n  var load = function(keyboard_manager){\n    var action_all = {\n        cmd: i18n.msg._('find and replace'),\n        help: i18n.msg._('find and replace'),\n        handler: function(env, event){\n          snr(env, event);\n        }\n    };\n\n    var act_all = keyboard_manager.actions.register(action_all, 'find-and-replace', 'jupyter-notebook');\n\n    keyboard_manager.command_shortcuts.add_shortcuts({\n        'f': 'jupyter-notebook:find-and-replace'\n    });\n  };\n\n\n  return {load:load};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    \"jquery\",\n    \"notebook/js/quickhelp\",\n    \"base/js/dialog\",\n    \"marked\",\n    \"react\",\n    \"react-dom/client\",\n    \"create-react-class\",\n], function (\n    $,\n    QH,\n    dialog,\n    marked,\n    React,\n    ReactDOM,\n    createReactClass\n) {\n\n\n/**\n * Humanize the action name to be consumed by user.\n * internally the actions name are of the form\n * <namespace>:<description-with-dashes>\n * we drop <namespace> and replace dashes for space.\n */\nvar humanize_action_id = function(str) {\n  return str.split(':')[1].replace(/-/g, ' ').replace(/_/g, '-');\n};\n\n/**\n * given an action id return 'command-shortcut', 'edit-shortcut' or 'no-shortcut'\n * for the action. This allows us to tag UI in order to visually distinguish\n * Wether an action have a keybinding or not.\n **/\n\nvar KeyBinding = createReactClass({\n  displayName: 'KeyBindings',\n  getInitialState: function() {\n    return {shrt:''};\n  },\n  handleShrtChange: function (element){\n    this.setState({shrt:element.target.value});\n  },\n  render: function(){\n    var that = this;\n    var available = this.props.available(this.state.shrt);\n    var empty = (this.state.shrt === '');\n    var binding_setter = function(){\n      if (available) { \n        that.props.onAddBindings(that.state.shrt, that.props.ckey);\n      }\n      that.state.shrt='';\n      event.preventDefault();\n      return false;\n    };\n    return React.createElement('form', {className:'jupyter-keybindings',\n            onSubmit: binding_setter\n        },\n              React.createElement('i', {className: \"pull-right fa fa-plus\", alt: 'add-keyboard-shortcut',\n                  onClick: binding_setter\n              }),\n              React.createElement('input', {\n                                      type:'text', \n                               placeholder:'add shortcut', \n                                 className:'pull-right'+((available||empty)?'':' alert alert-danger'),\n                                     value:that.state.shrt,\n                                  onChange:that.handleShrtChange\n              }),\n              that.props.shortcuts ? that.props.shortcuts.map(function (item, index) {\n                  return React.createElement('span', {className: 'pull-right', key: index},\n                  React.createElement('kbd', {},\n                    item.h,\n                    React.createElement('i', {className: \"fa fa-times\", alt: 'remove '+item.h,\n                      onClick:function () {\n                        that.props.unbind(item.raw);\n                      }\n                    })\n                  )\n                );\n              }): null,\n              React.createElement('div', {title: '(' + that.props.ckey + ')' ,\n                className:'jupyter-keybindings-text'}, that.props.display )\n      );\n  }\n});\n\nvar KeyBindingList = createReactClass({\n  displayName: 'KeyBindingList',\n  getInitialState: function(){\n    return {data:[]};\n  },\n  componentDidMount: function(){\n      this.setState({data:this.props.callback()});\n  },\n  render: function() {\n      var that = this;\n      var children = this.state.data.map(function (binding) {\n          return React.createElement(KeyBinding, Object.assign({}, binding, {\n          onAddBindings: function (shortcut, action) {\n              that.props.bind(shortcut, action);\n              that.setState({data:that.props.callback()});\n          },\n          available: that.props.available,\n          unbind: function (shortcut) {\n                  that.props.unbind(shortcut);\n                  that.setState({data:that.props.callback()});\n             }\n          }));\n      });\n      children.unshift(React.createElement('div', {className:'well', key:'disclamer1', id:'short-key-binding-intro', dangerouslySetInnerHTML:\n            {__html: \n            marked.parse(\n\n            \"Here you can modify the keyboard shortcuts available in \"+\n            \"command mode. Your changes will be stored for later sessions. \"+\n            \"See more [**details of defining keyboard shortcuts**](#long-key-binding-intro) below.\"\n            )}\n      }));\n      children.push(React.createElement('div', {className:'well', key:'disclamer2', id:'long-key-binding-intro', dangerouslySetInnerHTML:\n            {__html: \n            marked.parse(\n\n            \"This dialog allows you to modify the keyboard shortcuts available in command mode. \"+ \n            \"Any changes will be persisted between sessions and across environments. \"+\n            \"You can define two kinds of shortcuts: **key combinations** and **key sequences**.\\n\"+\n            \"\\n\"+\n            \" - **Key Combinations**:\\n\"+\n            \"   - Use hyphens `-` to represent keys that should be pressed at the same time.\\n\"+\n            \"   - This is designed for use with *modifier* keys: `Cmd`, `Ctrl`, `Alt` ,`Meta`, \"+\n            \"`Cmdtrl`, and `Shift`.\\n\"+ \n            \"       - `Cmdtrl` acts like `Cmd` on OS X/MacOS and `Ctrl` on Windows/Linux.\\n\"+\n            \"   - At most, one non-modifier key can exist in a key combination.\\n\"+\n            \"   - Multiple modifier keys can exist in a key combination.\\n\"+\n            \"   - Modifier keys need to precede the non-modifier key in a combination.\\n\"+\n            \"   - *Valid Examples*: `Shift-a`, `Ctrl-;`, or `Ctrl-Shift-a`. \\n\"+\n            \"   - *Invalid Example*s: `a-b` and `a-Ctrl-Shift`. \\n\"+\n            \" - **Key Sequences**:\\n\"+\n            \"   - Use commas `,` to represent keys that should be pressed in sequence.\\n\"+\n            \"   - The order in which keys must be pressed exactly matches the left-to-right order of \"+\n            \"the characters in the sequence, with no interruptions.\\n\"+\n            \"     - E.g., `h,a,l,t` would be triggered by typing <kbd>h</kbd> <kbd>a</kbd> \"+\n            \"<kbd>l</kbd> <kbd>t</kbd> but not <kbd>h</kbd> <kbd>a</kbd> <kbd>a</kbd> <kbd>l</kbd> \"+\n            \"<kbd>t</kbd> or <kbd>a</kbd>  <kbd>h</kbd> <kbd>l</kbd> <kbd>t</kbd>.\\n\"+\n            \"   - Sequences can include the same key multiple times (e.g., `d,d`).\\n\"+\n            \"   - You cannot include any pairs of sequences where one is a 'prefix' the other.\\n\"+\n            \"     - E.g., `d,d,d` cannot be used a the same time as `d,d`.\\n\"+ \n            \"   - Key combinations are unique elements that can be used in a sequence.\\n\"+ \n            \"     - E.g., `Ctrl-d,d` and `d,d` can exist at the same time and are both valid key sequences.\\n\"+\n            \"\\n\"+\n            \"**Additional notes**:\\n\"+\n            \"\\n\"+\n            \"The case in which elements are written does not change the binding's meaning. \"+\n            \"E.g., `Ctrl-D` and `cTrl-d` are the same key binding. \"+\n            \"Thus, `Shift` needs to be explicitly included if it is part of the key binding. \"+\n            \"So, for example, if you set a command to be activated by `Shift-D,D`, the second `d` \"+\n            \"cannot be pressed at the same time as the `Shift` modifier key.\\n\"+\n            \"\\n\"+\n            \"Valid modifiers are specified by writing out their names explicitly: \"+\n            \"e.g., `Shift`, `Cmd`, `Ctrl`, `Alt` ,`Meta`, `Cmdtrl`. You cannot use the symbol equivalents \"+\n            \"(e.g., `⇧`, `⌘`, `⌃`, `⌥`); refer to developer docs for the corresponding keys \"+\n            \"(the mapping of which depends on the platform you are using).\"+\n            \"You can hover on the name/description of a command to see its exact internal name and \"+\n            \"differentiate from actions defined in various plugins. \\n\"+\n            \"\\n\"+\n            \"Changing the keybindings of edit mode is not currently available.\"\n            )}\n      }));\n      return React.createElement('div',{}, children);\n    }\n});\n\nvar get_shortcuts_data = function(notebook) {\n    var actions = Object.keys(notebook.keyboard_manager.actions._actions);\n    var src = [];\n\n    for (var i = 0; i < actions.length; i++) {\n      var action_id = actions[i];\n      var action = notebook.keyboard_manager.actions.get(action_id);\n\n      var shortcuts = notebook.keyboard_manager.command_shortcuts.get_action_shortcuts(action_id);\n      var hshortcuts = [];\n      if (shortcuts.length > 0) {\n        hshortcuts = shortcuts.map(function (raw) {\n          return {h:QH._humanize_sequence(raw),raw:raw};}\n        );\n      }\n      src.push({\n        display: humanize_action_id(action_id),\n        shortcuts: hshortcuts,\n        key:action_id, // react specific thing\n        ckey: action_id\n      });\n    }\n    return src;\n};\n\n\nvar ShortcutEditor = function(notebook) {\n\n    if(!notebook){\n      throw new Error(\"CommandPalette takes a notebook non-null mandatory argument\");\n    }\n\n    var body =  $('<div>');\n    var mod = dialog.modal({\n        notebook: notebook,\n        keyboard_manager: notebook.keyboard_manager,\n        title : \"Edit Command mode Shortcuts\",\n        body : body,\n        buttons : {\n            OK : {}\n        }\n    });\n    \n    var src = get_shortcuts_data(notebook);\n\n    mod.addClass(\"modal_stretch\");\n\n    mod.modal('show');\n    const root = ReactDOM.createRoot(body.get(0));\n    root.render(\n        React.createElement(KeyBindingList, {\n            callback: function () { return src; },\n            bind: function (shortcut, command) {\n                return notebook.keyboard_manager.command_shortcuts._persist_shortcut(shortcut, command);\n            },\n            unbind: function (shortcut) {\n                return notebook.keyboard_manager.command_shortcuts._persist_remove_shortcut(shortcut);\n            },\n            available: function (shrt) { return notebook.keyboard_manager.command_shortcuts.is_available_shortcut(shrt);}\n          })\n    );\n};\n    return {ShortcutEditor: ShortcutEditor};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n',\n    'notebook/js/cell',\n    'base/js/security',\n    'services/config',\n    'notebook/js/mathjaxutils',\n    'notebook/js/celltoolbar',\n    'marked',\n    'codemirror/lib/codemirror',\n    'codemirror/mode/gfm/gfm',\n    'notebook/js/codemirror-ipythongfm'\n], function(\n    $,\n    utils,\n    i18n,\n    cell,\n    security,\n    configmod,\n    mathjaxutils,\n    celltoolbar,\n    marked,\n    CodeMirror,\n    gfm,\n    ipgfm\n    ) {\n    \"use strict\";\n    function encodeURIandParens(uri){return encodeURI(uri).replace('(','%28').replace(')','%29')}\n\n    var Cell = cell.Cell;\n\n    var TextCell = function (options) {\n        /**\n         * Constructor\n         *\n         * Construct a new TextCell, codemirror mode is by default 'htmlmixed', \n         * and cell type is 'text' cell start as not redered.\n         *\n         * Parameters:\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance \n         *          config: dictionary\n         *          keyboard_manager: KeyboardManager instance \n         *          notebook: Notebook instance\n         */\n        options = options || {};\n\n        // in all TextCell/Cell subclasses\n        // do not assign most of members here, just pass it down\n        // in the options dict potentially overwriting what you wish.\n        // they will be assigned in the base class.\n        this.notebook = options.notebook;\n        this.events = options.events;\n        this.config = options.config;\n\n        // we cannot put this as a class key as it has handle to \"this\".\n        Cell.apply(this, [{\n                    config: options.config, \n                    keyboard_manager: options.keyboard_manager, \n                    events: this.events}]);\n\n        this.cell_type = this.cell_type || 'text';\n        mathjaxutils = mathjaxutils;\n        this.rendered = false;\n    };\n\n    TextCell.prototype = Object.create(Cell.prototype);\n\n    TextCell.options_default = {\n        cm_config : {\n            mode: 'htmlmixed',\n            lineWrapping : true,\n        }\n    };\n\n\n    /**\n     * Create the DOM element of the TextCell\n     * @method create_element\n     * @private\n     */\n    TextCell.prototype.create_element = function () {\n        Cell.prototype.create_element.apply(this, arguments);\n        var that = this;\n\n        var cell = $(\"<div>\").addClass('cell text_cell');\n        cell.attr('tabindex','2');\n\n        var prompt = $('<div/>').addClass('prompt input_prompt');\n        cell.append(prompt);\n        var inner_cell = $('<div/>').addClass('inner_cell');\n        this.celltoolbar = new celltoolbar.CellToolbar({\n            cell: this, \n            notebook: this.notebook});\n        inner_cell.append(this.celltoolbar.element);\n        var input_area = $('<div/>').addClass('input_area').attr(\"aria-label\", i18n.msg._(\"Edit Markup Text here\"));\n        this.code_mirror = new CodeMirror(input_area.get(0), this._options.cm_config);\n        // In case of bugs that put the keyboard manager into an inconsistent state,\n        // ensure KM is enabled when CodeMirror is focused:\n        this.code_mirror.on('focus', function () {\n            if (that.keyboard_manager) {\n                that.keyboard_manager.enable();\n            }\n            that.code_mirror.setOption('readOnly', !that.is_editable());\n        });\n        this.code_mirror.on('keydown', $.proxy(this.handle_keyevent,this))\n        // The tabindex=-1 makes this div focusable.\n        var render_area = $('<div/>').addClass('text_cell_render rendered_html')\n            .attr('tabindex','-1');\n        inner_cell.append(input_area).append(render_area);\n        cell.append(inner_cell);\n        this.element = cell;\n        this.inner_cell = inner_cell;\n    };\n\n\n    // Cell level actions\n\n    TextCell.prototype.add_attachment = function (key, mime_type, b64_data) {\n        /**\n         * Add a new attachment to this cell\n         */\n        this.attachments[key] = {};\n        this.attachments[key][mime_type] = b64_data;\n    };\n\n    TextCell.prototype.select = function () {\n        var cont = Cell.prototype.select.apply(this, arguments);\n        if (cont) {\n            if (this.mode === 'edit') {\n                this.code_mirror.refresh();\n            }\n        }\n        return cont;\n    };\n\n    TextCell.prototype.unrender = function () {\n        var cont = Cell.prototype.unrender.apply(this);\n        if (cont) {\n            var text_cell = this.element;\n            if (this.get_text() === this.placeholder) {\n                this.set_text('');\n            }\n            this.refresh();\n        }\n        return cont;\n    };\n\n    TextCell.prototype.execute = function () {\n        this.render();\n    };\n\n    /**\n     * setter: {{#crossLink \"TextCell/set_text\"}}{{/crossLink}}\n     * @method get_text\n     * @return {string} CodeMirror current text value\n     */\n    TextCell.prototype.get_text = function() {\n        return this.code_mirror.getValue();\n    };\n\n    /**\n     * @param {string} text - Codemiror text value\n     * @see TextCell#get_text\n     * @method set_text\n     * */\n    TextCell.prototype.set_text = function(text) {\n        this.code_mirror.setValue(text);\n        this.unrender();\n        this.code_mirror.refresh();\n    };\n\n    /**\n     * setter :{{#crossLink \"TextCell/set_rendered\"}}{{/crossLink}}\n     * @method get_rendered\n     * */\n    TextCell.prototype.get_rendered = function() {\n        return this.element.find('div.text_cell_render').html();\n    };\n\n    /**\n     * @method set_rendered\n     */\n    TextCell.prototype.set_rendered = function(text) {\n        this.element.find('div.text_cell_render').html(text);\n    };\n\n\n    /**\n     * Create Text cell from JSON\n     * @param {json} data - JSON serialized text-cell\n     * @method fromJSON\n     */\n    TextCell.prototype.fromJSON = function (data) {\n        Cell.prototype.fromJSON.apply(this, arguments);\n        if (data.cell_type === this.cell_type) {\n            if (data.attachments !== undefined) {\n                this.attachments = data.attachments;\n            }\n\n            if (data.source !== undefined) {\n                if( Array.isArray(data.source) ) {\n                    data.source = data.source.join(\"\");\n                }\n                this.set_text(data.source);\n                // make this value the starting point, so that we can only undo\n                // to this state, instead of a blank cell\n                this.code_mirror.clearHistory();\n                // TODO: This HTML needs to be treated as potentially dangerous\n                // user input and should be handled before set_rendered.\n                this.set_rendered(data.rendered || '');\n                this.rendered = false;\n                this.render();\n            }\n        }\n    };\n\n    /** Generate JSON from cell\n     * @param {bool} gc_attachments - If true, will remove unused attachments\n     *               from the returned JSON\n     * @return {object} cell data serialised to json\n     */\n    TextCell.prototype.toJSON = function (gc_attachments) {\n        if (gc_attachments === undefined) {\n            gc_attachments = false;\n        }\n\n        var data = Cell.prototype.toJSON.apply(this);\n        data.source = this.get_text();\n        if (data.source == this.placeholder) {\n            data.source = \"\";\n        }\n\n        // We deepcopy the attachments so copied cells don't share the same\n        // objects\n        if (Object.keys(this.attachments).length > 0) {\n            if (gc_attachments) {\n                // Garbage collect unused attachments : The general idea is to\n                // render the text, and find used attachments like when we\n                // substitute them in render()\n                var that = this;\n                data.attachments = {};\n                // To find attachments, rendering to HTML is easier than\n                // searching in the markdown source for the multiple ways you\n                // can reference an image in markdown (using []() or a\n                // HTML <img>)\n                var text = this.get_text();\n                // [Basthon] do not render code as it can breack the sync call we use here\n                var renderer = new marked.Renderer();\n                renderer.code = function (code, infostring, escaped) { return code; };\n                var html = undefined;\n                try { marked.parse(text, {renderer: renderer}); } catch (e) {}\n                if (html != null) {\n                    html = $(security.sanitize_html_and_parse(html));\n                    html.find('img[src^=\"attachment:\"]').each(function (i, h) {\n                        h = $(h);\n                        var key = h.attr('src').replace(/^attachment:/, '');\n                        if (that.attachments.hasOwnProperty(key)) {\n                            data.attachments[key] = JSON.parse(JSON.stringify(\n                                that.attachments[key]));\n                        }\n\n                        // This is to avoid having the browser do a GET request\n                        // on the invalid attachment: URL\n                        h.attr('src', '');\n                    });\n                } else {\n                    // if parse fails, we fall back to no gc\n                    data.attachments = JSON.parse(JSON.stringify(this.attachments));\n                }\n                if (Object.keys(data.attachments).length === 0) {\n                    // omit attachments dict if no attachments\n                    delete data.attachments;\n                }\n            } else {\n                data.attachments = JSON.parse(JSON.stringify(this.attachments));\n            }\n        }\n        return data;\n    };\n\n\n    var MarkdownCell = function (options) {\n        /**\n         * Constructor\n         *\n         * Parameters:\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance \n         *          config: ConfigSection instance\n         *          keyboard_manager: KeyboardManager instance \n         *          notebook: Notebook instance\n         */\n        options = options || {};\n        var config_default = utils.mergeopt(TextCell, MarkdownCell.options_default);\n        this.class_config = new configmod.ConfigWithDefaults(options.config,\n                                            config_default, 'MarkdownCell');\n        TextCell.apply(this, [$.extend({}, options, {config: options.config})]);\n\n        this.cell_type = 'markdown';\n\n        // Used to keep track of drag events\n        this.drag_counter = 0;\n    };\n\n    MarkdownCell.options_default = {\n        cm_config: {\n            mode: 'ipythongfm'\n        },\n        placeholder: \"Type *Markdown* and LaTeX: $\\\\alpha^2$\"\n    };\n\n    MarkdownCell.prototype = Object.create(TextCell.prototype);\n\n    MarkdownCell.prototype.set_heading_level = function (level) {\n        /**\n         * make a markdown cell a heading\n         */\n        level = level || 1;\n        var source = this.get_text();\n        source = source.replace(/^(#*)\\s?/,\n            new Array(level + 1).join('#') + ' ');\n        this.set_text(source);\n        this.refresh();\n        if (this.rendered) {\n            this.render();\n        }\n    };\n\n    MarkdownCell.prototype.select = function () {\n        var cont = TextCell.prototype.select.apply(this, arguments);\n        if (cont) {\n            this.notebook.set_insert_image_enabled(!this.rendered);\n        }\n    };\n\n    MarkdownCell.prototype.unrender = function () {\n        var cont = TextCell.prototype.unrender.apply(this);\n        this.notebook.set_insert_image_enabled(true);\n    };\n\n    MarkdownCell.prototype.insert_inline_image_from_blob = function(blob) {\n        /**\n         * Insert markup for an inline image at the current cursor position.\n         * This works as follow :\n         * - We insert the base64-encoded blob data into the cell attachments\n         *   dictionary, keyed by the filename.\n         * - We insert an img tag with a 'attachment:key' src that refers to\n         *   the attachments entry.\n         *\n         * Parameters:\n         *  file: Blob\n         *      The JS Blob object (e.g. from the DataTransferItem)\n         */\n        var that = this;\n        var pos = this.code_mirror.getCursor();\n        var reader = new FileReader();\n        // We can get either a named file (drag'n'drop) or a blob (copy/paste)\n        // We generate names for blobs\n        var key;\n        if (blob.name !== undefined) {\n            key = encodeURIandParens(blob.name);\n        } else {\n            key = '_auto_' + Object.keys(that.attachments).length;\n        }\n\n        reader.onloadend = function() {\n            var d = utils.parse_b64_data_uri(reader.result);\n            if (blob.type != d[0]) {\n                // TODO(julienr): Not sure what we should do in this case\n                console.log('File type (' + blob.type + ') != data-uri ' +\n                            'type (' + d[0] + ')');\n            }\n            that.add_attachment(key, blob.type, d[1]);\n            var img_md = '![' + key + '](attachment:' + key + ')';\n            that.code_mirror.replaceRange(img_md, pos);\n        }\n        reader.readAsDataURL(blob);\n    };\n\n    /**\n     * @method render\n     */\n    MarkdownCell.prototype.render = function () {\n        // We clear the dropzone here just in case the dragenter/leave\n        // logic of bind_events wasn't 100% successful.\n        this.drag_counter = 0;\n        this.inner_cell.removeClass('dropzone');\n\n        var cont = TextCell.prototype.render.apply(this);\n        if (cont) {\n            var that = this;\n            var text = this.get_text();\n            var math = null;\n            if (text === \"\") { text = this.placeholder; }\n            var text_and_math = mathjaxutils.remove_math(text);\n            text = text_and_math[0];\n            math = text_and_math[1];\n            // Prevent marked from returning inline styles for table cells\n            var renderer = new marked.Renderer();\n            renderer.tablecell = function (content, flags) {\n              var type = flags.header ? 'th' : 'td';\n              var style = flags.align == null ? '': ' style=\"text-align: ' + flags.align + '\"';\n              var start_tag = '<' + type + style + '>';\n              var end_tag = '</' + type + '>\\n';\n              return start_tag + content + end_tag;\n            };\n            marked.parse(text, { renderer: renderer }, function (err, html) {\n                html = mathjaxutils.replace_math(html, math);\n                html = $(security.sanitize_html_and_parse(html));\n                // add anchors to headings\n                html.find(\":header\").addBack(\":header\").each(function (i, h) {\n                    h = $(h);\n                    var hash = h.text().replace(/ /g, '-');\n                    h.attr('id', hash);\n                    h.append(\n                        $('<a/>')\n                            .addClass('anchor-link')\n                            .attr('href', '#' + hash)\n                            .text('¶')\n                            .on('click',function(){\n                                setTimeout(function(){that.unrender(); that.render()}, 100)\n                            })\n                    );\n                });\n                // links in markdown cells should open in new tabs\n                html.find(\"a[href]\").not('[href^=\"#\"]').attr(\"target\", \"_blank\");\n                // replace attachment:<key> by the corresponding entry\n                // in the cell's attachments\n                html.find('img[src^=\"attachment:\"]').each(function (i, h) {\n                  h = $(h);\n                  var key = h.attr('src').replace(/^attachment:/, '');\n\n                  if (that.attachments.hasOwnProperty(key)) {\n                    var att = that.attachments[key];\n                    var mime = Object.keys(att)[0];\n                    h.attr('src', 'data:' + mime + ';base64,' + att[mime]);\n                  } else {\n                    h.attr('src', '');\n                  }\n                });\n                that.set_rendered(html);\n                that.typeset();\n                that.events.trigger(\"rendered.MarkdownCell\", {cell: that});\n            });\n        }\n        return cont;\n    };\n\n    /** @method bind_events **/\n    MarkdownCell.prototype.bind_events = function () {\n        TextCell.prototype.bind_events.apply(this);\n        var that = this;\n\n        this.element.dblclick(function () {\n            var cont = that.unrender();\n            if (cont) {\n                that.focus_editor();\n            }\n        });\n\n        var attachment_regex = /^image\\/.*$/;\n\n        // Event handlers to allow users to insert image using either\n        // drag'n'drop or copy/paste\n        var div = that.code_mirror.getWrapperElement();\n        $(div).on('paste', function(evt) {\n            var data = evt.originalEvent.clipboardData;\n            var items = data.items;\n            if (data.items !== undefined) {\n                for (var i = 0; i < items.length; ++i) {\n                    var item = items[i];\n                    if (item.kind == 'file' && attachment_regex.test(item.type)) {\n                        // TODO(julienr): This does not stop code_mirror from pasting\n                        // the filename.\n                        evt.stopPropagation();\n                        evt.preventDefault();\n                        that.insert_inline_image_from_blob(item.getAsFile());\n                    }\n                }\n            }\n        });\n\n        // Allow drag event if the dragged file can be used as an attachment\n        // If we use this.code_mirror.on to register a \"dragover\" handler, we\n        // get an empty dataTransfer\n        this.code_mirror.on(\"dragover\", function(cm, evt) {\n            if (utils.dnd_contain_file(evt)) {\n                evt.preventDefault();\n            }\n        });\n\n        // We want to display a visual indicator that the drop is possible.\n        // The dragleave event is fired when we hover a child element (which\n        // is often immediately after we got the dragenter), so we keep track\n        // of the number of dragenter/dragleave we got, as discussed here :\n        // https://stackoverflow.com/q/7110353/116067\n        // This doesn't seem to be 100% reliable, so we clear the dropzone\n        // class when the cell is rendered as well\n        this.code_mirror.on(\"dragenter\", function(cm, evt) {\n            if (utils.dnd_contain_file(evt)) {\n                that.drag_counter++;\n                that.inner_cell.addClass('dropzone');\n            }\n            evt.preventDefault();\n            evt.stopPropagation();\n        });\n\n        this.code_mirror.on(\"dragleave\", function(cm, evt) {\n            that.drag_counter--;\n            if (that.drag_counter <= 0) {\n                that.inner_cell.removeClass('dropzone');\n            }\n            evt.preventDefault();\n            evt.stopPropagation();\n        });\n\n        this.code_mirror.on(\"drop\", function(cm, evt) {\n            that.drag_counter = 0;\n            that.inner_cell.removeClass('dropzone');\n\n            var files = evt.dataTransfer.files;\n            for (var i = 0; i < files.length; ++i) {\n                var file = files[i];\n                if (attachment_regex.test(file.type)) {\n                    // Prevent the default code_mirror 'drop' event handler\n                    // (which inserts the file content) if this is a\n                    // recognized media file\n                    evt.stopPropagation();\n                    evt.preventDefault();\n                    that.insert_inline_image_from_blob(file);\n                }\n            }\n        });\n    };\n\n\n    var RawCell = function (options) {\n        /**\n         * Constructor\n         *\n         * Parameters:\n         *  options: dictionary\n         *      Dictionary of keyword arguments.\n         *          events: $(Events) instance \n         *          config: ConfigSection instance\n         *          keyboard_manager: KeyboardManager instance \n         *          notebook: Notebook instance\n         */\n        options = options || {};\n        var config_default = utils.mergeopt(TextCell, RawCell.options_default);\n        this.class_config = new configmod.ConfigWithDefaults(options.config,\n                                            config_default, 'RawCell');\n        TextCell.apply(this, [$.extend({}, options, {config: options.config})]);\n        this.cell_type = 'raw';\n    };\n\n    RawCell.options_default = {\n        highlight_modes : {\n            'diff'         :{'reg':[/^diff/]}\n        },\n        placeholder : i18n.msg._(\"Write raw LaTeX or other formats here, for use with nbconvert. \" +\n            \"It will not be rendered in the notebook. \" +\n            \"When passing through nbconvert, a Raw Cell's content is added to the output unmodified.\"),\n    };\n\n    RawCell.prototype = Object.create(TextCell.prototype);\n\n    /** @method bind_events **/\n    RawCell.prototype.bind_events = function () {\n        TextCell.prototype.bind_events.apply(this);\n        var that = this;\n        this.element.focusout(function() {\n            that.auto_highlight();\n            that.render();\n        });\n\n        this.code_mirror.on('focus', function() { that.unrender(); });\n    };\n\n    /** @method render **/\n    RawCell.prototype.render = function () {\n        var cont = TextCell.prototype.render.apply(this);\n        if (cont){\n            var text = this.get_text();\n            if (text === \"\") { text = this.placeholder; }\n            this.set_text(text);\n            this.element.removeClass('rendered');\n            this.auto_highlight();\n        }\n        return cont;\n    };\n\n    var textcell = {\n        TextCell: TextCell,\n        MarkdownCell: MarkdownCell,\n        RawCell: RawCell\n    };\n    return textcell;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine(['jquery','base/js/i18n'], function($, i18n) {\n    \"use strict\";\n\n    /**\n     * A generic toolbar on which one can add button\n     * @class ToolBar\n     * @constructor\n     * @param {Dom_object} selector\n     */\n    var ToolBar = function (selector, options) {\n        this.selector = selector;\n        this.actions = (options||{}).actions;\n        if (this.selector !== undefined) {\n            this.element = $(selector);\n            this.style();\n        }\n    };\n\n    ToolBar.prototype._pseudo_actions={};\n\n\n    ToolBar.prototype.construct = function (config) {\n        for(var k=0; k<config.length; k++) {\n            this.add_buttons_group(config[k][0],config[k][1]);\n        }\n    };\n\n    /**\n     *  Add a group of button into the current toolbar.\n     *\n     *  Use a [dict of [list of action name]] to trigger\n     *  on click to the button\n     *\n     *  @example\n     *\n     *      ... todo, maybe use a list of  list to keep ordering.\n     *\n     *      [\n     *          [\n     *            [\n     *              action_name_1,\n     *              action_name_2,\n     *              action_name_3,\n     *            ],\n     *            optional_group_name\n     *          ],\n     *          ...\n     *      ]\n     *\n     *  @param list {List}\n     *      List of button of the group, with the following parameter for each :\n     *      @param list.label {string} text to show on button hover\n     *      @param list.icon {string} icon to choose from [Font Awesome](http://fortawesome.github.io/Font-Awesome)\n     *      @param list.callback {function} function to be called on button click\n     *      @param [list.id] {String} id to give to the button\n     *  @param [group_id] {String} optional id to give to the group\n     *\n     *\n     *  for private usage, the key can also be strings starting with '<' and ending with '>' to inject custom element that cannot\n     *  be bound to an action.\n     *\n     */\n    // TODO JUPYTER:\n    // get rid of legacy code that handle things that are not actions.\n    ToolBar.prototype.add_buttons_group = function (list, group_id) {\n        // handle custom call of pseudoaction binding.\n        if(typeof(list) === 'string' && list.slice(0,1) === '<' && list.slice(-1) === '>'){\n            var _pseudo_action;\n            try{\n                _pseudo_action = list.slice(1,-1);\n                this.element.append(this._pseudo_actions[_pseudo_action].call(this));\n            } catch (e) {\n                console.warn('ouch, calling ', _pseudo_action, 'does not seem to work...:', e);\n            }\n            return ;\n        }\n        var that = this;\n        var btn_group = $('<div/>').addClass(\"btn-group\");\n        if( group_id !== undefined ) {\n            btn_group.attr('id',group_id);\n        }\n        list.forEach(function(el) {\n                var action_name;\n                var action;\n                if(typeof(el) === 'string'){\n                    action = that.actions.get(el);\n                    action_name = el;\n                } else if (el.action) {\n                    action = that.actions.get(el.action);\n                    action_name = el.action\n                }\n                var button  = $('<button/>')\n                    .addClass('btn btn-default')\n                    .attr(\"title\", el.label||i18n.msg._(action.help))\n                    .append(\n                        $(\"<i/>\").addClass(el.icon||(action||{icon:'fa-exclamation-triangle'}).icon).addClass('fa')\n                    );\n                if (el.label) {\n                    var label = $('<span/>').text(i18n.msg._(el.label)).addClass('toolbar-btn-label');\n                    button.append(label);\n                }\n                var id = el.id;\n                if( id !== undefined ){\n                    button.attr('id',id);\n                }\n                button.attr('data-jupyter-action', action_name);\n                var fun = el.callback|| function(){\n                    that.actions.call(action_name);\n                };\n                button.click(fun);\n                btn_group.append(button);\n        });\n        $(this.selector).append(btn_group);\n        return btn_group;\n    };\n\n    ToolBar.prototype.style = function () {\n        this.element.addClass('toolbar');\n    };\n\n    /**\n     * Show and hide toolbar\n     * @method toggle\n     */\n    ToolBar.prototype.toggle = function () {\n        this.element.toggle();\n    };\n\n    /**\n     * A simple class to hold information defining one toolbar button.\n     * @class ToolBar\n     * @constructor\n     * @param action {String} name of a Jupyter action taken when pressed\n     * @param options.label {String} short label to display on the button\n     */\n    var Button = function(action, options) {\n        this.action = action;\n        this.label = (options||{}).label;\n    };\n\n    return {\n        'ToolBar': ToolBar,\n        'Button': Button\n    };\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'base/js/i18n'\n], function($, utils, i18n) {\n    \"use strict\";\n\n    // tooltip constructor\n    var Tooltip = function (events) {\n        var that = this;\n        this.events = events;\n        this.time_before_tooltip = 1200;\n\n        // handle to html\n        this.tooltip = $('#tooltip');\n        this._hidden = true;\n\n        // variable for consecutive call\n        this._old_cell = null;\n        this._old_request = null;\n        this._consecutive_counter = 0;\n\n        // 'sticky ?'\n        this._sticky = false;\n\n        // display tooltip if the docstring is empty?\n        this._hide_if_no_docstring = false;\n\n        // contain the button in the upper right corner\n        this.buttons = $('<div/>').addClass('tooltipbuttons');\n\n        // will contain the docstring\n        this.text = $('<div/>').addClass('tooltiptext').addClass('smalltooltip');\n\n        // build the buttons menu on the upper right\n        // expand the tooltip to see more\n        var expandlink = $('<a/>').attr('href', \"#\").attr('role', \"button\").addClass('ui-button')\n        .attr('id', 'expanbutton').attr('title', i18n.msg._('Grow the tooltip vertically (press shift-tab twice)')).click(function () {\n            that.expand();\n            event.preventDefault();\n        }).append(\n        $('<span/>').text('Expand').addClass('ui-icon').addClass('ui-icon-plus'));\n\n        // open in pager\n        var morelink = $('<a/>').attr('href', \"#\").attr('role', \"button\").addClass('ui-button').attr('title', i18n.msg._('show the current docstring in pager (press shift-tab 4 times)'));\n        var morespan = $('<span/>').text(i18n.msg._('Open in Pager')).addClass('ui-icon').addClass('ui-icon-arrowstop-l-n');\n        morelink.append(morespan);\n        morelink.click(function () {\n            that.showInPager(that._old_cell);\n            event.preventDefault();\n        });\n\n        // close the tooltip\n        var closelink = $('<a/>').attr('href', \"#\").attr('role', \"button\").addClass('ui-button');\n        var closespan = $('<span/>').text(i18n.msg._('Close')).addClass('ui-icon').addClass('ui-icon-close');\n        closelink.append(closespan);\n        closelink.click(function () {\n            that.remove_and_cancel_tooltip(true);\n            event.preventDefault();\n        });\n\n        this._clocklink = $('<a/>').attr('href', \"#\");\n        this._clocklink.attr('role', \"button\");\n        this._clocklink.addClass('ui-button');\n        this._clocklink.attr('title', i18n.msg._('Tooltip will linger for 10 seconds while you type'));\n        var clockspan = $('<span/>').text(i18n.msg._('Close'));\n        clockspan.addClass('ui-icon');\n        clockspan.addClass('ui-icon-clock');\n        this._clocklink.append(clockspan);\n        this._clocklink.click(function () {\n            that.cancel_stick();\n            event.preventDefault();\n        });\n\n\n\n\n        //construct the tooltip\n        // add in the reverse order you want them to appear\n        this.buttons.append(closelink);\n        this.buttons.append(expandlink);\n        this.buttons.append(morelink);\n        this.buttons.append(this._clocklink);\n        this._clocklink.hide();\n\n\n        // we need a phony element to make the small arrow\n        // of the tooltip in css\n        // we will move the arrow later\n        this.arrow = $('<div/>').addClass('pretooltiparrow');\n        this.tooltip.append(this.buttons);\n        this.tooltip.append(this.arrow);\n        this.tooltip.append(this.text);\n\n        // function that will be called if you press tab 1, 2, 3... times in a row\n        this.tabs_functions = [function (cell, text, cursor) {\n            that._request_tooltip(cell, text, cursor);\n        }, function () {\n            that.expand();\n        }, function () {\n            that.stick();\n        }, function (cell) {\n            that.cancel_stick();\n            that.showInPager(cell);\n        }];\n        // call after all the tabs function above have bee call to clean their effects\n        // if necessary\n        this.reset_tabs_function = function (cell, text) {\n            this._old_cell = (cell) ? cell : null;\n            this._old_request = (text) ? text : null;\n            this._consecutive_counter = 0;\n        };\n    };\n\n    Tooltip.prototype.is_visible = function () {\n        return !this._hidden;\n    };\n\n    Tooltip.prototype.showInPager = function (cell) {\n        /**\n         * reexecute last call in pager by appending ? to show back in pager\n         */\n        this.events.trigger('open_with_text.Pager', this._reply.content);\n        this.remove_and_cancel_tooltip();\n    };\n\n    // grow the tooltip vertically\n    Tooltip.prototype.expand = function () {\n        this.text.removeClass('smalltooltip');\n        this.text.addClass('bigtooltip');\n        $('#expanbutton').hide('slow');\n    };\n\n    // deal with all the logic of hiding the tooltip\n    // and reset it's status\n    Tooltip.prototype._hide = function () {\n        this._hidden = true;\n        this.tooltip.fadeOut('fast');\n        $('#expanbutton').show('slow');\n        this.text.removeClass('bigtooltip');\n        this.text.addClass('smalltooltip');\n        // keep scroll top to be sure to always see the first line\n        this.text.scrollTop(0);\n        this.code_mirror = null;\n    };\n\n    // return true on successfully removing a visible tooltip; otherwise return\n    // false.\n    Tooltip.prototype.remove_and_cancel_tooltip = function (force) {\n        /**\n         * note that we don't handle closing directly inside the calltip\n         * as in the completer, because it is not focusable, so won't\n         * get the event.\n         */\n        this.cancel_pending();\n        if (!this._hidden) {\n          if (force || !this._sticky) {\n              this.cancel_stick();\n              this._hide();\n          }\n          this.reset_tabs_function();\n          return true;\n        } else {\n          return false;\n        }\n    };\n\n    // cancel autocall done after '(' for example.\n    Tooltip.prototype.cancel_pending = function () {\n        if (this._tooltip_timeout !== null) {\n            clearTimeout(this._tooltip_timeout);\n            this._tooltip_timeout = null;\n        }\n    };\n\n    // will trigger tooltip after timeout\n    Tooltip.prototype.pending = function (cell, hide_if_no_docstring) {\n        var that = this;\n        this._tooltip_timeout = setTimeout(function () {\n            that.request(cell, hide_if_no_docstring);\n        }, that.time_before_tooltip);\n    };\n\n    // easy access for julia monkey patching.\n    Tooltip.last_token_re = /[a-z_][0-9a-z._]*$/gi;\n\n    Tooltip.prototype._request_tooltip = function (cell, text, cursor_pos) {\n        var callbacks = $.proxy(this._show, this);\n        var msg_id = cell.kernel.inspect(text, cursor_pos, callbacks);\n    };\n\n    // make an immediate completion request\n    Tooltip.prototype.request = function (cell, hide_if_no_docstring) {\n        /**\n         * request(codecell)\n         * Deal with extracting the text from the cell and counting\n         * call in a row\n         */\n        this.cancel_pending();\n        var editor = cell.code_mirror;\n        var cursor = editor.getCursor();\n        var text = cell.get_text();\n        var cursor_pos = utils.js_idx_to_char_idx(editor.indexFromPos(cursor), text);\n\n        this._hide_if_no_docstring = hide_if_no_docstring;\n\n        if(editor.somethingSelected()){\n            // get only the most recent selection.\n            text = editor.getSelection();\n        }\n\n        // need a permanent handle to code_mirror for future auto recall\n        this.code_mirror = editor;\n\n        // now we treat the different number of keypress\n        // first if same cell, same text, increment counter by 1\n        if (this._old_cell == cell && this._old_request == text && this._hidden === false) {\n            this._consecutive_counter++;\n        } else {\n            // else reset\n            this.cancel_stick();\n            this.reset_tabs_function (cell, text);\n        }\n\n        this.tabs_functions[this._consecutive_counter](cell, text, cursor_pos);\n\n        // then if we are at the end of list function, reset\n        if (this._consecutive_counter == this.tabs_functions.length) {\n            this.reset_tabs_function (cell, text, cursor);\n        }\n\n        return;\n    };\n\n    // cancel the option of having the tooltip to stick\n    Tooltip.prototype.cancel_stick = function () {\n        clearTimeout(this._stick_timeout);\n        this._stick_timeout = null;\n        this._clocklink.hide('slow');\n        this._sticky = false;\n    };\n\n    // put the tooltip in a sicky state for 10 seconds\n    // it won't be removed by remove_and_cancel() unless you called with\n    // the first parameter set to true.\n    // remove_and_cancel_tooltip(true)\n    Tooltip.prototype.stick = function (time) {\n        time = (time !== undefined) ? time : 10;\n        var that = this;\n        this._sticky = true;\n        this._clocklink.show('slow');\n        this._stick_timeout = setTimeout(function () {\n            that._sticky = false;\n            that._clocklink.hide('slow');\n        }, time * 1000);\n    };\n\n    // should be called with the kernel reply to actually show the tooltip\n    Tooltip.prototype._show = function (reply) {\n        /**\n         * move the bubble if it is not hidden\n         * otherwise fade it\n         */\n        this._reply = reply;\n        var content = reply.content;\n        if (!content.found) {\n            // object not found, nothing to show\n            return;\n        }\n        this.name = content.name;\n\n        // do some math to have the tooltip arrow on more or less on left or right\n        // position of the editor\n        var cm_pos = $(this.code_mirror.getWrapperElement()).position();\n        var cell_pos = $(this.code_mirror.getWrapperElement().offsetParent).position();\n\n        // anchor and head positions are local within CodeMirror element\n        var anchor = this.code_mirror.cursorCoords(false, 'local');\n        var head = this.code_mirror.cursorCoords(true, 'local');\n        // locate the target at the center of anchor, head\n        var center_left = (head.left + anchor.left) / 2;\n        // locate the left edge of the tooltip, at most 450 px left of the arrow\n        var edge_left = Math.max(center_left - 450, 0);\n        // locate the arrow at the cursor. A 24 px offset seems necessary.\n        var arrow_left = center_left - edge_left - 24;\n        \n        // locate left, top within container element\n        var left = (cell_pos.left + cm_pos.left + edge_left) + 'px';\n        var top = (cell_pos.top + cm_pos.top + head.bottom + 10) + 'px';\n\n        if (this._hidden === false) {\n            this.tooltip.animate({\n                left: left,\n                top: top\n            });\n        } else {\n            this.tooltip.css({\n                left: left\n            });\n            this.tooltip.css({\n                top: top\n            });\n        }\n        this.arrow.animate({\n            'left': arrow_left + 'px'\n        });\n        \n        this._hidden = false;\n        this.tooltip.fadeIn('fast');\n        this.text.children().remove();\n        \n        // This should support rich data types, but only text/plain for now\n        // Any HTML within the docstring is escaped by the fixConsole() method.\n        var pre = $('<pre/>').html(utils.fixConsole(content.data['text/plain']));\n        this.text.append(pre);\n        // keep scroll top to be sure to always see the first line\n        this.text.scrollTop(0);\n    };\n\n    return {'Tooltip': Tooltip};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine(['jquery', 'bootstrap-tour', 'base/js/i18n'], function($, Tour, i18n) {\n    \"use strict\";\n\n    var tour_style = \"<div class='popover tour'>\\n\" +\n        \"<div class='arrow'></div>\\n\" +\n        \"<div style='position:absolute; top:7px; right:7px'>\\n\" +\n            \"<button class='btn btn-default btn-sm fa fa-times' data-role='end'></button>\\n\" +\n        \"</div><h3 class='popover-title'></h3>\\n\" +\n        \"<div class='popover-content'></div>\\n\" +\n        \"<div class='popover-navigation'>\\n\" +\n            \"<button class='btn btn-default fa fa-step-backward' data-role='prev'></button>\\n\" +\n            \"<button class='btn btn-default fa fa-step-forward pull-right' data-role='next'></button>\\n\" +\n            \"<button id='tour-pause' class='btn btn-sm btn-default fa fa-pause' data-resume-text='' data-pause-text='' data-role='pause-resume'></button>\\n\" +\n        \"</div>\\n\" +\n    \"</div>\";\n\n    var NotebookTour = function (notebook, events) {\n        var that = this;\n        this.notebook = notebook;\n        this.step_duration = 0;\n        this.events = events;\n        this.tour_steps = [\n            { \n                title: i18n.msg._(\"Welcome to the Notebook Tour\"),\n                placement: 'bottom',\n                orphan: true,\n                content: i18n.msg._(\"You can use the left and right arrow keys to go backwards and forwards.\")\n            }, {\n                element: \"#notebook_name\",\n                title: i18n.msg._(\"Filename\"),\n                placement: 'bottom',\n                content: i18n.msg._(\"Click here to change the filename for this notebook.\")\n            }, {\n                element: $(\"#menus\").parent(),\n                placement: 'bottom',\n                title: i18n.msg._(\"Notebook Menubar\"),\n                content: i18n.msg._(\"The menubar has menus for actions on the notebook, its cells, and the kernel it communicates with.\")\n            }, {\n                element: \"#maintoolbar\",\n                placement: 'bottom',\n                title: i18n.msg._(\"Notebook Toolbar\"),\n                content: i18n.msg._(\"The toolbar has buttons for the most common actions. Hover your mouse over each button for more information.\")\n            }, {\n                element: \"#modal_indicator\",\n                title: i18n.msg._(\"Mode Indicator\"),\n                placement: 'bottom',\n                content: i18n.msg._(\"The Notebook has two modes: Edit Mode and Command Mode. In this area, an indicator can appear to tell you which mode you are in.\"),\n                onShow: function(tour) { that.command_icon_hack(); }\n            }, {\n                element: \"#modal_indicator\",\n                title: i18n.msg._(\"Command Mode\"),\n                placement: 'bottom',\n                onShow: function(tour) { notebook.command_mode(); that.command_icon_hack(); },\n                onNext: function(tour) { that.edit_mode(); },\n                content: i18n.msg._(\"Right now you are in Command Mode, and many keyboard shortcuts are available. In this mode, no icon is displayed in the indicator area.\")\n            }, {\n                element: \"#modal_indicator\",\n                title: i18n.msg._(\"Edit Mode\"),\n                placement: 'bottom',\n                onShow: function(tour) { that.edit_mode(); },\n                content: i18n.msg._(\"Pressing <code>Enter</code> or clicking in the input text area of the cell switches to Edit Mode.\")\n            }, {\n                element: '.selected',\n                title: i18n.msg._(\"Edit Mode\"),\n                placement: 'bottom',\n                onShow: function(tour) { that.edit_mode(); },\n                content: i18n.msg._(\"Notice that the border around the currently active cell changed color. Typing will insert text into the currently active cell.\")\n            }, {\n                element: '.selected',\n                title: i18n.msg._(\"Back to Command Mode\"),\n                placement: 'bottom',\n                onShow: function(tour) { notebook.command_mode(); },\n                content: i18n.msg._(\"Pressing <code>Esc</code> or clicking outside of the input text area takes you back to Command Mode.\")\n            }, {\n                element: '#keyboard_shortcuts',\n                title: i18n.msg._(\"Keyboard Shortcuts\"),\n                placement: 'bottom',\n                onShow: function(tour) {\n                    /** need to add `open` and `pulse` classes in 2 calls */\n                    $('#help_menu').parent().addClass('open');\n                    $('#help_menu').parent().addClass('pulse');\n                    $('#keyboard_shortcuts').addClass('pulse');\n                  },\n                onHide: function(tour) { \n                    $('#help_menu').parent().removeClass('open pulse');\n                    $('#keyboard_shortcuts').removeClass('pulse');\n                  },\n                content: i18n.msg._(\"You can click here to get a list of all of the keyboard shortcuts.\")\n            }, {\n                element: \"#kernel_indicator_icon\",\n                title: i18n.msg._(\"Kernel Indicator\"),\n                placement: 'bottom',\n                onShow: function(tour) { events.trigger('kernel_idle.Kernel');},\n                content: i18n.msg._(\"This is the Kernel indicator. It looks like this when the Kernel is idle.\")\n            }, {\n                element: \"#kernel_indicator_icon\",\n                title: i18n.msg._(\"Kernel Indicator\"),\n                placement: 'bottom',\n                onShow: function(tour) { events.trigger('kernel_busy.Kernel'); },\n                content: i18n.msg._(\"The Kernel indicator looks like this when the Kernel is busy.\")\n            }, {\n                element: \".fa-stop\",\n                placement: 'bottom',\n                title: i18n.msg._(\"Interrupting the Kernel\"),\n                onHide: function(tour) { events.trigger('kernel_idle.Kernel'); },\n                content: i18n.msg._(\"To cancel a computation in progress, you can click here.\")\n            }, {\n                element: \"#notification_kernel\",\n                placement: 'bottom',\n                onShow: function(tour) { $('.fa-stop').click(); },\n                title: i18n.msg._(\"Notification Area\"),\n                content: i18n.msg._(\"Messages in response to user actions (Save, Interrupt, etc.) appear here.\")\n            }, {\n                title: i18n.msg._(\"End of Tour\"),\n                placement: 'bottom',\n                orphan: true,\n                content: i18n.msg._(\"This concludes the Jupyter Notebook User Interface Tour.\")\n            }\n        ];\n\n        this.tour = new Tour({\n            storage: false, // start tour from beginning every time\n            debug: true,\n            reflex: true, // click on element to continue tour\n            animation: false,\n            duration: this.step_duration,\n            onStart: function() { console.log('tour started'); },\n            // TODO: remove the onPause/onResume logic once pi's patch has been\n            // merged upstream to make this work via data-resume-class and \n            // data-resume-text attributes.\n            onPause: this.toggle_pause_play,\n            onResume: this.toggle_pause_play,\n            steps: this.tour_steps,\n            template: tour_style,\n            orphan: true\n        });\n        \n    };\n\n    NotebookTour.prototype.start = function () {\n        console.log(\"let's start the tour\");\n        this.tour.init();\n        this.tour.start();\n        if (this.tour.ended())\n        {\n            this.tour.restart();\n        }\n    };\n\n    NotebookTour.prototype.command_icon_hack =  function() {\n        $('#modal_indicator').css('min-height', '18px');\n    };\n    \n    NotebookTour.prototype.toggle_pause_play = function () { \n        $('#tour-pause').toggleClass('fa-pause fa-play'); \n    };\n    \n    NotebookTour.prototype.edit_mode = function() { \n        this.notebook.focus_cell(); \n        this.notebook.edit_mode();\n    };\n\n    return {'Tour': NotebookTour};\n\n});\n\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    ],\n    function($, utils) {\n    \"use strict\";\n    var ConfigSection = function(section_name, options) {\n        this.section_name = section_name;\n        this.base_url = options.base_url;\n        this.data = {};\n        \n        var that = this;\n        \n        /* .loaded is a promise, fulfilled the first time the config is loaded\n         * from the server. Code can do:\n         *      conf.loaded.then(function() { ... using conf.data ... });\n         */\n        this._one_load_finished = false;\n        this.loaded = new Promise(function(resolve, reject) {\n            that._finish_firstload = resolve;\n        });\n    };\n\n    ConfigSection.prototype.api_url = function() {\n        return utils.url_path_join(this.base_url, 'api/config',\n            utils.encode_uri_components(this.section_name));\n    };\n    \n    ConfigSection.prototype._load_done = function() {\n        if (!this._one_load_finished) {\n            this._one_load_finished = true;\n            this._finish_firstload();\n        }\n    };\n    \n    ConfigSection.prototype.load = async function() {\n        var that = this;\n        // [Basthon] disabling config load (except for RISE)\n        that.data = {};\n        if (this.api_url() === \"api/config/rise\")\n            that.data = {\"scroll\": true, \"enable_chalkboard\": true};\n        that._load_done();\n        return that.data;\n        return utils.promising_ajax(this.api_url(), {\n            cache: false,\n            type: \"GET\",\n            dataType: \"json\",\n            beforeSend: (xhr) => xhr.overrideMimeType(\"application/json\")\n        }).then(function(data) {\n            that.data = data;\n            that._load_done();\n            return data;\n        });\n    };\n    \n    /**\n     * Modify the config values stored. Update the local data immediately,\n     * send the change to the server, and use the updated data from the server\n     * when the reply comes.\n     */\n    ConfigSection.prototype.update = function(newdata) {\n        $.extend(true, this.data, newdata);  // true -> recursive update\n\n        /* [Basthon] */\n        // we disbale this patch request since it fails and is useless\n        return;\n        \n        var that = this;\n        return utils.promising_ajax(this.api_url(), {\n            processData: false,\n            type : \"PATCH\",\n            data: JSON.stringify(newdata),\n            dataType : \"json\",\n            contentType: 'application/json',\n        }).then(function(data) {\n            that.data = data;\n            that._load_done();\n            return data;\n        });\n    };\n    \n    \n    var ConfigWithDefaults = function(section, defaults, classname) {\n        this.section = section;\n        this.defaults = defaults;\n        this.classname = classname;\n    };\n    \n    ConfigWithDefaults.prototype._class_data = function() {\n        if (this.classname) {\n            return this.section.data[this.classname] || {};\n        } else {\n            return this.section.data;\n        }\n    };\n    \n    /**\n     * Wait for config to have loaded, then get a value or the default.\n     * Returns a promise.\n     */\n    ConfigWithDefaults.prototype.get = function(key) {\n        var that = this;\n        return this.section.loaded.then(function() {\n            return that.get_sync(key);\n        });\n    };\n    \n    /**\n     * Return a config value. If config is not yet loaded, return the default\n     * instead of waiting for it to load.\n     */\n    ConfigWithDefaults.prototype.get_sync = function(key) {\n        var data = this._class_data();\n        if (key === undefined) {\n            // no key specified, return full config data\n            return $.extend(true, {}, this.defaults, data);\n        }\n\n        var value = data[key];\n        if (value !== undefined) {\n            if (typeof value == 'object') {\n                // merge with defaults if it's an object\n                return $.extend(true, {}, this.defaults[key], value);\n            } else {\n                return value;\n            }\n        }\n        return this.defaults[key];\n    };\n    \n    /**\n     * Set a config value. Send the update to the server, and change our\n     * local copy of the data immediately.\n     * Returns a promise which is fulfilled when the server replies to the\n     * change.\n     */\n     ConfigWithDefaults.prototype.set = function(key, value) {\n         var d = {};\n         d[key] = value;\n         if (this.classname) {\n            var d2 = {};\n            d2[this.classname] = d;\n            return this.section.update(d2);\n        } else {\n            return this.section.update(d);\n        }\n    };\n    \n    return {ConfigSection: ConfigSection,\n            ConfigWithDefaults: ConfigWithDefaults,\n           };\n\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\"jquery\", \"base/js/utils\"], function ($, utils) {\n  \"use strict\";\n\n  var Contents = function (options) {\n    /**\n     * Constructor\n     *\n     * Preliminary documentation for the REST API is at\n     * https://github.com/ipython/ipython/wiki/IPEP-27%3A-Contents-Service\n     *\n     * A contents handles passing file operations\n     * to the back-end.  This includes checkpointing\n     * with the normal file operations.\n     *\n     * Parameters:\n     *  options: dictionary\n     *      Dictionary of keyword arguments.\n     *          base_url: string\n     */\n    this.base_url = options.base_url;\n  };\n\n  /** Error type */\n  Contents.DIRECTORY_NOT_EMPTY_ERROR = \"DirectoryNotEmptyError\";\n\n  Contents.DirectoryNotEmptyError = function () {\n    // Constructor\n    //\n    // An error representing the result of attempting to delete a non-empty\n    // directory.\n    this.message = \"A directory must be empty before being deleted.\";\n  };\n\n  Contents.DirectoryNotEmptyError.prototype = Object.create(Error.prototype);\n  Contents.DirectoryNotEmptyError.prototype.name =\n    Contents.DIRECTORY_NOT_EMPTY_ERROR;\n\n  Contents.prototype.api_url = function () {\n    var url_parts = [\n      this.base_url,\n      \"api/contents\",\n      utils.url_join_encode.apply(null, arguments),\n    ];\n    return utils.url_path_join.apply(null, url_parts);\n  };\n\n  /**\n   * Creates a basic error handler that wraps a jqXHR error as an Error.\n   *\n   * Takes a callback that accepts an Error, and returns a callback that can\n   * be passed directly to $.ajax, which will wrap the error from jQuery\n   * as an Error, and pass that to the original callback.\n   *\n   * @method create_basic_error_handler\n   * @param{Function} callback\n   * @return{Function}\n   */\n  Contents.prototype.create_basic_error_handler = function (callback) {\n    if (!callback) {\n      return utils.log_ajax_error;\n    }\n    return function (xhr, status, error) {\n      callback(utils.wrap_ajax_error(xhr, status, error));\n    };\n  };\n\n  /**\n   * File Functions (including notebook operations)\n   */\n\n  /**\n   * Get a file.\n   *\n   * @method get\n   * @param {String} path\n   * @param {Object} options\n   *    type : 'notebook', 'file', or 'directory'\n   *    format: 'text' or 'base64'; only relevant for type: 'file'\n   *    content: true or false; // whether to include the content\n   */\n  Contents.prototype.get = function (path, options) {\n    // [Basthon]\n    if (options.type === \"notebook\") return this.get_untitled(path, options);\n    /**\n     * We do the call with settings so we can set cache to false.\n     */\n    var settings = {\n      processData: false,\n      cache: false,\n      type: \"GET\",\n      dataType: \"json\",\n      beforeSend: (xhr) => xhr.overrideMimeType(\"application/json\"),\n    };\n    var url = this.api_url(path);\n    var params = {};\n    if (options.type) {\n      params.type = options.type;\n    }\n    if (options.format) {\n      params.format = options.format;\n    }\n    if (options.content === false) {\n      params.content = \"0\";\n    }\n    return utils.promising_ajax(url + \"?\" + $.param(params), settings);\n  };\n\n  /**\n   * Get untitled.\n   *\n   * @method get_untitled\n   * @param {String} path\n   * @param {Object} options\n   *    type : 'notebook'\n   *    format: 'text' or 'base64'; only relevant for type: 'file'\n   *    content: true or false; // whether to include the content\n   */\n  Contents.prototype.get_untitled = async function (path, options) {\n    const ks = window.Jupyter.kernelselector;\n    await ks.loaded;\n    const language = window.basthonLanguage;\n    const languageCodemirror =\n      {\n        python3: \"ipython\",\n        \"python3-old\": \"ipython\",\n        sql: \"text/x-sqlite\",\n        javascript: \"text/javascript\",\n        ocaml: \"text/x-ocaml\",\n      }[language] || language;\n    const spec = ks.kernelspecs[language].spec;\n\n    return {\n      cells: [\n        {\n          cell_type: \"code\",\n          execution_count: null,\n          metadata: {},\n          outputs: [],\n        },\n      ],\n      metadata: {\n        kernelspec: {\n          display_name: spec.display_name,\n          language: spec.language,\n          name: language,\n        },\n        language_info: {\n          codemirror_mode: {\n            name: languageCodemirror,\n            version: 3,\n          },\n          name: spec.language,\n          nbconvert_exporter: spec.language,\n        },\n      },\n      nbformat: 4,\n      nbformat_minor: 2,\n      name: \"Untitled.ipynb\",\n      path: \"Untitled.ipynb\",\n    };\n  };\n\n  /**\n   * Creates a new untitled file or directory in the specified directory path.\n   *\n   * @method new\n   * @param {String} path: the directory in which to create the new file/directory\n   * @param {Object} options:\n   *      ext: file extension to use\n   *      type: model type to create ('notebook', 'file', or 'directory')\n   */\n  Contents.prototype.new_untitled = function (path, options) {\n    return;\n    var data = JSON.stringify({\n      ext: options.ext,\n      type: options.type,\n    });\n\n    var settings = {\n      processData: false,\n      type: \"POST\",\n      data: data,\n      contentType: \"application/json\",\n      dataType: \"json\",\n    };\n    return utils.promising_ajax(this.api_url(path), settings);\n  };\n\n  Contents.prototype.delete = function (path) {\n    var settings = {\n      processData: false,\n      type: \"DELETE\",\n      dataType: \"json\",\n    };\n    var url = this.api_url(path);\n    return utils.promising_ajax(url, settings).catch(\n      // Translate certain errors to more specific ones.\n      function (error) {\n        // TODO: update IPEP27 to specify errors more precisely, so\n        // that error types can be detected here with certainty.\n        if (error.xhr.status === 400) {\n          throw new Contents.DirectoryNotEmptyError();\n        }\n        throw error;\n      }\n    );\n  };\n\n  Contents.prototype.rename = function (path, new_path) {\n    var data = { path: new_path };\n    var settings = {\n      processData: false,\n      type: \"PATCH\",\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\",\n    };\n    var url = this.api_url(path);\n    return utils.promising_ajax(url, settings);\n  };\n\n  Contents.prototype.trust = function (path) {\n    var settings = {\n      processData: false,\n      type: \"POST\",\n      contentType: \"application/json\",\n    };\n    var url = this.api_url(path, \"trust\");\n    return utils.promising_ajax(url, settings);\n  };\n\n  Contents.prototype.save = function (path, model) {\n    /**\n     * We do the call with settings so we can set cache to false.\n     */\n    var settings = {\n      processData: false,\n      type: \"PUT\",\n      dataType: \"json\",\n      data: JSON.stringify(model),\n      contentType: \"application/json\",\n    };\n    var url = this.api_url(path);\n    return utils.promising_ajax(url, settings);\n  };\n\n  Contents.prototype.copy = function (from_file, to_dir) {\n    /**\n     * Copy a file into a given directory via POST\n     * The server will select the name of the copied file\n     */\n    var url = this.api_url(to_dir);\n\n    var settings = {\n      processData: false,\n      type: \"POST\",\n      data: JSON.stringify({ copy_from: from_file }),\n      contentType: \"application/json\",\n      dataType: \"json\",\n    };\n    return utils.promising_ajax(url, settings);\n  };\n\n  /**\n   * Checkpointing Functions\n   */\n\n  Contents.prototype.create_checkpoint = function (path) {\n    var url = this.api_url(path, \"checkpoints\");\n    var settings = {\n      type: \"POST\",\n      contentType: false, // no data\n      dataType: \"json\",\n    };\n    return utils.promising_ajax(url, settings);\n  };\n\n  Contents.prototype.list_checkpoints = function (path) {\n    var url = this.api_url(path, \"checkpoints\");\n    var settings = {\n      type: \"GET\",\n      cache: false,\n      dataType: \"json\",\n      beforeSend: (xhr) => xhr.overrideMimeType(\"application/json\"),\n    };\n    return utils.promising_ajax(url, settings);\n  };\n\n  Contents.prototype.restore_checkpoint = function (path, checkpoint_id) {\n    var url = this.api_url(path, \"checkpoints\", checkpoint_id);\n    var settings = {\n      type: \"POST\",\n      contentType: false, // no data\n    };\n    return utils.promising_ajax(url, settings);\n  };\n\n  Contents.prototype.delete_checkpoint = function (path, checkpoint_id) {\n    var url = this.api_url(path, \"checkpoints\", checkpoint_id);\n    var settings = {\n      type: \"DELETE\",\n    };\n    return utils.promising_ajax(url, settings);\n  };\n\n  /**\n   * File management functions\n   */\n\n  /**\n   * List notebooks and directories at a given path\n   *\n   * On success, load_callback is called with an array of dictionaries\n   * representing individual files or directories.  Each dictionary has\n   * the keys:\n   *     type: \"notebook\" or \"directory\"\n   *     created: created date\n   *     last_modified: last modified dat\n   * @method list_notebooks\n   * @param {String} path The path to list notebooks in\n   */\n  Contents.prototype.list_contents = function (path) {\n    return this.get(path, { type: \"directory\" });\n  };\n\n  return { Contents: Contents };\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n], function($, utils) {\n    \"use strict\";\n\n    //-----------------------------------------------------------------------\n    // CommManager class\n    //-----------------------------------------------------------------------\n    \n    var CommManager = function (kernel) {\n        this.comms = {};\n        this.targets = {};\n        if (kernel !== undefined) {\n            this.init_kernel(kernel);\n        }\n    };\n    \n    CommManager.prototype.init_kernel = function (kernel) {\n        /**\n         * connect the kernel, and register message handlers\n         */\n        this.kernel = kernel;\n        var msg_types = ['comm_open', 'comm_msg', 'comm_close'];\n        for (var i = 0; i < msg_types.length; i++) {\n            var msg_type = msg_types[i];\n            kernel.register_iopub_handler(msg_type, $.proxy(this[msg_type], this));\n        }\n    };\n\n    CommManager.prototype.new_comm = function (target_name, data, callbacks, metadata, comm_id, buffers) {\n        /**\n         * Create a new Comm, register it, and open its Kernel-side counterpart\n         * Mimics the auto-registration in `Comm.__init__` in the Jupyter Comm.\n         *\n         * argument comm_id is optional\n         */\n        var comm = new Comm(target_name, comm_id);\n        this.register_comm(comm);\n        comm.open(data, callbacks, metadata, buffers);\n        return comm;\n    };\n    \n    CommManager.prototype.register_target = function (target_name, f) {\n        /**\n         * Register a target function for a given target name\n         */\n        this.targets[target_name] = f;\n    };\n    \n    CommManager.prototype.unregister_target = function (target_name, f) {\n        /**\n         * Unregister a target function for a given target name\n         */\n        delete this.targets[target_name];\n    };\n    \n    CommManager.prototype.register_comm = function (comm) {\n        /**\n         * Register a comm in the mapping\n         */\n        this.comms[comm.comm_id] = Promise.resolve(comm);\n        comm.kernel = this.kernel;\n        return comm.comm_id;\n    };\n    \n    CommManager.prototype.unregister_comm = function (comm) {\n        /**\n         * Remove a comm from the mapping\n         */\n        delete this.comms[comm.comm_id];\n    };\n    \n    // comm message handlers\n    \n    CommManager.prototype.comm_open = function (msg) {\n        var content = msg.content;\n        var that = this;\n        var comm_id = content.comm_id;\n\n        this.comms[comm_id] = utils.load_class(content.target_name, content.target_module, \n            this.targets).then(function(target) {\n                var comm = new Comm(content.target_name, comm_id);\n                comm.kernel = that.kernel;\n                try {\n                    var response = target(comm, msg);\n                } catch (e) {\n                    comm.close();\n                    that.unregister_comm(comm);\n                    var wrapped_error = new utils.WrappedError(\"Exception opening new comm\", e);\n                    console.error(wrapped_error);\n                    return Promise.reject(wrapped_error);\n                }\n                // Regardless of the target return value, we need to\n                // then return the comm\n                return Promise.resolve(response).then(function() {return comm;});\n            }, utils.reject('Could not open comm', true));\n        return this.comms[comm_id];\n    };\n    \n    CommManager.prototype.comm_close = function(msg) {\n        var content = msg.content;\n        if (this.comms[content.comm_id] === undefined) {\n            console.error('Comm promise not found for comm id ' + content.comm_id);\n            return;\n        }\n        var that = this;\n        this.comms[content.comm_id] = this.comms[content.comm_id].then(function(comm) {\n            that.unregister_comm(comm);\n            try {\n                comm.handle_close(msg);\n            } catch (e) {\n                console.log(\"Exception closing comm: \", e, e.stack, msg);\n            }\n            // don't return a comm, so that further .then() functions\n            // get an undefined comm input\n        });\n        return this.comms[content.comm_id];\n    };\n    \n    CommManager.prototype.comm_msg = function(msg) {\n        var content = msg.content;\n        if (this.comms[content.comm_id] === undefined) {\n            console.error('Comm promise not found for comm id ' + content.comm_id);\n            return;\n        }\n\n        this.comms[content.comm_id] = this.comms[content.comm_id].then(function(comm) {\n            return (Promise.resolve(comm.handle_msg(msg))\n                .catch(utils.reject('Exception handling comm message'))\n                .then(function() {return comm;}));\n        });\n        return this.comms[content.comm_id];\n    };\n    \n    //-----------------------------------------------------------------------\n    // Comm base class\n    //-----------------------------------------------------------------------\n    \n    var Comm = function (target_name, comm_id) {\n        this.target_name = target_name;\n        this.comm_id = comm_id || utils.uuid();\n        this._msg_callback = this._close_callback = null;\n    };\n    \n    // methods for sending messages\n    Comm.prototype.open = function (data, callbacks, metadata, buffers) {\n        var content = {\n            comm_id : this.comm_id,\n            target_name : this.target_name,\n            data : data || {},\n        };\n        return this.kernel.send_shell_message(\"comm_open\", content, callbacks, metadata, buffers);\n    };\n    \n    Comm.prototype.send = function (data, callbacks, metadata, buffers) {\n        var content = {\n            comm_id : this.comm_id,\n            data : data || {},\n        };\n        return this.kernel.send_shell_message(\"comm_msg\", content, callbacks, metadata, buffers);\n    };\n\n    Comm.prototype.close = function (data, callbacks, metadata, buffers) {\n        var content = {\n            comm_id : this.comm_id,\n            data : data || {},\n        };\n        return this.kernel.send_shell_message(\"comm_close\", content, callbacks, metadata, buffers);\n    };\n    \n    // methods for registering callbacks for incoming messages\n    Comm.prototype._register_callback = function (key, callback) {\n        this['_' + key + '_callback'] = callback;\n    };\n    \n    Comm.prototype.on_msg = function (callback) {\n        this._register_callback('msg', callback);\n    };\n    \n    Comm.prototype.on_close = function (callback) {\n        this._register_callback('close', callback);\n    };\n    \n    // methods for handling incoming messages\n    \n    Comm.prototype._callback = function (key, msg) {\n        var callback = this['_' + key + '_callback'];\n        if (callback) {\n            try {\n                return callback(msg);\n            } catch (e) {\n                console.log(\"Exception in Comm callback\", e, e.stack, msg);\n            }\n        }\n    };\n    \n    Comm.prototype.handle_msg = function (msg) {\n        return this._callback('msg', msg);\n    };\n    \n    Comm.prototype.handle_close = function (msg) {\n        this._callback('close', msg);\n    };\n    \n    return {\n        'CommManager': CommManager,\n        'Comm': Comm\n    };\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    './comm',\n    './serialize',\n    'base/js/events',\n    'basthonwebsocket'\n], function($, utils, comm, serialize, events, bws) {\n    \"use strict\";\n\n    /**\n     * A Kernel class to communicate with the Python kernel. This\n     * should generally not be constructed directly, but be created\n     * by.  the `Session` object. Once created, this object should be\n     * used to communicate with the kernel.\n     * \n     * Preliminary documentation for the REST API is at\n     * https://github.com/ipython/ipython/wiki/IPEP-16%3A-Notebook-multi-directory-dashboard-and-URL-mapping#kernels-api\n     * \n     * Documentation for the messaging specifications is at\n     * https://jupyter-client.readthedocs.io/en/stable/messaging.html\n     *\n     * @class Kernel\n     * @param {string} kernel_service_url - the URL to access the kernel REST api\n     * @param {string} ws_url - the websockets URL\n     * @param {string} name - the kernel type (e.g. python3)\n     */\n    var Kernel = function (kernel_service_url, ws_url, name, basthonKernelAvailable) {\n        this.events = events;\n        this.basthonKernelAvailable = basthonKernelAvailable;\n\n        this.id = null;\n        this.name = name;\n        this.ws = null;\n        this._stopping = false;\n\n        this.kernel_service_url = kernel_service_url;\n        this.kernel_url = null;\n        this.ws_url = ws_url || utils.get_body_data(\"wsUrl\");\n        if (!this.ws_url) {\n            // trailing 's' in https will become wss for secure web sockets\n            this.ws_url = location.protocol.replace('http', 'ws') + \"//\" + location.host;\n        }\n\n        this.username = \"username\";\n        this.session_id = utils.uuid();\n        this._msg_callbacks = {};\n        this._msg_callbacks_overrides = {};\n        this._display_id_to_parent_ids = {};\n        this._msg_queue = Promise.resolve();\n        this.info_reply = {}; // kernel_info_reply stored here after starting\n\n        if (typeof(WebSocket) !== 'undefined') {\n            this.WebSocket = WebSocket;\n        } else if (typeof(MozWebSocket) !== 'undefined') {\n            this.WebSocket = MozWebSocket;\n        } else {\n            alert('Your browser does not have WebSocket support, please try Chrome, Safari or Firefox ≥ 6. Firefox 4 and 5 are also supported by you have to enable WebSockets in about:config.');\n        }\n\n        this.WebSocket = bws.BasthonWebSocket;\n        \n        this.bind_events();\n        this.init_iopub_handlers();\n        this.comm_manager = new comm.CommManager(this);\n        \n        this.last_msg_id = null;\n        this.last_msg_callbacks = {};\n\n        this._autorestart_attempt = 0;\n        this._reconnect_attempt = 0;\n        this.reconnect_limit = 7;\n        \n        this._pending_messages = [];\n    };\n\n    /**\n     * @function _get_msg\n     */\n    Kernel.prototype._get_msg = function (msg_type, content, metadata, buffers) {\n        var msg = {\n            header : {\n                msg_id : utils.uuid(),\n                username : this.username,\n                session : this.session_id,\n                msg_type : msg_type,\n                version : \"5.2\",\n            },\n            metadata : metadata || {},\n            content : content,\n            buffers : buffers || [],\n            parent_header : {}\n        };\n        return msg;\n    };\n\n    /**\n     * @function bind_events\n     */\n    Kernel.prototype.bind_events = function () {\n        var that = this;\n        this.events.on('send_input_reply.Kernel', function(evt, data) { \n            that.send_input_reply(data);\n        });\n\n        var record_status = function (evt, info) {\n            console.log('Kernel: ' + evt.type + ' (' + info.kernel.id + ')');\n        };\n\n        this.events.on('kernel_created.Kernel', record_status);\n        this.events.on('kernel_reconnecting.Kernel', record_status);\n        this.events.on('kernel_connected.Kernel', record_status);\n        this.events.on('kernel_starting.Kernel', record_status);\n        this.events.on('kernel_restarting.Kernel', record_status);\n        this.events.on('kernel_autorestarting.Kernel', record_status);\n        this.events.on('kernel_interrupting.Kernel', record_status);\n        this.events.on('kernel_disconnected.Kernel', record_status);\n        // these are commented out because they are triggered a lot, but can\n        // be uncommented for debugging purposes\n        //this.events.on('kernel_idle.Kernel', record_status);\n        //this.events.on('kernel_busy.Kernel', record_status);\n        this.events.on('kernel_ready.Kernel', record_status);\n        this.events.on('kernel_killed.Kernel', record_status);\n        this.events.on('kernel_dead.Kernel', record_status);\n\n        this.events.on('kernel_ready.Kernel', function () {\n            that._autorestart_attempt = 0;\n        });\n        this.events.on('kernel_connected.Kernel', function () {\n            that._reconnect_attempt = 0;\n        });\n    };\n\n    /**\n     * Initialize the iopub handlers.\n     *\n     * @function init_iopub_handlers\n     */\n    Kernel.prototype.init_iopub_handlers = function () {\n        var output_msg_types = ['stream', 'display_data', 'execute_result', 'error', 'update_display_data'];\n        this._iopub_handlers = {};\n        this.register_iopub_handler('status', $.proxy(this._handle_status_message, this));\n        this.register_iopub_handler('clear_output', $.proxy(this._handle_clear_output, this));\n        this.register_iopub_handler('execute_input', $.proxy(this._handle_input_message, this));\n        \n        for (var i=0; i < output_msg_types.length; i++) {\n            this.register_iopub_handler(output_msg_types[i], $.proxy(this._handle_output_message, this));\n        }\n    };\n\n    /**\n     * GET /api/kernels\n     *\n     * Get the list of running kernels.\n     *\n     * @function list\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Kernel.prototype.list = function (success, error) {\n        utils.ajax(this.kernel_service_url, {\n            processData: false,\n            cache: false,\n            type: \"GET\",\n            dataType: \"json\",\n            success: success,\n            error: this._on_error(error)\n        });\n    };\n\n    /**\n     * POST /api/kernels\n     *\n     * Start a new kernel.\n     *\n     * In general this shouldn't be used -- the kernel should be\n     * started through the session API. If you use this function and\n     * are also using the session API then your session and kernel\n     * WILL be out of sync!\n     *\n     * @function start\n     * @param {params} [Object] - parameters to include in the query string\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Kernel.prototype.start = function (params, success, error) {\n        var url = this.kernel_service_url;\n        var qs = $.param(params || {}); // query string for sage math stuff\n        if (qs !== \"\") {\n            url = url + \"?\" + qs;\n        }\n\n        this.events.trigger('kernel_starting.Kernel', {kernel: this});\n        var that = this;\n        var on_success = function (data, status, xhr) {\n            that.events.trigger('kernel_created.Kernel', {kernel: that});\n            that._kernel_created(data);\n            if (success) {\n                success(data, status, xhr);\n            }\n        };\n\n        utils.ajax(url, {\n            processData: false,\n            cache: false,\n            type: \"POST\",\n            data: JSON.stringify({name: this.name}),\n            contentType: 'application/json',\n            dataType: \"json\",\n            success: this._on_success(on_success),\n            error: this._on_error(error)\n        });\n\n        return url;\n    };\n\n    /**\n     * GET /api/kernels/[:kernel_id]\n     *\n     * Get information about the kernel.\n     *\n     * @function get_info\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Kernel.prototype.get_info = function (success, error) {\n        utils.ajax(this.kernel_url, {\n            processData: false,\n            cache: false,\n            type: \"GET\",\n            dataType: \"json\",\n            success: this._on_success(success),\n            error: this._on_error(error)\n        });\n    };\n\n    /**\n     * DELETE /api/kernels/[:kernel_id]\n     *\n     * Shutdown the kernel.\n     *\n     * If you are also using sessions, then this function should NOT be\n     * used. Instead, use Session.delete. Otherwise, the session and\n     * kernel WILL be out of sync.\n     *\n     * @function kill\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Kernel.prototype.kill = function (success, error) {\n        this.events.trigger('kernel_killed.Kernel', {kernel: this});\n        this._kernel_dead();\n        utils.ajax(this.kernel_url, {\n            processData: false,\n            cache: false,\n            type: \"DELETE\",\n            dataType: \"json\",\n            success: this._on_success(success),\n            error: this._on_error(error)\n        });\n    };\n\n    /**\n     * POST /api/kernels/[:kernel_id]/interrupt\n     *\n     * Interrupt the kernel.\n     *\n     * @function interrupt\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Kernel.prototype.interrupt = function (success, error) {\n        this.events.trigger('kernel_interrupting.Kernel', {kernel: this});\n\n        var that = this;\n        var on_success = function (data, status, xhr) {\n            /**\n             * get kernel info so we know what state the kernel is in\n             */\n            that.kernel_info();\n            if (success) {\n                success(data, status, xhr);\n            }\n        };\n\n        var url = utils.url_path_join(this.kernel_url, 'interrupt');\n        utils.ajax(url, {\n            processData: false,\n            cache: false,\n            type: \"POST\",\n            contentType: false,  // there's no data with this\n            dataType: \"json\",\n            success: this._on_success(on_success),\n            error: this._on_error(error)\n        });\n    };\n\n    Kernel.prototype.restart = function (success, error) {\n        /**\n         * POST /api/kernels/[:kernel_id]/restart\n         *\n         * Restart the kernel.\n         *\n         * @function interrupt\n         * @param {function} [success] - function executed on ajax success\n         * @param {function} [error] - function executed on ajax error\n         */\n        this.events.trigger('kernel_restarting.Kernel', {kernel: this});\n        this.stop_channels();\n        this._msg_callbacks = {};\n        this._msg_callbacks_overrides = {};\n        this._display_id_to_parent_ids = {};\n\n        var that = this;\n        var on_success = function (data, status, xhr) {\n            that.events.trigger('kernel_created.Kernel', {kernel: that});\n            that._kernel_created(data);\n            if (success) {\n                success(data, status, xhr);\n            }\n        };\n\n        var on_error = function (xhr, status, err) {\n            that.events.trigger('kernel_failed_restart.Kernel', {kernel: that});\n            that._kernel_dead();\n            if (error) {\n                error(xhr, status, err);\n            }\n        };\n\n        var url = utils.url_path_join(this.kernel_url, 'restart');\n        utils.ajax(url, {\n            processData: false,\n            cache: false,\n            type: \"POST\",\n            contentType: false,  // there's no data with this\n            dataType: \"json\",\n            success: this._on_success(on_success),\n            error: this._on_error(on_error)\n        });\n    };\n\n    Kernel.prototype.reconnect = function () {\n        /**\n         * Reconnect to a disconnected kernel. This is not actually a\n         * standard HTTP request, but useful function nonetheless for\n         * reconnecting to the kernel if the connection is somehow lost.\n         *\n         * @function reconnect\n         */\n        if (this.is_connected()) {\n            this.stop_channels();\n        }\n        this._reconnect_attempt = this._reconnect_attempt + 1;\n        this.events.trigger('kernel_reconnecting.Kernel', {\n            kernel: this,\n            attempt: this._reconnect_attempt,\n        });\n        this.start_channels();\n    };\n\n    Kernel.prototype._on_success = function (success) {\n        /**\n         * Handle a successful AJAX request by updating the kernel id and\n         * name from the response, and then optionally calling a provided\n         * callback.\n         *\n         * @function _on_success\n         * @param {function} success - callback\n         */\n        var that = this;\n        return function (data, status, xhr) {\n            if (data) {\n                that.id = data.id;\n                that.name = data.name;\n            }\n            that.kernel_url = utils.url_path_join(that.kernel_service_url,\n                encodeURIComponent(that.id));\n            if (success) {\n                success(data, status, xhr);\n            }\n        };\n    };\n\n    Kernel.prototype._on_error = function (error) {\n        /**\n         * Handle a failed AJAX request by logging the error message, and\n         * then optionally calling a provided callback.\n         *\n         * @function _on_error\n         * @param {function} error - callback\n         */\n        return function (xhr, status, err) {\n            utils.log_ajax_error(xhr, status, err);\n            if (error) {\n                error(xhr, status, err);\n            }\n        };\n    };\n\n    Kernel.prototype._kernel_created = function (data) {\n        /**\n         * Perform necessary tasks once the kernel has been started,\n         * including actually connecting to the kernel.\n         *\n         * @function _kernel_created\n         * @param {Object} data - information about the kernel including id\n         */\n        this.id = data.id;\n        this.kernel_url = utils.url_path_join(this.kernel_service_url,\n            encodeURIComponent(this.id));\n        this.start_channels();\n    };\n\n    Kernel.prototype._kernel_connected = function () {\n        /**\n         * Perform necessary tasks once the connection to the kernel has\n         * been established. This includes requesting information about\n         * the kernel.\n         *\n         * @function _kernel_connected\n         */\n        this.events.trigger('kernel_connected.Kernel', {kernel: this});\n\n        // Send pending messages. We shift the message off the queue\n        // after the message is sent so that if there is an exception,\n        // the message is still pending.\n        while (this._pending_messages.length > 0) {\n          this.ws.send(this._pending_messages[0]);\n          this._pending_messages.shift();\n        }\n\n        // get kernel info so we know what state the kernel is in\n        var that = this;\n        this.kernel_info(function (reply) {\n            that.info_reply = reply.content;\n            that.events.trigger('kernel_ready.Kernel', {kernel: that});\n        });\n    };\n\n    Kernel.prototype._kernel_dead = function () {\n        /**\n         * Perform necessary tasks after the kernel has died. This closing\n         * communication channels to the kernel if they are still somehow\n         * open.\n         *\n         * @function _kernel_dead\n         */\n        this.stop_channels();\n    };\n\n    Kernel.prototype.start_channels = function () {\n        /**\n         * Start the websocket channels.\n         * Will stop and restart them if they already exist.\n         *\n         * @function start_channels\n         */\n        var that = this;\n        this.stop_channels();\n        var ws_host_url = this.ws_url + this.kernel_url;\n\n        console.log(\"Starting WebSockets:\", ws_host_url);\n\n        this.ws = new this.WebSocket([\n            that.ws_url,\n            utils.url_path_join(that.kernel_url, 'channels'),\n            \"?session_id=\" + that.session_id\n        ].join(''), this.basthonKernelAvailable);\n        \n        var already_called_onclose = false; // only alert once\n        var ws_closed_early = function(evt){\n            console.log(\"WebSocket closed early\", evt);\n            if (already_called_onclose){\n                return;\n            }\n            already_called_onclose = true;\n            // If the websocket was closed early, that could mean\n            // that the kernel is actually dead. Try getting\n            // information about the kernel from the API call --\n            // if that fails, then assume the kernel is dead,\n            // otherwise just follow the typical websocket closed\n            // protocol.\n            that.get_info(function () {\n                that._ws_closed(ws_host_url, false);\n            }, function () {\n                that.events.trigger('kernel_dead.Kernel', {kernel: that});\n                that._kernel_dead();\n            });\n        };\n        var ws_closed_late = function(evt){\n            console.log(\"WebSocket closed unexpectedly\", evt);\n            if (already_called_onclose){\n                return;\n            }\n            already_called_onclose = true;\n            that._ws_closed(ws_host_url, false);\n        };\n        var ws_error = function(evt){\n            if (already_called_onclose){\n                return;\n            }\n            already_called_onclose = true;\n            that._ws_closed(ws_host_url, true);\n        };\n\n        this.ws.onopen = $.proxy(this._ws_opened, this);\n        this.ws.onclose = ws_closed_early;\n        this.ws.onerror = ws_error;\n        // switch from early-close to late-close message after 1s\n        setTimeout(function() {\n            if (that.ws !== null && !that._stopping) {\n                that.ws.onclose = ws_closed_late;\n            }\n        }, 1000);\n        this.ws.onmessage = $.proxy(this._handle_ws_message, this);\n    };\n\n    Kernel.prototype._ws_opened = function (evt) {\n        /**\n         * Handle a websocket entering the open state,\n         * signaling that the kernel is connected when websocket is open.\n         *\n         * @function _ws_opened\n         */\n        if (this.is_connected()) {\n            // all events ready, trigger started event.\n            this._kernel_connected();\n        }\n    };\n\n    Kernel.prototype._ws_closed = function(ws_url, error) {\n        /**\n         * Handle a websocket entering the closed state.  If the websocket\n         * was not closed due to an error, try to reconnect to the kernel.\n         *\n         * @function _ws_closed\n         * @param {string} ws_url - the websocket url\n         * @param {bool} error - whether the connection was closed due to an error\n         */\n        this.stop_channels();\n\n        this.events.trigger('kernel_disconnected.Kernel', {kernel: this});\n        if (error) {\n            console.log('WebSocket connection failed: ', ws_url, error);\n            this.events.trigger('kernel_connection_failed.Kernel', {\n                kernel: this,\n                ws_url: ws_url,\n                attempt: this._reconnect_attempt,\n                error: error,\n            });\n        }\n        this._schedule_reconnect();\n    };\n    \n    Kernel.prototype._schedule_reconnect = function () {\n        /**\n         * function to call when kernel connection is lost\n         * schedules reconnect, or fires 'connection_dead' if reconnect limit is hit\n         */\n        if (this._reconnect_attempt < this.reconnect_limit) {\n            var timeout = Math.pow(2, this._reconnect_attempt);\n            console.log(\"Connection lost, reconnecting in \" + timeout + \" seconds.\");\n            setTimeout($.proxy(this.reconnect, this), 1e3 * timeout);\n        } else {\n            this.events.trigger('kernel_connection_dead.Kernel', {\n                kernel: this,\n                reconnect_attempt: this._reconnect_attempt,\n            });\n            console.log(\"Failed to reconnect, giving up.\");\n        }\n    };\n    \n    Kernel.prototype.stop_channels = function () {\n        /**\n         * Close the websocket. After successful close, the value\n         * in `this.ws` will be null.\n         *\n         * @function stop_channels\n         */\n        var that = this;\n        var close = function () {\n            that._stopping = false;\n            if (that.ws && that.ws.readyState === WebSocket.CLOSED) {\n                that.ws = null;\n            }\n        };\n        if (this.ws !== null) {\n            // flag to avoid races with on_close_late\n            this._stopping = true;\n            if (this.ws.readyState === WebSocket.OPEN) {\n                this.ws.onclose = close;\n                this.ws.close();\n            } else {\n                close();\n            }\n        }\n    };\n\n    Kernel.prototype.is_connected = function () {\n        /**\n         * Check whether there is a connection to the kernel. This\n         * function only returns true if websocket has been\n         * created and has a state of WebSocket.OPEN.\n         *\n         * @function is_connected\n         * @returns {bool} - whether there is a connection\n         */\n        // if any channel is not ready, then we're not connected\n        if (this.ws === null) {\n            return false;\n        }\n        if (this.ws.readyState !== WebSocket.OPEN) {\n            return false;\n        }\n        return true;\n    };\n\n    Kernel.prototype.is_fully_disconnected = function () {\n        /**\n         * Check whether the connection to the kernel has been completely\n         * severed. This function only returns true if all channel objects\n         * are null.\n         *\n         * @function is_fully_disconnected\n         * @returns {bool} - whether the kernel is fully disconnected\n         */\n        return (this.ws === null);\n    };\n    \n    Kernel.prototype._send = function(msg) {\n      /**\n       * Send a message (if the kernel is connected) or queue the message for future delivery\n       *\n       * Pending messages will automatically be sent when a kernel becomes connected.\n       *\n       * @function _send\n       * @param msg\n       */\n      if (this.is_connected()) {\n            this.ws.send(msg);\n        } else {\n            this._pending_messages.push(msg);\n        }\n    };\n    \n    Kernel.prototype.send_shell_message = function (msg_type, content, callbacks, metadata, buffers) {\n        /**\n         * Send a message on the Kernel's shell channel\n         *\n         * If the kernel is not connected, the message will be buffered.\n         * \n         * @function send_shell_message\n         */\n        var msg = this._get_msg(msg_type, content, metadata, buffers);\n        msg.channel = 'shell';\n        this.set_callbacks_for_msg(msg.header.msg_id, callbacks);\n        this._send(serialize.serialize(msg));\n        return msg.header.msg_id;\n    };\n\n    Kernel.prototype.kernel_info = function (callback) {\n        /**\n         * Get kernel info\n         *\n         * @function kernel_info\n         * @param callback {function}\n         *\n         * When calling this method, pass a callback function that expects one argument.\n         * The callback will be passed the complete `kernel_info_reply` message documented\n         * [here](https://jupyter-client.readthedocs.io/en/latest/messaging.html#kernel-info)\n         */\n        var callbacks;\n        if (callback) {\n            callbacks = { shell : { reply : callback } };\n        }\n        return this.send_shell_message(\"kernel_info_request\", {}, callbacks);\n    };\n\n    Kernel.prototype.comm_info = function (target_name, callback) {\n        /**\n         * Get comm info\n         *\n         * @function comm_info\n         * @param callback {function}\n         *\n         * When calling this method, pass a callback function that expects one argument.\n         * The callback will be passed the complete `comm_info_reply` message documented\n         * [here](https://jupyter-client.readthedocs.io/en/latest/messaging.html#comm_info)\n         */\n        var callbacks;\n        if (callback) {\n            callbacks = { shell : { reply : callback } };\n        }\n        var content = {\n            target_name : target_name,\n        };\n        return this.send_shell_message(\"comm_info_request\", content, callbacks);\n    };\n\n    Kernel.prototype.inspect = function (code, cursor_pos, callback) {\n        /**\n         * Get info on an object\n         *\n         * When calling this method, pass a callback function that expects one argument.\n         * The callback will be passed the complete `inspect_reply` message documented\n         * [here](https://jupyter-client.readthedocs.io/en/latest/messaging.html#object-information)\n         *\n         * @function inspect\n         * @param code {string}\n         * @param cursor_pos {integer}\n         * @param callback {function}\n         */\n        var callbacks;\n        if (callback) {\n            callbacks = { shell : { reply : callback } };\n        }\n        \n        var content = {\n            code : code,\n            cursor_pos : cursor_pos,\n            detail_level : 0\n        };\n        return this.send_shell_message(\"inspect_request\", content, callbacks);\n    };\n\n    Kernel.prototype.execute = function (code, callbacks, options) {\n        /**\n         * Execute given code into kernel, and pass result to callback.\n         *\n         * @async\n         * @function execute\n         * @param {string} code\n         * @param [callbacks] {Object} With the following keys (all optional)\n         *      @param callbacks.shell.reply {function}\n         *      @param callbacks.shell.payload.[payload_name] {function}\n         *      @param callbacks.iopub.output {function}\n         *      @param callbacks.iopub.clear_output {function}\n         *      @param callbacks.input {function}\n         *      @param callbacks.clear_on_done=true {Boolean}\n         * @param {object} [options]\n         *      @param [options.silent=false] {Boolean}\n         *      @param [options.user_expressions=empty_dict] {Dict}\n         *      @param [options.allow_stdin=false] {Boolean} true|false\n         *\n         * @example\n         *\n         * The options object should contain the options for the execute\n         * call. Its default values are:\n         *\n         *      options = {\n         *        silent : true,\n         *        user_expressions : {},\n         *        allow_stdin : false\n         *      }\n         *\n         * When calling this method pass a callbacks structure of the\n         * form:\n         *\n         *      callbacks = {\n         *       shell : {\n         *         reply : execute_reply_callback,\n         *         payload : {\n         *           set_next_input : set_next_input_callback,\n         *         }\n         *       },\n         *       iopub : {\n         *         output : output_callback,\n         *         clear_output : clear_output_callback,\n         *       },\n         *       input : raw_input_callback\n         *      }\n         *\n         * Each callback will be passed the entire message as a single\n         * argument.  Payload handlers will be passed the corresponding\n         * payload and the execute_reply message.\n         */\n        var content = {\n            code : code,\n            silent : true,\n            store_history : false,\n            user_expressions : {},\n            allow_stdin : false\n        };\n        callbacks = callbacks || {};\n        if (callbacks.input !== undefined) {\n            content.allow_stdin = true;\n        }\n        $.extend(true, content, options);\n        this.events.trigger('execution_request.Kernel', {kernel: this, content: content});\n        return this.send_shell_message(\"execute_request\", content, callbacks);\n    };\n\n    /**\n     * When calling this method, pass a function to be called with the\n     * `complete_reply` message as its only argument when it arrives.\n     *\n     * `complete_reply` is documented\n     * [here](https://jupyter-client.readthedocs.io/en/latest/messaging.html#complete)\n     *\n     * @function complete\n     * @param code {string}\n     * @param cursor_pos {integer}\n     * @param callback {function}\n     */\n    Kernel.prototype.complete = function (code, cursor_pos, callback) {\n        var callbacks;\n        if (callback) {\n            callbacks = { shell : { reply : callback } };\n        }\n        var content = {\n            code : code,\n            cursor_pos : cursor_pos\n        };\n        return this.send_shell_message(\"complete_request\", content, callbacks);\n    };\n\n    /**\n     * @function send_input_reply\n     */\n    Kernel.prototype.send_input_reply = function (input) {\n        var content = {\n            value : input\n        };\n        this.events.trigger('input_reply.Kernel', {kernel: this, content: content});\n        var msg = this._get_msg(\"input_reply\", content);\n        msg.channel = 'stdin';\n        this._send(serialize.serialize(msg));\n        return msg.header.msg_id;\n    };\n\n    /**\n     * @function register_iopub_handler\n     */\n    Kernel.prototype.register_iopub_handler = function (msg_type, callback) {\n        this._iopub_handlers[msg_type] = callback;\n    };\n\n    /**\n     * Get the iopub handler for a specific message type.\n     *\n     * @function get_iopub_handler\n     */\n    Kernel.prototype.get_iopub_handler = function (msg_type) {\n        return this._iopub_handlers[msg_type];\n    };\n\n    /**\n     * Get callbacks for a specific message.\n     *\n     * @function get_callbacks_for_msg\n     */\n    Kernel.prototype.get_callbacks_for_msg = function (msg_id) {\n        if (msg_id == this.last_msg_id) {\n            return this.last_msg_callbacks;\n        } else {\n            return this._msg_callbacks[msg_id];\n        }\n    };\n\n    /**\n     * Get output callbacks for a specific message.\n     *\n     * @function get_output_callbacks_for_msg\n     *\n     * Since output callbacks can be overridden, we first check the override stack.\n     */\n    Kernel.prototype.get_output_callbacks_for_msg = function (msg_id) {\n        return this.get_callbacks_for_msg(this.get_output_callback_id(msg_id));\n    };\n\n\n    /**\n     * Get the output callback id for a message\n     *\n     * Since output callbacks can be redirected, this may not be the same as\n     * the msg_id.\n     *\n     * @function get_output_callback_id\n     */\n    Kernel.prototype.get_output_callback_id = function (msg_id) {\n        var callback_id = msg_id;\n        var overrides = this._msg_callbacks_overrides[msg_id];\n        if (overrides && overrides.length > 0) {\n            callback_id = overrides[overrides.length-1];\n        }\n        return callback_id\n    }\n\n    /**\n     * Clear callbacks for a specific message.\n     *\n     * @function clear_callbacks_for_msg\n     */\n    Kernel.prototype.clear_callbacks_for_msg = function (msg_id) {\n        if (this._msg_callbacks[msg_id] !== undefined ) {\n            var callbacks = this._msg_callbacks[msg_id];\n            var kernel = this;\n            // clear display_id:msg_id map for display_ids associated with this msg_id\n            if (!callbacks) return;\n            callbacks.display_ids.map(function (display_id) {\n                var msg_ids = kernel._display_id_to_parent_ids[display_id];\n                if (msg_ids) {\n                    var idx = msg_ids.indexOf(msg_id);\n                    if (idx === -1) {\n                        return;\n                    }\n                    if (msg_ids.length === 1) {\n                        delete kernel._display_id_to_parent_ids[display_id];\n                    } else {\n                        msg_ids.splice(idx, 1);\n                        kernel._display_id_to_parent_ids[display_id] = msg_ids;\n                    }\n                }\n            });\n            delete this._msg_callbacks[msg_id];\n        }\n    };\n    \n    /**\n     * @function _finish_shell\n     */\n    Kernel.prototype._finish_shell = function (msg_id) {\n        var callbacks = this._msg_callbacks[msg_id];\n        if (callbacks !== undefined) {\n            callbacks.shell_done = true;\n            if (callbacks.clear_on_done && callbacks.iopub_done) {\n                this.clear_callbacks_for_msg(msg_id);\n            }\n        }\n    };\n\n    /**\n     * @function _finish_iopub\n     */\n    Kernel.prototype._finish_iopub = function (msg_id) {\n        var callbacks = this._msg_callbacks[msg_id];\n        if (callbacks !== undefined) {\n            callbacks.iopub_done = true;\n            if (callbacks.clear_on_done && callbacks.shell_done) {\n                this.clear_callbacks_for_msg(msg_id);\n            }\n        }\n        this.events.trigger('finished_iopub.Kernel', {kernel: this, msg_id: msg_id});\n    };\n    \n    /**\n     * Set callbacks for a particular message.\n     * Callbacks should be a struct of the following form:\n     * shell : {\n     * \n     * }\n     *\n     * If the third parameter is truthy, the callback is set as the last\n     * callback registered.\n     *\n     * @function set_callbacks_for_msg\n     */\n    Kernel.prototype.set_callbacks_for_msg = function (msg_id, callbacks, save) {\n        var remember = save || true;\n        if (remember) {\n            this.last_msg_id = msg_id;\n        }\n        if (callbacks) {\n            // shallow-copy mapping, because we will modify it at the top level\n            var cbcopy = this._msg_callbacks[msg_id] = this.last_msg_callbacks = {};\n            cbcopy.shell = callbacks.shell;\n            cbcopy.iopub = callbacks.iopub;\n            cbcopy.input = callbacks.input;\n            cbcopy.clear_on_done = callbacks.clear_on_done;\n            cbcopy.shell_done = (!callbacks.shell);\n            cbcopy.iopub_done = (!callbacks.iopub);\n            cbcopy.display_ids = [];\n            if (callbacks.clear_on_done === undefined) {\n                // default to clear-on-done\n                cbcopy.clear_on_done = true;\n            }\n        } else if (remember) {\n            this.last_msg_callbacks = {};\n        }\n    };\n\n    /**\n     * Override output callbacks for a particular msg_id\n     */\n    Kernel.prototype.output_callback_overrides_push = function(msg_id, callback_id) {\n        var output_callbacks = this._msg_callbacks_overrides[msg_id];\n        if (!output_callbacks) {\n            this._msg_callbacks_overrides[msg_id] = output_callbacks = [];\n        }\n        output_callbacks.push(callback_id);\n    }\n\n    Kernel.prototype.output_callback_overrides_pop = function(msg_id) {\n        var callback_ids = this._msg_callbacks_overrides[msg_id];\n        if (!callback_ids) {\n            console.error(\"Popping callback overrides, but none registered\", msg_id);\n            return;\n        }\n        return callback_ids.pop();\n    }\n\n    Kernel.prototype._handle_ws_message = function (e) {\n        var that = this;\n        this._msg_queue = this._msg_queue.then(function() {\n            return serialize.deserialize(e.data);\n        }).then(function(msg) {return that._finish_ws_message(msg);})\n        .catch(function(error) { console.error(\"Couldn't process kernel message\", error); });\n    };\n\n    Kernel.prototype._finish_ws_message = function (msg) {\n        switch (msg.channel) {\n            case 'shell':\n                return this._handle_shell_reply(msg);\n            case 'iopub':\n                return this._handle_iopub_message(msg);\n            case 'stdin':\n                return this._handle_input_request(msg);\n            default:\n                console.error(\"unrecognized message channel\", msg.channel, msg);\n        }\n    };\n    \n    Kernel.prototype._handle_shell_reply = function (reply) {\n        this.events.trigger('shell_reply.Kernel', {kernel: this, reply:reply});\n        var that = this;\n        var content = reply.content;\n        var metadata = reply.metadata;\n        var parent_id = reply.parent_header.msg_id;\n        var callbacks = this.get_callbacks_for_msg(parent_id);\n        var promise = Promise.resolve();\n        if (!callbacks || !callbacks.shell) {\n            return;\n        }\n        var shell_callbacks = callbacks.shell;\n        \n        // signal that shell callbacks are done\n        this._finish_shell(parent_id);\n        \n        if (shell_callbacks.reply !== undefined) {\n            promise = promise.then(function() {return shell_callbacks.reply(reply);});\n        }\n        if (content.payload && shell_callbacks.payload) {\n            promise = promise.then(function() {\n                return that._handle_payloads(content.payload, shell_callbacks.payload, reply);\n            });\n        }\n        return promise;\n    };\n\n    /**\n     * @function _handle_payloads\n     */\n    Kernel.prototype._handle_payloads = function (payloads, payload_callbacks, msg) {\n        var promise = [];\n        var l = payloads.length;\n        // Payloads are handled by triggering events because we don't want the Kernel\n        // to depend on the Notebook or Pager classes.\n        for (var i=0; i<l; i++) {\n            var payload = payloads[i];\n            var callback = payload_callbacks[payload.source];\n            if (callback) {\n                promise.push(callback(payload, msg));\n            }\n        }\n        return Promise.all(promise);\n    };\n\n    /**\n     * @function _handle_status_message\n     */\n    Kernel.prototype._handle_status_message = function (msg) {\n        var execution_state = msg.content.execution_state;\n        var parent_id = msg.parent_header.msg_id;\n        \n        // dispatch status msg callbacks, if any\n        var callbacks = this.get_callbacks_for_msg(parent_id);\n        if (callbacks && callbacks.iopub && callbacks.iopub.status) {\n            try {\n                callbacks.iopub.status(msg);\n            } catch (e) {\n                console.log(\"Exception in status msg handler\", e, e.stack);\n            }\n        }\n        \n        if (execution_state === 'busy') {\n            this.events.trigger('kernel_busy.Kernel', {kernel: this});\n\n        } else if (execution_state === 'idle') {\n            // signal that iopub callbacks are (probably) done\n            // async output may still arrive,\n            // but only for the most recent request\n            this._finish_iopub(parent_id);\n            \n            // trigger status_idle event\n            this.events.trigger('kernel_idle.Kernel', {kernel: this});\n\n        } else if (execution_state === 'starting') {\n            this.events.trigger('kernel_starting.Kernel', {kernel: this});\n            var that = this;\n            this.kernel_info(function (reply) {\n                that.info_reply = reply.content;\n                that.events.trigger('kernel_ready.Kernel', {kernel: that});\n            });\n\n        } else if (execution_state === 'restarting') {\n            // autorestarting is distinct from restarting,\n            // in that it means the kernel died and the server is restarting it.\n            // kernel_restarting sets the notification widget,\n            // autorestart shows the more prominent dialog.\n            this._autorestart_attempt = this._autorestart_attempt + 1;\n            this.events.trigger('kernel_restarting.Kernel', {kernel: this});\n            this.events.trigger('kernel_autorestarting.Kernel', {kernel: this, attempt: this._autorestart_attempt});\n\n        } else if (execution_state === 'dead') {\n            this.events.trigger('kernel_dead.Kernel', {kernel: this});\n            this._kernel_dead();\n        }\n    };\n    \n    /**\n     * Handle clear_output message\n     *\n     * @function _handle_clear_output\n     */\n    Kernel.prototype._handle_clear_output = function (msg) {\n        var callbacks = this.get_output_callbacks_for_msg(msg.parent_header.msg_id);\n        if (!callbacks || !callbacks.iopub) {\n            return;\n        }\n        var callback = callbacks.iopub.clear_output;\n        if (callback) {\n            callback(msg);\n        }\n    };\n\n    /**\n     * handle an output message (execute_result, display_data, etc.)\n     *\n     * @function _handle_output_message\n     */\n    Kernel.prototype._handle_output_message = function (msg) {\n        var that = this;\n        var msg_id = msg.parent_header.msg_id;\n        var callbacks = this.get_output_callbacks_for_msg(msg_id);\n        if (['display_data', 'update_display_data', 'execute_result'].indexOf(msg.header.msg_type) > -1) {\n            // display_data messages may re-route based on their display_id\n            var display_id = (msg.content.transient || {}).display_id;\n            if (display_id) {\n                // it has a display_id\n                var parent_ids = this._display_id_to_parent_ids[display_id];\n                if (parent_ids) {\n                    // we've seen it before, update existing outputs with same display_id\n                    // by handling display_data as update_display_data\n                    var update_msg = $.extend(true, {}, msg);\n                    update_msg.header.msg_type = 'update_display_data';\n\n                    parent_ids.map(function (parent_id) {\n                        var callbacks = that.get_callbacks_for_msg(parent_id);\n                        if (!callbacks) return;\n                        var callback = callbacks.iopub.output;\n                        if (callback) {\n                            callback(update_msg);\n                        }\n                    });\n                }\n                // we're done here if it's update_display\n                if (msg.header.msg_type === 'update_display_data') {\n                    // it's an update, don't proceed to the normal display\n                    return;\n                }\n                // regular display_data with id, record it for future updating\n                // in _display_id_to_parent_ids for future lookup\n                if (this._display_id_to_parent_ids[display_id] === undefined) {\n                    this._display_id_to_parent_ids[display_id] = [];\n                }\n                var callback_id = this.get_output_callback_id(msg_id);\n                if (this._display_id_to_parent_ids[display_id].indexOf(callback_id) === -1) {\n                    this._display_id_to_parent_ids[display_id].push(callback_id);\n                }\n                // and in callbacks for cleanup on clear_callbacks_for_msg\n                if (callbacks && callbacks.display_ids.indexOf(display_id) === -1) {\n                    callbacks.display_ids.push(display_id);\n                }\n            }\n        }\n\n\n        if (!callbacks || !callbacks.iopub) {\n            // The message came from another client. Let the UI decide what to\n            // do with it.\n            this.events.trigger('received_unsolicited_message.Kernel', msg);\n            return;\n        }\n        var callback = callbacks.iopub.output;\n        if (callback) {\n            callback(msg);\n        }\n    };\n\n    /**\n     * Handle an input message (execute_input).\n     *\n     * @function _handle_input message\n     */\n    Kernel.prototype._handle_input_message = function (msg) {\n        var callbacks = this.get_callbacks_for_msg(msg.parent_header.msg_id);\n        if (!callbacks) {\n            // The message came from another client. Let the UI decide what to\n            // do with it.\n            this.events.trigger('received_unsolicited_message.Kernel', msg);\n        }\n    };\n\n    /**\n     * Dispatch IOPub messages to respective handlers. Each message\n     * type should have a handler.\n     *\n     * @function _handle_iopub_message\n     */\n    Kernel.prototype._handle_iopub_message = function (msg) {\n        var handler = this.get_iopub_handler(msg.header.msg_type);\n        if (handler !== undefined) {\n            return handler(msg);\n        }\n    };\n\n    /**\n     * @function _handle_input_request\n     */\n    Kernel.prototype._handle_input_request = function (request) {\n        var header = request.header;\n        var content = request.content;\n        var metadata = request.metadata;\n        var msg_type = header.msg_type;\n        if (msg_type !== 'input_request') {\n            console.log(\"Invalid input request!\", request);\n            return;\n        }\n        var callbacks = this.get_callbacks_for_msg(request.parent_header.msg_id);\n        if (callbacks) {\n            if (callbacks.input) {\n                callbacks.input(request);\n            }\n        }\n    };\n\n    return {'Kernel': Kernel};\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'underscore',\n    ], function (_) {\n    \"use strict\";\n    \n    var _deserialize_array_buffer = function (buf) {\n        var data = new DataView(buf);\n        // read the header: 1 + nbufs 32b integers\n        var nbufs = data.getUint32(0);\n        var offsets = [];\n        var i;\n        for (i = 1; i <= nbufs; i++) {\n            offsets.push(data.getUint32(i * 4));\n        }\n        var json_bytes = new Uint8Array(buf.slice(offsets[0], offsets[1]));\n        var msg = JSON.parse(\n            (new TextDecoder('utf8')).decode(json_bytes)\n        );\n        // the remaining chunks are stored as DataViews in msg.buffers\n        msg.buffers = [];\n        var start, stop;\n        for (i = 1; i < nbufs; i++) {\n            start = offsets[i];\n            stop = offsets[i+1] || buf.byteLength;\n            msg.buffers.push(new DataView(buf.slice(start, stop)));\n        }\n        return msg;\n    };\n    \n    var _deserialize_binary = function(data) {\n        /**\n         * deserialize the binary message format\n         * callback will be called with a message whose buffers attribute\n         * will be an array of DataViews.\n         */\n        if (data instanceof Blob) {\n            // data is Blob, have to deserialize from ArrayBuffer in reader callback\n            var reader = new FileReader();\n            var promise = new Promise(function(resolve, reject) {\n                reader.onload = function () {\n                    var msg = _deserialize_array_buffer(this.result);\n                    resolve(msg);\n                };\n            });\n            reader.readAsArrayBuffer(data);\n            return promise;\n        } else {\n            // data is ArrayBuffer, can deserialize directly\n            var msg = _deserialize_array_buffer(data);\n            return msg;\n        }\n    };\n\n    var deserialize = function (data) {\n        /**\n         * deserialize a message and return a promise for the unpacked message\n         */\n        if (typeof data === \"string\") {\n            // text JSON message\n            return Promise.resolve(JSON.parse(data));\n        } else {\n            // binary message\n            return Promise.resolve(_deserialize_binary(data));\n        }\n    };\n    \n    var _serialize_binary = function (msg) {\n        /**\n         * implement the binary serialization protocol\n         * serializes JSON message to ArrayBuffer\n         */\n        msg = _.clone(msg);\n        var offsets = [];\n        var buffers = [];\n        var i;\n        for (i = 0; i < msg.buffers.length; i++) {\n            // msg.buffers elements could be either views or ArrayBuffers\n            // buffers elements are ArrayBuffers\n            var b = msg.buffers[i];\n            buffers.push(b.buffer instanceof ArrayBuffer ? b.buffer : b);\n        }\n        delete msg.buffers;\n        var json_utf8 = (new TextEncoder('utf8')).encode(JSON.stringify(msg));\n        buffers.unshift(json_utf8);\n        var nbufs = buffers.length;\n        offsets.push(4 * (nbufs + 1));\n        for (i = 0; i + 1 < buffers.length; i++) {\n            offsets.push(offsets[offsets.length-1] + buffers[i].byteLength);\n        }\n        var msg_buf = new Uint8Array(\n            offsets[offsets.length-1] + buffers[buffers.length-1].byteLength\n        );\n        // use DataView.setUint32 for network byte-order\n        var view = new DataView(msg_buf.buffer);\n        // write nbufs to first 4 bytes\n        view.setUint32(0, nbufs);\n        // write offsets to next 4 * nbufs bytes\n        for (i = 0; i < offsets.length; i++) {\n            view.setUint32(4 * (i+1), offsets[i]);\n        }\n        // write all the buffers at their respective offsets\n        for (i = 0; i < buffers.length; i++) {\n            msg_buf.set(new Uint8Array(buffers[i]), offsets[i]);\n        }\n        \n        // return raw ArrayBuffer\n        return msg_buf.buffer;\n    };\n    \n    var serialize = function (msg) {\n        if (msg.buffers && msg.buffers.length) {\n            return _serialize_binary(msg);\n        } else {\n            return JSON.stringify(msg);\n        }\n    };\n    \n    var exports = {\n        deserialize : deserialize,\n        serialize: serialize\n    };\n    return exports;\n});\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\ndefine([\n    'jquery',\n    'base/js/utils',\n    'services/kernels/kernel',\n], function($, utils, kernel) {\n    \"use strict\";\n\n    /**\n     * Session object for accessing the session REST api. The session\n     * should be used to start kernels and then shut them down -- for\n     * all other operations, the kernel object should be used.\n     *\n     * Preliminary documentation for the REST API is at\n     * https://github.com/ipython/ipython/wiki/IPEP-16%3A-Notebook-multi-directory-dashboard-and-URL-mapping#sessions-api\n     *\n     * Options should include:\n     *  - notebook_path: the path (not including name) to the notebook\n     *  - kernel_name: the type of kernel (e.g. python3)\n     *  - base_url: the root url of the notebook server\n     *  - ws_url: the url to access websockets\n     *  - notebook: Notebook object\n     *\n     * @class Session\n     * @param {Object} options\n     */\n    var Session = function (options) {\n        this.id = null;\n        this.notebook_model = {\n            path: options.notebook_path\n        };\n        this.kernel_model = {\n            id: null,\n            name: options.kernel_name\n        };\n\n        this.base_url = options.base_url;\n        this.ws_url = options.ws_url;\n        this.session_service_url = utils.url_path_join(this.base_url, 'api/sessions');\n        this.session_url = null;\n\n        this.notebook = options.notebook;\n        this.kernel = null;\n        this.events = options.notebook.events;\n\n        this.bind_events();\n    };\n\n    Session.prototype.bind_events = function () {\n        var that = this;\n        var record_status = function (evt, info) {\n            console.log('Session: ' + evt.type + ' (' + info.session.id + ')');\n        };\n\n        this.events.on('kernel_created.Session', record_status);\n        this.events.on('kernel_dead.Session', record_status);\n        this.events.on('kernel_killed.Session', record_status);\n\n        // if the kernel dies, then also remove the session\n        this.events.on('kernel_dead.Kernel', function () {\n            that.delete();\n        });\n        this.events.on('kernel_failed_restart.Kernel', function () {\n            that.notebook.start_session();\n        });\n    };\n\n\n    // Public REST api functions\n\n    /**\n     * GET /api/sessions\n     *\n     * Get a list of the current sessions.\n     *\n     * @function list\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Session.prototype.list = function (success, error) {\n        utils.ajax(this.session_service_url, {\n            processData: false,\n            cache: false,\n            type: \"GET\",\n            dataType: \"json\",\n            success: success,\n            error: this._on_error(error)\n        });\n    };\n\n    /**\n     * POST /api/sessions\n     *\n     * Start a new session. This function can only executed once.\n     *\n     * @function start\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Session.prototype.start = function (success, error) {\n        var that = this;\n        var on_success = function (data, status, xhr) {\n            if (that.kernel) {\n                that.kernel.name = that.kernel_model.name;\n            } else {\n                var kernel_service_url = utils.url_path_join(that.base_url, \"api/kernels\");\n                var kernelAvailable = that.notebook.basthonGUI.kernelLoader.kernelAvailable();\n                that.kernel = new kernel.Kernel(kernel_service_url, that.ws_url, that.kernel_model.name, kernelAvailable);\n            }\n            that.events.trigger('kernel_created.Session', {session: that, kernel: that.kernel});\n            that.kernel._kernel_created(data.kernel);\n            if (success) {\n                success(data, status, xhr);\n            }\n        };\n        var on_error = function (xhr, status, err) {\n            that.events.trigger('kernel_dead.Session', {session: that, xhr: xhr, status: status, error: err});\n            if (error) {\n                error(xhr, status, err);\n            }\n        };\n\n        on_success({kernel: {id: 0}}, null, null);\n        /*\n        utils.ajax(this.session_service_url, {\n            processData: false,\n            cache: false,\n            type: \"POST\",\n            data: JSON.stringify(this._get_model()),\n            contentType: 'application/json',\n            dataType: \"json\",\n            success: this._on_success(on_success),\n            error: this._on_error(on_error)\n        });\n        */\n    };\n\n    /**\n     * GET /api/sessions/[:session_id]\n     *\n     * Get information about a session.\n     *\n     * @function get_info\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Session.prototype.get_info = function (success, error) {\n        utils.ajax(this.session_url, {\n            processData: false,\n            cache: false,\n            type: \"GET\",\n            dataType: \"json\",\n            success: this._on_success(success),\n            error: this._on_error(error)\n        });\n    };\n\n    /**\n     * PATCH /api/sessions/[:session_id]\n     *\n     * Rename or move a notebook. If the given name or path are\n     * undefined, then they will not be changed.\n     *\n     * @function rename_notebook\n     * @param {string} [path] - new notebook path\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Session.prototype.rename_notebook = function (path, success, error) {\n        if (path !== undefined) {\n            this.notebook_model.path = path;\n        }\n\n        utils.ajax(this.session_url, {\n            processData: false,\n            cache: false,\n            type: \"PATCH\",\n            data: JSON.stringify(this._get_model()),\n            contentType: 'application/json',\n            dataType: \"json\",\n            success: this._on_success(success),\n            error: this._on_error(error)\n        });\n    };\n\n    /**\n     * DELETE /api/sessions/[:session_id]\n     *\n     * Kill the kernel and shutdown the session.\n     *\n     * @function delete\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Session.prototype.delete = function (success, error) {\n        if (this.kernel && this.kernel.is_connected()) {\n            this.events.trigger('kernel_killed.Session', {session: this, kernel: this.kernel});\n            this.kernel._kernel_dead();\n        }\n\n        utils.ajax(this.session_url, {\n            processData: false,\n            cache: false,\n            type: \"DELETE\",\n            dataType: \"json\",\n            success: this._on_success(success),\n            error: this._on_error(error)\n        });\n    };\n\n    /**\n     * Restart the session by deleting it and the starting it\n     * fresh. If options are given, they can include any of the\n     * following:\n     *\n     * - notebook_path - the path to the notebook\n     * - kernel_name - the name (type) of the kernel\n     *\n     * @function restart\n     * @param {Object} [options] - options for the new kernel\n     * @param {function} [success] - function executed on ajax success\n     * @param {function} [error] - function executed on ajax error\n     */\n    Session.prototype.restart = function (options, success, error) {\n        var that = this;\n        var start = function () {\n            if (options && options.notebook_path) {\n                that.notebook_model.path = options.notebook_path;\n            }\n            if (options && options.kernel_name) {\n                that.kernel_model.name = options.kernel_name;\n            }\n            that.kernel_model.id = null;\n            that.start(success, error);\n        };\n        this.delete(start, start);\n    };\n\n    // Helper functions\n\n    /**\n     * Get the data model for the session, which includes the notebook path\n     * and kernel (name and id).\n     *\n     * @function _get_model\n     * @returns {Object} - the data model\n     */\n    Session.prototype._get_model = function () {\n        return {\n            path: this.notebook_model.path,\n            type: 'notebook',\n            name: '',\n            kernel: this.kernel_model\n        };\n    };\n\n    /**\n     * Update the data model from the given JSON object, which should\n     * have attributes of `id`, `notebook`, and/or `kernel`. If\n     * provided, the notebook data must include name and path, and the\n     * kernel data must include name and id.\n     *\n     * @function _update_model\n     * @param {Object} data - updated data model\n     */\n    Session.prototype._update_model = function (data) {\n        if (data && data.id) {\n            this.id = data.id;\n            this.session_url = utils.url_path_join(this.session_service_url, this.id);\n        }\n        if (data && data.notebook) {\n            this.notebook_model.path = data.path;\n        }\n        if (data && data.kernel) {\n            this.kernel_model.name = data.kernel.name;\n            this.kernel_model.id = data.kernel.id;\n        }\n    };\n\n    /**\n     * Handle a successful AJAX request by updating the session data\n     * model with the response, and then optionally calling a provided\n     * callback.\n     *\n     * @function _on_success\n     * @param {function} success - callback\n     */\n    Session.prototype._on_success = function (success) {\n        var that = this;\n        return function (data, status, xhr) {\n            that._update_model(data);\n            if (success) {\n                success(data, status, xhr);\n            }\n        };\n    };\n\n    /**\n     * Handle a failed AJAX request by logging the error message, and\n     * then optionally calling a provided callback.\n     *\n     * @function _on_error\n     * @param {function} error - callback\n     */\n    Session.prototype._on_error = function (error) {\n        return function (xhr, status, err) {\n            utils.log_ajax_error(xhr, status, err);\n            if (error) {\n                error(xhr, status, err);\n            }\n        };\n    };\n\n    /**\n     * Error type indicating that the session is already starting.\n     */\n    var SessionAlreadyStarting = function (message) {\n        this.name = \"SessionAlreadyStarting\";\n        this.message = (message || \"\");\n    };\n\n    SessionAlreadyStarting.prototype = Error.prototype;\n\n    return {\n        Session: Session,\n        SessionAlreadyStarting: SessionAlreadyStarting\n    };\n});\n","var map = {\n\t\"./apl/apl.js\": [\n\t\t29483,\n\t\t9483\n\t],\n\t\"./asciiarmor/asciiarmor.js\": [\n\t\t95637,\n\t\t5637\n\t],\n\t\"./asn.1/asn.1.js\": [\n\t\t97922,\n\t\t7922\n\t],\n\t\"./asterisk/asterisk.js\": [\n\t\t31881,\n\t\t1881\n\t],\n\t\"./brainfuck/brainfuck.js\": [\n\t\t9460,\n\t\t9460\n\t],\n\t\"./clike/clike.js\": [\n\t\t99762,\n\t\t9762\n\t],\n\t\"./clojure/clojure.js\": [\n\t\t63693,\n\t\t3693\n\t],\n\t\"./cmake/cmake.js\": [\n\t\t33160,\n\t\t3160\n\t],\n\t\"./cobol/cobol.js\": [\n\t\t65542,\n\t\t5542\n\t],\n\t\"./coffeescript/coffeescript.js\": [\n\t\t90044,\n\t\t44\n\t],\n\t\"./commonlisp/commonlisp.js\": [\n\t\t29073,\n\t\t9073\n\t],\n\t\"./crystal/crystal.js\": [\n\t\t76149,\n\t\t6149\n\t],\n\t\"./css/css.js\": [\n\t\t36629,\n\t\t6629\n\t],\n\t\"./cypher/cypher.js\": [\n\t\t88441,\n\t\t8441\n\t],\n\t\"./d/d.js\": [\n\t\t49570,\n\t\t9570\n\t],\n\t\"./dart/dart.js\": [\n\t\t20842,\n\t\t9762,\n\t\t842\n\t],\n\t\"./diff/diff.js\": [\n\t\t1715,\n\t\t1715\n\t],\n\t\"./django/django.js\": [\n\t\t75288,\n\t\t6876,\n\t\t6629,\n\t\t5288\n\t],\n\t\"./dockerfile/dockerfile.js\": [\n\t\t75258,\n\t\t5258\n\t],\n\t\"./dtd/dtd.js\": [\n\t\t70655,\n\t\t655\n\t],\n\t\"./dylan/dylan.js\": [\n\t\t25184,\n\t\t5184\n\t],\n\t\"./ebnf/ebnf.js\": [\n\t\t84134,\n\t\t4134\n\t],\n\t\"./ecl/ecl.js\": [\n\t\t60427,\n\t\t427\n\t],\n\t\"./eiffel/eiffel.js\": [\n\t\t34717,\n\t\t4717\n\t],\n\t\"./elm/elm.js\": [\n\t\t78919,\n\t\t8919\n\t],\n\t\"./erlang/erlang.js\": [\n\t\t76392,\n\t\t6392\n\t],\n\t\"./factor/factor.js\": [\n\t\t27566,\n\t\t7566\n\t],\n\t\"./fcl/fcl.js\": [\n\t\t15300,\n\t\t5300\n\t],\n\t\"./forth/forth.js\": [\n\t\t88859,\n\t\t8859\n\t],\n\t\"./fortran/fortran.js\": [\n\t\t44874,\n\t\t4874\n\t],\n\t\"./gas/gas.js\": [\n\t\t28902,\n\t\t8902\n\t],\n\t\"./gfm/gfm.js\": [\n\t\t42425\n\t],\n\t\"./gherkin/gherkin.js\": [\n\t\t85546,\n\t\t5546\n\t],\n\t\"./go/go.js\": [\n\t\t94750,\n\t\t4750\n\t],\n\t\"./groovy/groovy.js\": [\n\t\t53123,\n\t\t3123\n\t],\n\t\"./haml/haml.js\": [\n\t\t20147,\n\t\t6876,\n\t\t6629,\n\t\t147\n\t],\n\t\"./handlebars/handlebars.js\": [\n\t\t62101,\n\t\t2101\n\t],\n\t\"./haskell-literate/haskell-literate.js\": [\n\t\t28510,\n\t\t8510\n\t],\n\t\"./haskell/haskell.js\": [\n\t\t18176,\n\t\t8176\n\t],\n\t\"./haxe/haxe.js\": [\n\t\t19889,\n\t\t9889\n\t],\n\t\"./htmlembedded/htmlembedded.js\": [\n\t\t79820,\n\t\t6876,\n\t\t6629,\n\t\t9820\n\t],\n\t\"./htmlmixed/htmlmixed.js\": [\n\t\t16531,\n\t\t6876,\n\t\t6629,\n\t\t6531\n\t],\n\t\"./http/http.js\": [\n\t\t98411,\n\t\t8411\n\t],\n\t\"./idl/idl.js\": [\n\t\t41797,\n\t\t1797\n\t],\n\t\"./javascript/javascript.js\": [\n\t\t96876,\n\t\t6876\n\t],\n\t\"./jinja2/jinja2.js\": [\n\t\t74670,\n\t\t4670\n\t],\n\t\"./jsx/jsx.js\": [\n\t\t71548,\n\t\t6876,\n\t\t1548\n\t],\n\t\"./julia/julia.js\": [\n\t\t68059,\n\t\t8059\n\t],\n\t\"./livescript/livescript.js\": [\n\t\t14373,\n\t\t4373\n\t],\n\t\"./lua/lua.js\": [\n\t\t57745,\n\t\t7745\n\t],\n\t\"./markdown/markdown.js\": [\n\t\t49047\n\t],\n\t\"./mathematica/mathematica.js\": [\n\t\t93672,\n\t\t3672\n\t],\n\t\"./mbox/mbox.js\": [\n\t\t94377,\n\t\t4377\n\t],\n\t\"./meta.js\": [\n\t\t52539\n\t],\n\t\"./mirc/mirc.js\": [\n\t\t94268,\n\t\t4268\n\t],\n\t\"./mllike/mllike.js\": [\n\t\t52587,\n\t\t5880\n\t],\n\t\"./modelica/modelica.js\": [\n\t\t24333,\n\t\t4333\n\t],\n\t\"./mscgen/mscgen.js\": [\n\t\t68810,\n\t\t8810\n\t],\n\t\"./mumps/mumps.js\": [\n\t\t12875,\n\t\t2875\n\t],\n\t\"./nginx/nginx.js\": [\n\t\t10131,\n\t\t131\n\t],\n\t\"./nsis/nsis.js\": [\n\t\t42313,\n\t\t2313\n\t],\n\t\"./ntriples/ntriples.js\": [\n\t\t82954,\n\t\t2954\n\t],\n\t\"./octave/octave.js\": [\n\t\t15734,\n\t\t5734\n\t],\n\t\"./oz/oz.js\": [\n\t\t44323,\n\t\t4323\n\t],\n\t\"./pascal/pascal.js\": [\n\t\t23057,\n\t\t3057\n\t],\n\t\"./pegjs/pegjs.js\": [\n\t\t31472,\n\t\t6876,\n\t\t1472\n\t],\n\t\"./perl/perl.js\": [\n\t\t10024,\n\t\t24\n\t],\n\t\"./php/php.js\": [\n\t\t36702,\n\t\t6876,\n\t\t6629,\n\t\t9762,\n\t\t6702\n\t],\n\t\"./pig/pig.js\": [\n\t\t54763,\n\t\t4763\n\t],\n\t\"./powershell/powershell.js\": [\n\t\t97196,\n\t\t7196\n\t],\n\t\"./properties/properties.js\": [\n\t\t7999,\n\t\t7999\n\t],\n\t\"./protobuf/protobuf.js\": [\n\t\t72360,\n\t\t2360\n\t],\n\t\"./pug/pug.js\": [\n\t\t75354,\n\t\t6876,\n\t\t6629,\n\t\t5354\n\t],\n\t\"./puppet/puppet.js\": [\n\t\t20673,\n\t\t673\n\t],\n\t\"./python/python.js\": [\n\t\t5321\n\t],\n\t\"./q/q.js\": [\n\t\t97713,\n\t\t7713\n\t],\n\t\"./r/r.js\": [\n\t\t85420,\n\t\t5420\n\t],\n\t\"./rpm/rpm.js\": [\n\t\t4344,\n\t\t4344\n\t],\n\t\"./rst/rst.js\": [\n\t\t22968,\n\t\t2968\n\t],\n\t\"./ruby/ruby.js\": [\n\t\t80853,\n\t\t853\n\t],\n\t\"./rust/rust.js\": [\n\t\t90911,\n\t\t911\n\t],\n\t\"./sas/sas.js\": [\n\t\t16229,\n\t\t6229\n\t],\n\t\"./sass/sass.js\": [\n\t\t81201,\n\t\t6629,\n\t\t1201\n\t],\n\t\"./scheme/scheme.js\": [\n\t\t42372,\n\t\t2372\n\t],\n\t\"./shell/shell.js\": [\n\t\t31149,\n\t\t1149\n\t],\n\t\"./sieve/sieve.js\": [\n\t\t49311,\n\t\t9311\n\t],\n\t\"./slim/slim.js\": [\n\t\t32486,\n\t\t6876,\n\t\t6629,\n\t\t2486\n\t],\n\t\"./smalltalk/smalltalk.js\": [\n\t\t66690,\n\t\t6690\n\t],\n\t\"./smarty/smarty.js\": [\n\t\t52889,\n\t\t2889\n\t],\n\t\"./solr/solr.js\": [\n\t\t18715,\n\t\t8715\n\t],\n\t\"./soy/soy.js\": [\n\t\t61527,\n\t\t6876,\n\t\t6629,\n\t\t1527\n\t],\n\t\"./sparql/sparql.js\": [\n\t\t63982,\n\t\t3982\n\t],\n\t\"./spreadsheet/spreadsheet.js\": [\n\t\t63138,\n\t\t3138\n\t],\n\t\"./sql/sql.js\": [\n\t\t54086,\n\t\t4086\n\t],\n\t\"./stex/stex.js\": [\n\t\t80785\n\t],\n\t\"./stylus/stylus.js\": [\n\t\t60742,\n\t\t742\n\t],\n\t\"./swift/swift.js\": [\n\t\t37355,\n\t\t7355\n\t],\n\t\"./tcl/tcl.js\": [\n\t\t25664,\n\t\t5664\n\t],\n\t\"./textile/textile.js\": [\n\t\t43897,\n\t\t3897\n\t],\n\t\"./tiddlywiki/tiddlywiki.js\": [\n\t\t91046,\n\t\t1046\n\t],\n\t\"./tiki/tiki.js\": [\n\t\t17988,\n\t\t7988\n\t],\n\t\"./toml/toml.js\": [\n\t\t47617,\n\t\t7617\n\t],\n\t\"./tornado/tornado.js\": [\n\t\t66043,\n\t\t6876,\n\t\t6629,\n\t\t6043\n\t],\n\t\"./troff/troff.js\": [\n\t\t20800,\n\t\t800\n\t],\n\t\"./ttcn-cfg/ttcn-cfg.js\": [\n\t\t68923,\n\t\t8923\n\t],\n\t\"./ttcn/ttcn.js\": [\n\t\t71105,\n\t\t1105\n\t],\n\t\"./turtle/turtle.js\": [\n\t\t73556,\n\t\t3556\n\t],\n\t\"./twig/twig.js\": [\n\t\t54702,\n\t\t4702\n\t],\n\t\"./vb/vb.js\": [\n\t\t12660,\n\t\t2660\n\t],\n\t\"./vbscript/vbscript.js\": [\n\t\t98073,\n\t\t8073\n\t],\n\t\"./velocity/velocity.js\": [\n\t\t15912,\n\t\t5912\n\t],\n\t\"./verilog/verilog.js\": [\n\t\t63249,\n\t\t3249\n\t],\n\t\"./vhdl/vhdl.js\": [\n\t\t53140,\n\t\t3140\n\t],\n\t\"./vue/vue.js\": [\n\t\t2426,\n\t\t6876,\n\t\t6629,\n\t\t742,\n\t\t5354,\n\t\t2426\n\t],\n\t\"./wast/wast.js\": [\n\t\t8632,\n\t\t8632\n\t],\n\t\"./webidl/webidl.js\": [\n\t\t11015,\n\t\t1015\n\t],\n\t\"./xml/xml.js\": [\n\t\t29589\n\t],\n\t\"./xquery/xquery.js\": [\n\t\t61484,\n\t\t1484\n\t],\n\t\"./yacas/yacas.js\": [\n\t\t65278,\n\t\t5278\n\t],\n\t\"./yaml-frontmatter/yaml-frontmatter.js\": [\n\t\t98554,\n\t\t8554\n\t],\n\t\"./yaml/yaml.js\": [\n\t\t53631,\n\t\t3631\n\t],\n\t\"./z80/z80.js\": [\n\t\t22245,\n\t\t2245\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(() => {\n\t\treturn __webpack_require__.t(id, 7 | 16);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = 24259;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./af\": 42786,\n\t\"./af.js\": 42786,\n\t\"./ar\": 30867,\n\t\"./ar-dz\": 14130,\n\t\"./ar-dz.js\": 14130,\n\t\"./ar-kw\": 96135,\n\t\"./ar-kw.js\": 96135,\n\t\"./ar-ly\": 56440,\n\t\"./ar-ly.js\": 56440,\n\t\"./ar-ma\": 47702,\n\t\"./ar-ma.js\": 47702,\n\t\"./ar-sa\": 16040,\n\t\"./ar-sa.js\": 16040,\n\t\"./ar-tn\": 37100,\n\t\"./ar-tn.js\": 37100,\n\t\"./ar.js\": 30867,\n\t\"./az\": 31083,\n\t\"./az.js\": 31083,\n\t\"./be\": 9808,\n\t\"./be.js\": 9808,\n\t\"./bg\": 68338,\n\t\"./bg.js\": 68338,\n\t\"./bm\": 67438,\n\t\"./bm.js\": 67438,\n\t\"./bn\": 8905,\n\t\"./bn-bd\": 76225,\n\t\"./bn-bd.js\": 76225,\n\t\"./bn.js\": 8905,\n\t\"./bo\": 11560,\n\t\"./bo.js\": 11560,\n\t\"./br\": 1278,\n\t\"./br.js\": 1278,\n\t\"./bs\": 80622,\n\t\"./bs.js\": 80622,\n\t\"./ca\": 2468,\n\t\"./ca.js\": 2468,\n\t\"./cs\": 5822,\n\t\"./cs.js\": 5822,\n\t\"./cv\": 50877,\n\t\"./cv.js\": 50877,\n\t\"./cy\": 47373,\n\t\"./cy.js\": 47373,\n\t\"./da\": 24780,\n\t\"./da.js\": 24780,\n\t\"./de\": 59740,\n\t\"./de-at\": 60217,\n\t\"./de-at.js\": 60217,\n\t\"./de-ch\": 60894,\n\t\"./de-ch.js\": 60894,\n\t\"./de.js\": 59740,\n\t\"./dv\": 5300,\n\t\"./dv.js\": 5300,\n\t\"./el\": 50837,\n\t\"./el.js\": 50837,\n\t\"./en-au\": 78348,\n\t\"./en-au.js\": 78348,\n\t\"./en-ca\": 77925,\n\t\"./en-ca.js\": 77925,\n\t\"./en-gb\": 22243,\n\t\"./en-gb.js\": 22243,\n\t\"./en-ie\": 46436,\n\t\"./en-ie.js\": 46436,\n\t\"./en-il\": 47207,\n\t\"./en-il.js\": 47207,\n\t\"./en-in\": 44175,\n\t\"./en-in.js\": 44175,\n\t\"./en-nz\": 76319,\n\t\"./en-nz.js\": 76319,\n\t\"./en-sg\": 31662,\n\t\"./en-sg.js\": 31662,\n\t\"./eo\": 92915,\n\t\"./eo.js\": 92915,\n\t\"./es\": 55655,\n\t\"./es-do\": 55251,\n\t\"./es-do.js\": 55251,\n\t\"./es-mx\": 96112,\n\t\"./es-mx.js\": 96112,\n\t\"./es-us\": 71146,\n\t\"./es-us.js\": 71146,\n\t\"./es.js\": 55655,\n\t\"./et\": 5603,\n\t\"./et.js\": 5603,\n\t\"./eu\": 77763,\n\t\"./eu.js\": 77763,\n\t\"./fa\": 76959,\n\t\"./fa.js\": 76959,\n\t\"./fi\": 11897,\n\t\"./fi.js\": 11897,\n\t\"./fil\": 42549,\n\t\"./fil.js\": 42549,\n\t\"./fo\": 94694,\n\t\"./fo.js\": 94694,\n\t\"./fr\": 94470,\n\t\"./fr-ca\": 63049,\n\t\"./fr-ca.js\": 63049,\n\t\"./fr-ch\": 52330,\n\t\"./fr-ch.js\": 52330,\n\t\"./fr.js\": 94470,\n\t\"./fy\": 5044,\n\t\"./fy.js\": 5044,\n\t\"./ga\": 29295,\n\t\"./ga.js\": 29295,\n\t\"./gd\": 2101,\n\t\"./gd.js\": 2101,\n\t\"./gl\": 38794,\n\t\"./gl.js\": 38794,\n\t\"./gom-deva\": 27884,\n\t\"./gom-deva.js\": 27884,\n\t\"./gom-latn\": 23168,\n\t\"./gom-latn.js\": 23168,\n\t\"./gu\": 95349,\n\t\"./gu.js\": 95349,\n\t\"./he\": 24206,\n\t\"./he.js\": 24206,\n\t\"./hi\": 30094,\n\t\"./hi.js\": 30094,\n\t\"./hr\": 30316,\n\t\"./hr.js\": 30316,\n\t\"./hu\": 22138,\n\t\"./hu.js\": 22138,\n\t\"./hy-am\": 11423,\n\t\"./hy-am.js\": 11423,\n\t\"./id\": 29218,\n\t\"./id.js\": 29218,\n\t\"./is\": 90135,\n\t\"./is.js\": 90135,\n\t\"./it\": 90626,\n\t\"./it-ch\": 10150,\n\t\"./it-ch.js\": 10150,\n\t\"./it.js\": 90626,\n\t\"./ja\": 39183,\n\t\"./ja.js\": 39183,\n\t\"./jv\": 24286,\n\t\"./jv.js\": 24286,\n\t\"./ka\": 12105,\n\t\"./ka.js\": 12105,\n\t\"./kk\": 47772,\n\t\"./kk.js\": 47772,\n\t\"./km\": 18758,\n\t\"./km.js\": 18758,\n\t\"./kn\": 79282,\n\t\"./kn.js\": 79282,\n\t\"./ko\": 33730,\n\t\"./ko.js\": 33730,\n\t\"./ku\": 1408,\n\t\"./ku.js\": 1408,\n\t\"./ky\": 33291,\n\t\"./ky.js\": 33291,\n\t\"./lb\": 36841,\n\t\"./lb.js\": 36841,\n\t\"./lo\": 55466,\n\t\"./lo.js\": 55466,\n\t\"./lt\": 57010,\n\t\"./lt.js\": 57010,\n\t\"./lv\": 37595,\n\t\"./lv.js\": 37595,\n\t\"./me\": 39861,\n\t\"./me.js\": 39861,\n\t\"./mi\": 35493,\n\t\"./mi.js\": 35493,\n\t\"./mk\": 95966,\n\t\"./mk.js\": 95966,\n\t\"./ml\": 87341,\n\t\"./ml.js\": 87341,\n\t\"./mn\": 5115,\n\t\"./mn.js\": 5115,\n\t\"./mr\": 10370,\n\t\"./mr.js\": 10370,\n\t\"./ms\": 9847,\n\t\"./ms-my\": 41237,\n\t\"./ms-my.js\": 41237,\n\t\"./ms.js\": 9847,\n\t\"./mt\": 72126,\n\t\"./mt.js\": 72126,\n\t\"./my\": 56165,\n\t\"./my.js\": 56165,\n\t\"./nb\": 64924,\n\t\"./nb.js\": 64924,\n\t\"./ne\": 16744,\n\t\"./ne.js\": 16744,\n\t\"./nl\": 93901,\n\t\"./nl-be\": 59814,\n\t\"./nl-be.js\": 59814,\n\t\"./nl.js\": 93901,\n\t\"./nn\": 83877,\n\t\"./nn.js\": 83877,\n\t\"./oc-lnc\": 92135,\n\t\"./oc-lnc.js\": 92135,\n\t\"./pa-in\": 15858,\n\t\"./pa-in.js\": 15858,\n\t\"./pl\": 64495,\n\t\"./pl.js\": 64495,\n\t\"./pt\": 89520,\n\t\"./pt-br\": 57971,\n\t\"./pt-br.js\": 57971,\n\t\"./pt.js\": 89520,\n\t\"./ro\": 96459,\n\t\"./ro.js\": 96459,\n\t\"./ru\": 21793,\n\t\"./ru.js\": 21793,\n\t\"./sd\": 40950,\n\t\"./sd.js\": 40950,\n\t\"./se\": 10490,\n\t\"./se.js\": 10490,\n\t\"./si\": 90124,\n\t\"./si.js\": 90124,\n\t\"./sk\": 64249,\n\t\"./sk.js\": 64249,\n\t\"./sl\": 14985,\n\t\"./sl.js\": 14985,\n\t\"./sq\": 51104,\n\t\"./sq.js\": 51104,\n\t\"./sr\": 49131,\n\t\"./sr-cyrl\": 79915,\n\t\"./sr-cyrl.js\": 79915,\n\t\"./sr.js\": 49131,\n\t\"./ss\": 85893,\n\t\"./ss.js\": 85893,\n\t\"./sv\": 98760,\n\t\"./sv.js\": 98760,\n\t\"./sw\": 91172,\n\t\"./sw.js\": 91172,\n\t\"./ta\": 27333,\n\t\"./ta.js\": 27333,\n\t\"./te\": 23110,\n\t\"./te.js\": 23110,\n\t\"./tet\": 52095,\n\t\"./tet.js\": 52095,\n\t\"./tg\": 27321,\n\t\"./tg.js\": 27321,\n\t\"./th\": 9041,\n\t\"./th.js\": 9041,\n\t\"./tk\": 19005,\n\t\"./tk.js\": 19005,\n\t\"./tl-ph\": 75768,\n\t\"./tl-ph.js\": 75768,\n\t\"./tlh\": 89444,\n\t\"./tlh.js\": 89444,\n\t\"./tr\": 72397,\n\t\"./tr.js\": 72397,\n\t\"./tzl\": 28254,\n\t\"./tzl.js\": 28254,\n\t\"./tzm\": 51106,\n\t\"./tzm-latn\": 30699,\n\t\"./tzm-latn.js\": 30699,\n\t\"./tzm.js\": 51106,\n\t\"./ug-cn\": 9288,\n\t\"./ug-cn.js\": 9288,\n\t\"./uk\": 67691,\n\t\"./uk.js\": 67691,\n\t\"./ur\": 13795,\n\t\"./ur.js\": 13795,\n\t\"./uz\": 6791,\n\t\"./uz-latn\": 60588,\n\t\"./uz-latn.js\": 60588,\n\t\"./uz.js\": 6791,\n\t\"./vi\": 65666,\n\t\"./vi.js\": 65666,\n\t\"./x-pseudo\": 14378,\n\t\"./x-pseudo.js\": 14378,\n\t\"./yo\": 75805,\n\t\"./yo.js\": 75805,\n\t\"./zh-cn\": 83839,\n\t\"./zh-cn.js\": 83839,\n\t\"./zh-hk\": 55726,\n\t\"./zh-hk.js\": 55726,\n\t\"./zh-mo\": 99807,\n\t\"./zh-mo.js\": 99807,\n\t\"./zh-tw\": 74152,\n\t\"./zh-tw.js\": 74152\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46700;","var map = {\n\t\"./beige.css\": [\n\t\t83179,\n\t\t3179\n\t],\n\t\"./black.css\": [\n\t\t38994,\n\t\t8994\n\t],\n\t\"./blood.css\": [\n\t\t55945,\n\t\t5945\n\t],\n\t\"./fonts/league-gothic/league-gothic.css\": [\n\t\t95482,\n\t\t5482\n\t],\n\t\"./fonts/source-sans-pro/source-sans-pro.css\": [\n\t\t62029,\n\t\t2029\n\t],\n\t\"./league.css\": [\n\t\t63263,\n\t\t3263\n\t],\n\t\"./moon.css\": [\n\t\t56170,\n\t\t6170\n\t],\n\t\"./night.css\": [\n\t\t64805,\n\t\t4805\n\t],\n\t\"./serif.css\": [\n\t\t38933,\n\t\t8933\n\t],\n\t\"./simple.css\": [\n\t\t67657,\n\t\t7657\n\t],\n\t\"./sky.css\": [\n\t\t21374,\n\t\t1374\n\t],\n\t\"./solarized.css\": [\n\t\t72456,\n\t\t2456\n\t],\n\t\"./white.css\": [\n\t\t62481,\n\t\t2481\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(() => {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = 2577;\nmodule.exports = webpackAsyncContext;"],"names":["dialog","require","GUI","options","uiName","_contentFilename","_urlKey","admonitionLoader","marked","admonition","use","registerExtension","JSON","stringify","this","_notebook","toJSON","content","ipynb","parse","e","Error","toString","fromJSON","title","message","modal","notebook","keyboard_manager","body","$","html","buttons","OK","text","callback","textCancel","callbackCancel","choices","selected","selectMenu","forEach","c","i","item","addClass","click","parent","find","removeClass","append","handler","getState","_getDarkmode","darkmode","setState","updateDarkLight","mode","set_theme","notebook_name","location","reload","_events","events","_fully_loaded","Promise","resolve","reject","on","language","url","URL","window","href","searchParams","set","confirm","trigger","file","reader","FileReader","readAsText","onload","event","insert_cell_above","set_text","target","result","onerror","msg","name","loadPythonInCell","putFSRessource","_openFile","openPythonFile","bind","open","GUIBase","DomNodeBus","Map","obj","id","_bus","size","has","res","get","EvalQueue","ws","data","_queue","push","ready","popAndRun","shift","pop","_send_busy","parent_msg","_send","_format_msg","code","execution_count","execution_cout","setTimeout","kernelSafe","dispatchEvent","CLOSED","OPEN","BasthonWebSocket","basthonKernelAvailable","undefined","eval_queue","_basthonDomNodeBus","domNodeBus","onopen","call","then","_connectEvents","kernel","send_finished_and_continue","_send_idle","metadata","addEventListener","stream","_input_resolver","send_data","display_type","root","setAttribute","outerHTML","console","error","transcient","loaded","Jupyter","basthonGUI","onmessage","msg_type","channel","parent_header","header","session_id","session","msg_id","String","message_count","username","date","Date","toISOString","version","buffers","execution_state","status","src","slice","cursor_pos","kernelCompletions","complete","length","cursor_start","completions","matches","cursor_end","value","onclose","define","CodeMirror","bs","i18n","attr","appendTo","dialog_content","sanitize","mousedown","draggable","handle","_","default_button","footer","label","btn_opts","button","translate","fetch","proxy","last","focus","destroy","remove","cell","get_selected_cell","select","enable","command_mode","focus_button","disable","backdrop","kernel_modal","edit_metadata","error_div","css","message_cell","message_notebook","message_end","title_msg","textarea","md","dialogform","editor","fromTextArea","theme","lineNumbers","matchBrackets","indentUnit","autoIndent","modal_obj","Cancel","Edit","class","new_md","getValue","log","refresh","edit_metadata_button","edit_attachments","attachments_list","Object","keys","attachments","to_delete","refresh_attachments_list","key","btn","mime","deleted","_key","row","Apply","insert_image","file_input","$btn","files","_Events","Events","_original_trigger","apply","arguments","Jed","gettext","utils","_keycodes","browser","platform","extend","keycodes","inv_keycodes","names","split","n","primary","secondary","normalize_key","normalize_shortcut","shortcut","toLowerCase","replace","indexOf","sht","map","values","modifiers","sort","join","event_to_shortcut","which","altKey","ctrlKey","metaKey","shiftKey","ShortcutManager","delay","actions","env","config","_shortcuts","_defaults_bindings","extend_env","_cleartimeout","_config","_mode","seal","prototype","clearsoon","that","clearTimeout","clearqueue","flatten_shorttree","tree","dct","ftree","v2","subkey","get_action_shortcuts","get_action_shortcut","help","action","help_string","help_index","shortstring","a","b","clear_shortcuts","get_shortcut","_get_leaf","shortcut_array","set_shortcut","action_name","_set_leaf","_is_leaf","subtree","_remove_leaf","allow_node","is_available_shortcut","_is_available_shortcut","current_node","warn","_persist_shortcut","add_shortcut","patch","update","_persist_remove_shortcut","remove_shortcut","unbind_array","unbind","_parray","concat","unbind_patch","suppress_help_update","get_name","_shortcut","add_shortcuts","_add_default_shortcuts","ex","call_handler","only_modifier_event","exists","preventDefault","handles","shortcut_to_event","type","opts","Event","jprop","module_path","defineProperty","requirejs","enumerable","configurable","jglobal","_target","notificationwidget","NotificationWidget","NotificationArea","selector","element","widget_dict","widget","new_notification_widget","get_widget","div","timeout","busy","style","hide","inner","fadeOut","set_message","click_callback","icon","fadeIn","info","warning","danger","get_message","Page","header_div_selector","site_div_selector","header_div_element","site_div_element","bind_events","_handle_resize","_resize_site","resize","document","show","show_header","show_site","tagName","height","promises","app_initialized","google_caja","caja","noop","x","html4","sanitizeStylesheet","sanitizeAttribs","attribs","opt_naiveUriRewriter","opt_nmTokenPolicy","opt_logger","ATTRIBS","attribName","substr","attribKey","hasOwnProperty","sanitize_html","allow_css","ELEMENTS","eflags","UNSAFE","atype","STYLE","SCRIPT","record_messages","policy","change","sanitized","sanitizeWithPolicy","tagPolicy","h","style_tags","each","innerHTML","pathname","containerClass","idSuffix","virtualizeAttrName","sanitize_css","sanitize_stylesheets","sanitize_html_and_parse","sanitized_html","prev_htmlPrefilter","htmlPrefilter","parseHTML","moment","baseUrl","extensions_loaded","is_loaded","extension","ext_path","load_extension","module","load_ipython_extension","err","load_extensions","all","Array","requireModules","filter_extensions","nbext_config","active","nbext","_ANSI_COLORS","_pushColoredChunk","chunk","fg","bg","bold","underline","inverse","out","classes","styles","_getExtendedColors","numbers","r","g","some","RangeError","idx","Math","floor","_ansispan","str","match","ansi_re","start","exec","items","search","parseInt","substring","index","lastIndex","fixCarriageReturn","txt","base","insert","fixBackspace","tmp","url_path_join","encode_uri_components","uri","encodeURIComponent","navigator","tem","N","appName","ua","userAgent","M","appVersion","OSName","is_or_has","is","ajax_error_msg","jqXHR","responseJSON","traceback","statusText","log_ajax_error","XHR_ERROR","wrap_ajax_error","wrapped_error","xhr","xhr_status","xhr_error","ajax","settings","cache","BASTHON_CACHE_BUSTING_TIMESTAMP","_add_auth_header","headers","Authorization","xsrf_token","cookie","WrappedError","properties","getOwnPropertyNames","error_stack","create","time","js_idx_to_char_idx","js_idx","char_idx","char_code","charCodeAt","next_char_code","char_idx_to_js_idx","milliseconds","s","m","d","thresholds","relativeTimeThreshold","timeout_from_dt","dt","throttle","fn","pending","run","load_extensions_from_config","section","section_name","regex_split","separator","limit","separator2","lastLength","output","flags","ignoreCase","multiline","extended","sticky","lastLastIndex","RegExp","source","compliantExecNpcg","test","uuid","hexDigits","random","fixConsole","escape","fixOverwrittenChars","autoLinkUrls","points_to_pixels","points","pixel_per_point","width","get_body_data","val","basthonLanguage","decodeURIComponent","parse_url","createElement","url_path_split","path","lastIndexOf","url_join_encode","splitext","filename","escape_html","always_new","constructor","to_absolute_cursor_pos","cm","cursor","indexFromPos","from_absolute_cursor_pos","posFromIndex","get_url_param","is_focused","activeElement","mergeopt","_class","overwrite","options_default","requireCodeMirrorMode","errback","modename","modes","findModeByName","findModeByExtension","findModeByMIME","promising_ajax","success","load_class","class_name","module_name","registry","resolve_promises_dict","v","typeset","$el","jquery","MathJax","Hub","Queue","Ajax","InputJax","TeX","resetEquationNumbers","parse_b64_data_uri","format_datetime","fromNow","format_filesize","num","UNITS","Number","isFinite","neg","exponent","min","log10","pow","toPrecision","datetime_sort_helper","order","isBefore","isSame","dnd_contain_file","dataTransfer","types","change_favicon","link","oldLink","getElementById","rel","head","removeChild","appendChild","numericshaping","shaperType","_uiLang","_isMirroringEnabled","applyBidi","shapeNumerals","isMirroringEnabled","loadLocale","dir","locale","bidi","_shapeEuropean","fromCharCode","_shapeArabic","Reveal","configmod","complete_config","is_slideshow","get_cells","is_slide","is_subslide","get_slide_type","slide_type","slideshow","is_fragment","is_skip","is_notes","setScrollingSlide","scroll","filter","autoLaunch","autolaunch","revealMode","referrer","getPrototypeOf","get_cell_elements","container","outputObserver","toggleAllRiseButtons","fadeToggle","Unselecter","unselect","smartExec","smart_exec","execute_selected_cells","fragment_div","smart_exec_next_fragment","hasClass","execute_cell_and_select_below","reveal_actions","slide","MAX_VALUE","toggleOverview","riseHelp","RevealChalkboard","clear","reset","toggleChalkboard","toggleNotesCanvas","colorNext","colorPrev","download","RevealNotes","reveal_helpstr","reveal_default_bindings","updateRevealBindings","default_bindings","custom_shortcuts","reveal_shortcuts","setupKeys","key_str","reveal_bindings","command_shortcuts","edit_shortcuts","helpListItem","shortcut_str","help_str","shortcuts","first_entry","default_str","shortcutRepr","reveal_keys","cb_keys","no_keys","updated_keybindings","reveal_help","cb_help","no_help","firstSlide","lastSlide","openNotes","toggleNotesCanvaas","reveal_current_position","current_slide","getCurrentSlide","chunks","reveal_cell_index","cell_type","auto_select_fragment","subslide","fragment","slide_counter","subslide_counter","fragment_counter","cells","max","fragment_match","registerJupyterActions","toggle_slide_type","new_type","CellToolbar","rebuild_all","register","render","unrender","showConfig","api_call","help_button","exit_button","toggle","current_cell_index","get_selected_index","configure","minScale","removeEventListeners","children","disconnect","history","pushState","Remover","fixCellHeight","ensure_focused","restore_timeout","selected_slide","dot_index","stem","name_css","keyboard","dependencies","async","setting","enable_leap_motion","leap","enable_chalkboard","promise","initialized","initialize","autoSelectHook","$output","MutationObserver","WebKitMutationObserver","mutationRecords","mutation","addedNodes","sync","observerOptions","childList","characterData","attributes","observe","setupOutputObserver","start_slideshow_at","sync_timeout","overlay","backimage","overlay_body","overlay_div","addHeaderFooterOverlay","show_buttons_on_startup","Revealer","slide_section","subslide_section","new_slide","new_subslide","current_fragment","selected_cell_idx","selected_cell_slide","content_on_slide1","tag","j","next_cell","next_type","markupSlides","after","auto_select","auto_select_timeout","addButtonsAndShortcuts","toolbar","add_buttons_group","toolbar_icon","setup","hardwired_config","transition","slideNumber","controls","progress","center","margin","config_section_legacy","ConfigSection","base_url","load","config_section","nbext_configurator","rise","metadata_legacy","livereveal","configLoaded","load_jupyter_extension","IPython","sys_info","textNb","textKernel","warn_bad_name","ActionHandler","_actions","cmd","getAttribute","show_shortcuts_editor","shutdown_kernel","restart_kernel","restart_run_all","restart_clear_output","interrupt","execute_cell_and_insert_below","execute_all_cells","execute_cells_above","execute_cells_below","cut_cell_attachments","copy_cell_attachments","paste_cell_attachments","split_cell","edit_mode","select_prev","focus_cell","ncells","select_next","extend_selection_by","select_all","cut_cell","copy_cell","paste_cell_replace","paste_cell_above","paste_cell_below","insert_cell_below","cells_to_code","cells_to_markdown","cells_to_raw","to_heading","toggle_cells_outputs","toggle_cells_outputs_scroll","clear_cells_outputs","move_cell_down","move_cell_up","cell_toggle_line_numbers","quick_help","show_keyboard_shortcuts","delete_cell","undelete_cell","merge_cell_above","merge_cell_below","merge_selected_cells","get_selected_cells_indices","show_command_palette","line_numbers","code_mirror","setOption","pager","expanded","collapse","execCommand","close_and_halt","custom_ignore","get_cell","cur","getCursor","at_top","ch","setCursor","lastLine","at_bottom","scroll_manager","scroll_cell_percent","copy_notebook","trust_notebook","save_widget","rename_notebook","toggle_all_output","toggle_all_output_scroll","clear_all_output","save_checkpoint","openFile","share","selectCheckpoint","setContent","switchDarkLight","_prepare_handler","k","final_actions","fun","prefix","normalise","full_name","_data","name_or_data","init","cm_match","cm_closeb","cm_comment","overlayHack","scrollbarModel","horiz","minHeight","Cell","anchor","rendered","_metadata","celltoolbar","rebuild","_options","cm_config","user_highlight","class_config_data","class_config","get_sync","cell_config_data","ConfigWithDefaults","placeholder","cell_id","create_element","init_classes","readOnly","extraKeys","dragDrop","_on_click","dblclick","handle_codemirror_keyevent","line","keyCode","_ipkmIgnore","nLastLine","getLineHandle","moveanchor","set_insert_image_enabled","execute","handle_keyevent","lineCount","getLine","hasFocus","focus_editor","get_text","deletable","editable","collapsed","is_splittable","is_deletable","is_mergeable","is_editable","get_pre_cursor","getRange","get_post_cursor","last_line_num","end","show_line_numbers","toggle_line_numbers","getOption","force_highlight","auto_highlight","_auto_highlight","autoLoadMode","default_mode","current_mode","first_line","regs","reg","re","spec","magic_mode","defineMode","overlayMode","getMode","startState","firstMatched","inMagicLine","token","state","eat","eol","skipToEnd","UnrecognizedCell","sprintf","prompt","inner_cell","_instances","inner_element","global_hide","global_show","_callback_dict","_ui_controls_list","_presets","register_callback","cell_types","register_preset","preset_list","activate_preset","unregister_preset","list_presets","preset_name","preset","empty","ui_controls_list","callbacks","local_div","checkbox_ui_generator","setter","getter","button_container","chkb","lbl","input_ui_generator","keyup","register_events","select_ui_generator","list_list","opt","add_dialog_button","edit_attachments_dialog","attachments_preset","raw_edit","add_raw_edit_button","example_preset","raw_cell_preset","select_type","raw_mimetype","ui","keydown","enter","first","slideshow_preset","ns","array_difference","write_tag","add","tags","splice","preprocess_input","input","make_tag","on_remove","tag_UI","remove_button","add_tags_cellbar","tag_container","tag_map","jQuery","remove_tag","ok","tag_list","isArray","tag_name","init_tag_container","on_add","add_tag","input_container","old_tags","new_tags","added_tags","removed_tags","tag_dialog","add_tag_edit","tags_preset","jcbprefix","jcbsuffix","copy","getSelection","isCollapsed","selectionStart","selectionEnd","isProgrammaticCopy","clipboard","t","setData","store_json","get_selected_cells","clipboardData","paste","pix","six","getData","first_inserted","cell_data","new_cell","notebookOnlyEvent","enabled","setup_clipboard_events","full_action_name","entry_box","paste_close_dlg","paste_dlg","removeEventListener","cmdtrl","dialog_body","outputarea","completer","cmpython","cmip","commands","delSpaceToPrevTabStop","from","ranges","listSelections","replaceRange","Pos","tabsize","chToPrevTabStop","ceil","deleteH","CodeCell","tooltip","input_prompt_number","output_area","last_msg_id","focusout","autoCloseBrackets","highlight_modes","msg_cells","prompt_container","run_this_cell","prop","stopImmediatePropagation","input_area","getInputField","OutputArea","prompt_area","Completer","set_input_prompt","tooltip_closed","tab","remove_and_cancel_tooltip","down","time_before_tooltip","esc","_hidden","codemirrorIgnore","somethingSelected","getSelections","trim","request","startCompletion","set_kernel","stop_on_error","clear_output","old_msg_id","clear_callbacks_for_msg","get_callbacks","silent","store_history","handleFinished","evt","off","clear_on_done","shell","reply","_handle_execute_reply","payload","set_next_input","_handle_set_next_input","page","_open_with_pager","iopub","handle_output","handle_clear_output","_handle_input_request","append_raw_input","cont","nlines","setSelection","collapse_output","expand_output","expand","unscroll_area","scroll_output","scroll_if_long","toggle_output","toggle_output_scroll","toggle_scroll","input_prompt_classical","prompt_value","lines_number","input_prompt_continuation","input_prompt_function","number","nline","prompt_html","clear_input","setValue","wait","ignore_queue","clearHistory","trusted","outputs","scroll_state","scrolled","close","conf","parserConf","pythonConf","singleOperators","identifiers","defineMIME","parserConfig","gfm_mode","tex_mode","multiplexingMode","delimStyle","typeahead","QH","get_mode_for_action_id","form","field","mod","before_close","onSubmit","node","query","resultCount","action_id","group","display","display_text","short","humanize_sequence","mode_shortcut","emptyTemplate","maxItem","minLength","hint","template","searchOnFocus","mustSelectItem","onClickAfter","onResult","requestAnimationFrame","debug","prepend_n_prc","_existing_completion","completion_array","skip_kernel_completion","done","carry_on_completion","reinvoke_re","reinvoke","pre_cursor","block","first_invocation","autopick","finish_completing","results","contextHint","filtered_results","to","unshift","raw_result","visible","sel","pick","_handle_keydown","_handle_keypress","keypress","top","pos","cursorCoords","left","cheight","wheight","bottom","build_gui_list","completion","scrollTop","selectedIndex","backspace","sh","B","drop_prct","A","min_lead_prct","localmin","tem1","tem2","shared_start","up","pageup","pagedown","right","charCode","getTokenAt","list","clist","getCompletions","found","l","tk","className","arr","arrayContains","string","getAllTokens","kernelspecs","KernelSelector","set_kernelselector","current_selection","kernelselector","_finish_load","_loaded","request_kernelspecs","_got_kernelspecs","_sorted_names","da","display_name","db","change_kernel_submenu","new_notebook_submenu","baseURL","origin","ks","new_notebook","_spec_changed","cur_kernel_entry","prepend","logo_img","resources","css_url","kernel_mod","new_ks","save_notebook","_set_kernel","available","_session_starting","_spec_not_found","no_kernel_msg","kernel_name","w","_basthonEmptyContent","lock_switch","KeyboardManager","last_mode","get_default_common_shortcuts","get_default_command_shortcuts","get_default_edit_shortcuts","edit_unbind","command_unbind","edit","TypeError","u","command","originalEvent","handle_keydown","set_notebook","set_quickhelp","handle_blur","blur","MainToolBar","ToolBar","_make","grps","Button","construct","_pseudo_actions","add_celltype_list","multiselect","removeAttr","_warn_heading","MATHSPLIT","process_math","pre_process","math","blocks","Config","tex2jax","inlineMath","displayMath","processEscapes","processEnvironments","MathML","extensions","displayAlign","availableFonts","imageFont","preferredFont","webFont","linebreaks","automatic","Configured","mathjax_url","remove_math","braces","de_tilde","tilde","wholematch","character","T","D","charAt","replace_math","math_group","tour","MenuBar","contents","Tour","add_bundler_items","bundlers","bundlerextensions","bundler_id","bundler","$li","_bundle","_new_window","dirty","writable","notebook_path","_nbconvert","format","_size_header","ev","parentElement","_add_celltoolbar_list","id_actions_dict","id_act","reconnect","update_restore_checkpoint","checkpoints","langinfo","language_info","update_nbconvert_script","info_reply","add_kernel_help_links","help_links","submenu","preset_added","presets","ul","checkpoint","last_modified","restore_checkpoint_dialog","el","langname","toUpperCase","file_extension","divider","about","prev","before","next","toUrl","cellmod","textcell","codecell","runMode","mathjaxutils","default_celltoolbar","rawcell_celltoolbar","slideshow_celltoolbar","attachments_celltoolbar","tags_celltoolbar","scrollmanager","commandpalette","shortcuteditor","ShortcutEditor","_SOFT_SELECTION_CLASS","soft_selected","Notebook","validate_config","Tooltip","ws_url","_last_modified","_ff_beforeunload_fired","ScrollManager","setOptions","gfm","tables","langPrefix","highlight","lang","kernel_busy","clipboard_attachments","undelete_backup_stack","paste_enabled","paste_attachments_enabled","set_dirty","_checkpoint_after_save","last_checkpoint","autosave_interval","autosave_timer","minimum_autosave_interval","notebook_name_blacklist_re","nbformat","nbformat_minor","current_nbformat_minor","codemirror_mode","create_elements","kernel_selector","_changed_on_disk_dialog","default_cell_type","Header","Toolbar","kill_kernel","code_cell","cm_keymap","keyMap","end_space","find_cell_index","warn_nbformat_minor","extendSelection","handle_edit_mode","handle_command_mode","existing_spec","kernelspec","isEqual","start_session","kinfo","existing_info","cm_mode","set_codemirror_mode","extrap","new_height","duration","outerHeight","animate","app_height","splitter_height","onbeforeunload","backup","CommandPalette","orig_vs","this_vs","scroll_to_cell","percent","sme","st","offset","scroll_value","scroll_to_bottom","scrollHeight","scroll_to_top","not","get_cell_element","eq","get_msg_cell","toArray","ce","get_next_cell","is_valid_cell_index","toggle_all_line_numbers","get_prev_cell","index_or_selected","get_anchor_index","delta","update_soft_selection","i1","i2","low","high","_contract_selection","sindex","level","get_edit_index","move_selection_up","indices","anchored","tomove","pivot","detach","move_selection_down","_unsafe_delete_cell","delete_cells","undelete_backup","below","cursor_ix_before","deleting_before_cursor","new_ncells","cursor_ix_after","insert_cell_at_index","cell_options","MarkdownCell","RawCell","_insert_element_at_index","insert_cell_at_bottom","len","to_code","source_cell","target_cell","to_markdown","TextCell","to_raw","set_heading_level","enable_paste","disable_paste","cell_json","insertion_index","render_cell_output","cell_index","texta","textb","merge_cells","into_last","was_rendered","old_class","new_class","getElementsByClassName","cl","classList","documentElement","switch_theme","new_theme","insert_inline_image_from_blob","enable_attachments_paste","disable_attachments_paste","collapse_all_output","expand_all_output","scroll_all_output","_dispatch_mode","newmode","_mode_equal","mode1","mode2","SessionAlreadyStarting","_session_started","failure","_session_start_failed","restart","Session","jqxhr","restart_options","_restart_kernel","shutdown_options","kernel_action","resolve_promise","do_kernel_action","kernelRestart","is_connected","close_window","execute_cells","execute_cell","execute_cell_range","get_notebook_name","set_notebook_name","test_notebook_name","nbname","new_cells","orig_nbformat","orig_nbformat_minor","cell_array","set_autosave_interval","interval","clearInterval","setInterval","check_last_modified","model","getTime","_save","save","save_notebook_success","last_modified_check_margin","Reload","Overwrite","_update_autosave_interval","create_checkpoint","save_notebook_as","current_dir","Save","nb_path","nb_name","save_thunk","warning_body","from_notification","nb","Trust","trust","ensure_extension","ext","rename","new_name","new_path","json","load_notebook","load_notebook_success","load_notebook_error","failed","nbmodel","oldmsg","newmsg","k_selector","isSanitized","stack","cookieEnabled","add_checkpoint","list_checkpoints","list_checkpoints_success","create_checkpoint_success","Revert","restore_checkpoint","restore_checkpoint_success","delete_checkpoint","delete_checkpoint_success","notificationarea","NotebookNotificationArea","init_notification_widgets","init_kernel_notification_widget","knw","$kernel_ind_icon","$modal_ind_icon","$readonly_ind_icon","$body","busy_favicon_timer","set_busy_favicon","update_document_title","attempt","the_dialog","dismiss","showMsg","full","short_message","cm_elem","cm_open","init_notebook_notification_widget","nnw","init_trusted_notebook_notification_widget","tnw","security","wrapper","clear_queued","_display_id_targets","config_defaults","handle_appended","stream_chunk_size","collapse_button","prompt_overlay","_should_scroll","threshold","minimum_scroll_threshold","auto_scroll_threshold","fontSize","lineHeight","parseFloat","scroll_area","should_scroll","output_type","ename","evalue","append_output","MIME_JAVASCRIPT","MIME_HTML","MIME_MARKDOWN","MIME_LATEX","MIME_SVG","MIME_PNG","MIME_JPEG","MIME_GIF","MIME_PDF","MIME_TEXT","_get_metadata_key","mime_md","output_types","validate_mimebundle","bundle","_needs_height_reset","record_output","update_display_data","append_execute_result","append_stream","append_error","append_unrecognized","append_display_data","create_output_area","oa","create_output_subarea","subarea","iframe","contentDocument","write","_append_javascript_error","_safe_append","toinsert","toreplace","replaceWith","output_prompt_classical","output_prompt_function","_record_display_id","inserted","append_mime_type","tb","append_text","append_map","subclass","pre","last_newline_idx","tail","handle_inserted","targets","display_id","safe_outputs","display_order","parsed","append_html","dblclick_to_reset_size","append_markdown","markdown","text_and_math","renderer","Renderer","tablecell","align","append_javascript","js","eval","append_svg","svg_html","svg","svg_area","img","set_width_height","append_png","png","append_jpeg","jpeg","append_gif","gif","append_pdf","pdf","append_latex","latex","area","input_type","password","_submit_raw_input","raw_input","theprompt","theinput","echo","ignore_clear_queue","Basthon","pendingInput","getBoundingClientRect","out2","mime_types","register_mime_type","mimetype","safe","Pager","pager_selector","pager_element","pager_button_area","_default_end_space","resizable","_resize","create_button_area","pager_body","clone","htm","notebook_loaded","one","platform_specific","QuickHelp","cmd_ctrl","humanize_map","cm_shortcuts","default_humanize_map","special_case","humanize_key","sequence","humanize_shortcut","_humanize_shortcut","joinchar","force_rebuild","shortcut_dialog","doc","key_div","build_key_names","cmd_div","build_command_help","edit_div","build_edit_help","Close","half","key_names_mac","sub_div","col1","col2","build_one","cmdkey","build_div","edit_button","enterkey","merge","_humanize_sequence","SaveWidget","_checkpoint_date","update_notebook_name","update_address_bar","set_save_status","_set_last_checkpoint","set_autosaved","replaceState","_render_checkpoint","_schedule_render_checkpoint","human_date","chkd","long_date","calendar","_checkpoint_timeout","animation_speed","onScroll","func","rate","_timeout","scroll_some","scroll_to","pages","get_first_visible_cell","cell_count","first_cell_top","avg_cell_height","is_cell_visible","cell_rect","scroll_rect","TargetScrollManager","is_target","selected_index","SlideScrollManager","HeadingScrollManager","_level","heading_level","current_scroll","header_scroll","cutAfter","getMatches","caseSensitive","escape_hatch","abort","action_all","isRegExpButton","allCellsButton","isCaseSensitiveButton","findFormGroup","replaceFormGroup","isCaseSensitive","RegExpOrNot","onError","onChange","sre","replaceValue","_hb","aborted","replacer_reg","current_line","match_abort","mindex","stop","initial","replaced","compute_preview_model","get_all_text","warnmsg","matchmsg","ngettext","rindex","build_preview","onsubmit","newvalue","snr","React","ReactDOM","createReactClass","KeyBinding","displayName","getInitialState","shrt","handleShrtChange","props","binding_setter","onAddBindings","ckey","alt","onClick","raw","KeyBindingList","componentDidMount","binding","assign","dangerouslySetInnerHTML","__html","hshortcuts","get_shortcuts_data","createRoot","ipgfm","lineWrapping","render_area","add_attachment","mime_type","b64_data","get_rendered","set_rendered","gc_attachments","infostring","escaped","config_default","drag_counter","blob","encodeURI","onloadend","img_md","readAsDataURL","addBack","hash","att","attachment_regex","getWrapperElement","kind","stopPropagation","getAsFile","group_id","btn_group","_pseudo_action","_old_cell","_old_request","_consecutive_counter","_sticky","_hide_if_no_docstring","expandlink","morelink","morespan","showInPager","closelink","closespan","_clocklink","clockspan","cancel_stick","arrow","tabs_functions","_request_tooltip","stick","reset_tabs_function","is_visible","_reply","_hide","force","cancel_pending","_tooltip_timeout","hide_if_no_docstring","last_token_re","_show","inspect","_stick_timeout","cm_pos","position","cell_pos","offsetParent","center_left","edge_left","arrow_left","NotebookTour","step_duration","tour_steps","placement","orphan","onShow","command_icon_hack","onNext","onHide","storage","reflex","animation","onStart","onPause","toggle_pause_play","onResume","steps","ended","toggleClass","_one_load_finished","_finish_firstload","api_url","_load_done","newdata","defaults","classname","_class_data","d2","Contents","DIRECTORY_NOT_EMPTY_ERROR","DirectoryNotEmptyError","url_parts","create_basic_error_handler","get_untitled","params","param","processData","dataType","beforeSend","overrideMimeType","languageCodemirror","python3","sql","javascript","ocaml","nbconvert_exporter","new_untitled","contentType","from_file","to_dir","copy_from","checkpoint_id","list_contents","CommManager","comms","init_kernel","msg_types","register_iopub_handler","new_comm","target_name","comm_id","comm","Comm","register_comm","register_target","f","unregister_target","unregister_comm","comm_open","target_module","response","comm_close","handle_close","comm_msg","handle_msg","_msg_callback","_close_callback","send_shell_message","send","_register_callback","on_msg","on_close","_callback","serialize","bws","Kernel","kernel_service_url","_stopping","kernel_url","protocol","host","_msg_callbacks","_msg_callbacks_overrides","_display_id_to_parent_ids","_msg_queue","WebSocket","MozWebSocket","alert","init_iopub_handlers","comm_manager","last_msg_callbacks","_autorestart_attempt","_reconnect_attempt","reconnect_limit","_pending_messages","_get_msg","send_input_reply","record_status","output_msg_types","_iopub_handlers","_handle_status_message","_handle_clear_output","_handle_input_message","_handle_output_message","_on_error","qs","_on_success","_kernel_created","get_info","kill","_kernel_dead","kernel_info","stop_channels","start_channels","_kernel_connected","ws_host_url","already_called_onclose","ws_closed_late","_ws_closed","_ws_opened","_handle_ws_message","_schedule_reconnect","reconnect_attempt","readyState","is_fully_disconnected","set_callbacks_for_msg","comm_info","detail_level","user_expressions","allow_stdin","get_iopub_handler","get_callbacks_for_msg","get_output_callbacks_for_msg","get_output_callback_id","callback_id","overrides","display_ids","msg_ids","_finish_shell","shell_done","iopub_done","_finish_iopub","remember","cbcopy","output_callback_overrides_push","output_callbacks","output_callback_overrides_pop","callback_ids","deserialize","_finish_ws_message","_handle_shell_reply","_handle_iopub_message","parent_id","shell_callbacks","_handle_payloads","payloads","payload_callbacks","parent_ids","update_msg","_deserialize_array_buffer","buf","DataView","nbufs","getUint32","offsets","json_bytes","Uint8Array","TextDecoder","decode","byteLength","Blob","readAsArrayBuffer","_deserialize_binary","buffer","ArrayBuffer","json_utf8","TextEncoder","encode","msg_buf","view","setUint32","_serialize_binary","notebook_model","kernel_model","session_service_url","session_url","kernelAvailable","kernelLoader","on_success","_get_model","_update_model","webpackAsyncContext","req","__webpack_require__","o","ids","exports","webpackContext","webpackContextResolve"],"sourceRoot":""}