<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title data-i18n="title">PGZ Studio</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">    
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">  
<style>
/* ========================================
   –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –°–¢–û–†–Ü–ù–ö–ò
   ======================================== */
#page-loader {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999999;
}

.spinner {
  width: 60px;
  height: 60px;
  border: 6px solid #444;
  border-top-color: #4caf50;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
    <link rel="stylesheet" href="./lib/cm/codemirror.css">    
    <link rel="stylesheet" href="./lib/cm/cobalt.css">
    <link rel="stylesheet" href="./lib/cm/blackboard.css">
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="./new-message.css">
    <link rel="stylesheet" href="./lib/font-awesome.min.css">   
    <link rel="stylesheet" href="./jquery/ui/1.13.3/themes/base/jquery-ui.css">
 </head>
<body>
	<div id="page-loader">
		<div class="spinner"></div>
	</div>
	<!-- CodeMirror -->
    <script src="./lib/cm/codemirror.js"></script>
    <script src="./lib/cm/active-line.js"></script>
    <script src="./lib/cm/show-hint.js"></script>
    <script src="./lib/cm/python.js"></script>
    <script src="./lib/cm/xml.js"></script>
    <script src="./lib/cm/javascript.js"></script>
    <script src="./lib/cm/css.js"></script>
    <script src="./lib/cm/htmlmixed.js"></script>    
    <script src="./lib/cm/dialog.js"></script>       
    <script src="./lib/cm/searchcursor.js"></script>
    <script src="./lib/cm/search.js"></script>
    <script src="./lib/cm/searchbox.js"></script>   
    <!-- –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ -->
    <script src="./lib/base.js"></script>
<!--
    <script src="./jquery/jquery-3.7.1.js"></script>
    <script src="./jquery/ui/1.13.3/jquery-ui.js"></script> 
    <script src="./lib/jq/jquery.ui.touch-punch.min.js"></script>
-->
    <script src="./lib/lib.js"></script>
    <script src="./lib/skulpt/skulpt.min.js"></script>
    <script src="./lib/skulpt/skulpt-stdlib.js"></script>
    <script src="./lib/extlibs.js"></script>
    <script src="./lib/jsfs2.js"></script>    
    <script src="./lib/jszip.min.js"></script>
    <script src="./lib/FileSaver.min.js"></script>
<style>

/* ========================================
   –ì–ê–õ–ï–†–ï–Ø –†–ï–°–£–†–°–Ü–í
   ======================================== */
.assets-items-scroll {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  gap: 10px;
  padding: 8px;
  margin: 0;
  min-height: 60px;
  max-width: 400px;
  overflow-y: auto;
  align-items: flex-start;
}

.assets-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  width: 90px;
  text-align: center;
  font-size: 12px;
  color: #333;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.assets-item .thumb-container {
  width: 80px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #eee;
  border-radius: 4px;
  margin-bottom: 4px;
}

.assets-item img.thumb {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.audio-icon {
  font-size: 24px;
  margin-bottom: 4px;
}

/* ========================================
   –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –°–¢–í–û–†–ï–ù–ù–Ø –ü–†–û–Ñ–ö–¢–£
   ======================================== */
#newProjectModal input[type="text"],
#newProjectModal input[type="number"],
#newProjectModal textarea,
#newProjectModal select {
  transition: all 0.3s ease;
}

#newProjectModal input[type="text"]:focus,
#newProjectModal input[type="number"]:focus,
#newProjectModal textarea:focus,
#newProjectModal select:focus {
  outline: none;
  border-color: #4caf50;
  box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.3);
}

#newProjectModal input:disabled,
#newProjectModal textarea:disabled {
  background-color: #444;
  color: #888;
  cursor: not-allowed;
}

@keyframes modalFadeIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

#newProjectModal > div {
  animation: modalFadeIn 0.3s ease-out;
}

#newProjectModal label {
  display: flex;
  align-items: center;
  gap: 5px;
}

#newProjectModal label::before {
  content: '‚Ä¢';
  color: #4caf50;
  font-size: 20px;
  line-height: 1;
}

#newProjectModal button {
  position: relative;
  overflow: hidden;
}

#newProjectModal button::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

#newProjectModal button:active::after {
  width: 300px;
  height: 300px;
}

/* ========================================
   –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –§–ê–ô–õ–Ü–í (–ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø/–í–Ü–î–ù–û–í–õ–ï–ù–ù–Ø)
   ======================================== */
#saveModal {
  z-index: 9999;
}

#saveModal .modal-content {
  max-width: 600px;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫-–∫–∞—Ä—Ç */
.files-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 10px;
}

/* –ö–Ω–æ–ø–∫–∞-–∫–∞—Ä—Ç–∞ (–∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) - —Ç–µ–ø–µ—Ä –ª–µ–π–±–ª */
.file-action-button {
  display: flex;
  flex-direction: column;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  border-radius: 10px;
  padding: 16px;
  border: 1px solid #dee2e6;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.2s ease;
  cursor: pointer;
  text-align: left;
  font-family: inherit;
  color: inherit;
  text-decoration: none;
  width: 100%;
  min-height: 120px;
  box-sizing: border-box;
  position: relative;
}

/* –°–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Å—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É */
.file-upload-button {
  position: relative;
  overflow: hidden;
  cursor: pointer;
}

.file-upload-button input[type="file"] {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
}

/* –ï—Ñ–µ–∫—Ç–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
.file-action-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
  border-color: #adb5bd;
}

.file-action-button:active {
  transform: translateY(0);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

/* –§–æ–∫—É—Å –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ */
.file-action-button:focus,
.file-action-button:focus-within {
  outline: none;
  box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.3);
  border-color: #007bff;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ä—Ç–∫–∏ */
.card-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 12px;
  padding-bottom: 10px;
  border-bottom: 2px solid #e9ecef;
}

.card-header i {
  font-size: 20px;
  color: #495057;
}

.card-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: #212529;
}

/* –¢—ñ–ª–æ –∫–∞—Ä—Ç–∫–∏ */
.card-body {
  padding: 12px 0 0 0;
  flex-grow: 1;
  display: flex;
  flex-direction: column;
}

.card-body p {
  margin: 0 0 16px 0;
  font-size: 13px;
  color: #495057;
  line-height: 1.5;
}

/* –ü—ñ–¥–∫–∞–∑–∫–∞ –ø—Ä–æ –≥–∞—Ä—è—á—ñ –∫–ª–∞–≤—ñ—à—ñ */
.shortcut-hint {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: auto;
  padding: 8px 12px;
  background-color: rgba(0, 0, 0, 0.05);
  border-radius: 4px;
  font-size: 12px;
  color: #6c757d;
  border-left: 3px solid #28a745;
}

.shortcut-hint i {
  font-size: 14px;
}

/* –ö–æ–ª—å–æ—Ä–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –∫–Ω–æ–ø–æ–∫ */
#btn_show_recover_label {
  background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
}

#btn_show_recover_label .card-header i,
#btn_show_recover_label .card-header h3 {
  color: #fff;
}

#btn_show_recover_label .card-header {
  border-bottom-color: rgba(255, 255, 255, 0.2);
}

#btn_show_recover_label .card-body p {
  color: #e9ecef;
}

#btn_show_recover_label:hover {
  background: linear-gradient(135deg, #5a6268 0%, #4e555b 100%);
  border-color: #4e555b;
}

#btnDownloadLabel {
  background: linear-gradient(135deg, #28a745 0%, #218838 100%);
}

#btnDownloadLabel .card-header i,
#btnDownloadLabel .card-header h3 {
  color: #fff;
}

#btnDownloadLabel .card-header {
  border-bottom-color: rgba(255, 255, 255, 0.2);
}

#btnDownloadLabel .card-body p {
  color: #e9ecef;
}

#btnDownloadLabel .shortcut-hint {
  background-color: rgba(255, 255, 255, 0.1);
  border-left-color: #fff;
  color: #fff;
}

#btnDownloadLabel:hover {
  background: linear-gradient(135deg, #218838 0%, #1e7e34 100%);
  border-color: #1e7e34;
}

.file-upload-button {
  background: linear-gradient(135deg, #007bff 0%, #0069d9 100%);
}

.file-upload-button .card-header i,
.file-upload-button .card-header h3 {
  color: #fff;
}

.file-upload-button .card-header {
  border-bottom-color: rgba(255, 255, 255, 0.2);
}

.file-upload-button .card-body p {
  color: #e9ecef;
}

.file-upload-button:hover {
  background: linear-gradient(135deg, #0069d9 0%, #0062cc 100%);
  border-color: #0062cc;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
@media (max-width: 600px) {
  .files-container {
    gap: 12px;
  }
  
  .file-action-button {
    padding: 14px;
    min-height: 110px;
  }
  
  .card-header h3 {
    font-size: 14px;
  }
  
  .card-body p {
    font-size: 12px;
  }
  
  .shortcut-hint {
    font-size: 11px;
    padding: 6px 10px;
  }
}

/* –¢–µ–º–Ω–∞ —Ç–µ–º–∞ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ */
#saveModal .modal-dark {
  background-color: #1a1a1a;
}

#saveModal .modal-title {
  color: #e0e0e0;
}

#saveModal .modal-body {
  color: #d4d4d4;
}

/* –ê–Ω—ñ–º–∞—Ü—ñ—ó */
@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#saveModal .modal-content {
  animation: modalSlideIn 0.3s ease-out;
}

/* ========================================
   –ú–û–î–ê–õ–¨–ù–ï –í–Ü–ö–ù–û –í–Ü–î–ù–û–í–õ–ï–ù–ù–Ø
   ======================================== */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  backdrop-filter: blur(4px);
}

.modal-content {
  background-color: #1e1e1e;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
  width: 90%;
  max-width: 900px;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  border: 1px solid #3a3a3a;
}

.modal-dark {
  background-color: #1a1a1a;
}

.modal-header {
  padding: 18px 24px;
  border-bottom: 1px solid #333;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-title {
  margin: 0;
  font-size: 18px;
  color: #e0e0e0;
  font-weight: 500;
}

.modal-close {
  background: none;
  border: none;
  font-size: 32px;
  cursor: pointer;
  color: #aaa;
  padding: 0;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  border-radius: 6px;
}

.modal-close:hover {
  color: #fff;
  background-color: rgba(255, 255, 255, 0.1);
}

.modal-body {
  padding: 24px;
  overflow-y: auto;
  flex-grow: 1;
  color: #d4d4d4;
  font-size: 14px;
  line-height: 1.6;
}

/* –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∞ —Å–µ–∫—Ü—ñ—è */
.modal-info {
  margin-bottom: 20px;
  padding: 15px;
  background-color: rgba(50, 50, 50, 0.5);
  border-radius: 8px;
  border-left: 4px solid #5c7aff;
}

.info-text {
  margin: 0 0 8px 0;
  color: #c5c5c5;
}

.info-count {
  margin: 0;
  font-weight: 500;
  color: #75beff;
}

.info-count span {
  color: #5c7aff;
  font-size: 16px;
  font-weight: 600;
}

/* –°–ª–∞–π–¥–µ—Ä */
.slider-container-recover {
  margin: 20px 0;
  width: 100%;
}

#slider_recover {
  margin-bottom: 12px;
  width: 100%;
}

.ui-slider {
  height: 6px;
  background: #333;
  border-radius: 3px;
  border: none;
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.3);
}

.ui-slider-range {
  background: linear-gradient(90deg, #5c7aff, #75beff);
  border-radius: 3px;
  height: 6px;
}

.ui-slider-handle {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: #5c7aff;
  border: 3px solid #1a1a1a;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(92, 122, 255, 0.4);
  outline: none;
  transition: transform 0.2s ease;
}

.ui-slider-handle:hover {
  transform: scale(1.2);
}

.ui-slider-handle:focus {
  box-shadow: 0 0 0 3px rgba(92, 122, 255, 0.3);
}

.recover-time-info {
  color: #c5c5c5;
  font-size: 13px;
  margin-top: 20px;
}

.recover_date {
  font-weight: 600;
  color: #75beff;
  margin: 4px 0;
  font-size: 14px;
}

.recover_label {
  font-size: 12px;
  color: #888;
  margin: 4px 0;
}

#recover_time_hours,
#recover_time_mins {
  font-family: 'Courier New', monospace;
  font-weight: bold;
  color: #5c7aff;
  margin: 0 2px;
}

/* –§—Ä–µ–π–º –ø–µ—Ä–µ–≥–ª—è–¥—É –∫–æ–¥—É */
.code-preview-frame {
  margin: 20px 0;
  border: 1px solid #333;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.preview-header {
  background-color: #252526;
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #333;
}

.preview-title {
  font-weight: 600;
  color: #75beff;
  font-size: 14px;
}

.preview-file-name {
  color: #858585;
  font-size: 12px;
  font-family: 'Courier New', monospace;
}

.preview-content {
  padding: 16px;
  background-color: #000;
  min-height: 250px;
  max-height: 400px;
  overflow-y: auto;
  font-family: monospace;
  font-size: 13px;
  line-height: 1.6;
}

.preview-content::-webkit-scrollbar {
  width: 8px;
}

.preview-content::-webkit-scrollbar-track {
  background: #1a1a1a;
  border-radius: 4px;
}

.preview-content::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 4px;
  border: 2px solid #1a1a1a;
}

.preview-content::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.code-preview {
  margin: 0;
  white-space: pre;
  word-wrap: normal;
  color: #d4d4d4;
  font-family: monospace;
  overflow-x: auto;
  height: 200px;
  font-size: 11px;
  line-height: 0.9em;
}

.code-preview::-webkit-scrollbar {
  height: 8px;
}

.code-preview::-webkit-scrollbar-track {
  background: #1a1a1a;
}

.code-preview::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 4px;
}

.code-preview::-webkit-scrollbar-thumb:hover {
  background: #555;
}

/* –°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è (–±–∞–∑–æ–≤–∏–π) */
.code-preview .keyword {
  color: #569cd6;
}

.code-preview .string {
  color: #ce9178;
}

.code-preview .comment {
  color: #6a9955;
}

.code-preview .function {
  color: #dcdcaa;
}

.code-preview .number {
  color: #b5cea8;
}

/* –ö–Ω–æ–ø–∫–∏ –¥—ñ–π */
.modal-actions {
  margin: 20px 0;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

.btn-primary,
.btn-danger {
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.btn-primary {
  background-color: #4caf50;
  color: white;
}

.btn-primary:hover {
  background-color: #4a6bff;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(92, 122, 255, 0.4);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-danger {
  background-color: #dc3545;
  color: white;
  margin-top: 10px;
}

.btn-danger:hover {
  background-color: #c82333;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
}

.btn-danger:active {
  transform: translateY(0);
}

/* –°–µ–∫—Ü—ñ—è –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å */
.warning-section {
  margin-top: 20px;
  padding: 18px;
  background-color: rgba(66, 45, 0, 0.4);
  border: 1px solid #5c4b00;
  border-radius: 8px;
  border-left: 4px solid #ffc107;
}

.warning-text {
  margin: 0 0 10px 0;
  color: #e0e0e0;
}

.warning-caution {
  margin: 8px 0;
  color: #ffc107;
  font-size: 13px;
}

.warning-caution i {
  color: #ffc107;
  margin-right: 6px;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
@media (max-width: 768px) {
  .modal-content {
    width: 95%;
    margin: 10px;
  }
  
  .modal-body {
    padding: 16px;
  }
  
  .modal-header {
    padding: 14px 16px;
  }
  
  .modal-title {
    font-size: 18px;
  }
  
  .preview-content {
    min-height: 200px;
    max-height: 300px;
  }
}

/* –ê–Ω—ñ–º–∞—Ü—ñ—ó */
@keyframes modalFadeIn {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.modal-content {
  animation: modalFadeIn 0.3s ease-out;
}

/* –¢—ñ–Ω—å –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ –Ω–∞ —Å–ª–∞–π–¥–µ—Ä */
.ui-slider:hover {
  box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.5);
}

/* ========================================
   –°–¢–ò–õ–Ü –î–õ–Ø –ö–ù–û–ü–û–ö –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
   ======================================== */
.save_option {
  background: #82ffab !important;
  padding: 15px !important;
  border-radius: 8px !important;
  cursor: pointer !important;
  transition: all 0.3s ease !important;
  text-align: center !important;
  margin-bottom: 15px !important;
}

.save_option:hover {
  background: #6cff96 !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

.save_option h2,
.save_option h3 {
  margin: 5px 0 !important;
  color: #000 !important;
  font-size: 18px !important;
}

.save_option p {
  margin: 8px 0 !important;
  color: #000 !important;
  font-size: 13px !important;
}

.box__input {
  background-color: #e9ff89 !important;
  border-radius: 0.3rem !important;
  padding: 1rem !important;
  border: 1px solid #ccc !important;
  cursor: pointer !important;
  transition: all 0.3s ease !important;
  text-align: center !important;
}

.box__input:hover {
  background-color: #dfff69 !important;
  transform: scale(1.02) !important;
}

/* –°—Ç–∏–ª—ñ –¥–ª—è —Ä–∞–¥—ñ–æ–∫–Ω–æ–ø–æ–∫ */
.ui-dialog input[type="radio"] {
  margin-right: 8px !important;
  cursor: pointer !important;
}

.ui-dialog label[for^="radio_"] {
  margin-right: 20px !important;
  cursor: pointer !important;
}

/* –°–ª–∞–π–¥–µ—Ä–∏ */
.slider {
  margin: 15px 0 !important;
}

/* –°—Ç–∏–ª—ñ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–í—ñ–¥–Ω–æ–≤–∏—Ç–∏" */
#btn_show_recover {
  background: none !important;
  border: none !important;
  padding: 0 !important;
  cursor: pointer !important;
  display: block !important;
  margin: 20px auto 0 !important;
}

#btn_show_recover button {
  background: #ff9800 !important;
  color: white !important;
  border: none !important;
  padding: 8px 16px !important;
  border-radius: 6px !important;
  cursor: pointer !important;
  font-size: 14px !important;
  transition: background 0.3s !important;
}

#btn_show_recover button:hover {
  background: #f57c00 !important;
}

/* –°—Ç–∏–ª—ñ –¥–ª—è —ñ–∫–æ–Ω–æ–∫ Font Awesome */
.ui-dialog .fa {
  margin-right: 8px !important;
  color: #4caf50 !important;
}

/* –°—Ç–∏–ª—ñ –¥–ª—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª–∞–º–∏ */
#file-btn {
  display: none !important;
}

/* ========================================
   –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø –°–õ–ê–ô–î–ï–†–Ü–í
   ======================================== */
.slider-container-settings {
  display: flex;
  flex-direction: column;
  gap: 6px;
  width: 100%;
}

.slider-value {
  width: 70px;
  text-align: center;
}

.slider-native {
  width: 100%;
}

.slider-recover-native {
  width: 600px;
}
</style>

	
<div id="pgz-playground" >
  <!-- –∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫—É –≥—Ä–∏ –¥–ª—è standalone-mode -->
  <button id="playGameBtn" style="
	    display:none;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 200px;
        height: 200px;
        background: url('./media/play-game.png') no-repeat center center;
        background-size: contain;
        border: none;
        cursor: pointer;
        transition: opacity 0.3s ease;
        z-index: 10;
    "></button>	
<!-- –≤–µ—Ä—Ö–Ω—è –ø–∞–Ω–µ–ª—å -->
<div id="topPanel" style="display: none;">
  <!-- –ª—ñ–≤–∞ —á–∞—Å—Ç–∏–Ω–∞: –∫–Ω–æ–ø–∫–∏ (—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏) -->
  <div id="toolPanel" class="toolPanel">
    <img title="–í–∏–∫–æ–Ω–∞—Ç–∏" data-i18n-title="run_title" alt="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å, —â–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥" data-i18n-alt="run_alt" id="btn_run" class="toolButton" src="./media/play.png">
    <img title="–ü—Ä–∏–ø–∏–Ω–∏—Ç–∏" class="toolButton" src="./media/stop.png" id="btn_stopRunning" style="display:none;">
    <img alt="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å, —â–æ–± –ø–æ–∫–∞–∑–∞—Ç–∏/—Å—Ö–æ–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏" data-i18n-alt="tools_alt" title="–ü–æ–∫–∞–∑–∞—Ç–∏/—Å—Ö–æ–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏" data-i18n-title="tools_title" class="toolButton" src="./media/ttools.png" id="btn_tools1" style="display:none;">
    <img title="–í—ñ–¥–∫—Ä–∏—Ç–∏ –∫–æ–Ω—Å–æ–ª—å" data-i18n-title="console_title" alt="–ö–æ–Ω—Å–æ–ª—å - –ø–æ–∫–∞–∑–∞—Ç–∏ –∞–±–æ —Å—Ö–æ–≤–∞—Ç–∏ –≤—ñ–∫–Ω–æ –∫–æ–Ω—Å–æ–ª—ñ" data-i18n-alt="console_alt" class="toolButton" src="./media/console.png" onclick="showConsole()">
    <img title="–ù–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç" class="toolButton" src="./media/new-project.png" onclick="createNewProject()">
    <img title="–í—ñ–¥–∫—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç" alt="–í—ñ–¥–∫—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç" id="btn_pgz_open" class="toolButton" src="./media/pgz-open.png" onclick="importGallery()">
    <img title="–ó–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ—î–∫—Ç" alt="–ó–±–µ—Ä–µ–≥—Ç–∏ –ø—Ä–æ—î–∫—Ç" id="btn_pgz_save" class="toolButton" src="./media/pgz-save.png" onclick="exportGallery()">
    <img title="–Ü–º–ø–æ—Ä—Ç —Ä–µ—Å—É—Ä—Å—ñ–≤" alt="–Ü–º–ø–æ—Ä—Ç —Ä–µ—Å—É—Ä—Å—ñ–≤" class="toolButton" src="./media/import.png" onclick="openImportModal()">
    <img title="–ì–∞–ª–µ—Ä–µ—è —Ä–µ—Å—É—Ä—Å—ñ–≤" alt="–ì–∞–ª–µ—Ä–µ—è —Ä–µ—Å—É—Ä—Å—ñ–≤" class="toolButton" src="./media/gallery.png" onclick="toggleShowGallery()">    
    <img title="–†–µ–¥–∞–∫—Ç–æ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω—å" alt="–†–µ–¥–∞–∫—Ç–æ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω—å" class="toolButton" src="./media/img-edit.png" onclick="showEditor()"> 
    <img title="–í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –∫–æ–¥" alt="–í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∫–æ–¥" id="btn_restore_code" class="toolButton" src="./media/restore-code.png" onclick="restoreLastSavedCode()">
    <img title="–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–π–ª–∏" data-i18n-title="share_title" alt="–§–∞–π–ª–∏ - –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏" data-i18n-alt="share_alt" id="btn_show_share" class="toolButton" src="./media/share.png">
    <img title="–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è" data-i18n-title="settings_title" alt="–ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –µ–∫—Ä–∞–Ω" data-i18n-alt="settings_alt" id="btn_show_settings" class="toolButton" src="./media/settings.png">
    <img title="–ü–æ—Å—ñ–±–Ω–∏–∫ –∑ Pygame Zero" alt="–ü–æ—Å—ñ–±–Ω–∏–∫ –∑ Pygame Zero" class="toolButton" src="./media/pgz-handbook.png"  onclick="showHandbook()">
   
  </div>
  <div id="hintBar" data-i18n="hint_bar" style="left:50px;margin-top:20px;font-size: 14px;z-index: 3500;color: #FFF;"></div>
  <!-- –ø—Ä–∞–≤–∞ —á–∞—Å—Ç–∏–Ω–∞: –ø–æ–ª–µ –Ω–∞–∑–≤–∏ –ø—Ä–æ—î–∫—Ç—É -->
  <input type="text" id="projectNameInput" 
         placeholder="–ù–∞–∑–≤–∞ –ø—Ä–æ—î–∫—Ç—É" 
         maxlength="32"
         style="
           padding: 6px 10px;
           border-radius: 20px;
           border: 2px solid #67ade8;
           background-color: white;
           font-family: inherit;
           font-size: 14px;
           min-width: 240px;
           max-width: 280px;
           box-sizing: border-box;
           margin-top: 20px;
           z-index: 10;           
         ">
</div>

<!-- –æ—Å–Ω–æ–≤–Ω–∏–π –º–∞–∫–µ—Ç -->
<div id="mainLayout" style="display: none; height: calc(100vh - 60px);background-color: #2a2a2a;">
  <!-- –ª—ñ–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ -->
  <div style="flex: 1; display: flex; flex-direction: column; min-width: 0;background-color: #2a2a2a;margin-bottom: 20px;">
    <div id="editorContainer" style="flex: 1; min-height: 0; border: 1px solid #444; background-color: #fff;position: relative;margin-top: 20px;margin-left: 10px;border-radius: 12px;">
      <span id="file_tabs" style="display:none;"><span class="file_tab file_tab_selected" data-i18n="file_tab_name">my_pgz.py</span></span>
      <div id="editor" style="position: absolute; height: 95%"></div>
    </div>
    <div id="consoleContainer" style="min-height: 220px;max-height: 300px;border-top: 1px solid #444; overflow: auto; padding: 8px; background-color: #000; color: #fff; font-family: monospace; font-size: 14px;border-radius: 10px;margin-top: 10px;margin-left: 10px;">
		<div id="output" style ="white-space: pre-wrap;word-break: break-word;"></div>		
    </div>
  </div>
     <!-- –ø—Ä–∞–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ -->
     <div id="rightBar" style="width: 20%;flex: 1; display: flex; flex-direction: column; min-width: 0;max-width:480px; background-color: #2a2a2a;margin-bottom: 20px;margin-right:20px;margin-top: 20px;">
		 <div class="container" id="splashImg" style="margin-left: 10px; display: flex;justify-content: center;align-items: center;height:100%;border-radius: 10px;background:#140b20;margin-bottom: -20px;">
			<img src="./media/splash.png" alt="" width="90%">
		</div>
        <iframe src="./pgz-handbook.html" id="handbook" 
					style="display: none; margin-left: 10px; justify-content: center;align-items: center;height:100%;border-radius: 10px;background:#140b20;margin-bottom: -20px;"
					title="–ü–æ—Å—ñ–±–Ω–∏–∫ –∑ Pygame Zero">
		</iframe>;

<!-- –≥–∞–ª–µ—Ä–µ—è —Ä–µ—Å—É—Ä—Å—ñ–≤ -->
<div id="resourceGallery" style="display: none; margin-top: -20px;">
  <div class="frame" id="imagesFrame">
    <h3>üñºÔ∏è –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è</h3>
    <div id="imagesList" class="assets-items-scroll"></div>
    <div class="controls-bar">
      <button onclick="addFile('image')" title="–î–æ–¥–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è">‚ûï</button>
      <span class="file-controls" id="imageControls" style="display:none;">
        <button onclick="showSelected('image')" title="–ü–æ–∫–∞–∑–∞—Ç–∏">üëÅÔ∏è</button>
        <button onclick="renameSelected('image')" title="–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏">‚úèÔ∏è</button>
        <button onclick="showEditor('image')" title="–†–µ–¥–∞–≥—É–≤–∞—Ç–∏">üé®Ô∏è</button>
        <button onclick="deleteSelected('image')" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóëÔ∏è</button>
      </span>
    </div>
  </div>

  <div class="frame" id="soundsFrame">
    <h3>üîä –ê—É–¥—ñ–æ</h3>
    <div id="soundsList" class="assets-items-scroll"></div>
    <div class="controls-bar">
      <button onclick="addFile('audio')" title="–î–æ–¥–∞—Ç–∏ –∞—É–¥—ñ–æ">‚ûï</button>
      <span class="file-controls" id="soundControls" style="display:none;">
        <button id="playBtn" onclick="togglePlayPause()" title="–ü—Ä–æ–≥—Ä–∞—Ç–∏">‚ñ∂Ô∏è</button>
        <button onclick="renameSelected('audio')" title="–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏">‚úèÔ∏è</button>
        <button onclick="deleteSelected('audio')" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóëÔ∏è</button>
      </span>
    </div>
  </div>

  <div class="frame" id="musicFrame">
    <h3>üéµ –ú—É–∑–∏–∫–∞</h3>
    <div id="musicList" class="assets-items-scroll"></div>
    <div class="controls-bar">
      <button onclick="addFile('music')" title="–î–æ–¥–∞—Ç–∏ –º—É–∑–∏—á–Ω–∏–π —Ñ–∞–π–ª">‚ûï</button>
      <span class="file-controls" id="musicControls" style="display:none;">
        <button id="playMusicBtn" onclick="togglePlayPauseMusic()" title="–ü—Ä–æ–≥—Ä–∞—Ç–∏">‚ñ∂Ô∏è</button>
        <button onclick="renameSelected('music')" title="–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏">‚úèÔ∏è</button>
        <button onclick="deleteSelected('music')" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóëÔ∏è</button>
      </span>
    </div>
  </div>
 <!-- 
    <div class="frame" id="fontsFrame">
    <h3>üî§ –®—Ä–∏—Ñ—Ç–∏</h3>
    <div id="fontsList" class="assets1-items-scroll"></div>
    <div class="controls-bar">
      <button onclick="addFile('font')" title="–î–æ–¥–∞—Ç–∏ —à—Ä–∏—Ñ—Ç">‚ûï</button>
      <span class="controls-bar" id="fontControls" style="display:none;">
        <button onclick="renameSelected('font')" title="–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏">‚úèÔ∏è</button>
        <button onclick="deleteSelected('font')" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóëÔ∏è</button>
      </span>
    </div>
  </div>
-->
</div>
    </div>
 </div>
 

 
<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —ñ–º–ø–æ—Ä—Ç—É -->
<div id="importModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center;">
  <div class="modal-content modal-dark"style="height:70vh; overflow:auto;">

        <div class="modal-header">
            <h3 class="modal-title" >üì• –Ü–º–ø–æ—Ä—Ç –∑–æ–±—Ä–∞–∂–µ–Ω—å</h3>
            <button class="modal-close" <button onclick="closeImportModal()" aria-label="Close">&times;</button>
        </div>

    <!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó -->
    <div id="importCategories" style="display:flex; flex-wrap:wrap; gap:8px; margin-left:10px;margin-bottom:15px;margin-top:10px;"></div>

    <!-- –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è -->
    <div id="importImages" style="display:flex; flex-wrap:wrap; gap:10px; max-height:450px; overflow-y:auto; padding:4px;"></div>

    <!-- –ö–Ω–æ–ø–∫–∞ —ñ–º–ø–æ—Ä—Ç—É -->
    <div id="importFileBtnContainer" style="margin-top:15px; text-align:center; display:none;">
      <button onclick="importSelectedImage()" style="background:#4caf50; color:white; border:0; border-radius:6px; padding:8px 20px; font-size:14px;">–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ñ–∞–π–ª</button>
    </div>
  </div>
</div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å -->
    <div id="modal" onclick="this.style.display='none'">
        <img id="modalImg" />
    </div>

		<div id="modal-container" class="modal-overlay" style="display:none;">
			<div class="modal-mcontent" style="width:400px; height:auto;background: #fff;padding: 20px;border-radius: 10px;font-family: sans-serif">
				<h3 id="modal-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h3>
				<p id="modal-text">–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...</p>
				<div id="modal-input-wrapper" class="modal-input-wrapper" style="display: none;">
					<input type="text" id="modal-input-field" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç —Ç—É—Ç...">
				</div>
				<div class="modal-buttons">
					<button id="modal-cancel-btn" class="btn btn-cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
					<button id="modal-ok-btn" class="btn btn-ok">OK</button>
				</div>
			</div>
		</div>
    <!-- –°–∫—Ä–∏–ø—Ç–∏ –ÑPython -->
    <script>
    Sk.builtin.jsfswrite = new Sk.builtin.func(function(filename, data) {
        Sk.builtin.pyCheckArgs("jsfswrite", arguments, 2, 2);
        if (!Sk.builtin.checkString(filename)) throw new Sk.builtin.TypeError("filename must be a string");
        if (!Sk.builtin.checkString(data)) throw new Sk.builtin.TypeError("data must be a string");
        const jsFilename = Sk.ffi.remapToJs(filename);
        const jsData = Sk.ffi.remapToJs(data);
        if (!Sk.__jsfs) Sk.__jsfs = new window.FileSystem("PGZfs");
        try { Sk.__jsfs.write(jsFilename, jsData, false); } 
        catch (e) { throw new Sk.builtin.IOError(e.message || "Failed to write to file"); }
        return Sk.builtin.none.none$;
    });
    </script>
<!--
    <script>
        let script = document.createElement('script');
        script.src = selectedLang === 'en' ? './lib/filedialog-en.js' : './lib/filedialog.js';
        document.head.appendChild(script);
    </script>
-->    
    <script src="./lib/customfile.js"></script>
    <script src="./lib/translations.js"></script>
    
    <!-- –¥–∞–Ω—ñ –ø—Ä–æ—î–∫—Ç—É -->
    <div id="myfilename.txt"></div>    
    <div id="recover" title="–§–∞–π–ª–∏ - –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è, –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è" style="display:none"></div>
    <div id="dlg" title="my_pgz.py" data-i18n-title="file_tab_name_title" style="display:none">       
    </div>
<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è/–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ -->
<div id="saveModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-dark">
        <div class="modal-header">
            <h3 class="modal-title" data-i18n="files_title">–§–∞–π–ª–∏ - –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è, –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è</h3>
            <button class="modal-close" id="btn_save_close" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body">
            
            <div class="files-container">
                
                <!-- –ö–Ω–æ–ø–∫–∞ –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ (–∑–≤–µ—Ä—Ö—É) -->
                <label class="file-action-button" id="btn_show_recover_label">
                    <div class="card-header">
                        <i class="fa fa-history"></i>
                        <h3 data-i18n="recover_btn">–í—ñ–¥–Ω–æ–≤–∏—Ç–∏</h3>
                    </div>
                    <div class="card-body">
                        <p data-i18n="recover_description">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ç–∞ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤–µ—Ä—Å—ñ—ó –≤–∞—à–æ–≥–æ py-–∫–æ–¥—É.</p>
                    </div>
                </label>

                <!-- –ö–Ω–æ–ø–∫–∞ –ó–±–µ—Ä–µ–≥—Ç–∏ py-–∫–æ–¥ (–ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ) -->
                <label class="file-action-button" id="btnDownloadLabel">
                    <div class="card-header">
                        <i class="fa fa-download"></i>
                        <h3 data-i18n="save_py_code">–ó–±–µ—Ä–µ–≥—Ç–∏ py-–∫–æ–¥</h3>
                    </div>
                    <div class="card-body">
                        <p data-i18n="save_description">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π py-–∫–æ–¥ —É —Ñ–∞–π–ª –Ω–∞ –≤–∞—à –∫–æ–º–ø'—é—Ç–µ—Ä.</p>
                        <div class="shortcut-hint">
                            <i class="fa fa-keyboard-o"></i>
                            <span>Ctrl + Alt + S</span>
                        </div>
                    </div>
                </label>

                <!-- –ö–Ω–æ–ø–∫–∞ –û—Ç—Ä–∏–º–∞—Ç–∏ py-–∫–æ–¥ (–∑–Ω–∏–∑—É) -->
                <label for="file-btn" class="file-action-button file-upload-button">
                    <div class="card-header">
                        <i class="fa fa-upload"></i>
                        <h3 data-i18n="get_py_code">–û—Ç—Ä–∏–º–∞—Ç–∏ py-–∫–æ–¥</h3>
                    </div>
                    <div class="card-body">
                        <p data-i18n="upload_file_instruction">–í–∏–±–µ—Ä—ñ—Ç—å Python-—Ñ–∞–π–ª, —â–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –π–æ–≥–æ –∑ –∫–æ–º–ø'—é—Ç–µ—Ä–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä.</p>
                    </div>
                    <input type="file" id="file-btn" accept=".py,.txt,.pyj" hidden>
                </label>

            </div>
            
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–æ—î–∫—Ç—É -->
<div id="projectSettingsModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-dark">
        <div class="modal-header">
            <h3 class="modal-title" data-i18n="project_title">–ü—Ä–æ—î–∫—Ç</h3>
            <button class="modal-close" id="btn_project_settings_close" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="settings-section">
                <div class="section-content">
                    <p class="setting-description" data-i18n="project_rename_help">
                        –ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É –¥–æ–ø–æ–º–æ–∂–µ –≤–∞–º —É–ø–æ—Ä—è–¥–∫—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –∫–æ–¥
                    </p>
                    
                    <div class="form-group">
                        <label for="txt_project_name" class="form-label" data-i18n="project_name_label">–ù–∞–∑–≤–∞ –ø—Ä–æ—î–∫—Ç—É:</label>
                        <input type="text" id="txt_project_name" name="txt_project_name" 
                               class="form-input" value="mycode" maxlength="50">
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button id="btn_project_ok" class="btn-primary">
                    <i class="fa fa-check"></i>
                    <span data-i18n="ok">OK</span>
                </button>
                <button id="btn_project_cancel" class="btn-secondary">
                    <i class="fa fa-times"></i>
                    <span data-i18n="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Ñ–∞–π–ª—É -->
<div id="fileSettingsModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-dark">
        <div class="modal-header">
            <h3 class="modal-title" data-i18n="file_title">–§–∞–π–ª</h3>
            <button class="modal-close" id="btn_file_settings_close" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body">
            <div class="settings-section">
                <div class="section-content">
                    <div class="warning-box">
                        <i class="fa fa-warning"></i>
                        <p class="warning-text" data-i18n="file_warning">
                            –ë—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ: —è–∫—â–æ –≤–∏ –≤–∏—Ä—ñ—à–∏—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ñ–∞–π–ª, –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –π–æ–≥–æ, —è–∫—â–æ –Ω–µ –∑–±–µ—Ä–µ–∂–µ—Ç–µ –∫–æ–ø—ñ—é
                        </p>
                    </div>
                    
                    <div class="form-group">
                        <label for="txt_file_name" class="form-label" data-i18n="file_rename_label">–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏ —Ñ–∞–π–ª:</label>
                        <input type="text" id="txt_file_name" name="txt_file_name" 
                               class="form-input" value="">
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button id="btn_file_rename" class="btn-primary">
                    <i class="fa fa-edit"></i>
                    <span data-i18n="rename_file">–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏</span>
                </button>
                <button id="btn_file_delete" class="btn-danger">
                    <i class="fa fa-trash"></i>
                    <span data-i18n="delete_file">–í–∏–¥–∞–ª–∏—Ç–∏</span>
                </button>
                <button id="btn_file_cancel" class="btn-secondary">
                    <i class="fa fa-times"></i>
                    <span data-i18n="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å -->
<div id="settingsModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-dark settings-modal" style="width:600px;">
        <div class="modal-header">
            <h3 class="modal-title" data-i18n="settings_title">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h3>
            <button class="modal-close" id="btn_settings_close" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body settings-body">
            <!-- –†–æ–∑–º—ñ—Ä–∏ —Ç–µ–∫—Å—Ç—É -->
            <div class="settings-section">
                <div class="section-header">                    
                    <h4 data-i18n="text_size_legend">–†–æ–∑–º—ñ—Ä–∏ —à—Ä–∏—Ñ—Ç—ñ–≤ —Ç–µ–∫—Å—Ç—É</h4>
                </div>
                <div class="section-content">
                    
                    <div class="setting-item">
                        <label for="txt_code_size" class="setting-label" data-i18n="code_font_size">–†–æ–∑–º—ñ—Ä —à—Ä–∏—Ñ—Ç—É —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–æ–¥—É:</label>
                        <div class="slider-container-settings" style="display: flex;flex-direction: column;">
                            <input type="text" id="txt_code_size" class="slider-value" style="width: 50px;" readonly>
                            <input type="range" id="slider_code_size" min="6" max="40" value="12" class="slider-native">
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <label for="txt_output_size" class="setting-label" data-i18n="output_font_size">–†–æ–∑–º—ñ—Ä —à—Ä–∏—Ñ—Ç—É –∫–æ–Ω—Å–æ–ª—ñ:</label>
                        <div class="slider-container-settings" style="display: flex;flex-direction: column;">
                            <input type="text" id="txt_output_size" class="slider-value" style="width: 50px;" readonly>
                            <input type="range" id="slider_output_size" min="6" max="40" value="12" class="slider-native">
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- –ö–æ–ª—å–æ—Ä–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
            <div class="settings-section">
                <div class="section-header">                    
                    <h4 data-i18n="editor_colors_legend">–ö–æ–ª—å–æ—Ä–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h4>
                </div>
                <div class="section-content">
                    <div class="radio-group" id="radio_code_style">
                        <label class="radio-label" for="radio_code_style_light">
                            <input type="radio" id="radio_code_style_light" name="radio_code_style" checked="checked">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="day">–î–µ–Ω—å</span>
                        </label>
                        <label class="radio-label" for="radio_code_style_dusk">
                            <input type="radio" id="radio_code_style_dusk" name="radio_code_style">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="dusk">–°—É—Ç—ñ–Ω–∫–∏</span>
                        </label>
                        <label class="radio-label" for="radio_code_style_dark">
                            <input type="radio" id="radio_code_style_dark" name="radio_code_style">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="night">–ù—ñ—á</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- –ö–æ–ª—å–æ—Ä–∏ –∫–æ–Ω—Å–æ–ª—ñ -->
            <div class="settings-section">
                <div class="section-header">                    
                    <h4 data-i18n="console_colors_legend">–ö–æ–ª—å–æ—Ä–∏ –∫–æ–Ω—Å–æ–ª—ñ</h4>
                </div>
                <div class="section-content">
                    <div class="radio-group" id="radio_output_style">
                        <label class="radio-label" for="radio_output_style_light">
                            <input type="radio" id="radio_output_style_light" name="radio_output_style">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="day">–î–µ–Ω—å</span>
                        </label>
                        <label class="radio-label" for="radio_output_style_dusk">
                            <input type="radio" id="radio_output_style_dusk" name="radio_output_style">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="dusk">–°—É—Ç—ñ–Ω–∫–∏</span>
                        </label>
                        <label class="radio-label" for="radio_output_style_dark">
                            <input type="radio" id="radio_output_style_dark" name="radio_output_style" checked="checked">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="night">–ù—ñ—á</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- –†–µ–∂–∏–º –∑–∞–ø—É—Å–∫—É -->
            <div class="settings-section">
                <div class="section-header">                    
                    <h4 data-i18n="run_mode_legend">–†–µ–∂–∏–º –∑–∞–ø—É—Å–∫—É</h4>
                </div>
                <div class="section-content">
                    <div class="radio-group" id="radio_run_mode">
                        <label class="radio-label" for="radio_run_mode_all">
                            <input type="radio" id="radio_run_mode_all" name="radio_run_mode" checked>
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="run_whole">–£—Å—è –ø—Ä–æ–≥—Ä–∞–º–∞</span>
                        </label>
                        <label class="radio-label" for="radio_run_mode_single">
                            <input type="radio" id="radio_run_mode_single" name="radio_run_mode">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="run_step">–ü–æ–∫—Ä–æ–∫–æ–≤–æ</span>
                        </label>
                        <label class="radio-label" for="radio_run_mode_anim">
                            <input type="radio" id="radio_run_mode_anim" name="radio_run_mode">
                            <span class="radio-custom"></span>
                            <span class="radio-text" data-i18n="run_animated">–ê–Ω—ñ–º–∞—Ü—ñ—è —Ä—è–¥–∫—ñ–≤</span>
                        </label>
                    </div>
                    
                    <div class="setting-item" id="anim_time_setting">
                        <label for="txt_step_anim_time" class="setting-label" data-i18n="delay_time">–ß–∞—Å –∑–∞—Ç—Ä–∏–º–∫–∏ –º—ñ–∂ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞:</label>
                        <div class="slider-container-settings" style="display: flex;flex-direction: column;">
                            <input type="text" id="txt_step_anim_time" class="slider-value" style="width: 50px;" readonly>
                            <input type="range" id="slider_step_anim_time" min="500" max="5000" step="500" value="500" class="slider-native">
                        </div>
                    </div>
                    
                </div>
            </div>
           
        </div>
    </div>
</div>
  <dialog id='filemanager'></dialog>
  
<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É -->
<div id="recoverModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-dark">
        <div class="modal-header">
            <h3 class="modal-title" data-i18n="recover_code">–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–¥—É</h3>
            <button class="modal-close" id="btn_recover_close" aria-label="Close">&times;</button>
        </div>
        <div class="modal-body">
            
            <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è -->
            <div class="modal-info">
                <p class="info-text" id="recover_info_text">
                    –ö–æ–ø—ñ—è –≤–∞—à–æ–≥–æ –∫–æ–¥—É –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É —Å—Ö–æ–≤–∏—â—ñ –≤–∞—à–æ–≥–æ –≤–µ–±–æ–≥–ª—è–¥–∞—á–∞ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –≤–∏ –π–æ–≥–æ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ.
                </p>
                <p class="info-count" id="recover_count_text">
                    –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–ø—ñ–π –∫–æ–¥—É, —è–∫—ñ –∑–∞—Ä–∞–∑ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Å—Ö–æ–≤–∏—â—ñ: <span id="vault_count">0</span>
                </p>
            </div>

            <!-- –°–ª–∞–π–¥–µ—Ä –¥–ª—è –≤–∏–±–æ—Ä—É –≤–µ—Ä—Å—ñ—ó -->
            <div class="slider-container-recover">
                <input type="range" id="slider_recover" min="0" max="0" value="0" class="slider-native-recover">
                <div id="recover_time" class="recover-time-info" style="margin-top:20px; background: #333;">
                    –ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å –ø–æ–≤–∑—É–Ω–æ–∫, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Å—Ç–∞–Ω –∫–æ–¥—É
                </div>
            </div>

            <!-- –§—Ä–µ–π–º –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –∫–æ–¥—É -->
            <div class="code-preview-frame">
                <div class="preview-header">
                    <span class="preview-title" data-i18n="code_preview">–ü–µ—Ä–µ–≥–ª—è–¥ –∫–æ–¥—É</span>
                    <span class="preview-file-name" id="preview_file_name">my_pgz.py</span>
                </div>
                <div class="preview-content">
                    <pre id="code_preview" class="code-preview"><code></code></pre>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
            <div class="modal-actions">
                <button id="btn_recover" class="btn-primary btn-recover">
                    <i class="fa fa-undo"></i>
                    <span data-i18n="restore_code">–í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –æ–±—Ä–∞–Ω—É –∫–æ–ø—ñ—é –∫–æ–¥—É</span>
                </button>
            </div>

            <!-- –°–µ–∫—Ü—ñ—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è -->
            <div class="warning-section">
                <p class="warning-text" id="recover_delete_info">
                    –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –∫–æ–ø—ñ—ó –∫–æ–¥—É, —â–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É —Å—Ö–æ–≤–∏—â—ñ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è.
                </p>
                <p class="warning-caution">
                    <i class="fa fa-warning"></i>
                    <span id="recover_warning_text">
                        –ë—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ: –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –≤–∏ –Ω–∞—Ç–∏—Å–Ω—É–ª–∏ –í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å–µ, –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Ü—é –¥—ñ—é.
                    </span>
                </p>
                <button id="btn_recover_clear" class="btn-danger">
                    <i class="fa fa-trash"></i>
                    <span data-i18n="delete_storage">–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å–µ –∑—ñ —Å—Ö–æ–≤–∏—â–∞</span>
                </button>
            </div>
            
        </div>
    </div>
</div>
<!-- 
    <script src="./lib/addfuncs.js"></script> 
-->
    <!--–ì–∞–ª–µ—Ä–µ—è —Ä–µ—Å—É—Ä—Å—ñ–≤ -->
    <script src="./lib/assets-gallery.js"></script>
    <script>
	function applyTranslations(lang) {
        const translation = translations[lang] || {};

        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (key && translation[key]) {
                element.textContent = translation[key];
            }
        });

        // –û–±—Ä–æ–±–ª—è—î–º–æ –≤—Å—ñ data-i18n-*, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: data-i18n-title="some_key"
        document.querySelectorAll('*').forEach(element => {
            [...element.attributes].forEach(attr => {
                if (attr.name.startsWith('data-i18n-')) {
                    const attrName = attr.name.replace('data-i18n-', ''); 
                    const translationKey = attr.value; 
                    if (translation[translationKey]) {
                        element.setAttribute(attrName, translation[translationKey]);
                    }
                }
            });
        });
        
        // –ü–µ—Ä–µ–∫–ª–∞–¥ jQuery UI –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –¥—ñ–∞–ª–æ–≥–æ–≤–∏—Ö –≤—ñ–∫–æ–Ω
        
        ukTranslations = translations['uk'];
        enTranslations = translations['en'];


    }
     
	applyTranslations(selectedLang);	
	PythonIDE.init('normal');	

    async function showEditor(filename = null) {
        const modal = document.createElement('div');
        modal.id = 'imageEditorModal';
        modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        `;

		const path = getPath(filename);

        // –ü–µ—Ä–µ–¥–∞—î–º–æ —ñ–º‚Äô—è —Ñ–∞–π–ª—É —á–µ—Ä–µ–∑ URL-–ø–∞—Ä–∞–º–µ—Ç—Ä
        const editorUrl = path 
            ? `draw-editor.html?load=${encodeURIComponent(path)}`
            : 'draw-editor.html';
    
        const iframe = document.createElement('iframe');
        iframe.src = editorUrl;
        iframe.style.cssText = `
            width: 80vw;
            height: 90vh;
            border: none;
            border-radius: 8px;
            background: white;
        `;
        iframe.id = 'drawEditorFrame';
    
        modal.appendChild(iframe);
        document.body.appendChild(modal);
    
        const messageHandler = async(event) => {
            if (event.source === iframe.contentWindow && event.data === 'closeEditor') {
                modal.remove();
                window.removeEventListener('message', messageHandler);
                await initializeAssetsGallery(); 
                console.log("Close editor")
            }
        };
    
        window.addEventListener('message', messageHandler);
    }	
	function showPGZ() {
			document.getElementById("pgz-playground").style.display = "block";
			document.getElementById("cdraw-editor").style.display = "none";
	}	
	async function showGallery() {
			document.getElementById("splashImg").style.display = "none";
			document.getElementById("handbook").style.display = "none";
			document.getElementById("resourceGallery").style.display = "block";
			await initializeAssetsGallery();
	}

	function showSplash() {
		document.getElementById("resourceGallery").style.display = "none";
		document.getElementById("handbook").style.display = "none";
		document.getElementById("splashImg").style.display = "block";
	}
	function toggleShowGallery() {
		const gallery = document.getElementById("resourceGallery").style.display;
		if (gallery=="none") {
			showGallery();
		} else {
			showSplash();
		}
	}

	function generateProjectName() {
    const project_names = [
        "HiddenJourney",
        "SilentQuest",
        "ArcaneExploit",
        "MysticVenture",
        "ShadowQuest",
        "ObscureTale",
        "SilentUndertaking",
        "ArcaneAdventure",
        "HiddenExploit",
        "MysticJourney",
        "ShadowJourney",
        "SilentExpedition",
        "ArcaneQuest",
        "HiddenLark",
        "MysticEscapade",
        "ShadowUndertaking",
        "SilentCode",
        "ArcaneJourney",
        "HiddenIncident",
        "MysticExploit",
        "ShadowAdventure",
        "SilentVenture",
        "ArcaneWorld",
        "HiddenQuest",
        "MysticUndertaking",
        "ShadowLark",
        "SilentEscapade",
        "ArcaneIncident",
        "HiddenCode",
        "MysticAdventure",
        "ShadowExpedition",
        "WhisperingQuest",
        "ArcaneLark",
        "HiddenVenture",
        "MysticIncident",
        "ShadowCode",
        "SilentJourney",
        "ArcaneUndertaking",
        "HiddenSpace",
        "EtherealAdventure",
        "VeiledJourney",
        "SilentExploit",
        "ArcaneCode",
        "HiddenEscapade",
        "MysticQuest",
        "ShadowExploit",
        "SilentLark",
        "ArcaneExpedition",
        "HiddenUndertaking",
        "MysticCode",
        "ShadowIncident",
        "SilentAdventure",
        "ArcaneVenture",
        "HiddenExpedition",
        "MysticLark",
        "ShadowEscapade",
        "SilentIncident",
        "ArcaneEscapade",
        "ObscureQuest",
        "ObscureAdventure",
        "ObscureJourney"
    ];

    const randomName = project_names[Math.floor(Math.random() * project_names.length)];
    return "my" + randomName + "Game";
}

// –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –∫–æ–¥
function restoreLastSavedCode() {
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –∫–æ–ø—ñ—ó
    if (!PythonIDE.vault || PythonIDE.vault.length === 0) {
        const message = selectedLang === 'en'
            ? 'No saved code backups found. Run your code first to create a backup.'
            : '–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –∫–æ–ø—ñ–π –∫–æ–¥—É. –°–ø–æ—á–∞—Ç–∫—É –∑–∞–ø—É—Å—Ç—ñ—Ç—å –∫–æ–¥, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω—É –∫–æ–ø—ñ—é.';
        PythonIDE.showHint(message);
        return;
    }
    
    // –û—Ç—Ä–∏–º—É—î–º–æ –æ—Å—Ç–∞–Ω–Ω—é –∑–±–µ—Ä–µ–∂–µ–Ω—É –∫–æ–ø—ñ—é (–Ω–∞–π–Ω–æ–≤—ñ—à—É)
    const lastSnapshot = PythonIDE.vault[PythonIDE.vault.length - 1];
    const files = JSON.parse(lastSnapshot.files);
    
    // –í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ —Ñ–∞–π–ª–∏
    PythonIDE.files = files;
    
    // –í–∏–∑–Ω–∞—á–∞—î–º–æ –∞–∫—Ç–∏–≤–Ω–∏–π —Ñ–∞–π–ª
    let restoreFile = PythonIDE.currentFile;
    if (!files[restoreFile]) {
        restoreFile = "my_pgz.py";
    }
    
    PythonIDE.currentFile = restoreFile;
    PythonIDE.editor.setValue(files[restoreFile]);
    PythonIDE.updateFileTabs();
    PythonIDE.editor.setCursor(0);
    
    // –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—à–Ω–µ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è
    const successMessage = selectedLang === 'en'
        ? `Code successfully restored from ${new Date(lastSnapshot.date).toLocaleString()}`
        : `–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ –∫–æ–¥ –≤—ñ–¥ ${new Date(lastSnapshot.date).toLocaleString()}`;
    PythonIDE.showHint(successMessage);
    
    console.log("–ö–æ–¥ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ –∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ—ó –∫–æ–ø—ñ—ó –≤—ñ–¥:", new Date(lastSnapshot.date));
}

	</script>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –≥—Ä–∏     background: rgba(64, 64, 64, 0.6);
    backdrop-filter: blur(8px); 
    -webkit-backdrop-filter: blur(8px); /* –¥–ª—è Safari */-->
<div id="gameModal" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 3000;
    justify-content: center;
    align-items: center;
">
  <div style="
      position: relative;
      max-width: 900px;
      max-height: 900px;
      display: flex;
      flex-direction: column;
      background: #1a1a1a;
      border-radius: 8px;
      border: solid 1px #222;
      overflow: hidden;
  ">
    <!-- –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑ –∫–Ω–æ–ø–∫–æ—é -->
    <div style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 5px 10px;
        background: #2a2a2a;
        color: white;
        font-weight: bold;
        font-size: 16px;
        border-bottom: 1px solid #444;
    ">
      <div style="width: 28px;"></div>
      <span id="gameTitle">Pygame Zero</span>
      <div id="cgb" style="display: none; width: 28px;"></div>
      <button id="closeGameBtn" style="
          background: #ff0000;
          color: white;
          border: solid 1px #222;
          border-radius: 5px;
          width: 28px;
          height: 24px;
          font-weight: bold;
          font-size: 18px;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          padding-bottom: 10px;
      ">√ó</button>
    </div>

    <!-- Canvas –ø—ñ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º -->
    <canvas id="gameCanvas" style="
        flex: 1;
        background-color: #000;
        display: block;
    "></canvas>
  </div>
</div>
<!-- –≤—ñ–∫–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É -->
<div id="newProjectModal" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.8);
    z-index: 4000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(4px);
">
 
   <div class="modal-content modal-dark"style="width:500px; overflow:auto;">

        <div class="modal-header">
            <h3 class="modal-title" >–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç</h3>
            <button class="modal-close" <button onclick="closeNewProjectModal()" aria-label="Close">&times;</button>
        </div>
 
 
        <form id="newProjectForm" style="margin:20px;">

            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: #ccc; font-size: 13px;">
                    –ù–∞–∑–≤–∞ –ø—Ä–æ—î–∫—Ç—É:
                </label>
                <input type="text" id="projectFileName" 
                       placeholder="myWonderfulGame" 
                       maxlength="50"
                       style="
                           width: 100%;
                           padding: 10px;
                           border-radius: 6px;
                           border: 1px solid #444;
                           background-color: #333;
                           color: white;
                           font-family: monospace;
                           font-size: 14px;
                           box-sizing: border-box;
                       ">
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: #ccc; font-size: 13px;">
                    –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤—ñ–∫–Ω–∞ –ø—Ä–æ—î–∫—Ç—É:
                </label>
                <input type="text" id="projectWindowTitle" 
                       placeholder="Pygame Zero" 
                       maxlength="60"
                       style="
                           width: 100%;
                           padding: 10px;
                           border-radius: 6px;
                           border: 1px solid #444;
                           background-color: #333;
                           color: white;
                           font-size: 14px;
                           box-sizing: border-box;
                       ">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 10px; color: #ccc; font-size: 13px;">
                    –†–æ–∑–º—ñ—Ä –≤—ñ–∫–Ω–∞ –ø—Ä–æ—î–∫—Ç—É:
                </label>
                
                <!-- –í–∏–±—ñ—Ä –∑—ñ —Å–ø–∏—Å–∫—É -->
                <div style="margin-bottom: 10px;">
                    <select id="presetWindowSize" style="
                        width: 100%;
                        padding: 8px;
                        border-radius: 6px;
                        border: 1px solid #444;
                        background-color: #333;
                        color: white;
                        font-size: 14px;
                        margin-bottom: 10px;
                    ">
                        <option value="custom">–í–ª–∞—Å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä</option>
                        <option value="1280x1024">1280√ó1024</option>
                        <option value="1280x960">1280√ó960</option>
                        <option value="1024x768">1024√ó768</option>
                        <option value="800x600">800√ó600</option>
                        <option value="720x480">720√ó480</option>
                        <option value="640x480">640√ó480</option>
                    </select>
                </div>
                
                <!-- –ü–æ–ª—è –¥–ª—è –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É -->
                <div style="display: flex; gap: 10px;">
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 3px; color: #888; font-size: 12px;">
                            –®–∏—Ä–∏–Ω–∞:
                        </label>
                        <input type="number" id="windowWidth" 
                               value="800"
                               min="100"
                               max="1920"
                               style="
                                   width: 100px;
                                   padding: 8px;
                                   border-radius: 6px;
                                   border: 1px solid #444;
                                   background-color: #333;
                                   color: white;
                                   font-size: 14px;
                               ">
                    </div>
                    <div style="flex: 1;">
                        <label style="display: block; margin-bottom: 3px; color: #888; font-size: 12px;">
                            –í–∏—Å–æ—Ç–∞:
                        </label>
                        <input type="number" id="windowHeight" 
                               value="600"
                               min="100"
                               max="1080"
                               style="
                                   width: 100px;
                                   padding: 8px;
                                   border-radius: 6px;
                                   border: 1px solid #444;
                                   background-color: #333;
                                   color: white;
                                   font-size: 14px;
                               ">
                    </div>
                </div>
            </div>

            <!-- –æ–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É -->
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 5px; color: #ccc; font-size: 13px;">
                    –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É:
                </label>
                <textarea id="projectDescription" 
                          placeholder="–û–ø–∏—à—ñ—Ç—å –≤–∞—à –ø—Ä–æ—î–∫—Ç —Ç—É—Ç..." 
                          rows="4"
                          style="
                              width: 100%;
                              padding: 10px;
                              border-radius: 6px;
                              border: 1px solid #444;
                              background-color: #333;
                              color: white;
                              font-size: 14px;
                              resize: vertical;
                              box-sizing: border-box;
                          "></textarea>
            </div>

            <!-- –∫–Ω–æ–ø–∫–∏ -->
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button type="button" onclick="closeNewProjectModal()" style="
                    flex: 1;
                    padding: 12px;
                    border-radius: 6px;
                    border: 0;
                    background: #555;
                    color: white;
                    font-size: 14px;
                    cursor: pointer;
                    transition: background 0.3s;
                " onmouseover="this.style.background='#666'" onmouseout="this.style.background='#555'">
                    –°–∫–∞—Å—É–≤–∞—Ç–∏
                </button>
                <button type="submit" style="
                    flex: 1;
                    padding: 12px;
                    border-radius: 6px;
                    border: 0;
                    background: #4caf50;
                    color: white;
                    font-size: 14px;
                    font-weight: bold;
                    cursor: pointer;
                    transition: background 0.3s;
                " onmouseover="this.style.background='#45a049'" onmouseout="this.style.background='#4caf50'">
                    –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç
                </button>
            </div>
        </form>
    </div>
</div>
<script>
document.getElementById('closeGameBtn').addEventListener('click', function() {
    PythonIDE.stop();
});


function showConsole() {
	console.log("showConsole")
		if (document.getElementById("consoleContainer").style.display != "none") {
			document.getElementById("consoleContainer").style.display = "none";
		} else {
			document.getElementById("consoleContainer").style.display = "block";
		}	
}
function showHandbook() {
	console.log("showHandbook")
	if (document.getElementById("handbook").style.display != "none") {
			document.getElementById("handbook").style.display = "none";
			document.getElementById("splashImg").style.display = "block";
		} else {
			document.getElementById("handbook").style.display = "block";
			document.getElementById("resourceGallery").style.display = "none";
		    document.getElementById("splashImg").style.display = "none";
		}
}
// –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
async function clearFolder(folderPath) {
	// –ø–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—è, —â–æ jsfs —ñ—Å–Ω—É—î
	if (typeof window.jsfs === 'undefined') {
		if (typeof window.FileSystem !== 'undefined') {
			window.jsfs = new window.FileSystem("PGZfs");
		} else {
			throw new Error("FileSystem not available");
		}
	}
        try {
            const entries = await window.jsfs.ls(folderPath, 'all');
            for (const entry of entries) {
                const fullPath = folderPath + '/' + entry;
                const entryType = await window.jsfs.type(fullPath);
                if (entryType === 'folder') {
                    await clearFolder(fullPath); // —Ä–µ–∫—É—Ä—Å—ñ—è
                    await window.jsfs.rm(fullPath); // –≤–∏–¥–∞–ª–∏—Ç–∏ –ø–æ—Ä–æ–∂–Ω—é —Ç–µ–∫—É
                } else if (entryType === 'file') {
                    await window.jsfs.rm(fullPath);
                }
            }
        } catch (e) {
            if (!e.message?.includes('Invalid folder')) {
                console.warn('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—á–∏—â–µ–Ω–Ω—ñ:', folderPath, e);
            }
        }
    }

// –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
async function clearProjectResources() {	

    await clearFolder('images');
    await clearFolder('sounds');
    await clearFolder('music');
    document.getElementById("imagesList").innerHTML = "";
	document.getElementById("soundsList").innerHTML = "";
	document.getElementById("musicList").innerHTML = "";

    if (typeof initializeAssetsGallery === 'function') {
            showSplash();
        }
	document.getElementById('output').innerHTML = '';
}
//
// —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É
async function createNewProject() {
    document.getElementById('newProjectModal').style.display = 'flex';
    
    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
    document.getElementById('projectFileName').value = generateProjectName();
    document.getElementById('projectWindowTitle').value = 'Pygame Zero';
    document.getElementById('windowWidth').value = '800';
    document.getElementById('windowHeight').value = '600';
    document.getElementById('presetWindowSize').value = 'custom';
    document.getElementById('projectDescription').value = '';
    
    // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ—ó —Ñ–æ—Ä–º–∏
    document.getElementById('newProjectForm').onsubmit = function(e) {
        e.preventDefault();
        createProjectFromModal();
    };
}

// –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
function closeNewProjectModal() {
    document.getElementById('newProjectModal').style.display = 'none';
}

// –æ–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É –ø—Ä–µ—Å–µ—Ç—É —Ä–æ–∑–º—ñ—Ä—É
document.getElementById('presetWindowSize').addEventListener('change', function() {
    const preset = this.value;
    const widthInput = document.getElementById('windowWidth');
    const heightInput = document.getElementById('windowHeight');
    
    if (preset !== 'custom') {
        const [width, height] = preset.split('x');
        widthInput.value = width;
        heightInput.value = height;
        
        // –ó–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –ø–æ–ª—è –¥–ª—è –ø—Ä–µ—Å–µ—Ç—ñ–≤
        widthInput.disabled = true;
        heightInput.disabled = true;
    } else {
        // –†–æ–∑–±–ª–æ–∫—É–≤–∞—Ç–∏ –ø–æ–ª—è –¥–ª—è –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É
        widthInput.disabled = false;
        heightInput.disabled = false;
    }
});

// —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É –∑ –¥–∞–Ω–∏—Ö –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
async function createProjectFromModal() {
    const fileName = document.getElementById('projectFileName').value.trim();
    const windowTitle = document.getElementById('projectWindowTitle').value.trim();
    const width = parseInt(document.getElementById('windowWidth').value);
    const height = parseInt(document.getElementById('windowHeight').value);
    const description = document.getElementById('projectDescription').value.trim();
    
    // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö
    if (!fileName) {
        await message('–ü–æ–º–∏–ª–∫–∞', '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ñ–∞–π–ª—É –ø—Ä–æ—î–∫—Ç—É');
        return;
    }
    
    if (!windowTitle) {
        await message('–ü–æ–º–∏–ª–∫–∞', '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤—ñ–∫–Ω–∞ –ø—Ä–æ—î–∫—Ç—É');
        return;
    }
    
    if (isNaN(width) || width < 100 || width > 1920) {
        await message('–ü–æ–º–∏–ª–∫–∞', '–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∞ —à–∏—Ä–∏–Ω–∞ –≤—ñ–∫–Ω–∞ (100-1920)');
        return;
    }
    
    if (isNaN(height) || height < 100 || height > 1080) {
        await message('–ü–æ–º–∏–ª–∫–∞', '–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∞ –≤–∏—Å–æ—Ç–∞ –≤—ñ–∫–Ω–∞ (100-1080)');
        return;
    }
    
    // –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É
    const confirm = await askConfirm(
        '–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç',
        `–í–∏ –¥—ñ–π—Å–Ω–æ —Ö–æ—á–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –ø—Ä–æ—î–∫—Ç?\n–ù–∞–∑–≤–∞ —Ñ–∞–π–ª—É: ${fileName}\n–†–æ–∑–º—ñ—Ä: ${width}√ó${height}\n\n–£–≤–∞–≥–∞: –≤—Å—ñ —Ñ–∞–π–ª–∏ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É –±—É–¥—É—Ç—å –≤–∏–¥–∞–ª–µ–Ω—ñ!`
    );    
    if (!confirm) {
        return;
    }
    
    await clearProjectResources();
    
    // —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –∫–æ–¥—É –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    const pgzTemplate = `import pgzrun

# ${description || 'Pygame Zero'}

WIDTH = ${width}
HEIGHT = ${height}

TITLE = "${windowTitle}"

# –í–∞—à –∫–æ–¥ –º–∞—î –±—É—Ç–∏ —Ç—É—Ç


pgzrun.go()
`;
    
    if (typeof PythonIDE !== 'undefined') {
        PythonIDE.files['my_pgz.py'] = pgzTemplate;
        PythonIDE.currentFile = 'my_pgz.py';
        if (PythonIDE.editor && typeof PythonIDE.editor.setValue === 'function') {
            PythonIDE.editor.setValue(pgzTemplate);
        }
        console.log(`–ü—Ä–æ—î–∫—Ç ${fileName} —Å—Ç–≤–æ—Ä–µ–Ω–æ –∑ —Ä–æ–∑–º—ñ—Ä–æ–º ${width}√ó${height}`);
    } else {
        console.warn('PythonIDE –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π ‚Äî –∫–æ–¥ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ.');
    }
    
    document.getElementById('projectNameInput').value = fileName;    
    closeNewProjectModal();

}

// –∫–µ—Ä—É–≤–∞–Ω–Ω—è –º–æ–¥–∞–ª—å–Ω–∏–º –≤—ñ–∫–Ω–æ–º –¥–ª—è message/confirm/input
const ModalUI = {
            container: document.getElementById('modal-container'),
            title: document.getElementById('modal-title'),
            text: document.getElementById('modal-text'),
            inputWrapper: document.getElementById('modal-input-wrapper'),
            inputField: document.getElementById('modal-input-field'),
            okBtn: document.getElementById('modal-ok-btn'),
            cancelBtn: document.getElementById('modal-cancel-btn'),

            show(title, text, type) {
                return new Promise((resolve) => {
                    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É
                    this.title.innerText = title;
                    this.text.innerText = text;
                    this.inputField.value = '';
                    
                    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
                    this.inputWrapper.style.display = (type === 'input') ? 'block' : 'none';
                    this.cancelBtn.style.display = (type === 'message') ? 'none' : 'inline-block';
                    this.container.style.display = 'flex';

                    // –û–±—Ä–æ–±–∫–∞ –∫–Ω–æ–ø–æ–∫
                    const cleanup = () => {
                        this.container.style.display = 'none';
                    };

                    this.okBtn.onclick = () => {
                        cleanup();
                        resolve(type === 'input' ? this.inputField.value : true);
                    };

                    this.cancelBtn.onclick = () => {
                        cleanup();
                        resolve(type === 'input' ? null : false);
                    };

                    // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª—ñ –≤–≤–µ–¥–µ–Ω–Ω—è, —è–∫—â–æ —Ü–µ input
                    if (type === 'input') {
                        setTimeout(() => this.inputField.focus(), 100);
                    }
                });
            }
        };
// –≤–∏–≤–µ–¥–µ–Ω–Ω—è —Ç–∞ –≤–≤–µ–¥–µ–Ω–Ω—è
async function message(title, text) {
			document.getElementById('modal-container').style.display = 'none'
            return await ModalUI.show(title, text, 'message');
            
}

async function askConfirm(title, text) {
            return await ModalUI.show(title, text, 'confirm');
}

async function input(title, text) {
            return await ModalUI.show(title, text, 'input');
}  
</script>
<!-- –ü—Ä–∏—Ö–æ–≤–∞–Ω–∏–π input –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (–ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è lib.js) -->
<input type="file" id="file-btn" hidden> 
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const rawUrl = urlParams.get('run') || urlParams.get('pgz');	
  window.addEventListener('load', async () => {
		document.getElementById("page-loader")?.remove();
		if (!rawUrl) {
			    document.getElementById('topPanel').style.display = 'flex';
				document.getElementById('mainLayout').style.display = 'flex';
				document.getElementById('playGameBtn').style.display = 'none';
			} else {
			    document.getElementById('playGameBtn').style.display = 'block';
				await loadProjectFromUrl(rawUrl);
				}
	});
	
    document.getElementById('projectNameInput').value = generateProjectName();
</script>
</body>
</html>

